2024-10-22 16:59:32,674 - INFO - AlphaZero_Agent initialized.
2024-10-22 16:59:32,702 - INFO - Agent state has been reset.
2024-10-22 16:59:32,702 - INFO - === Starting MCTS Search ===
2024-10-22 16:59:32,703 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 40, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B3 || XX|RYGWB12345
R4 || XX|RYGWB12345
G2 || XX|RYGWB12345
R3 || XX|RYGWB12345
Y1 || XX|RYGWB12345
Deck size: 40
Discards:}
2024-10-22 16:59:32,703 - INFO - Max Rollouts: 10
2024-10-22 16:59:32,703 - DEBUG - --- Rollout #1 ---
2024-10-22 16:59:32,704 - DEBUG - Node () is a leaf node.
2024-10-22 16:59:32,705 - DEBUG - Traversing Path: ['()']
2024-10-22 16:59:32,942 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:32,945 - DEBUG - Network Policy Logits: [[ 0.03441123  0.0007694  -0.03565385 -0.02344893 -0.00527955  0.07446578
  -0.03303142 -0.00465673  0.02045616  0.08512619 -0.05119294  0.0092334
  -0.0794113   0.01943907  0.05652038 -0.00103892 -0.04275962 -0.03539212
   0.04163882 -0.02732581]]
2024-10-22 16:59:32,945 - DEBUG - Network Policy after Softmax: [[0.05169699 0.04998673 0.04819881 0.04879068 0.04968528 0.05380972
  0.04832538 0.04971623 0.05098056 0.05438642 0.04745563 0.05041162
  0.04613524 0.05092873 0.05285269 0.04989642 0.04785754 0.04821143
  0.05207198 0.04860189]]
2024-10-22 16:59:32,948 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.5085875  0.         0.49141255
  0.         0.        ]]
2024-10-22 16:59:32,949 - DEBUG - Dirichlet Noise Added: [0.        0.        0.        0.        0.        0.        0.
 0.        0.        0.        0.        0.        0.        0.
 0.        0.3814406 0.        0.6185594 0.        0.       ]
2024-10-22 16:59:32,951 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.3814406096935272
2024-10-22 16:59:32,951 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.6185594201087952
2024-10-22 16:59:32,951 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 16:59:32,951 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:32,952 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 40, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B3 || XX|RYGWB12345
R4 || XX|RYGWB12345
G2 || XX|RYGWB12345
R3 || XX|RYGWB12345
Y1 || XX|RYGWB12345
Deck size: 40
Discards:}
2024-10-22 16:59:32,952 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:32,952 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 16:59:32,952 - DEBUG - --- Rollout #2 ---
2024-10-22 16:59:32,952 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 16:59:32,952 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 16:59:32,953 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:33,167 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:33,167 - DEBUG - Network Policy Logits: [[ 0.02060659 -0.00874021 -0.02395651 -0.01699612  0.03197363  0.06587543
  -0.02944519  0.01383231  0.02775224  0.07869348 -0.05500006 -0.02026204
  -0.05284145  0.04551031  0.05641287  0.00911897 -0.0421595  -0.02151981
   0.03031248 -0.01706073]]
2024-10-22 16:59:33,167 - DEBUG - Network Policy after Softmax: [[0.05076914 0.04930087 0.04855638 0.04889553 0.05134952 0.05312021
  0.0482906  0.05042638 0.05113322 0.05380549 0.04707217 0.0487361
  0.04717389 0.05204935 0.05261993 0.05018925 0.0476805  0.04867484
  0.05126429 0.04889237]]
2024-10-22 16:59:33,170 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.25355515 0.
  0.         0.         0.         0.2656823  0.         0.
  0.23293659 0.         0.         0.24782595 0.         0.
  0.         0.        ]]
2024-10-22 16:59:33,170 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 4)) | P=0.26568230986595154
2024-10-22 16:59:33,171 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 4)) | P=0.25355514883995056
2024-10-22 16:59:33,172 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.24782595038414001
2024-10-22 16:59:33,173 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color G)) | P=0.23293659090995789
2024-10-22 16:59:33,173 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 16:59:33,173 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:33,173 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 40, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 17, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 0}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
-----
G1 || XX|RYGWB12345
G5 || XX|RYGWB12345
B1 || XX|RYGWB12345
W3 || XX|RYGWB12345
Y3 || XX|RYGWB12345
Deck size: 40
Discards:}
2024-10-22 16:59:33,173 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:33,173 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 16:59:33,173 - DEBUG - --- Rollout #3 ---
2024-10-22 16:59:33,174 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 16:59:33,174 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 16:59:33,175 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 0 | Depth: 1
2024-10-22 16:59:33,366 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:33,367 - DEBUG - Network Policy Logits: [[ 0.00578195 -0.02905065 -0.03105932 -0.04672832 -0.02581939  0.03863796
  -0.00795675 -0.0218085   0.03493451  0.07150991 -0.04354947 -0.02794009
  -0.0891277   0.01803435  0.04669567  0.01445349 -0.07440337 -0.03219752
   0.06625697 -0.02636996]]
2024-10-22 16:59:33,368 - DEBUG - Network Policy after Softmax: [[0.05064642 0.04891264 0.04881449 0.04805558 0.04907095 0.05233809
  0.04995536 0.04926816 0.05214462 0.05408714 0.04820858 0.04896699
  0.04606064 0.05127077 0.05276152 0.05108751 0.04674387 0.04875896
  0.05380377 0.04904394]]
2024-10-22 16:59:33,370 - DEBUG - Normalized Policy: [[0.32781819 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.3415086  0.33067325 0.         0.
  0.         0.        ]]
2024-10-22 16:59:33,371 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 0)) | P=0.3278181850910187
2024-10-22 16:59:33,372 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1)) | P=0.3306732475757599
2024-10-22 16:59:33,373 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color B)) | P=0.3415085971355438
2024-10-22 16:59:33,373 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 16:59:33,373 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:33,373 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 40, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 0}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 0}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [], 'card_knowledge': [[{'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X3|RYGWB3
XX || XX|RYGWB1245
XX || XX|RYGWB1245
XX || X3|RYGWB3
XX || XX|RYGWB1245
-----
B1 || XX|RYGWB12345
G4 || XX|RYGWB12345
B1 || XX|RYGWB12345
R2 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 40
Discards:}
2024-10-22 16:59:33,373 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:33,373 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 16:59:33,373 - DEBUG - --- Rollout #4 ---
2024-10-22 16:59:33,375 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.5613899827003479 | PUCT: 0.5613899827003479
2024-10-22 16:59:33,375 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.9103725552558899 | PUCT: 0.9103725552558899
2024-10-22 16:59:33,375 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.9103725552558899
2024-10-22 16:59:33,375 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 16:59:33,375 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Reveal player +1 rank 1))
2024-10-22 16:59:33,375 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 rank 1))']
2024-10-22 16:59:33,376 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 0 | Depth: 1
2024-10-22 16:59:33,376 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 16:59:33,376 - DEBUG - Backpropagating reward: 0
2024-10-22 16:59:33,376 - DEBUG - Rollout #4 completed with reward=0
2024-10-22 16:59:33,376 - DEBUG - --- Rollout #5 ---
2024-10-22 16:59:33,377 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.6048867106437683 | PUCT: 0.6048867106437683
2024-10-22 16:59:33,378 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.6539390683174133 | PUCT: 0.6539390683174133
2024-10-22 16:59:33,378 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.6539390683174133
2024-10-22 16:59:33,378 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 16:59:33,378 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Reveal player +1 color B))
2024-10-22 16:59:33,378 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 color B))']
2024-10-22 16:59:33,379 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 0 | Depth: 1
2024-10-22 16:59:33,379 - DEBUG - Illegal move encountered: (Reveal player +1 color B)
2024-10-22 16:59:33,379 - DEBUG - Backpropagating reward: 0
2024-10-22 16:59:33,379 - DEBUG - Rollout #5 completed with reward=0
2024-10-22 16:59:33,379 - DEBUG - --- Rollout #6 ---
2024-10-22 16:59:33,380 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.6382293701171875 | PUCT: 0.6382293701171875
2024-10-22 16:59:33,380 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.5174891948699951 | PUCT: 0.5174891948699951
2024-10-22 16:59:33,380 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.6382293701171875
2024-10-22 16:59:33,380 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:33,380 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Play 4))
2024-10-22 16:59:33,380 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Play 4))']
2024-10-22 16:59:33,381 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:33,382 - DEBUG - Move: (Play 4) | Reward: 1 | Depth: 2
2024-10-22 16:59:33,572 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:33,572 - DEBUG - Network Policy Logits: [[ 0.0286757   0.00485617 -0.03644475 -0.0252686  -0.00503611  0.07973584
   0.00426202  0.01657438  0.03289257  0.08529755 -0.03810921 -0.00045215
  -0.07969502  0.03558787  0.04662312  0.01348189 -0.03643344 -0.01642188
   0.03103023 -0.02372996]]
2024-10-22 16:59:33,573 - DEBUG - Network Policy after Softmax: [[0.05111274 0.04990965 0.04789032 0.04842855 0.04941836 0.05379034
  0.04988    0.05049793 0.05132873 0.05409034 0.04781067 0.04964541
  0.0458632  0.05146727 0.05203837 0.05034202 0.04789086 0.04885888
  0.05123323 0.04850312]]
2024-10-22 16:59:33,574 - DEBUG - Normalized Policy: [[0.5112725 0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.4887275 0.        0.       ]]
2024-10-22 16:59:33,574 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 4), (Discard 0)) | P=0.5112724900245667
2024-10-22 16:59:33,575 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 4), (Reveal player +1 rank 3)) | P=0.48872750997543335
2024-10-22 16:59:33,575 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Play 4)) | Value: 0.0
2024-10-22 16:59:33,575 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:33,575 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 1, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R1 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B3 || XX|RYGWB2345
R4 || XX|RYGWB2345
G2 || XX|RYGWB2345
R3 || XX|RYGWB2345
Y3 || XX|RYGWB12345
Deck size: 39
Discards:}
2024-10-22 16:59:33,575 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:33,575 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 16:59:33,575 - DEBUG - --- Rollout #7 ---
2024-10-22 16:59:33,576 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.44341161847114563 | PUCT: 0.44341161847114563
2024-10-22 16:59:33,576 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.5392905473709106 | PUCT: 0.5392905473709106
2024-10-22 16:59:33,576 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.5392905473709106
2024-10-22 16:59:33,576 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 16:59:33,576 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Discard 0))
2024-10-22 16:59:33,576 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Discard 0))']
2024-10-22 16:59:33,577 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 0 | Depth: 1
2024-10-22 16:59:33,577 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 2
2024-10-22 16:59:33,778 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:33,779 - DEBUG - Network Policy Logits: [[-0.00252276  0.0210798   0.00760459 -0.04491082 -0.01607329  0.09680113
  -0.00971655  0.00036849  0.0025728   0.07279302 -0.05024144  0.02046451
  -0.08161576  0.02814029  0.02405463 -0.00731118 -0.03791949 -0.02663733
   0.05379549 -0.06885199]]
2024-10-22 16:59:33,779 - DEBUG - Network Policy after Softmax: [[0.04987122 0.05106232 0.05037885 0.04780146 0.0492     0.05507898
  0.04951375 0.05001562 0.050126   0.05377238 0.04754733 0.0510309
  0.04607872 0.05142412 0.05121444 0.04963299 0.04813682 0.04868299
  0.05276048 0.04667063]]
2024-10-22 16:59:33,781 - DEBUG - Normalized Policy: [[0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.4892691 0.        0.        0.
  0.        0.5107309 0.        0.        0.        0.       ]]
2024-10-22 16:59:33,783 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 0), (Reveal player +1 color R)) | P=0.48926910758018494
2024-10-22 16:59:33,783 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 0), (Reveal player +1 rank 1)) | P=0.5107309222221375
2024-10-22 16:59:33,784 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Discard 0)) | Value: 0.0
2024-10-22 16:59:33,784 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:33,784 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 11, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
R4 || XX|RYGWB1245
G2 || XX|RYGWB1245
R3 || X3|RYGWB3
Y1 || XX|RYGWB1245
G1 || XX|RYGWB12345
Deck size: 39
Discards: W3}
2024-10-22 16:59:33,784 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:33,784 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 16:59:33,784 - DEBUG - --- Rollout #8 ---
2024-10-22 16:59:33,785 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.45837298035621643 | PUCT: 0.45837298035621643
2024-10-22 16:59:33,785 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4459896683692932 | PUCT: 0.4459896683692932
2024-10-22 16:59:33,786 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.45837298035621643
2024-10-22 16:59:33,786 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:33,786 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 color G))
2024-10-22 16:59:33,786 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 color G))']
2024-10-22 16:59:33,787 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:33,787 - DEBUG - Move: (Reveal player +1 color G) | Reward: 0 | Depth: 2
2024-10-22 16:59:34,008 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:34,008 - DEBUG - Network Policy Logits: [[ 0.05614261 -0.01575967  0.00740055  0.00813103 -0.02666904  0.06563873
   0.03168627 -0.00483226  0.05722269  0.03198315 -0.00070821 -0.03710727
  -0.11269489 -0.00220026  0.03516082 -0.00474255 -0.04081628  0.00225071
   0.02925128  0.00121468]]
2024-10-22 16:59:34,009 - DEBUG - Network Policy after Softmax: [[0.052634   0.04898236 0.05013004 0.05016667 0.04845089 0.0531362
  0.05136238 0.04952054 0.05269088 0.05137763 0.04972519 0.04794778
  0.04445711 0.04965105 0.05154116 0.04952498 0.04777027 0.04987254
  0.05123747 0.0498209 ]]
2024-10-22 16:59:34,010 - DEBUG - Normalized Policy: [[0.         0.33366123 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.3266138
  0.         0.         0.         0.         0.         0.33972502
  0.         0.        ]]
2024-10-22 16:59:34,011 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color G), (Reveal player +1 color Y)) | P=0.32661381363868713
2024-10-22 16:59:34,012 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color G), (Discard 1)) | P=0.3336612284183502
2024-10-22 16:59:34,012 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color G), (Reveal player +1 rank 3)) | P=0.3397250175476074
2024-10-22 16:59:34,012 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Reveal player +1 color G)) | Value: 0.0
2024-10-22 16:59:34,012 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:34,012 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 40, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [], 'card_knowledge': [[{'color': 'G', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || GX|G12345
XX || XX|RYWB12345
XX || XX|RYWB12345
XX || XX|RYWB12345
XX || XX|RYWB12345
-----
B3 || XX|RYGWB2345
R4 || XX|RYGWB2345
G2 || XX|RYGWB2345
R3 || XX|RYGWB2345
Y1 || X1|RYGWB1
Deck size: 40
Discards:}
2024-10-22 16:59:34,012 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:34,013 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 16:59:34,013 - DEBUG - --- Rollout #9 ---
2024-10-22 16:59:34,013 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.35338181257247925 | PUCT: 0.35338181257247925
2024-10-22 16:59:34,014 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4584465026855469 | PUCT: 0.4584465026855469
2024-10-22 16:59:34,014 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.4584465026855469
2024-10-22 16:59:34,014 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 16:59:34,014 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.524380087852478 | PUCT: 0.524380087852478
2024-10-22 16:59:34,015 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Reveal player +1 color B)) | Q: 0.0 | U: 0.5415627360343933 | PUCT: 0.5415627360343933
2024-10-22 16:59:34,015 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Discard 0)) | Q: 0.0 | U: 0.5198525190353394 | PUCT: 0.5198525190353394
2024-10-22 16:59:34,015 - DEBUG - Selected Child: ((Reveal player +1 rank 3), (Reveal player +1 color B)) | PUCT: 0.5415627360343933
2024-10-22 16:59:34,015 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3), (Reveal player +1 color B))
2024-10-22 16:59:34,015 - DEBUG - Node ((Reveal player +1 rank 3), (Reveal player +1 color B)) is a leaf node.
2024-10-22 16:59:34,015 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 color B))']
2024-10-22 16:59:34,016 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 0 | Depth: 1
2024-10-22 16:59:34,016 - DEBUG - Move: (Reveal player +1 color B) | Reward: 0 | Depth: 2
2024-10-22 16:59:34,205 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:34,205 - DEBUG - Network Policy Logits: [[ 0.03218093 -0.0039387  -0.02201767 -0.01765785 -0.01576181  0.01598758
  -0.04547648  0.00248449 -0.01373227  0.03058561 -0.0695039  -0.01501412
  -0.03334389  0.03058761  0.04718526  0.03585076 -0.00599314 -0.01794888
   0.03612046 -0.02547646]]
2024-10-22 16:59:34,206 - DEBUG - Network Policy after Softmax: [[0.05175342 0.04991746 0.04902312 0.04923731 0.04933076 0.05092211
  0.04788647 0.05023912 0.04943098 0.05167092 0.0467496  0.04936766
  0.048471   0.05167102 0.0525358  0.0519437  0.04981501 0.04922299
  0.0519577  0.04885385]]
2024-10-22 16:59:34,207 - DEBUG - Normalized Policy: [[0.         0.24816464 0.         0.         0.         0.
  0.         0.         0.         0.         0.23241562 0.
  0.         0.         0.2611817  0.25823808 0.         0.
  0.         0.        ]]
2024-10-22 16:59:34,208 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color B), (Reveal player +1 color R)) | P=0.23241561651229858
2024-10-22 16:59:34,209 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color B), (Discard 1)) | P=0.24816463887691498
2024-10-22 16:59:34,209 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color B), (Reveal player +1 rank 1)) | P=0.2582380771636963
2024-10-22 16:59:34,210 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color B), (Reveal player +1 color B)) | P=0.26118171215057373
2024-10-22 16:59:34,210 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 16:59:34,210 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:34,211 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 40, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [], 'card_knowledge': [[{'color': 'B', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || BX|B12345
XX || XX|RYGW12345
XX || XX|RYGW12345
XX || XX|RYGW12345
XX || XX|RYGW12345
-----
B3 || X3|RYGWB3
R4 || XX|RYGWB1245
G2 || XX|RYGWB1245
R3 || X3|RYGWB3
Y1 || XX|RYGWB1245
Deck size: 40
Discards:}
2024-10-22 16:59:34,211 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:34,211 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 16:59:34,211 - DEBUG - --- Rollout #10 ---
2024-10-22 16:59:34,212 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3617551922798157 | PUCT: 0.3617551922798157
2024-10-22 16:59:34,212 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.39109113812446594 | PUCT: 0.39109113812446594
2024-10-22 16:59:34,212 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.39109113812446594
2024-10-22 16:59:34,212 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 16:59:34,213 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5532850027084351 | PUCT: 0.5532850027084351
2024-10-22 16:59:34,213 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Reveal player +1 color B)) | Q: 0.0 | U: 0.3809432089328766 | PUCT: 0.3809432089328766
2024-10-22 16:59:34,213 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Discard 0)) | Q: 0.0 | U: 0.5485079288482666 | PUCT: 0.5485079288482666
2024-10-22 16:59:34,213 - DEBUG - Selected Child: ((Reveal player +1 rank 3), (Reveal player +1 rank 1)) | PUCT: 0.5532850027084351
2024-10-22 16:59:34,214 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3), (Reveal player +1 rank 1))
2024-10-22 16:59:34,214 - DEBUG - Node ((Reveal player +1 rank 3), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 16:59:34,214 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 rank 1))']
2024-10-22 16:59:34,214 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 0 | Depth: 1
2024-10-22 16:59:34,215 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:34,423 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:34,424 - DEBUG - Network Policy Logits: [[ 0.03031726  0.02302455 -0.00103112 -0.02101937 -0.01340333 -0.00160591
  -0.04077016  0.0076356  -0.02157147  0.03613938 -0.02940157 -0.01523403
  -0.00910765  0.02463208  0.01236802 -0.02312021  0.0105926  -0.04175483
   0.03344621  0.00326635]]
2024-10-22 16:59:34,424 - DEBUG - Network Policy after Softmax: [[0.05161933 0.05124426 0.05002625 0.04903624 0.04941113 0.0499975
  0.04807724 0.0504617  0.04900918 0.05192074 0.04862693 0.04932075
  0.04962384 0.0513267  0.05070107 0.04893333 0.05061113 0.04802992
  0.0517811  0.0502417 ]]
2024-10-22 16:59:34,426 - DEBUG - Normalized Policy: [[0.         0.         0.20111114 0.         0.         0.
  0.         0.20286168 0.         0.         0.1954857  0.
  0.         0.         0.20382398 0.19671747 0.         0.
  0.         0.        ]]
2024-10-22 16:59:34,427 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.19671747088432312
2024-10-22 16:59:34,427 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.203823983669281
2024-10-22 16:59:34,428 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1), (Play 2)) | P=0.20286168158054352
2024-10-22 16:59:34,429 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1), (Reveal player +1 color R)) | P=0.1954856961965561
2024-10-22 16:59:34,429 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1), (Discard 2)) | P=0.20111113786697388
2024-10-22 16:59:34,430 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:34,430 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:34,430 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 40, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
B3 || X3|RYGWB3
R4 || XX|RYGWB1245
G2 || XX|RYGWB1245
R3 || X3|RYGWB3
Y1 || XX|RYGWB1245
Deck size: 40
Discards:}
2024-10-22 16:59:34,430 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:34,430 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 16:59:34,430 - INFO - === MCTS Search Completed ===
2024-10-22 16:59:34,430 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 3),) | Visit Count: 6
2024-10-22 16:59:34,430 - INFO - Actual Game Score: 0
2024-10-22 16:59:34,430 - DEBUG - === Recording Training Data ===
2024-10-22 16:59:34,430 - DEBUG - State Vector Shape: 658
2024-10-22 16:59:34,431 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.33333333 0.         0.66666667
 0.         0.        ]
2024-10-22 16:59:34,431 - DEBUG - === End of Training Data ===
2024-10-22 16:59:34,431 - INFO - Chosen Action: (Reveal player +1 rank 3) | Visit Count: 6
2024-10-22 16:59:36,178 - DEBUG - Not the current player's turn.
2024-10-22 16:59:36,178 - INFO - Agent state has been reset.
2024-10-22 16:59:36,178 - INFO - === Starting MCTS Search ===
2024-10-22 16:59:36,179 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 11, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
R4 || XX|RYGWB1245
G2 || XX|RYGWB1245
R3 || X3|RYGWB3
Y1 || XX|RYGWB1245
Y2 || XX|RYGWB12345
Deck size: 39
Discards: B3}
2024-10-22 16:59:36,179 - INFO - Max Rollouts: 10
2024-10-22 16:59:36,179 - DEBUG - --- Rollout #1 ---
2024-10-22 16:59:36,179 - DEBUG - Node () is a leaf node.
2024-10-22 16:59:36,179 - DEBUG - Traversing Path: ['()']
2024-10-22 16:59:36,396 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:36,396 - DEBUG - Network Policy Logits: [[ 0.02085638  0.01732977  0.00503288 -0.04654975 -0.00836075  0.0742467
   0.00134041  0.01138783  0.01416657  0.0815855  -0.0354376   0.00947935
  -0.07357673  0.02106647  0.03522395 -0.0092555  -0.04198411 -0.03600778
   0.05054153 -0.0670874 ]]
2024-10-22 16:59:36,397 - DEBUG - Network Policy after Softmax: [[0.05094906 0.0507697  0.05014921 0.04762797 0.04948201 0.05374317
  0.04996438 0.05046892 0.05060935 0.05413903 0.04816017 0.05037269
  0.04635797 0.05095976 0.05168635 0.04943775 0.04784591 0.04813271
  0.05248416 0.04665978]]
2024-10-22 16:59:36,398 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.49345484 0.
  0.         0.         0.         0.5065452  0.         0.
  0.         0.        ]]
2024-10-22 16:59:36,398 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.62009114 0.
 0.         0.         0.         0.3799089  0.         0.
 0.         0.        ]
2024-10-22 16:59:36,399 - DEBUG - Added Child Node: ((Reveal player +1 color R),) | P=0.6200911402702332
2024-10-22 16:59:36,399 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.37990888953208923
2024-10-22 16:59:36,399 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 16:59:36,400 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:36,400 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 11, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
R4 || XX|RYGWB1245
G2 || XX|RYGWB1245
R3 || X3|RYGWB3
Y1 || XX|RYGWB1245
Y2 || XX|RYGWB12345
Deck size: 39
Discards: B3}
2024-10-22 16:59:36,400 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:36,400 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 16:59:36,400 - DEBUG - --- Rollout #2 ---
2024-10-22 16:59:36,400 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R),)
2024-10-22 16:59:36,400 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)']
2024-10-22 16:59:36,401 - DEBUG - Move: (Reveal player +1 color R) | Reward: 0 | Depth: 1
2024-10-22 16:59:36,614 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:36,615 - DEBUG - Network Policy Logits: [[ 0.00774774 -0.00869157  0.003176   -0.0317972   0.0023401   0.04493618
  -0.00168102  0.0033482   0.05477021  0.05524408 -0.05937962 -0.02309092
  -0.05447909  0.01399968  0.05009893 -0.0245854  -0.0413317  -0.036394
   0.02193065 -0.04998437]]
2024-10-22 16:59:36,615 - DEBUG - Network Policy after Softmax: [[0.05054316 0.04971905 0.05031261 0.04858343 0.05027057 0.05245816
  0.05006883 0.05032127 0.05297658 0.05300169 0.04726169 0.04900826
  0.04749387 0.05086014 0.05272969 0.04893507 0.04812241 0.04836061
  0.05126511 0.04770782]]
2024-10-22 16:59:36,616 - DEBUG - Normalized Policy: [[0.         0.         0.34286547 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.3236566  0.         0.         0.33347794 0.         0.
  0.         0.        ]]
2024-10-22 16:59:36,617 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 2)) | P=0.3428654670715332
2024-10-22 16:59:36,617 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1)) | P=0.3334779441356659
2024-10-22 16:59:36,618 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color G)) | P=0.3236565887928009
2024-10-22 16:59:36,618 - DEBUG - Simulating Node: ((Reveal player +1 color R),) | Value: 0.0
2024-10-22 16:59:36,618 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:36,618 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || RX|R1245
XX || XX|YGWB1245
XX || R3|R3
XX || XX|YGWB1245
XX || XX|YGWB12345
-----
G3 || XX|RYGWB12345
Y3 || XX|RYGWB12345
G4 || XX|RYGWB12345
G1 || XX|RYGWB12345
W2 || XX|RYGWB12345
Deck size: 39
Discards: B3}
2024-10-22 16:59:36,618 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:36,618 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 16:59:36,618 - DEBUG - --- Rollout #3 ---
2024-10-22 16:59:36,619 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 16:59:36,619 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 16:59:36,619 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:36,829 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:36,829 - DEBUG - Network Policy Logits: [[-0.01118492  0.0035815   0.01326341 -0.03508156  0.01120589 -0.00061147
  -0.02329681  0.00093902  0.04409968  0.05767423 -0.03178473 -0.00292195
  -0.04028845  0.01802115  0.02830411  0.00350471 -0.02678494 -0.04596825
   0.03784107 -0.03570949]]
2024-10-22 16:59:36,830 - DEBUG - Network Policy after Softmax: [[0.04951018 0.0502467  0.05073554 0.04834108 0.05063126 0.05003645
  0.04891413 0.05011409 0.05232441 0.05303953 0.04850071 0.04992098
  0.04809003 0.0509775  0.05150441 0.05024283 0.04874381 0.04781766
  0.05199795 0.04831073]]
2024-10-22 16:59:36,831 - DEBUG - Normalized Policy: [[0.         0.         0.24772345 0.         0.         0.
  0.         0.         0.2554813  0.         0.         0.
  0.         0.         0.25147754 0.24531773 0.         0.
  0.         0.        ]]
2024-10-22 16:59:36,832 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 2)) | P=0.24772344529628754
2024-10-22 16:59:36,832 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 3)) | P=0.2554813027381897
2024-10-22 16:59:36,833 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.2453177273273468
2024-10-22 16:59:36,834 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.25147753953933716
2024-10-22 16:59:36,834 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 16:59:36,834 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:36,834 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 3}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB245
XX || XX|RYGWB245
XX || X3|RYGWB3
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
Y4 || XX|RYGWB12345
B3 || XX|RYGWB12345
B2 || XX|RYGWB12345
G4 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 39
Discards: B3}
2024-10-22 16:59:36,834 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:36,834 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 16:59:36,834 - DEBUG - --- Rollout #4 ---
2024-10-22 16:59:36,835 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.9126269221305847 | PUCT: 0.9126269221305847
2024-10-22 16:59:36,835 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.5591356754302979 | PUCT: 0.5591356754302979
2024-10-22 16:59:36,835 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.9126269221305847
2024-10-22 16:59:36,835 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 16:59:36,835 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Reveal player +1 rank 1))
2024-10-22 16:59:36,835 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Reveal player +1 rank 1))']
2024-10-22 16:59:36,836 - DEBUG - Move: (Reveal player +1 color R) | Reward: 0 | Depth: 1
2024-10-22 16:59:36,836 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:37,056 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:37,056 - DEBUG - Network Policy Logits: [[-0.01332379  0.01875483  0.04570196 -0.04737868 -0.04344039  0.00372147
  -0.01696539  0.04599569 -0.0067951   0.0541795  -0.01762873 -0.00345981
  -0.01463935 -0.02139787  0.00447305 -0.04705357  0.00314423 -0.07373773
   0.05808321 -0.02840686]]
2024-10-22 16:59:37,057 - DEBUG - Network Policy after Softmax: [[0.04955553 0.05117097 0.05256863 0.04789633 0.04808534 0.05040745
  0.04937539 0.05258407 0.04988012 0.05301618 0.04934265 0.05004676
  0.04949038 0.04915702 0.05044536 0.04791191 0.05037837 0.04665032
  0.05322354 0.04881369]]
2024-10-22 16:59:37,059 - DEBUG - Normalized Policy: [[0.         0.         0.20481297 0.         0.         0.
  0.         0.20487314 0.         0.         0.         0.
  0.         0.         0.         0.18666989 0.19627947 0.
  0.20736457 0.        ]]
2024-10-22 16:59:37,060 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.18666988611221313
2024-10-22 16:59:37,061 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Reveal player +1 rank 4)) | P=0.20736457407474518
2024-10-22 16:59:37,061 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Play 2)) | P=0.20487314462661743
2024-10-22 16:59:37,062 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Discard 2)) | P=0.20481297373771667
2024-10-22 16:59:37,063 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Reveal player +1 rank 2)) | P=0.19627946615219116
2024-10-22 16:59:37,063 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:37,063 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:37,063 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
R4 || RX|R1245
G2 || XX|YGWB1245
R3 || R3|R3
Y1 || XX|YGWB1245
Y2 || XX|YGWB12345
Deck size: 39
Discards: B3}
2024-10-22 16:59:37,063 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:37,063 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 16:59:37,063 - DEBUG - --- Rollout #5 ---
2024-10-22 16:59:37,064 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.6555584073066711 | PUCT: 0.6555584073066711
2024-10-22 16:59:37,064 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.6024577617645264 | PUCT: 0.6024577617645264
2024-10-22 16:59:37,064 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.6555584073066711
2024-10-22 16:59:37,065 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 16:59:37,065 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Reveal player +1 color G))
2024-10-22 16:59:37,065 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Reveal player +1 color G))']
2024-10-22 16:59:37,065 - DEBUG - Move: (Reveal player +1 color R) | Reward: 0 | Depth: 1
2024-10-22 16:59:37,066 - DEBUG - Move: (Reveal player +1 color G) | Reward: 0 | Depth: 2
2024-10-22 16:59:37,292 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:37,292 - DEBUG - Network Policy Logits: [[-0.00497323 -0.0135155   0.04127822  0.00398696 -0.01739213  0.04239764
  -0.01907452  0.02046083  0.01609685  0.07601172 -0.04903976 -0.02577235
  -0.05868044  0.00683207  0.02502513 -0.01753439 -0.01028676 -0.08651502
   0.06439386 -0.01703572]]
2024-10-22 16:59:37,292 - DEBUG - Network Policy after Softmax: [[0.04977229 0.04934892 0.05212839 0.05022026 0.04915799 0.05218678
  0.04907536 0.05105444 0.05083212 0.05397081 0.04762662 0.04874776
  0.04716967 0.05036334 0.05128799 0.049151   0.04950852 0.04587483
  0.05334741 0.04917552]]
2024-10-22 16:59:37,294 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.24436662 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.24433185 0.2461091  0.
  0.26519242 0.        ]]
2024-10-22 16:59:37,295 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color G), (Discard 4)) | P=0.2443666160106659
2024-10-22 16:59:37,296 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color G), (Reveal player +1 rank 1)) | P=0.24433185160160065
2024-10-22 16:59:37,296 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color G), (Reveal player +1 rank 2)) | P=0.24610909819602966
2024-10-22 16:59:37,297 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color G), (Reveal player +1 rank 4)) | P=0.2651924192905426
2024-10-22 16:59:37,297 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Reveal player +1 color G)) | Value: 0.0
2024-10-22 16:59:37,297 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:37,297 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}], [{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYWB12345
XX || XX|RYWB12345
XX || XX|RYWB12345
XX || XX|RYWB12345
XX || GX|G12345
-----
R4 || RX|R1245
G2 || XX|YGWB1245
R3 || R3|R3
Y1 || XX|YGWB1245
Y2 || XX|YGWB12345
Deck size: 39
Discards: B3}
2024-10-22 16:59:37,297 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:37,297 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 16:59:37,297 - DEBUG - --- Rollout #6 ---
2024-10-22 16:59:37,299 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5187706351280212 | PUCT: 0.5187706351280212
2024-10-22 16:59:37,299 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.6356664896011353 | PUCT: 0.6356664896011353
2024-10-22 16:59:37,299 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.6356664896011353
2024-10-22 16:59:37,299 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:37,299 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 color B))
2024-10-22 16:59:37,299 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 color B))']
2024-10-22 16:59:37,300 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:37,301 - DEBUG - Move: (Reveal player +1 color B) | Reward: 0 | Depth: 2
2024-10-22 16:59:37,529 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:37,529 - DEBUG - Network Policy Logits: [[ 0.01100927  0.04027858  0.02234207 -0.01961149  0.02708278  0.02066758
   0.03229204  0.00966999  0.01441758  0.08875192 -0.01649292  0.05321521
  -0.01425755  0.05367025 -0.01695981  0.01180146 -0.04464204 -0.06035157
   0.02701896 -0.04463607]]
2024-10-22 16:59:37,529 - DEBUG - Network Policy after Softmax: [[0.05002973 0.0515157  0.05059993 0.048521   0.05084038 0.05051527
  0.05110591 0.04996277 0.05020054 0.05407435 0.04867255 0.05218647
  0.04878147 0.05221022 0.04864983 0.05006938 0.04732157 0.04658397
  0.05083714 0.04732184]]
2024-10-22 16:59:37,531 - DEBUG - Normalized Policy: [[0.         0.         0.33408347 0.         0.         0.
  0.         0.         0.         0.         0.32135803 0.34455854
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:37,532 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Reveal player +1 color R)) | P=0.3213580250740051
2024-10-22 16:59:37,533 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Discard 2)) | P=0.3340834677219391
2024-10-22 16:59:37,534 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Reveal player +1 color Y)) | P=0.3445585370063782
2024-10-22 16:59:37,534 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 16:59:37,534 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:37,534 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'B', 'rank': None}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGW12345
XX || XX|RYGW12345
XX || BX|B12345
XX || BX|B12345
XX || XX|RYGW12345
-----
R4 || XX|RYGWB245
G2 || XX|RYGWB245
R3 || X3|RYGWB3
Y1 || X1|RYGWB1
Y2 || XX|RYGWB2345
Deck size: 39
Discards: B3}
2024-10-22 16:59:37,534 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:37,534 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 16:59:37,534 - DEBUG - --- Rollout #7 ---
2024-10-22 16:59:37,535 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.540626049041748 | PUCT: 0.540626049041748
2024-10-22 16:59:37,535 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4416310787200928 | PUCT: 0.4416310787200928
2024-10-22 16:59:37,535 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.540626049041748
2024-10-22 16:59:37,535 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 16:59:37,535 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 2))
2024-10-22 16:59:37,536 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 2))']
2024-10-22 16:59:37,536 - DEBUG - Move: (Reveal player +1 color R) | Reward: 0 | Depth: 1
2024-10-22 16:59:37,537 - DEBUG - Move: (Discard 2) | Reward: 0 | Depth: 2
2024-10-22 16:59:37,746 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:37,746 - DEBUG - Network Policy Logits: [[ 0.01064824  0.01111525 -0.01173869 -0.00199625 -0.02394143  0.09471861
  -0.0402094   0.02000742  0.00192156  0.0884303  -0.05282849 -0.00555635
  -0.05081239  0.02914418  0.07660379 -0.03491611 -0.00946296 -0.05628546
   0.07562943 -0.05492233]]
2024-10-22 16:59:37,747 - DEBUG - Network Policy after Softmax: [[0.05031289 0.05033639 0.04919905 0.04968071 0.04860234 0.0547256
  0.04781807 0.05078599 0.04987573 0.05438255 0.04721844 0.04950416
  0.04731374 0.05125213 0.05374318 0.04807186 0.04931114 0.04705549
  0.05369084 0.04711968]]
2024-10-22 16:59:37,748 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.31820107 0.32640424 0.
  0.3553947  0.        ]]
2024-10-22 16:59:37,749 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 2), (Reveal player +1 rank 1)) | P=0.31820106506347656
2024-10-22 16:59:37,749 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 2), (Reveal player +1 rank 2)) | P=0.32640424370765686
2024-10-22 16:59:37,751 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 2), (Reveal player +1 rank 4)) | P=0.3553946912288666
2024-10-22 16:59:37,751 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 2)) | Value: 0.0
2024-10-22 16:59:37,751 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:37,751 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 11, 12, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
R4 || RX|R1245
G2 || XX|YGWB1245
Y1 || XX|YGWB1245
Y2 || XX|YGWB12345
R2 || XX|RYGWB12345
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:37,751 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:37,751 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 16:59:37,751 - DEBUG - --- Rollout #8 ---
2024-10-22 16:59:37,752 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.44709405303001404 | PUCT: 0.44709405303001404
2024-10-22 16:59:37,752 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.45653235912323 | PUCT: 0.45653235912323
2024-10-22 16:59:37,753 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.45653235912323
2024-10-22 16:59:37,753 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:37,753 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Play 3))
2024-10-22 16:59:37,753 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Play 3))']
2024-10-22 16:59:37,753 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:37,754 - DEBUG - Move: (Play 3) | Reward: 1 | Depth: 2
2024-10-22 16:59:37,974 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:37,974 - DEBUG - Network Policy Logits: [[ 0.00135521  0.01660475  0.00532781 -0.02131096 -0.00319516  0.09140207
   0.01665623  0.01334493  0.01916269  0.08273058 -0.02517837  0.00428464
  -0.07492536  0.03023847  0.01866733 -0.01047764 -0.03658058 -0.01674098
   0.05892686 -0.0452323 ]]
2024-10-22 16:59:37,974 - DEBUG - Network Policy after Softmax: [[0.04971725 0.05048123 0.04991516 0.04860303 0.04949154 0.05440189
  0.05048383 0.05031694 0.05061052 0.05393219 0.04841543 0.04986311
  0.04606583 0.05117419 0.05058546 0.04913243 0.04786652 0.04882566
  0.05266356 0.04745418]]
2024-10-22 16:59:37,976 - DEBUG - Normalized Policy: [[0.506633 0.       0.       0.       0.       0.       0.       0.
  0.       0.       0.493367 0.       0.       0.       0.       0.
  0.       0.       0.       0.      ]]
2024-10-22 16:59:37,977 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 3), (Reveal player +1 color R)) | P=0.4933669865131378
2024-10-22 16:59:37,978 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 3), (Discard 0)) | P=0.5066329836845398
2024-10-22 16:59:37,978 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Play 3)) | Value: 0.0
2024-10-22 16:59:37,978 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:37,978 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 1, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R1 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
R4 || XX|RYGWB245
G2 || XX|RYGWB245
R3 || X3|RYGWB3
Y2 || XX|RYGWB2345
Y4 || XX|RYGWB12345
Deck size: 38
Discards: B3}
2024-10-22 16:59:37,978 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:37,978 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 16:59:37,978 - DEBUG - --- Rollout #9 ---
2024-10-22 16:59:37,979 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.45958176255226135 | PUCT: 0.45958176255226135
2024-10-22 16:59:37,979 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.35196277499198914 | PUCT: 0.35196277499198914
2024-10-22 16:59:37,979 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.45958176255226135
2024-10-22 16:59:37,980 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 16:59:37,980 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5288277864456177 | PUCT: 0.5288277864456177
2024-10-22 16:59:37,981 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Reveal player +1 color G)) | Q: 0.0 | U: 0.5132530927658081 | PUCT: 0.5132530927658081
2024-10-22 16:59:37,981 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 2)) | Q: 0.0 | U: 0.5437144637107849 | PUCT: 0.5437144637107849
2024-10-22 16:59:37,981 - DEBUG - Selected Child: ((Reveal player +1 color R), (Discard 2)) | PUCT: 0.5437144637107849
2024-10-22 16:59:37,981 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Discard 2))
2024-10-22 16:59:37,981 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 2), (Reveal player +1 rank 4))
2024-10-22 16:59:37,982 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 2))', '((Reveal player +1 color R), (Discard 2), (Reveal player +1 rank 4))']
2024-10-22 16:59:37,982 - DEBUG - Move: (Reveal player +1 color R) | Reward: 0 | Depth: 1
2024-10-22 16:59:37,983 - DEBUG - Move: (Discard 2) | Reward: 0 | Depth: 2
2024-10-22 16:59:37,984 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 0 | Depth: 3
2024-10-22 16:59:38,212 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:38,212 - DEBUG - Network Policy Logits: [[ 0.00975888 -0.00667935 -0.01384048 -0.04313589 -0.01230739  0.05897579
  -0.00729728  0.00727698  0.05648609  0.09308125 -0.07762115 -0.02883016
  -0.03782271  0.01375513  0.02746236  0.03115495 -0.06892314 -0.04227148
   0.07490247 -0.02497887]]
2024-10-22 16:59:38,213 - DEBUG - Network Policy after Softmax: [[0.05041564 0.04959366 0.04923978 0.04781821 0.04931533 0.05295901
  0.04956303 0.05029066 0.05282732 0.05479635 0.0461973  0.0485072
  0.04807295 0.0506175  0.05131611 0.05150595 0.04660087 0.04785956
  0.05380922 0.04869438]]
2024-10-22 16:59:38,215 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32859904 0.         0.
  0.         0.         0.         0.         0.31746036 0.
  0.         0.         0.         0.35394058 0.         0.
  0.         0.        ]]
2024-10-22 16:59:38,217 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 2), (Reveal player +1 rank 4), (Reveal player +1 color R)) | P=0.3174603581428528
2024-10-22 16:59:38,219 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 2), (Reveal player +1 rank 4), (Reveal player +1 rank 1)) | P=0.35394057631492615
2024-10-22 16:59:38,220 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 2), (Reveal player +1 rank 4), (Discard 3)) | P=0.3285990357398987
2024-10-22 16:59:38,220 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 2), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 16:59:38,220 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:38,220 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || R4|R4
XX || XX|YGWB125
XX || XX|YGWB125
XX || XX|YGWB1235
XX || XX|RYGWB1235
-----
R2 || XX|RYGWB12345
R4 || XX|RYGWB12345
B1 || XX|RYGWB12345
G2 || XX|RYGWB12345
W1 || XX|RYGWB12345
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:38,221 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:38,221 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 16:59:38,221 - DEBUG - --- Rollout #10 ---
2024-10-22 16:59:38,222 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.39205965399742126 | PUCT: 0.39205965399742126
2024-10-22 16:59:38,223 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.36030253767967224 | PUCT: 0.36030253767967224
2024-10-22 16:59:38,223 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.39205965399742126
2024-10-22 16:59:38,223 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 16:59:38,225 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5579778552055359 | PUCT: 0.5579778552055359
2024-10-22 16:59:38,225 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Reveal player +1 color G)) | Q: 0.0 | U: 0.5415446758270264 | PUCT: 0.5415446758270264
2024-10-22 16:59:38,226 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 2)) | Q: 0.0 | U: 0.38245677947998047 | PUCT: 0.38245677947998047
2024-10-22 16:59:38,226 - DEBUG - Selected Child: ((Reveal player +1 color R), (Reveal player +1 rank 1)) | PUCT: 0.5579778552055359
2024-10-22 16:59:38,226 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Reveal player +1 rank 1))
2024-10-22 16:59:38,226 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Reveal player +1 rank 4))
2024-10-22 16:59:38,226 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Reveal player +1 rank 1))', '((Reveal player +1 color R), (Reveal player +1 rank 1), (Reveal player +1 rank 4))']
2024-10-22 16:59:38,227 - DEBUG - Move: (Reveal player +1 color R) | Reward: 0 | Depth: 1
2024-10-22 16:59:38,228 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:38,230 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 0 | Depth: 3
2024-10-22 16:59:38,607 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:38,607 - DEBUG - Network Policy Logits: [[ 0.03178256  0.02122129 -0.00483127 -0.05025957  0.0026248   0.02221922
   0.00761403  0.04386198  0.0423615   0.06697726 -0.05201852 -0.01449227
  -0.00961293  0.04666861  0.07337377  0.02072107 -0.0265159  -0.05181031
   0.00566543 -0.05011443]]
2024-10-22 16:59:38,607 - DEBUG - Network Policy after Softmax: [[0.05125492 0.05071645 0.04941222 0.04721773 0.04978202 0.05076709
  0.05003101 0.0518778  0.05180002 0.05309094 0.04713475 0.04893715
  0.04917651 0.05202361 0.05343163 0.05069109 0.04835227 0.04714457
  0.04993362 0.04722458]]
2024-10-22 16:59:38,611 - DEBUG - Normalized Policy: [[0.3408699  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.32704747 0.         0.         0.         0.         0.
  0.3320826  0.        ]]
2024-10-22 16:59:38,612 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Reveal player +1 rank 4), (Discard 0)) | P=0.3408699035644531
2024-10-22 16:59:38,613 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Reveal player +1 rank 4), (Reveal player +1 color G)) | P=0.3270474672317505
2024-10-22 16:59:38,614 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Reveal player +1 rank 4), (Reveal player +1 rank 4)) | P=0.332082599401474
2024-10-22 16:59:38,614 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 16:59:38,614 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:38,614 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 5, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 4}, {'color': 'R', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 5
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || R4|R4
XX || XX|YGWB125
XX || R3|R3
XX || XX|YGWB125
XX || XX|YGWB1235
-----
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y5 || XX|RYGWB2345
R1 || X1|RYGWB1
Y4 || XX|RYGWB2345
Deck size: 39
Discards: B3}
2024-10-22 16:59:38,614 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:38,615 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 16:59:38,615 - INFO - === MCTS Search Completed ===
2024-10-22 16:59:38,615 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color R),) | Visit Count: 6
2024-10-22 16:59:38,615 - INFO - Actual Game Score: 0
2024-10-22 16:59:38,616 - DEBUG - === Recording Training Data ===
2024-10-22 16:59:38,616 - DEBUG - State Vector Shape: 658
2024-10-22 16:59:38,616 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.66666667 0.
 0.         0.         0.         0.33333333 0.         0.
 0.         0.        ]
2024-10-22 16:59:38,616 - DEBUG - === End of Training Data ===
2024-10-22 16:59:38,617 - INFO - Chosen Action: (Reveal player +1 color R) | Visit Count: 6
2024-10-22 16:59:41,593 - DEBUG - Not the current player's turn.
2024-10-22 16:59:41,594 - INFO - Agent state has been reset.
2024-10-22 16:59:41,594 - INFO - === Starting MCTS Search ===
2024-10-22 16:59:41,594 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
R4 || RX|R1245
G2 || XX|YGWB1245
Y1 || XX|YGWB1245
Y2 || XX|YGWB12345
B2 || XX|RYGWB12345
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:41,594 - INFO - Max Rollouts: 10
2024-10-22 16:59:41,594 - DEBUG - --- Rollout #1 ---
2024-10-22 16:59:41,595 - DEBUG - Node () is a leaf node.
2024-10-22 16:59:41,595 - DEBUG - Traversing Path: ['()']
2024-10-22 16:59:41,799 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:41,800 - DEBUG - Network Policy Logits: [[ 0.01518826  0.01200423 -0.00819886 -0.00128507 -0.02481608  0.08409034
  -0.04472607  0.02530997  0.00675947  0.07731256 -0.04812128  0.00168235
  -0.0378107   0.02750274  0.07476938 -0.02598647 -0.00092779 -0.05256592
   0.06986879 -0.06061925]]
2024-10-22 16:59:41,801 - DEBUG - Network Policy after Softmax: [[0.05048984 0.05032933 0.04932272 0.04966491 0.04850989 0.05409134
  0.04755361 0.05100347 0.05006605 0.05372596 0.04739243 0.04981251
  0.0478836  0.05111544 0.0535895  0.04845315 0.04968266 0.04718225
  0.05332752 0.04680381]]
2024-10-22 16:59:41,802 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.3199002  0.32801777 0.
  0.35208207 0.        ]]
2024-10-22 16:59:41,803 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.23992515 0.24601357 0.
 0.5140613  0.        ]
2024-10-22 16:59:41,804 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.23992514610290527
2024-10-22 16:59:41,805 - DEBUG - Added Child Node: ((Reveal player +1 rank 2),) | P=0.2460135668516159
2024-10-22 16:59:41,806 - DEBUG - Added Child Node: ((Reveal player +1 rank 4),) | P=0.5140612721443176
2024-10-22 16:59:41,806 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 16:59:41,806 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:41,807 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
R4 || RX|R1245
G2 || XX|YGWB1245
Y1 || XX|YGWB1245
Y2 || XX|YGWB12345
B2 || XX|RYGWB12345
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:41,807 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:41,807 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 16:59:41,807 - DEBUG - --- Rollout #2 ---
2024-10-22 16:59:41,807 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2),)
2024-10-22 16:59:41,807 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)']
2024-10-22 16:59:41,808 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 0 | Depth: 1
2024-10-22 16:59:42,110 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:42,110 - DEBUG - Network Policy Logits: [[-0.01416406 -0.01428941 -0.00486971 -0.07863677  0.00373044  0.00135441
  -0.02769275 -0.02480478  0.06626152  0.06016016 -0.04767465 -0.0643097
  -0.05086882  0.06063496  0.013182   -0.0017162  -0.06174883 -0.01280065
   0.07008635 -0.01284155]]
2024-10-22 16:59:42,110 - DEBUG - Network Policy after Softmax: [[0.04959953 0.04959331 0.05006268 0.04650262 0.05049508 0.05037524
  0.04893303 0.04907455 0.0537534  0.05342643 0.04796496 0.04717366
  0.047812   0.0534518  0.0509746  0.0502208  0.04729462 0.0496672
  0.05395939 0.04966517]]
2024-10-22 16:59:42,112 - DEBUG - Normalized Policy: [[0.         0.49685672 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.50314325 0.         0.
  0.         0.        ]]
2024-10-22 16:59:42,113 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 1)) | P=0.5031432509422302
2024-10-22 16:59:42,114 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 1)) | P=0.4968567192554474
2024-10-22 16:59:42,114 - DEBUG - Simulating Node: ((Reveal player +1 rank 2),) | Value: 0.0
2024-10-22 16:59:42,114 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:42,114 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 0}, {'color': 'B', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || RX|R145
XX || X2|YGWB2
XX || XX|YGWB145
XX || X2|YGWB2
XX || X2|RYGWB2
-----
G1 || XX|RYGWB12345
B5 || XX|RYGWB12345
B3 || XX|RYGWB12345
R1 || XX|RYGWB12345
R4 || XX|RYGWB12345
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:42,114 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:42,114 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 16:59:42,114 - DEBUG - --- Rollout #3 ---
2024-10-22 16:59:42,115 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4),)
2024-10-22 16:59:42,115 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)']
2024-10-22 16:59:42,115 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 0 | Depth: 1
2024-10-22 16:59:42,350 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:42,350 - DEBUG - Network Policy Logits: [[ 0.00139853 -0.00685964 -0.0049374  -0.04187434 -0.01511663  0.0615248
   0.00425632  0.00532448  0.05864366  0.09624746 -0.07091624 -0.03404776
  -0.02986275  0.0090118   0.01591797  0.02363493 -0.06524589 -0.03984847
   0.06883944 -0.02896327]]
2024-10-22 16:59:42,351 - DEBUG - Network Policy after Softmax: [[0.05000431 0.04959307 0.04968849 0.04788663 0.04918526 0.05310311
  0.05014742 0.05020102 0.05295034 0.05497938 0.04651591 0.04826289
  0.0484653  0.05038646 0.05073564 0.05112869 0.04678042 0.04798374
  0.05349297 0.04850891]]
2024-10-22 16:59:42,352 - DEBUG - Normalized Policy: [[0.49444112 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.50555885 0.         0.
  0.         0.        ]]
2024-10-22 16:59:42,353 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0)) | P=0.49444112181663513
2024-10-22 16:59:42,354 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1)) | P=0.5055588483810425
2024-10-22 16:59:42,354 - DEBUG - Simulating Node: ((Reveal player +1 rank 4),) | Value: 0.0
2024-10-22 16:59:42,354 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:42,354 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 0}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || R4|R4
XX || XX|YGWB125
XX || XX|YGWB125
XX || XX|YGWB1235
XX || XX|RYGWB1235
-----
R1 || XX|RYGWB12345
Y3 || XX|RYGWB12345
W2 || XX|RYGWB12345
W1 || XX|RYGWB12345
R1 || XX|RYGWB12345
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:42,354 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:42,354 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 16:59:42,354 - DEBUG - --- Rollout #4 ---
2024-10-22 16:59:42,354 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 16:59:42,355 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 16:59:42,355 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:42,617 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:42,617 - DEBUG - Network Policy Logits: [[-0.016334    0.00066849 -0.0006871  -0.05833771 -0.0080161   0.05512365
   0.01270604  0.00453464  0.07324706  0.05506641 -0.06266037 -0.01074888
  -0.06853651  0.00098308  0.00342066  0.00712338 -0.04736057 -0.02477417
   0.04833302 -0.03611293]]
2024-10-22 16:59:42,617 - DEBUG - Network Policy after Softmax: [[0.04933064 0.05017656 0.05010859 0.04730149 0.04974268 0.0529847
  0.05078421 0.05037092 0.05395371 0.05298166 0.04709746 0.04960693
  0.04682152 0.05019235 0.05031485 0.05050149 0.04782359 0.04891604
  0.05262612 0.04836452]]
2024-10-22 16:59:42,619 - DEBUG - Normalized Policy: [[0.         0.         0.24908167 0.         0.         0.
  0.         0.2503857  0.         0.         0.         0.
  0.         0.24949802 0.         0.2510347  0.         0.
  0.         0.        ]]
2024-10-22 16:59:42,620 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color W)) | P=0.24949802458286285
2024-10-22 16:59:42,621 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 2)) | P=0.24908167123794556
2024-10-22 16:59:42,621 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.2510347068309784
2024-10-22 16:59:42,622 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 2)) | P=0.25038570165634155
2024-10-22 16:59:42,622 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 16:59:42,623 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:42,623 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || RX|R245
XX || XX|YGWB245
XX || X1|YGWB1
XX || XX|YGWB2345
XX || XX|RYGWB2345
-----
R2 || XX|RYGWB12345
W1 || XX|RYGWB12345
W4 || XX|RYGWB12345
W2 || XX|RYGWB12345
B3 || XX|RYGWB12345
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:42,623 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:42,623 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 16:59:42,623 - DEBUG - --- Rollout #5 ---
2024-10-22 16:59:42,624 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.39012715220451355 | PUCT: 0.39012715220451355
2024-10-22 16:59:42,624 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.8151959180831909 | PUCT: 0.8151959180831909
2024-10-22 16:59:42,624 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3804721534252167 | PUCT: 0.3804721534252167
2024-10-22 16:59:42,625 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.8151959180831909
2024-10-22 16:59:42,625 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 16:59:42,625 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Reveal player +1 rank 1))
2024-10-22 16:59:42,625 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 rank 1))']
2024-10-22 16:59:42,625 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 0 | Depth: 1
2024-10-22 16:59:42,626 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:42,929 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:42,930 - DEBUG - Network Policy Logits: [[ 0.02249943  0.02200786 -0.0028985  -0.0147874  -0.02062522  0.07197087
  -0.03441895  0.00538855 -0.00172966  0.08936258 -0.01612742 -0.00055039
  -0.03987897  0.03458207  0.04795027  0.01206949 -0.01639297 -0.07023831
   0.07948958 -0.02449247]]
2024-10-22 16:59:42,930 - DEBUG - Network Policy after Softmax: [[0.05073131 0.05070638 0.04945907 0.04887453 0.04859005 0.05330418
  0.04792441 0.04987064 0.04951691 0.05423934 0.04880909 0.04957534
  0.04766345 0.051348   0.05203904 0.05020494 0.04879613 0.04623817
  0.05370647 0.0484025 ]]
2024-10-22 16:59:42,933 - DEBUG - Normalized Policy: [[0.         0.25656986 0.         0.         0.         0.
  0.24249333 0.         0.         0.         0.         0.
  0.         0.         0.         0.2540326  0.24690415 0.
  0.         0.        ]]
2024-10-22 16:59:42,934 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1), (Discard 1)) | P=0.25656986236572266
2024-10-22 16:59:42,935 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.25403261184692383
2024-10-22 16:59:42,936 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1), (Reveal player +1 rank 2)) | P=0.2469041496515274
2024-10-22 16:59:42,937 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1), (Play 1)) | P=0.24249333143234253
2024-10-22 16:59:42,938 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:42,938 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:42,938 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
-----
R4 || R4|R4
G2 || XX|YGWB125
Y1 || XX|YGWB125
Y2 || XX|YGWB1235
B2 || XX|RYGWB1235
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:42,938 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:42,938 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 16:59:42,938 - DEBUG - --- Rollout #6 ---
2024-10-22 16:59:42,939 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.4116317927837372 | PUCT: 0.4116317927837372
2024-10-22 16:59:42,939 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.5734208226203918 | PUCT: 0.5734208226203918
2024-10-22 16:59:42,940 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.40144461393356323 | PUCT: 0.40144461393356323
2024-10-22 16:59:42,940 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.5734208226203918
2024-10-22 16:59:42,940 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 16:59:42,940 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Discard 0))
2024-10-22 16:59:42,940 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Discard 0))']
2024-10-22 16:59:42,941 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 0 | Depth: 1
2024-10-22 16:59:42,942 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 2
2024-10-22 16:59:43,139 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:43,139 - DEBUG - Network Policy Logits: [[ 0.02062116  0.01439828 -0.01480937 -0.00979344 -0.01166524  0.07961675
  -0.03285501  0.01578617  0.00074429  0.11622433 -0.07811403  0.01243365
  -0.06198654  0.0079606   0.05664396 -0.01023679 -0.04071606 -0.0440306
   0.06326447 -0.04863963]]
2024-10-22 16:59:43,139 - DEBUG - Network Policy after Softmax: [[0.05089427 0.05057854 0.04912263 0.04936964 0.04927732 0.05398714
  0.04824413 0.05064879 0.04989263 0.0560001  0.04610932 0.05047927
  0.04685897 0.05025398 0.05276104 0.04934775 0.04786636 0.04770797
  0.0531115  0.04748859]]
2024-10-22 16:59:43,140 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.5076192  0.49238077 0.
  0.         0.        ]]
2024-10-22 16:59:43,141 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 rank 1)) | P=0.5076192021369934
2024-10-22 16:59:43,141 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 rank 2)) | P=0.4923807680606842
2024-10-22 16:59:43,141 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Discard 0)) | Value: 0.0
2024-10-22 16:59:43,141 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:43,141 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G2 || XX|YGWB125
Y1 || XX|YGWB125
Y2 || XX|YGWB1235
B2 || XX|RYGWB1235
Y2 || XX|RYGWB12345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:43,142 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:43,142 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 16:59:43,142 - DEBUG - --- Rollout #7 ---
2024-10-22 16:59:43,142 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.4289734959602356 | PUCT: 0.4289734959602356
2024-10-22 16:59:43,143 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.44818395376205444 | PUCT: 0.44818395376205444
2024-10-22 16:59:43,143 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.41835713386535645 | PUCT: 0.41835713386535645
2024-10-22 16:59:43,143 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.44818395376205444
2024-10-22 16:59:43,143 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 16:59:43,144 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.744062602519989 | PUCT: 0.744062602519989
2024-10-22 16:59:43,144 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Discard 0)) | Q: 0.0 | U: 0.7276999354362488 | PUCT: 0.7276999354362488
2024-10-22 16:59:43,144 - DEBUG - Selected Child: ((Reveal player +1 rank 4), (Reveal player +1 rank 1)) | PUCT: 0.744062602519989
2024-10-22 16:59:43,144 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4), (Reveal player +1 rank 1))
2024-10-22 16:59:43,144 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Reveal player +1 rank 1), (Reveal player +1 rank 2))
2024-10-22 16:59:43,144 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 rank 1))', '((Reveal player +1 rank 4), (Reveal player +1 rank 1), (Reveal player +1 rank 2))']
2024-10-22 16:59:43,145 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 0 | Depth: 1
2024-10-22 16:59:43,145 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:43,146 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 0 | Depth: 3
2024-10-22 16:59:43,328 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:43,328 - DEBUG - Network Policy Logits: [[ 0.00744523  0.00577645 -0.00990889 -0.06249855  0.00736197 -0.02688081
  -0.00112485  0.00914576  0.04629127  0.07489365 -0.04707038 -0.03282392
  -0.01760681  0.08333972  0.01024722  0.03251812 -0.06937183  0.00255438
   0.03390085 -0.02896832]]
2024-10-22 16:59:43,328 - DEBUG - Network Policy after Softmax: [[0.05029091 0.05020706 0.04942568 0.04689357 0.05028672 0.04859391
  0.04986176 0.0503765  0.05228295 0.05379996 0.04762266 0.04830597
  0.04904667 0.05425628 0.05043202 0.05156779 0.04657236 0.05004554
  0.05163914 0.04849258]]
2024-10-22 16:59:43,330 - DEBUG - Normalized Policy: [[0.3246173  0.         0.         0.         0.         0.
  0.         0.32516977 0.         0.         0.         0.
  0.         0.35021293 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:43,331 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1), (Reveal player +1 rank 2), (Reveal player +1 color W)) | P=0.3502129316329956
2024-10-22 16:59:43,331 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1), (Reveal player +1 rank 2), (Discard 0)) | P=0.32461729645729065
2024-10-22 16:59:43,332 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1), (Reveal player +1 rank 2), (Play 2)) | P=0.32516977190971375
2024-10-22 16:59:43,332 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1), (Reveal player +1 rank 2)) | Value: 0.0
2024-10-22 16:59:43,332 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:43,332 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 5, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15, 16, 17, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 2}, {'color': 'G', 'rank': 4}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 5
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || R4|R4
XX || X2|YGWB2
XX || XX|YGWB15
XX || X2|YGWB2
XX || X2|RYGWB2
-----
Y3 || XX|RYGWB2345
G5 || XX|RYGWB2345
W3 || XX|RYGWB2345
W1 || X1|RYGWB1
W2 || XX|RYGWB2345
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:43,332 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:43,332 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 16:59:43,332 - DEBUG - --- Rollout #8 ---
2024-10-22 16:59:43,333 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.44344770908355713 | PUCT: 0.44344770908355713
2024-10-22 16:59:43,333 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.37064507603645325 | PUCT: 0.37064507603645325
2024-10-22 16:59:43,334 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4324731230735779 | PUCT: 0.4324731230735779
2024-10-22 16:59:43,334 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.44344770908355713
2024-10-22 16:59:43,334 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 16:59:43,334 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Reveal player +1 rank 1))
2024-10-22 16:59:43,334 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 rank 1))']
2024-10-22 16:59:43,335 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 0 | Depth: 1
2024-10-22 16:59:43,335 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:43,521 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:43,521 - DEBUG - Network Policy Logits: [[ 0.04901544  0.02092052 -0.00451368  0.00860985 -0.02579106  0.07310358
  -0.04111613 -0.00728461  0.02423579  0.06267426 -0.00718005 -0.00333228
  -0.03817137  0.06110438  0.02996893  0.00511541 -0.02357486 -0.04600703
   0.03625171 -0.04207455]]
2024-10-22 16:59:43,521 - DEBUG - Network Policy after Softmax: [[0.05213217 0.05068791 0.04941495 0.05006773 0.04837464 0.05340318
  0.04763895 0.04927822 0.05085623 0.05284912 0.04928337 0.04947337
  0.04777944 0.05276622 0.05114863 0.04989307 0.04848197 0.04740652
  0.051471   0.04759331]]
2024-10-22 16:59:43,523 - DEBUG - Normalized Policy: [[0.         0.20343165 0.         0.         0.         0.
  0.19119492 0.         0.         0.         0.         0.19855721
  0.         0.         0.         0.20024167 0.         0.
  0.20657453 0.        ]]
2024-10-22 16:59:43,524 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.20024167001247406
2024-10-22 16:59:43,525 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 1), (Reveal player +1 rank 4)) | P=0.20657452940940857
2024-10-22 16:59:43,526 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 1), (Play 1)) | P=0.19119492173194885
2024-10-22 16:59:43,526 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 1), (Reveal player +1 color Y)) | P=0.19855721294879913
2024-10-22 16:59:43,527 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 1), (Discard 1)) | P=0.2034316509962082
2024-10-22 16:59:43,527 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:43,527 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:43,527 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
-----
R4 || RX|R145
G2 || X2|YGWB2
Y1 || XX|YGWB145
Y2 || X2|YGWB2
B2 || X2|RYGWB2
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:43,527 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:43,527 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 16:59:43,527 - DEBUG - --- Rollout #9 ---
2024-10-22 16:59:43,528 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.30388906598091125 | PUCT: 0.30388906598091125
2024-10-22 16:59:43,528 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.3809974789619446 | PUCT: 0.3809974789619446
2024-10-22 16:59:43,529 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4445524513721466 | PUCT: 0.4445524513721466
2024-10-22 16:59:43,529 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.4445524513721466
2024-10-22 16:59:43,529 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:43,529 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Play 2))
2024-10-22 16:59:43,529 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Play 2))']
2024-10-22 16:59:43,530 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:43,530 - DEBUG - Move: (Play 2) | Reward: 1 | Depth: 2
2024-10-22 16:59:43,808 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:43,808 - DEBUG - Network Policy Logits: [[ 0.02078617  0.01206444 -0.00607389  0.01212431 -0.01794003  0.08332466
   0.00594738  0.01890406  0.02683511  0.094579   -0.05915741 -0.02464379
  -0.05295514  0.02449582  0.06749056 -0.01838583  0.0011949  -0.0192599
   0.05039116 -0.0215524 ]]
2024-10-22 16:59:43,809 - DEBUG - Network Policy after Softmax: [[0.05050633 0.05006775 0.04916779 0.05007074 0.0485878  0.05376578
  0.04976241 0.05041136 0.05081277 0.0543743  0.04662585 0.04826317
  0.04691593 0.05069404 0.05292115 0.04856615 0.04952648 0.04852371
  0.05202392 0.0484126 ]]
2024-10-22 16:59:43,810 - DEBUG - Normalized Policy: [[0.33215454 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.32571054 0.
  0.34213498 0.        ]]
2024-10-22 16:59:43,811 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 2), (Discard 0)) | P=0.3321545422077179
2024-10-22 16:59:43,812 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 2), (Reveal player +1 rank 2)) | P=0.3257105350494385
2024-10-22 16:59:43,813 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 2), (Reveal player +1 rank 4)) | P=0.3421349823474884
2024-10-22 16:59:43,813 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Play 2)) | Value: 0.0
2024-10-22 16:59:43,813 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:43,813 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B1 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
R4 || RX|R245
G2 || XX|YGWB245
Y2 || XX|YGWB2345
B2 || XX|RYGWB2345
R1 || XX|RYGWB12345
Deck size: 37
Discards: B3 R3}
2024-10-22 16:59:43,813 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:43,813 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 16:59:43,814 - DEBUG - --- Rollout #10 ---
2024-10-22 16:59:43,814 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.31108972430229187 | PUCT: 0.31108972430229187
2024-10-22 16:59:43,815 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.39002522826194763 | PUCT: 0.39002522826194763
2024-10-22 16:59:43,815 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.303390771150589 | PUCT: 0.303390771150589
2024-10-22 16:59:43,816 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.39002522826194763
2024-10-22 16:59:43,816 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 16:59:43,817 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5344752669334412 | PUCT: 0.5344752669334412
2024-10-22 16:59:43,817 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Discard 0)) | Q: 0.0 | U: 0.7840824127197266 | PUCT: 0.7840824127197266
2024-10-22 16:59:43,817 - DEBUG - Selected Child: ((Reveal player +1 rank 4), (Discard 0)) | PUCT: 0.7840824127197266
2024-10-22 16:59:43,818 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4), (Discard 0))
2024-10-22 16:59:43,818 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 rank 1))
2024-10-22 16:59:43,818 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Discard 0))', '((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 rank 1))']
2024-10-22 16:59:43,819 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 0 | Depth: 1
2024-10-22 16:59:43,819 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 2
2024-10-22 16:59:43,820 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 3
2024-10-22 16:59:44,096 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:44,098 - DEBUG - Network Policy Logits: [[ 0.00754447  0.01606639 -0.02766602 -0.02804721 -0.0109085   0.03819849
  -0.02193915 -0.01693474  0.07691976  0.09612152 -0.02853159  0.00483138
  -0.05402376  0.03861121  0.02473404  0.03730297 -0.05908449 -0.02789949
   0.06136582 -0.03011068]]
2024-10-22 16:59:44,098 - DEBUG - Network Policy after Softmax: [[0.05009175 0.05052046 0.04835869 0.04834026 0.04917589 0.05165105
  0.04863643 0.04888044 0.05369027 0.05473118 0.04831685 0.04995604
  0.04710072 0.05167237 0.05096025 0.05160481 0.04686296 0.0483474
  0.05286163 0.04824062]]
2024-10-22 16:59:44,101 - DEBUG - Normalized Policy: [[0.         0.25044602 0.         0.         0.         0.
  0.24110627 0.         0.         0.         0.         0.
  0.         0.         0.2526262  0.2558215  0.         0.
  0.         0.        ]]
2024-10-22 16:59:44,102 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 rank 1), (Discard 1)) | P=0.25044602155685425
2024-10-22 16:59:44,105 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.25582149624824524
2024-10-22 16:59:44,105 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.2526262104511261
2024-10-22 16:59:44,107 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 rank 1), (Play 1)) | P=0.24110627174377441
2024-10-22 16:59:44,112 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:44,112 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:44,113 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|YGWB25
XX || X1|YGWB1
XX || XX|YGWB235
XX || XX|RYGWB235
XX || XX|RYGWB2345
-----
B2 || XX|RYGWB12345
W2 || XX|RYGWB12345
B1 || XX|RYGWB12345
R5 || XX|RYGWB12345
B4 || XX|RYGWB12345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:44,113 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:44,113 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 16:59:44,113 - INFO - === MCTS Search Completed ===
2024-10-22 16:59:44,113 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 4),) | Visit Count: 5
2024-10-22 16:59:44,113 - INFO - Actual Game Score: 0
2024-10-22 16:59:44,113 - DEBUG - === Recording Training Data ===
2024-10-22 16:59:44,113 - DEBUG - State Vector Shape: 658
2024-10-22 16:59:44,114 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.22222222 0.22222222 0.
 0.55555556 0.        ]
2024-10-22 16:59:44,114 - DEBUG - === End of Training Data ===
2024-10-22 16:59:44,114 - INFO - Chosen Action: (Reveal player +1 rank 4) | Visit Count: 5
2024-10-22 16:59:46,874 - DEBUG - Not the current player's turn.
2024-10-22 16:59:46,875 - INFO - Agent state has been reset.
2024-10-22 16:59:46,875 - INFO - === Starting MCTS Search ===
2024-10-22 16:59:46,875 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G2 || XX|YGWB125
Y1 || XX|YGWB125
Y2 || XX|YGWB1235
B2 || XX|RYGWB1235
G1 || XX|RYGWB12345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:46,875 - INFO - Max Rollouts: 10
2024-10-22 16:59:46,875 - DEBUG - --- Rollout #1 ---
2024-10-22 16:59:46,875 - DEBUG - Node () is a leaf node.
2024-10-22 16:59:46,875 - DEBUG - Traversing Path: ['()']
2024-10-22 16:59:47,061 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:47,061 - DEBUG - Network Policy Logits: [[ 0.02675571  0.00886253 -0.00333686 -0.01726302 -0.01360488  0.07789385
  -0.0264488   0.02310825  0.00985324  0.11326829 -0.08330177  0.01506579
  -0.05758817  0.00823686  0.05835454 -0.02081944 -0.03983385 -0.03952749
   0.07123637 -0.06032737]]
2024-10-22 16:59:47,062 - DEBUG - Network Policy after Softmax: [[0.05116471 0.05025735 0.04964797 0.04896136 0.0491408  0.05384923
  0.04851367 0.05097843 0.05030717 0.05578822 0.04583246 0.05057009
  0.04702626 0.05022592 0.05280727 0.04878754 0.04786864 0.0478833
  0.05349193 0.04689762]]
2024-10-22 16:59:47,063 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.5047535  0.49524653 0.
  0.         0.        ]]
2024-10-22 16:59:47,063 - DEBUG - Dirichlet Noise Added: [0.        0.        0.        0.        0.        0.        0.
 0.        0.        0.        0.        0.        0.        0.
 0.        0.3785651 0.6214349 0.        0.        0.       ]
2024-10-22 16:59:47,064 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.37856510281562805
2024-10-22 16:59:47,064 - DEBUG - Added Child Node: ((Reveal player +1 rank 2),) | P=0.6214349269866943
2024-10-22 16:59:47,065 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 16:59:47,065 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:47,065 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G2 || XX|YGWB125
Y1 || XX|YGWB125
Y2 || XX|YGWB1235
B2 || XX|RYGWB1235
G1 || XX|RYGWB12345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:47,065 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:47,065 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 16:59:47,065 - DEBUG - --- Rollout #2 ---
2024-10-22 16:59:47,065 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2),)
2024-10-22 16:59:47,065 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)']
2024-10-22 16:59:47,066 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 0 | Depth: 1
2024-10-22 16:59:47,259 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:47,259 - DEBUG - Network Policy Logits: [[-0.00729458  0.00661765 -0.03492545 -0.02302332  0.0283287   0.03651385
   0.00978765 -0.00450672  0.0654724   0.06811585 -0.02350115 -0.01917736
  -0.03070479  0.00409111  0.01704924  0.00442382 -0.08115789 -0.02680525
   0.04311025 -0.05233844]]
2024-10-22 16:59:47,259 - DEBUG - Network Policy after Softmax: [[0.04965242 0.05034802 0.04829926 0.04887756 0.05145308 0.05187596
  0.05050788 0.04979103 0.05340017 0.05354152 0.04885421 0.0490659
  0.04850354 0.05022097 0.05087598 0.05023769 0.0461171  0.04869305
  0.05221928 0.0474655 ]]
2024-10-22 16:59:47,261 - DEBUG - Normalized Policy: [[0.2466907  0.         0.         0.         0.         0.
  0.25094095 0.         0.         0.         0.         0.
  0.         0.         0.2527698  0.24959853 0.         0.
  0.         0.        ]]
2024-10-22 16:59:47,262 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 0)) | P=0.24669070541858673
2024-10-22 16:59:47,262 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 1)) | P=0.24959853291511536
2024-10-22 16:59:47,263 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color B)) | P=0.25276979804039
2024-10-22 16:59:47,264 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Play 1)) | P=0.2509409487247467
2024-10-22 16:59:47,264 - DEBUG - Simulating Node: ((Reveal player +1 rank 2),) | Value: 0.0
2024-10-22 16:59:47,264 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:47,264 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X2|YGWB2
XX || XX|YGWB15
XX || X2|YGWB2
XX || X2|RYGWB2
XX || XX|RYGWB1345
-----
B5 || XX|RYGWB12345
B4 || XX|RYGWB12345
G5 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y1 || XX|RYGWB12345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:47,264 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:47,264 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 16:59:47,264 - DEBUG - --- Rollout #3 ---
2024-10-22 16:59:47,264 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 16:59:47,264 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 16:59:47,265 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:47,588 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:47,589 - DEBUG - Network Policy Logits: [[ 0.00879098  0.0051515  -0.04099515 -0.00067857  0.01218495  0.03496925
  -0.0276678   0.00616364  0.08019072  0.09207962 -0.0379408  -0.01136084
  -0.0477254   0.01894762  0.04724021  0.02172205 -0.08420556 -0.04465609
   0.05543532 -0.02277416]]
2024-10-22 16:59:47,589 - DEBUG - Network Policy after Softmax: [[0.05022996 0.05004749 0.04779044 0.04975656 0.05040074 0.05156226
  0.04843163 0.05009817 0.05394751 0.05459271 0.04793663 0.04922787
  0.04746988 0.05074273 0.05219888 0.05088371 0.04576937 0.0476158
  0.05262841 0.04866921]]
2024-10-22 16:59:47,592 - DEBUG - Normalized Policy: [[0.         0.3425683  0.         0.         0.         0.
  0.33150795 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.32592374
  0.         0.        ]]
2024-10-22 16:59:47,593 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1)) | P=0.3425683081150055
2024-10-22 16:59:47,593 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 1)) | P=0.33150795102119446
2024-10-22 16:59:47,594 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 3)) | P=0.32592374086380005
2024-10-22 16:59:47,594 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 16:59:47,594 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:47,595 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 16, 17, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|YGWB25
XX || X1|YGWB1
XX || XX|YGWB235
XX || XX|RYGWB235
XX || X1|RYGWB1
-----
Y2 || XX|RYGWB12345
W3 || XX|RYGWB12345
Y3 || XX|RYGWB12345
R5 || XX|RYGWB12345
G3 || XX|RYGWB12345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:47,595 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:47,595 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 16:59:47,595 - DEBUG - --- Rollout #4 ---
2024-10-22 16:59:47,596 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.9146046042442322 | PUCT: 0.9146046042442322
2024-10-22 16:59:47,596 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.5571579337120056 | PUCT: 0.5571579337120056
2024-10-22 16:59:47,596 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.9146046042442322
2024-10-22 16:59:47,596 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 16:59:47,597 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Play 1))
2024-10-22 16:59:47,597 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Play 1))']
2024-10-22 16:59:47,597 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 0 | Depth: 1
2024-10-22 16:59:47,598 - DEBUG - Move: (Play 1) | Reward: 1 | Depth: 2
2024-10-22 16:59:47,890 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:47,891 - DEBUG - Network Policy Logits: [[ 0.00619186  0.04042299 -0.01720418 -0.04085993 -0.02415496  0.07301983
   0.02941295  0.03571434 -0.01452815  0.08194263 -0.03324782 -0.03313246
  -0.04719675 -0.01215856  0.07720032  0.00347003  0.00969249 -0.03248835
   0.04081463 -0.03826689]]
2024-10-22 16:59:47,891 - DEBUG - Network Policy after Softmax: [[0.05000656 0.05174797 0.04885018 0.04770816 0.04851181 0.05346259
  0.05118135 0.05150488 0.04898108 0.05394176 0.0480727  0.04807825
  0.0474068  0.04909728 0.05368656 0.04987064 0.05018192 0.04810923
  0.05176824 0.04783203]]
2024-10-22 16:59:47,893 - DEBUG - Normalized Policy: [[0.3309503 0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.3137447 0.
  0.355305  0.        0.        0.        0.        0.       ]]
2024-10-22 16:59:47,894 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Play 1), (Discard 0)) | P=0.3309502899646759
2024-10-22 16:59:47,895 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Play 1), (Reveal player +1 color B)) | P=0.3553049862384796
2024-10-22 16:59:47,896 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Play 1), (Reveal player +1 color G)) | P=0.3137446939945221
2024-10-22 16:59:47,896 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Play 1)) | Value: 0.0
2024-10-22 16:59:47,896 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:47,896 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B1 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G2 || X2|YGWB2
Y2 || X2|YGWB2
B2 || X2|RYGWB2
G1 || XX|RYGWB1345
Y3 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:47,896 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:47,896 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 16:59:47,896 - DEBUG - --- Rollout #5 ---
2024-10-22 16:59:47,897 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.6569790244102478 | PUCT: 0.6569790244102478
2024-10-22 16:59:47,898 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.6003267168998718 | PUCT: 0.6003267168998718
2024-10-22 16:59:47,898 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.6569790244102478
2024-10-22 16:59:47,898 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 16:59:47,898 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Reveal player +1 rank 1))
2024-10-22 16:59:47,898 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 rank 1))']
2024-10-22 16:59:47,899 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 0 | Depth: 1
2024-10-22 16:59:47,900 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:48,168 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:48,168 - DEBUG - Network Policy Logits: [[ 0.02606668  0.0248779   0.01726142 -0.04634892 -0.01204614  0.03131955
   0.00449975  0.0012334   0.00483298  0.03825603 -0.02409486 -0.01310221
   0.00116944 -0.03604339  0.04923001 -0.00349916 -0.02421146 -0.02902629
   0.02532307  0.00304109]]
2024-10-22 16:59:48,168 - DEBUG - Network Policy after Softmax: [[0.05120469 0.05114385 0.0507558  0.04762775 0.04928986 0.05147437
  0.05011218 0.04994877 0.05012889 0.05183266 0.04869954 0.04923783
  0.04994557 0.04812112 0.0524046  0.04971294 0.04869386 0.04845997
  0.05116663 0.05003914]]
2024-10-22 16:59:48,170 - DEBUG - Normalized Policy: [[0.         0.25455526 0.         0.         0.         0.
  0.24942037 0.         0.         0.         0.         0.
  0.24859111 0.         0.         0.24743326 0.         0.
  0.         0.        ]]
2024-10-22 16:59:48,171 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 1), (Discard 1)) | P=0.25455525517463684
2024-10-22 16:59:48,171 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.24743326008319855
2024-10-22 16:59:48,172 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 1), (Play 1)) | P=0.2494203746318817
2024-10-22 16:59:48,173 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 1), (Reveal player +1 color G)) | P=0.2485911101102829
2024-10-22 16:59:48,173 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:48,173 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:48,173 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || X1|RYGWB1
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
G2 || X2|YGWB2
Y1 || XX|YGWB15
Y2 || X2|YGWB2
B2 || X2|RYGWB2
G1 || XX|RYGWB1345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:48,173 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:48,173 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 16:59:48,173 - DEBUG - --- Rollout #6 ---
2024-10-22 16:59:48,174 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.5198948383331299 | PUCT: 0.5198948383331299
2024-10-22 16:59:48,174 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.6334180235862732 | PUCT: 0.6334180235862732
2024-10-22 16:59:48,174 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.6334180235862732
2024-10-22 16:59:48,174 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:48,174 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 rank 3))
2024-10-22 16:59:48,174 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 rank 3))']
2024-10-22 16:59:48,175 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:48,175 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 16:59:48,175 - DEBUG - Backpropagating reward: 0
2024-10-22 16:59:48,175 - DEBUG - Rollout #6 completed with reward=0
2024-10-22 16:59:48,175 - DEBUG - --- Rollout #7 ---
2024-10-22 16:59:48,176 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.5417975783348083 | PUCT: 0.5417975783348083
2024-10-22 16:59:48,176 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.44006896018981934 | PUCT: 0.44006896018981934
2024-10-22 16:59:48,177 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.5417975783348083
2024-10-22 16:59:48,177 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 16:59:48,177 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Reveal player +1 color B))
2024-10-22 16:59:48,177 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 color B))']
2024-10-22 16:59:48,177 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 0 | Depth: 1
2024-10-22 16:59:48,178 - DEBUG - Move: (Reveal player +1 color B) | Reward: 0 | Depth: 2
2024-10-22 16:59:48,406 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:48,407 - DEBUG - Network Policy Logits: [[ 0.01537356 -0.00215867  0.02778393 -0.02508443  0.00764039  0.0611225
   0.01602942  0.01368532  0.02392499  0.06268601 -0.05470141  0.03734955
  -0.03427291 -0.02491508  0.03990772 -0.00928489  0.00233628 -0.03939289
   0.0124325  -0.00950602]]
2024-10-22 16:59:48,407 - DEBUG - Network Policy after Softmax: [[0.05044411 0.04956742 0.05107404 0.04844398 0.05005553 0.05280548
  0.05047721 0.05035903 0.05087733 0.05288811 0.04703025 0.05156494
  0.04800089 0.04845218 0.05169703 0.04921545 0.04979073 0.04775576
  0.05029597 0.04920457]]
2024-10-22 16:59:48,410 - DEBUG - Normalized Policy: [[0.34162235 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.32507613 0.         0.         0.33330148 0.         0.
  0.         0.        ]]
2024-10-22 16:59:48,411 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color B), (Discard 0)) | P=0.34162235260009766
2024-10-22 16:59:48,412 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color B), (Reveal player +1 rank 1)) | P=0.33330148458480835
2024-10-22 16:59:48,413 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color B), (Reveal player +1 color G)) | P=0.3250761330127716
2024-10-22 16:59:48,413 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 16:59:48,413 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:48,413 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGW12345
XX || XX|RYGW12345
XX || BX|B12345
XX || XX|RYGW12345
XX || XX|RYGW12345
-----
G2 || X2|YGWB2
Y1 || XX|YGWB15
Y2 || X2|YGWB2
B2 || X2|RYGWB2
G1 || XX|RYGWB1345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:48,414 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:48,414 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 16:59:48,414 - DEBUG - --- Rollout #8 ---
2024-10-22 16:59:48,415 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.4480629563331604 | PUCT: 0.4480629563331604
2024-10-22 16:59:48,415 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4549175202846527 | PUCT: 0.4549175202846527
2024-10-22 16:59:48,415 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.4549175202846527
2024-10-22 16:59:48,416 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:48,416 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Discard 1))
2024-10-22 16:59:48,416 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Discard 1))']
2024-10-22 16:59:48,417 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:48,418 - DEBUG - Move: (Discard 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:48,768 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:48,769 - DEBUG - Network Policy Logits: [[ 0.01938458  0.03850312 -0.0156037  -0.02377213 -0.01291679  0.06005239
   0.02811383  0.02327409 -0.02208761  0.09743156 -0.06267364  0.0074543
  -0.04917982  0.02195026  0.05647764  0.01543649 -0.01988723 -0.04199111
   0.04167779 -0.02553386]]
2024-10-22 16:59:48,769 - DEBUG - Network Policy after Softmax: [[0.05059269 0.05156925 0.04885314 0.04845572 0.04898458 0.05269259
  0.05103626 0.05078985 0.04853741 0.05469947 0.04660691 0.04999269
  0.04724007 0.05072266 0.05250456 0.05039334 0.04864433 0.0475809
  0.05173323 0.04837043]]
2024-10-22 16:59:48,771 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.49267736 0.         0.         0.         0.50732267 0.
  0.         0.        ]]
2024-10-22 16:59:48,772 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1), (Reveal player +1 rank 2)) | P=0.5073226690292358
2024-10-22 16:59:48,772 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1), (Reveal player +1 color G)) | P=0.49267736077308655
2024-10-22 16:59:48,773 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Discard 1)) | Value: 0.0
2024-10-22 16:59:48,773 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:48,773 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G2 || XX|YGWB25
Y2 || XX|YGWB235
B2 || XX|RYGWB235
G1 || X1|RYGWB1
R1 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4 W1}
2024-10-22 16:59:48,773 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:48,773 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 16:59:48,773 - DEBUG - --- Rollout #9 ---
2024-10-22 16:59:48,774 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.46057766675949097 | PUCT: 0.46057766675949097
2024-10-22 16:59:48,775 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.35071781277656555 | PUCT: 0.35071781277656555
2024-10-22 16:59:48,775 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.46057766675949097
2024-10-22 16:59:48,775 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 16:59:48,775 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Discard 0))
2024-10-22 16:59:48,775 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Discard 0))']
2024-10-22 16:59:48,776 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 0 | Depth: 1
2024-10-22 16:59:48,777 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 2
2024-10-22 16:59:49,071 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:49,072 - DEBUG - Network Policy Logits: [[ 0.01300478  0.0374226  -0.00699635 -0.02100757 -0.01315989  0.08204752
  -0.01278579  0.0081695  -0.01862876  0.11147921 -0.04256409 -0.0192243
  -0.04963855 -0.01190541  0.06487679 -0.00076618 -0.00852522 -0.04630888
   0.04844256 -0.03381262]]
2024-10-22 16:59:49,072 - DEBUG - Network Policy after Softmax: [[0.05040547 0.05165141 0.04940732 0.04871989 0.04910374 0.05400856
  0.04912211 0.05016234 0.04883593 0.05562174 0.0476809  0.04880685
  0.04734477 0.04916538 0.05308911 0.0497161  0.04933184 0.04750268
  0.05222376 0.04810001]]
2024-10-22 16:59:49,074 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.49538562
  0.         0.         0.         0.5046144  0.         0.
  0.         0.        ]]
2024-10-22 16:59:49,075 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 0), (Reveal player +1 color Y)) | P=0.49538561701774597
2024-10-22 16:59:49,076 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 0), (Reveal player +1 rank 1)) | P=0.5046144127845764
2024-10-22 16:59:49,076 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Discard 0)) | Value: 0.0
2024-10-22 16:59:49,076 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:49,076 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
Y1 || XX|YGWB15
Y2 || X2|YGWB2
B2 || X2|RYGWB2
G1 || XX|RYGWB1345
W1 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4 W2}
2024-10-22 16:59:49,076 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:49,076 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 16:59:49,076 - DEBUG - --- Rollout #10 ---
2024-10-22 16:59:49,077 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.3929092586040497 | PUCT: 0.3929092586040497
2024-10-22 16:59:49,078 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.35902807116508484 | PUCT: 0.35902807116508484
2024-10-22 16:59:49,078 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.3929092586040497
2024-10-22 16:59:49,078 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 16:59:49,078 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Play 1)) | Q: 0.0 | U: 0.4198763370513916 | PUCT: 0.4198763370513916
2024-10-22 16:59:49,079 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.4176301956176758 | PUCT: 0.4176301956176758
2024-10-22 16:59:49,080 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 color B)) | Q: 0.0 | U: 0.4229363799095154 | PUCT: 0.4229363799095154
2024-10-22 16:59:49,080 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Discard 0)) | Q: 0.0 | U: 0.4127647876739502 | PUCT: 0.4127647876739502
2024-10-22 16:59:49,081 - DEBUG - Selected Child: ((Reveal player +1 rank 2), (Reveal player +1 color B)) | PUCT: 0.4229363799095154
2024-10-22 16:59:49,081 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2), (Reveal player +1 color B))
2024-10-22 16:59:49,081 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Reveal player +1 color B), (Reveal player +1 rank 1))
2024-10-22 16:59:49,081 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 color B))', '((Reveal player +1 rank 2), (Reveal player +1 color B), (Reveal player +1 rank 1))']
2024-10-22 16:59:49,082 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 0 | Depth: 1
2024-10-22 16:59:49,082 - DEBUG - Move: (Reveal player +1 color B) | Reward: 0 | Depth: 2
2024-10-22 16:59:49,083 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 3
2024-10-22 16:59:49,403 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:49,404 - DEBUG - Network Policy Logits: [[ 0.01408798  0.00717632 -0.00238182  0.03119526  0.02900628  0.02939701
   0.00867766  0.00359913  0.0468992   0.08683032 -0.06050109 -0.06008924
  -0.03793565  0.01454268  0.04917352  0.00439884 -0.0697538  -0.02338481
   0.03551946 -0.0300788 ]]
2024-10-22 16:59:49,405 - DEBUG - Network Policy after Softmax: [[0.05047654 0.05012887 0.04965201 0.05134749 0.05123521 0.05125523
  0.05020418 0.04994987 0.05216021 0.05428517 0.04684853 0.04686783
  0.04791771 0.0504995  0.05227897 0.04998983 0.04641705 0.04862005
  0.05157    0.04829567]]
2024-10-22 16:59:49,408 - DEBUG - Normalized Policy: [[0.         0.25479764 0.         0.         0.         0.
  0.25518045 0.         0.         0.         0.         0.
  0.         0.         0.         0.2540909  0.23593101 0.
  0.         0.        ]]
2024-10-22 16:59:49,409 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color B), (Reveal player +1 rank 1), (Discard 1)) | P=0.25479763746261597
2024-10-22 16:59:49,411 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color B), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.25409090518951416
2024-10-22 16:59:49,412 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color B), (Reveal player +1 rank 1), (Reveal player +1 rank 2)) | P=0.23593100905418396
2024-10-22 16:59:49,413 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color B), (Reveal player +1 rank 1), (Play 1)) | P=0.2551804482936859
2024-10-22 16:59:49,414 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Reveal player +1 color B), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:49,414 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:49,414 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 5, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}], [{'color': None, 'rank': None}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 5
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X2|YGWB2
XX || X1|YGWB1
XX || X2|YGWB2
XX || X2|RYGWB2
XX || X1|RYGWB1
-----
G5 || XX|RYGW12345
B2 || BX|B12345
Y1 || XX|RYGW12345
R1 || XX|RYGW12345
W1 || XX|RYGW12345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:49,414 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:49,414 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 16:59:49,414 - INFO - === MCTS Search Completed ===
2024-10-22 16:59:49,414 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 2),) | Visit Count: 6
2024-10-22 16:59:49,414 - INFO - Actual Game Score: 0
2024-10-22 16:59:49,415 - DEBUG - === Recording Training Data ===
2024-10-22 16:59:49,415 - DEBUG - State Vector Shape: 658
2024-10-22 16:59:49,415 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.33333333 0.66666667 0.
 0.         0.        ]
2024-10-22 16:59:49,416 - DEBUG - === End of Training Data ===
2024-10-22 16:59:49,416 - INFO - Chosen Action: (Reveal player +1 rank 2) | Visit Count: 6
2024-10-22 16:59:51,813 - DEBUG - Not the current player's turn.
2024-10-22 16:59:51,813 - INFO - Agent state has been reset.
2024-10-22 16:59:51,813 - INFO - === Starting MCTS Search ===
2024-10-22 16:59:51,813 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G2 || X2|YGWB2
Y2 || X2|YGWB2
B2 || X2|RYGWB2
G1 || XX|RYGWB1345
R1 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:51,813 - INFO - Max Rollouts: 10
2024-10-22 16:59:51,814 - DEBUG - --- Rollout #1 ---
2024-10-22 16:59:51,814 - DEBUG - Node () is a leaf node.
2024-10-22 16:59:51,814 - DEBUG - Traversing Path: ['()']
2024-10-22 16:59:52,027 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:52,027 - DEBUG - Network Policy Logits: [[ 0.02335518  0.03630698 -0.01977566 -0.03228743 -0.0136382   0.08081482
   0.03950893  0.03033475 -0.00963436  0.08781029 -0.04225727 -0.04340696
  -0.0267658  -0.01724287  0.07011395 -0.00714025  0.00284548 -0.04124215
   0.03769044 -0.03604865]]
2024-10-22 16:59:52,027 - DEBUG - Network Policy after Softmax: [[0.05083387 0.05149654 0.04868798 0.04808259 0.04898771 0.05384032
  0.0516617  0.05118991 0.04918424 0.05421827 0.0476056  0.0475509
  0.04834883 0.04881145 0.05326725 0.04930707 0.0498019  0.04765395
  0.05156784 0.04790208]]
2024-10-22 16:59:52,029 - DEBUG - Normalized Policy: [[0.34643647 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.32406282
  0.3295007  0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:52,030 - DEBUG - Dirichlet Noise Added: [0.25982735 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.49304712
 0.24712554 0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 16:59:52,031 - DEBUG - Added Child Node: ((Discard 0),) | P=0.2598273456096649
2024-10-22 16:59:52,032 - DEBUG - Added Child Node: ((Reveal player +1 color Y),) | P=0.4930471181869507
2024-10-22 16:59:52,033 - DEBUG - Added Child Node: ((Reveal player +1 color G),) | P=0.2471255362033844
2024-10-22 16:59:52,033 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 16:59:52,033 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:52,033 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G2 || X2|YGWB2
Y2 || X2|YGWB2
B2 || X2|RYGWB2
G1 || XX|RYGWB1345
R1 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:52,033 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:52,033 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 16:59:52,033 - DEBUG - --- Rollout #2 ---
2024-10-22 16:59:52,034 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G),)
2024-10-22 16:59:52,034 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)']
2024-10-22 16:59:52,035 - DEBUG - Move: (Reveal player +1 color G) | Reward: 1 | Depth: 1
2024-10-22 16:59:52,312 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:52,312 - DEBUG - Network Policy Logits: [[ 0.00460349 -0.0277045  -0.02710941 -0.0444599  -0.0091708   0.02556456
  -0.01149276 -0.02143353  0.06650876  0.03290939 -0.0297463  -0.06064462
  -0.06548667 -0.00952124  0.04568682 -0.01220252 -0.09079973 -0.01933024
   0.03609057 -0.03672513]]
2024-10-22 16:59:52,313 - DEBUG - Network Policy after Softmax: [[0.05083624 0.04922007 0.04924937 0.04840224 0.05014081 0.05191307
  0.05002452 0.0495297  0.05408273 0.05229577 0.04911968 0.04762517
  0.04739513 0.05012324 0.05296826 0.04998903 0.04621047 0.04963399
  0.0524624  0.04877808]]
2024-10-22 16:59:52,314 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.34263155 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.3415944  0.31577402 0.
  0.         0.        ]]
2024-10-22 16:59:52,315 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4)) | P=0.3426315486431122
2024-10-22 16:59:52,316 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 1)) | P=0.341594398021698
2024-10-22 16:59:52,317 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 2)) | P=0.31577402353286743
2024-10-22 16:59:52,317 - DEBUG - Simulating Node: ((Reveal player +1 color G),) | Value: 0.0
2024-10-22 16:59:52,317 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:52,317 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYWB12345
-----
G2 || XX|RYGWB12345
Y3 || XX|RYGWB12345
B1 || XX|RYGWB12345
W4 || XX|RYGWB12345
R2 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:52,317 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:52,317 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 16:59:52,317 - DEBUG - --- Rollout #3 ---
2024-10-22 16:59:52,318 - DEBUG - Expanding unexplored child: ((Discard 0),)
2024-10-22 16:59:52,318 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 16:59:52,319 - DEBUG - Move: (Discard 0) | Reward: 1 | Depth: 1
2024-10-22 16:59:52,529 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:52,530 - DEBUG - Network Policy Logits: [[-0.02793932 -0.0253631  -0.00135411 -0.02782775  0.0027563   0.03945385
  -0.02344215  0.03819701  0.07313814  0.05962761 -0.04317034 -0.03771806
  -0.07061619 -0.01835411  0.05900916  0.00195111 -0.06950644 -0.03060349
   0.05467677 -0.03504657]]
2024-10-22 16:59:52,530 - DEBUG - Network Policy after Softmax: [[0.04877779 0.04890361 0.05009195 0.04878324 0.05029827 0.05217838
  0.04899765 0.05211284 0.05396591 0.05324171 0.04804049 0.04830313
  0.0467399  0.04924759 0.05320879 0.05025779 0.0467918  0.04864801
  0.05297877 0.04843235]]
2024-10-22 16:59:52,532 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.48186612 0.         0.         0.5181339  0.         0.
  0.         0.        ]]
2024-10-22 16:59:52,532 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1)) | P=0.5181338787078857
2024-10-22 16:59:52,533 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color G)) | P=0.48186612129211426
2024-10-22 16:59:52,533 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 16:59:52,533 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:52,533 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 12, 13, 15, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || X2|YGWB2
XX || X2|YGWB2
XX || X2|RYGWB2
XX || XX|RYGWB1345
XX || XX|RYGWB12345
-----
G4 || XX|RYGWB12345
G5 || XX|RYGWB12345
W1 || XX|RYGWB12345
W4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Deck size: 35
Discards: B3 R3 R4 R3}
2024-10-22 16:59:52,534 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:52,534 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 16:59:52,534 - DEBUG - --- Rollout #4 ---
2024-10-22 16:59:52,534 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y),)
2024-10-22 16:59:52,534 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)']
2024-10-22 16:59:52,535 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 1 | Depth: 1
2024-10-22 16:59:52,747 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:52,747 - DEBUG - Network Policy Logits: [[-0.02475055 -0.00856591 -0.02370902 -0.04458776 -0.00888413  0.03792168
  -0.02763093 -0.00408912  0.06451178  0.07224475 -0.04892904 -0.04657079
  -0.0383523  -0.02599472  0.03494462  0.01234408 -0.07633414 -0.03667269
   0.04274857 -0.02118154]]
2024-10-22 16:59:52,748 - DEBUG - Network Policy after Softmax: [[0.04915946 0.04996156 0.04921069 0.04819388 0.04994566 0.05233898
  0.04901806 0.05018573 0.05374935 0.0541666  0.04798511 0.0480984
  0.04849533 0.04909833 0.0521834  0.05101725 0.04668793 0.04857685
  0.05259223 0.04933522]]
2024-10-22 16:59:52,749 - DEBUG - Normalized Policy: [[0.24866931 0.         0.         0.         0.         0.
  0.24795406 0.         0.         0.         0.         0.
  0.24530987 0.         0.         0.2580668  0.         0.
  0.         0.        ]]
2024-10-22 16:59:52,751 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 0)) | P=0.2486693114042282
2024-10-22 16:59:52,751 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 rank 1)) | P=0.2580668032169342
2024-10-22 16:59:52,752 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Play 1)) | P=0.24795405566692352
2024-10-22 16:59:52,753 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color G)) | P=0.24530987441539764
2024-10-22 16:59:52,753 - DEBUG - Simulating Node: ((Reveal player +1 color Y),) | Value: 0.0
2024-10-22 16:59:52,753 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:52,753 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 15, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 4}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || X2|GWB2
XX || Y2|Y2
XX || X2|RGWB2
XX || XX|RGWB1345
XX || XX|RGWB12345
-----
G5 || XX|RYGWB12345
W1 || XX|RYGWB12345
B1 || XX|RYGWB12345
G4 || XX|RYGWB12345
B4 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:52,753 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:52,753 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 16:59:52,753 - DEBUG - --- Rollout #5 ---
2024-10-22 16:59:52,754 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.3918904960155487 | PUCT: 0.3918904960155487
2024-10-22 16:59:52,755 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.41203299164772034 | PUCT: 0.41203299164772034
2024-10-22 16:59:52,756 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.7818718552589417 | PUCT: 0.7818718552589417
2024-10-22 16:59:52,756 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 0.7818718552589417
2024-10-22 16:59:52,756 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 16:59:52,756 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Reveal player +1 color G))
2024-10-22 16:59:52,756 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 color G))']
2024-10-22 16:59:52,757 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 1 | Depth: 1
2024-10-22 16:59:52,758 - DEBUG - Move: (Reveal player +1 color G) | Reward: 1 | Depth: 2
2024-10-22 16:59:53,104 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:53,104 - DEBUG - Network Policy Logits: [[ 0.03860735  0.00767941 -0.00692374  0.02658658  0.01046339  0.06924506
   0.04128998  0.00842061 -0.01430035  0.05696172 -0.04518955 -0.05823083
  -0.04887501 -0.03028128  0.08139183  0.00847569 -0.02333065 -0.0261123
   0.01947131 -0.01236999]]
2024-10-22 16:59:53,104 - DEBUG - Network Policy after Softmax: [[0.0516635  0.05009011 0.04936395 0.05104618 0.05022975 0.05327085
  0.05180228 0.05012725 0.04900116 0.05262051 0.04751069 0.04689511
  0.04733591 0.0482243  0.05392186 0.05013001 0.04856065 0.04842576
  0.05068427 0.04909583]]
2024-10-22 16:59:53,108 - DEBUG - Normalized Policy: [[0.         0.33946502 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.32079953 0.         0.         0.33973542 0.         0.
  0.         0.        ]]
2024-10-22 16:59:53,109 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color G), (Reveal player +1 rank 1)) | P=0.3397354185581207
2024-10-22 16:59:53,110 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color G), (Discard 1)) | P=0.33946502208709717
2024-10-22 16:59:53,111 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color G), (Reveal player +1 color G)) | P=0.3207995295524597
2024-10-22 16:59:53,111 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Reveal player +1 color G)) | Value: 0.0
2024-10-22 16:59:53,111 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:53,111 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 5, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}], [{'color': None, 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || GX|G12345
XX || XX|RYWB12345
XX || XX|RYWB12345
XX || XX|RYWB12345
XX || GX|G12345
-----
G2 || X2|GWB2
Y2 || Y2|Y2
B2 || X2|RGWB2
G1 || XX|RGWB1345
R1 || XX|RGWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:53,111 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:53,111 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 16:59:53,111 - DEBUG - --- Rollout #6 ---
2024-10-22 16:59:53,113 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.413492351770401 | PUCT: 0.413492351770401
2024-10-22 16:59:53,114 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4347451329231262 | PUCT: 0.4347451329231262
2024-10-22 16:59:53,114 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.5499802231788635 | PUCT: 0.5499802231788635
2024-10-22 16:59:53,114 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 0.5499802231788635
2024-10-22 16:59:53,114 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 16:59:53,115 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Discard 0))
2024-10-22 16:59:53,115 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Discard 0))']
2024-10-22 16:59:53,115 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 1 | Depth: 1
2024-10-22 16:59:53,117 - DEBUG - Move: (Discard 0) | Reward: 1 | Depth: 2
2024-10-22 16:59:53,413 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:53,414 - DEBUG - Network Policy Logits: [[ 0.02032809  0.00562989 -0.01817268 -0.00489972 -0.01616709  0.10000678
   0.00693883 -0.00543592 -0.00078436  0.0605461  -0.0349731  -0.02634623
  -0.04589259  0.00071585  0.05193455 -0.05013343 -0.01454319 -0.04594433
   0.01472881 -0.04746292]]
2024-10-22 16:59:53,414 - DEBUG - Network Policy after Softmax: [[0.05111717 0.05037134 0.04918653 0.04984373 0.04928528 0.05535679
  0.05043732 0.04981701 0.05004928 0.05321491 0.04836708 0.04878614
  0.04784181 0.05012442 0.05275862 0.04763935 0.04936538 0.04783933
  0.05083176 0.04776674]]
2024-10-22 16:59:53,416 - DEBUG - Normalized Policy: [[0.25446558 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.2626368  0.23715268 0.24574499 0.
  0.         0.        ]]
2024-10-22 16:59:53,417 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 0), (Reveal player +1 color B)) | P=0.26263681054115295
2024-10-22 16:59:53,418 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 0), (Discard 0)) | P=0.25446557998657227
2024-10-22 16:59:53,419 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 0), (Reveal player +1 rank 1)) | P=0.23715268075466156
2024-10-22 16:59:53,420 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 0), (Reveal player +1 rank 2)) | P=0.245744988322258
2024-10-22 16:59:53,420 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Discard 0)) | Value: 0.0
2024-10-22 16:59:53,420 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:53,420 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
Y2 || Y2|Y2
B2 || X2|RGWB2
G1 || XX|RGWB1345
R1 || XX|RGWB12345
R2 || XX|RYGWB12345
Deck size: 35
Discards: B3 R3 R4 G2}
2024-10-22 16:59:53,420 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:53,421 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 16:59:53,421 - DEBUG - --- Rollout #7 ---
2024-10-22 16:59:53,422 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.43091243505477905 | PUCT: 0.43091243505477905
2024-10-22 16:59:53,423 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4530605673789978 | PUCT: 0.4530605673789978
2024-10-22 16:59:53,423 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.4298627972602844 | PUCT: 0.4298627972602844
2024-10-22 16:59:53,423 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.4530605673789978
2024-10-22 16:59:53,424 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 16:59:53,424 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 rank 1))
2024-10-22 16:59:53,424 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 rank 1))']
2024-10-22 16:59:53,424 - DEBUG - Move: (Discard 0) | Reward: 1 | Depth: 1
2024-10-22 16:59:53,425 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 1 | Depth: 2
2024-10-22 16:59:53,694 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:53,694 - DEBUG - Network Policy Logits: [[ 0.01498574  0.03688096 -0.02932414 -0.02086375  0.01131528  0.06997316
   0.01153326  0.01580465  0.006424    0.0677     -0.03032114 -0.07007074
  -0.02105376 -0.01295451  0.07599058  0.03237078 -0.03089194 -0.03508861
   0.03114301 -0.00246446]]
2024-10-22 16:59:53,694 - DEBUG - Network Policy after Softmax: [[0.05041243 0.05152839 0.04822742 0.04863717 0.05022772 0.0532621
  0.05023868 0.05045373 0.04998265 0.05314117 0.04817936 0.04630182
  0.04862794 0.04902339 0.05358357 0.05129651 0.04815187 0.04795022
  0.05123357 0.04954035]]
2024-10-22 16:59:53,697 - DEBUG - Normalized Policy: [[0.         0.26196858 0.         0.         0.         0.
  0.25541174 0.         0.         0.         0.         0.23539688
  0.24722278 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:53,697 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Discard 1)) | P=0.26196858286857605
2024-10-22 16:59:53,698 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 color Y)) | P=0.2353968769311905
2024-10-22 16:59:53,698 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Play 1)) | P=0.2554117441177368
2024-10-22 16:59:53,699 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 color G)) | P=0.24722278118133545
2024-10-22 16:59:53,699 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:53,699 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:53,699 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}], [{'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
-----
G2 || X2|YGWB2
Y2 || X2|YGWB2
B2 || X2|RYGWB2
G1 || XX|RYGWB1345
R1 || XX|RYGWB12345
Deck size: 35
Discards: B3 R3 R4 G5}
2024-10-22 16:59:53,700 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:53,700 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 16:59:53,700 - DEBUG - --- Rollout #8 ---
2024-10-22 16:59:53,701 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.4454520642757416 | PUCT: 0.4454520642757416
2024-10-22 16:59:53,701 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.3122316896915436 | PUCT: 0.3122316896915436
2024-10-22 16:59:53,702 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.44436702132225037 | PUCT: 0.44436702132225037
2024-10-22 16:59:53,702 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.4454520642757416
2024-10-22 16:59:53,702 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 16:59:53,702 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Reveal player +1 rank 2))
2024-10-22 16:59:53,702 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 rank 2))']
2024-10-22 16:59:53,702 - DEBUG - Move: (Reveal player +1 color G) | Reward: 1 | Depth: 1
2024-10-22 16:59:53,703 - DEBUG - Illegal move encountered: (Reveal player +1 rank 2)
2024-10-22 16:59:53,703 - DEBUG - Backpropagating reward: 1
2024-10-22 16:59:53,703 - DEBUG - Rollout #8 completed with reward=1
2024-10-22 16:59:53,703 - DEBUG - --- Rollout #9 ---
2024-10-22 16:59:53,703 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.5 | U: 0.30526259541511536 | PUCT: 0.805262565612793
2024-10-22 16:59:53,704 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.32095256447792053 | PUCT: 0.32095256447792053
2024-10-22 16:59:53,704 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.45677855610847473 | PUCT: 0.45677855610847473
2024-10-22 16:59:53,705 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.805262565612793
2024-10-22 16:59:53,705 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 16:59:53,705 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Discard 4))
2024-10-22 16:59:53,705 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Discard 4))']
2024-10-22 16:59:53,705 - DEBUG - Move: (Reveal player +1 color G) | Reward: 1 | Depth: 1
2024-10-22 16:59:53,706 - DEBUG - Move: (Discard 4) | Reward: 1 | Depth: 2
2024-10-22 16:59:53,914 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:53,914 - DEBUG - Network Policy Logits: [[ 0.0257968   0.0399259   0.00535629 -0.01697017 -0.00472587  0.092279
   0.01531905  0.02942209 -0.03303968  0.07012452 -0.04354053 -0.0109595
  -0.03394376 -0.01424452  0.08796346 -0.00217659  0.01622795 -0.03440342
   0.04265439 -0.03126353]]
2024-10-22 16:59:53,915 - DEBUG - Network Policy after Softmax: [[0.05075619 0.05147842 0.04972924 0.04863126 0.04923038 0.05424527
  0.05022715 0.05094053 0.04785603 0.05305671 0.04735612 0.04892445
  0.04781278 0.04876399 0.05401167 0.04935604 0.05027283 0.04779081
  0.05161907 0.0479411 ]]
2024-10-22 16:59:53,917 - DEBUG - Normalized Policy: [[0.25188538 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.24279508
  0.23727828 0.         0.26804122 0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:53,919 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Discard 0)) | P=0.25188538432121277
2024-10-22 16:59:53,919 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Reveal player +1 color Y)) | P=0.24279507994651794
2024-10-22 16:59:53,920 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Reveal player +1 color B)) | P=0.2680412232875824
2024-10-22 16:59:53,921 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Reveal player +1 color G)) | P=0.2372782826423645
2024-10-22 16:59:53,921 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Discard 4)) | Value: 0.0
2024-10-22 16:59:53,921 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:53,921 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
G1 || GX|G1345
G1 || XX|RYGWB12345
Deck size: 35
Discards: B3 R3 R4 Y4}
2024-10-22 16:59:53,921 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:53,921 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 16:59:53,921 - DEBUG - --- Rollout #10 ---
2024-10-22 16:59:53,922 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.3333333333333333 | U: 0.2343718558549881 | PUCT: 0.5677052140235901
2024-10-22 16:59:53,923 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.328557550907135 | PUCT: 0.328557550907135
2024-10-22 16:59:53,923 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.4676019251346588 | PUCT: 0.4676019251346588
2024-10-22 16:59:53,923 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.5677052140235901
2024-10-22 16:59:53,923 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 16:59:53,923 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Reveal player +1 rank 1))
2024-10-22 16:59:53,923 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 rank 1))']
2024-10-22 16:59:53,924 - DEBUG - Move: (Reveal player +1 color G) | Reward: 1 | Depth: 1
2024-10-22 16:59:53,925 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 1 | Depth: 2
2024-10-22 16:59:54,190 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:54,191 - DEBUG - Network Policy Logits: [[ 0.0404243   0.03928139 -0.01084466 -0.01363995  0.01810526  0.07209525
   0.00913841 -0.00671725 -0.01841254  0.07253665 -0.04395049 -0.03876397
  -0.01493312  0.00197639  0.0670704   0.0419041  -0.01995618 -0.02673008
   0.04409117  0.00085534]]
2024-10-22 16:59:54,191 - DEBUG - Network Policy after Softmax: [[0.05147686 0.05141806 0.04890421 0.0487677  0.05034067 0.05313327
  0.04989129 0.04910647 0.0485355  0.05315673 0.0473117  0.04755772
  0.04870467 0.04953524 0.05286695 0.05155309 0.04846064 0.04813348
  0.05166597 0.04947975]]
2024-10-22 16:59:54,193 - DEBUG - Normalized Policy: [[0.         0.20300303 0.         0.         0.         0.
  0.19697522 0.         0.         0.         0.         0.18776208
  0.         0.         0.20872341 0.20353617 0.         0.
  0.         0.        ]]
2024-10-22 16:59:54,194 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.20353616774082184
2024-10-22 16:59:54,195 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.20872341096401215
2024-10-22 16:59:54,195 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 1), (Play 1)) | P=0.1969752162694931
2024-10-22 16:59:54,196 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 1), (Reveal player +1 color Y)) | P=0.1877620816230774
2024-10-22 16:59:54,197 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 1), (Discard 1)) | P=0.20300303399562836
2024-10-22 16:59:54,197 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:54,197 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:54,197 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 5, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
G1 || GX|G1345
R1 || XX|RYWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:54,197 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:54,197 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 16:59:54,197 - INFO - === MCTS Search Completed ===
2024-10-22 16:59:54,197 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color G),) | Visit Count: 4
2024-10-22 16:59:54,197 - INFO - Actual Game Score: 1
2024-10-22 16:59:54,197 - DEBUG - === Recording Training Data ===
2024-10-22 16:59:54,198 - DEBUG - State Vector Shape: 658
2024-10-22 16:59:54,198 - DEBUG - Policy Targets: [0.22222222 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.33333333
 0.44444444 0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 16:59:54,198 - DEBUG - === End of Training Data ===
2024-10-22 16:59:54,198 - INFO - Chosen Action: (Reveal player +1 color G) | Visit Count: 4
2024-10-22 16:59:56,592 - DEBUG - Not the current player's turn.
2024-10-22 16:59:56,593 - INFO - Agent state has been reset.
2024-10-22 16:59:56,593 - INFO - === Starting MCTS Search ===
2024-10-22 16:59:56,593 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 5, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
G1 || GX|G1345
R1 || XX|RYWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:56,593 - INFO - Max Rollouts: 10
2024-10-22 16:59:56,593 - DEBUG - --- Rollout #1 ---
2024-10-22 16:59:56,593 - DEBUG - Node () is a leaf node.
2024-10-22 16:59:56,593 - DEBUG - Traversing Path: ['()']
2024-10-22 16:59:56,792 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:56,792 - DEBUG - Network Policy Logits: [[ 0.0107965   0.02393323  0.03395291  0.00688597  0.01761043  0.01702087
   0.03413794  0.0072665  -0.00955827  0.04022313 -0.04547482 -0.06064942
  -0.0014101  -0.01182471  0.08640729  0.00711128  0.030145   -0.02526247
   0.05493333 -0.05659205]]
2024-10-22 16:59:56,792 - DEBUG - Network Policy after Softmax: [[0.05010923 0.05077184 0.05128312 0.04991366 0.05045183 0.0504221
  0.0512926  0.04993265 0.04909958 0.05160568 0.04736738 0.04665402
  0.04950128 0.04898842 0.05404494 0.0499249  0.0510882  0.04833453
  0.05237042 0.0468437 ]]
2024-10-22 16:59:56,794 - DEBUG - Normalized Policy: [[0.19951499 0.         0.         0.         0.         0.20076072
  0.         0.         0.         0.         0.         0.18575774
  0.         0.         0.21518543 0.19878109 0.         0.
  0.         0.        ]]
2024-10-22 16:59:56,795 - DEBUG - Dirichlet Noise Added: [0.14963624 0.         0.         0.         0.         0.40057054
 0.         0.         0.         0.         0.         0.1393183
 0.         0.         0.16138908 0.14908582 0.         0.
 0.         0.        ]
2024-10-22 16:59:56,795 - DEBUG - Added Child Node: ((Play 0),) | P=0.4005705416202545
2024-10-22 16:59:56,796 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.14908581972122192
2024-10-22 16:59:56,796 - DEBUG - Added Child Node: ((Discard 0),) | P=0.14963623881340027
2024-10-22 16:59:56,797 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.1613890826702118
2024-10-22 16:59:56,798 - DEBUG - Added Child Node: ((Reveal player +1 color Y),) | P=0.1393183022737503
2024-10-22 16:59:56,798 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 16:59:56,798 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:56,798 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 5, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
G1 || GX|G1345
R1 || XX|RYWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:56,798 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:56,798 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 16:59:56,798 - DEBUG - --- Rollout #2 ---
2024-10-22 16:59:56,799 - DEBUG - Expanding unexplored child: ((Play 0),)
2024-10-22 16:59:56,799 - DEBUG - Traversing Path: ['()', '((Play 0),)']
2024-10-22 16:59:56,799 - DEBUG - Move: (Play 0) | Reward: 2 | Depth: 1
2024-10-22 16:59:57,014 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:57,015 - DEBUG - Network Policy Logits: [[-0.0096433  -0.01050401  0.00636081 -0.02471192 -0.00551215  0.0591739
  -0.00643665 -0.00671576  0.04287047  0.03057154  0.00431524 -0.03796441
  -0.05769747 -0.01895619 -0.00188199 -0.0128163  -0.10109582 -0.02097419
   0.03920932 -0.03803843]]
2024-10-22 16:59:57,015 - DEBUG - Network Policy after Softmax: [[0.04991323 0.04987029 0.05071848 0.04916675 0.05011986 0.05346907
  0.05007355 0.05005957 0.05260441 0.05196139 0.05061483 0.04851947
  0.04757141 0.04945055 0.05030213 0.04975511 0.04555105 0.04935086
  0.05241217 0.04851587]]
2024-10-22 16:59:57,017 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.2576956  0.
  0.         0.         0.         0.         0.         0.24946703
  0.         0.         0.25863275 0.         0.23420464 0.
  0.         0.        ]]
2024-10-22 16:59:57,017 - DEBUG - Added Child Node: ((Play 0), (Discard 4)) | P=0.25769558548927307
2024-10-22 16:59:57,018 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color Y)) | P=0.24946703016757965
2024-10-22 16:59:57,019 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color B)) | P=0.25863274931907654
2024-10-22 16:59:57,019 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 2)) | P=0.23420463502407074
2024-10-22 16:59:57,019 - DEBUG - Simulating Node: ((Play 0),) | Value: 0.0
2024-10-22 16:59:57,019 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:57,019 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 5, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 1, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 4}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 5
Fireworks: R1 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYWB12345
-----
B4 || XX|RYGWB2345
Y5 || XX|RYGWB2345
Y1 || X1|RYGWB1
R2 || XX|RYGWB2345
B5 || XX|RYGWB12345
Deck size: 35
Discards: B3 R3 R4}
2024-10-22 16:59:57,019 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:57,020 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 16:59:57,020 - DEBUG - --- Rollout #3 ---
2024-10-22 16:59:57,020 - DEBUG - Expanding unexplored child: ((Discard 0),)
2024-10-22 16:59:57,020 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 16:59:57,021 - DEBUG - Move: (Discard 0) | Reward: 1 | Depth: 1
2024-10-22 16:59:57,221 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:57,221 - DEBUG - Network Policy Logits: [[-0.01201447 -0.01552184 -0.00011863 -0.02235179 -0.01096458  0.04442463
   0.00865726 -0.00720383  0.03550226  0.01670755  0.01738703 -0.03836942
  -0.0613443  -0.03405226  0.0035157  -0.02270519 -0.10796254 -0.01192787
   0.03553406 -0.04785859]]
2024-10-22 16:59:57,222 - DEBUG - Network Policy after Softmax: [[0.04994554 0.04977068 0.05054324 0.04943191 0.04999801 0.05284549
  0.05098875 0.0501864  0.05237608 0.05140088 0.05143582 0.04864643
  0.04754153 0.0488569  0.05072726 0.04941444 0.04537608 0.04994987
  0.05237775 0.048187  ]]
2024-10-22 16:59:57,223 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.51259226 0.
  0.         0.         0.         0.         0.         0.
  0.48740777 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:57,224 - DEBUG - Added Child Node: ((Discard 0), (Discard 4)) | P=0.5125922560691833
2024-10-22 16:59:57,225 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color G)) | P=0.48740777373313904
2024-10-22 16:59:57,225 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 16:59:57,225 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:57,225 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYWB12345
-----
B3 || XX|RYGWB2345
G4 || XX|RYGWB2345
G1 || X1|RYGWB1
R2 || XX|RYGWB2345
R4 || XX|RYGWB12345
Deck size: 35
Discards: B3 R3 R4 B1}
2024-10-22 16:59:57,225 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:57,225 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 16:59:57,225 - DEBUG - --- Rollout #4 ---
2024-10-22 16:59:57,225 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 16:59:57,226 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 16:59:57,226 - DEBUG - Move: (Reveal player +1 color B) | Reward: 1 | Depth: 1
2024-10-22 16:59:57,442 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:57,443 - DEBUG - Network Policy Logits: [[ 0.01140907 -0.00417541 -0.00831797 -0.02661669  0.000958   -0.02268327
  -0.01351845 -0.00382715  0.02282109  0.04761841 -0.04108249 -0.02015022
  -0.02151475  0.01025137  0.01072974  0.01365022 -0.06997558 -0.03092578
   0.0248701  -0.03094475]]
2024-10-22 16:59:57,443 - DEBUG - Network Policy after Softmax: [[0.05094069 0.05015296 0.04994562 0.04904    0.05041108 0.04923327
  0.04968656 0.05017043 0.05152535 0.05281902 0.0483357  0.04935814
  0.04929083 0.05088175 0.0509061  0.05105498 0.04695911 0.04882913
  0.05163104 0.04882821]]
2024-10-22 16:59:57,444 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.34052885 0.
  0.         0.         0.         0.         0.32650957 0.
  0.33296156 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:57,445 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color R)) | P=0.326509565114975
2024-10-22 16:59:57,446 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 4)) | P=0.34052884578704834
2024-10-22 16:59:57,446 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color G)) | P=0.3329615592956543
2024-10-22 16:59:57,446 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 16:59:57,446 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:57,447 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 4, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'G', 'rank': 0}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 4
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YW2
XX || B2|B2
XX || GX|G1345
XX || XX|RYW12345
-----
R1 || X1|RYGWB1
G4 || XX|RYGWB2345
B5 || XX|RYGWB2345
G1 || X1|RYGWB1
B4 || XX|RYGWB2345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:57,447 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:57,447 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 16:59:57,447 - DEBUG - --- Rollout #5 ---
2024-10-22 16:59:57,447 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y),)
2024-10-22 16:59:57,447 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)']
2024-10-22 16:59:57,448 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 1 | Depth: 1
2024-10-22 16:59:57,654 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:57,654 - DEBUG - Network Policy Logits: [[ 0.01052233 -0.02298952 -0.01239393 -0.02036004  0.0010692   0.01541499
  -0.03581567 -0.02919746  0.00728097  0.04752027 -0.05242656 -0.03528606
  -0.0096203   0.02125356  0.00385554  0.02398678 -0.06772144 -0.03305038
   0.04259808 -0.0357759 ]]
2024-10-22 16:59:57,654 - DEBUG - Network Policy after Softmax: [[0.05096545 0.0492858  0.04981079 0.04941557 0.05048594 0.05121542
  0.04865769 0.04898079 0.05080052 0.05288638 0.04785612 0.04868347
  0.04994914 0.05151531 0.0506268  0.05165631 0.04712974 0.04879243
  0.0526267  0.04865963]]
2024-10-22 16:59:57,656 - DEBUG - Normalized Policy: [[0.25505435 0.         0.         0.         0.         0.
  0.24350528 0.         0.         0.         0.         0.24363427
  0.         0.25780612 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:57,657 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color W)) | P=0.25780612230300903
2024-10-22 16:59:57,657 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 0)) | P=0.2550543546676636
2024-10-22 16:59:57,658 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | P=0.24363426864147186
2024-10-22 16:59:57,659 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Play 1)) | P=0.24350528419017792
2024-10-22 16:59:57,659 - DEBUG - Simulating Node: ((Reveal player +1 color Y),) | Value: 0.0
2024-10-22 16:59:57,659 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:57,659 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 4, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 4
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || Y2|Y2
XX || X2|RWB2
XX || GX|G1345
XX || XX|RWB12345
-----
Y1 || X1|RYGWB1
R4 || XX|RYGWB2345
W3 || XX|RYGWB2345
W1 || X1|RYGWB1
Y4 || XX|RYGWB2345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:57,659 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:57,659 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 16:59:57,659 - DEBUG - --- Rollout #6 ---
2024-10-22 16:59:57,660 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 16:59:57,660 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 16:59:57,660 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 1 | Depth: 1
2024-10-22 16:59:57,868 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:57,868 - DEBUG - Network Policy Logits: [[ 0.00182863 -0.01381689 -0.0181762  -0.00463535  0.02423636 -0.02593184
  -0.03149536  0.00297207  0.04018317  0.03979097 -0.05110577 -0.04111494
  -0.03085486  0.0215026   0.04696896  0.00132342 -0.08239277 -0.04630793
   0.02846608 -0.01863602]]
2024-10-22 16:59:57,868 - DEBUG - Network Policy after Softmax: [[0.05045808 0.04967478 0.0494587  0.05013297 0.05160149 0.04907661
  0.04880432 0.05051581 0.05243097 0.05241041 0.04785657 0.04833709
  0.04883559 0.05146062 0.05278796 0.05043259 0.04638246 0.04808673
  0.05182021 0.04943597]]
2024-10-22 16:59:57,870 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3290483  0.
  0.         0.         0.33433762 0.         0.         0.
  0.         0.         0.3366141  0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:57,871 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 3)) | P=0.33433762192726135
2024-10-22 16:59:57,872 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.33661410212516785
2024-10-22 16:59:57,872 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 4)) | P=0.3290483057498932
2024-10-22 16:59:57,872 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 16:59:57,872 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:57,873 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 4, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 0}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'B', 'rank': 0}, {'color': 'G', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 4
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || G1|G1
XX || X1|RYWB1
-----
B1 || X1|RYGWB1
Y3 || XX|RYGWB2345
W4 || XX|RYGWB2345
B1 || X1|RYGWB1
G4 || XX|RYGWB2345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:57,873 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:57,873 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 16:59:57,873 - DEBUG - --- Rollout #7 ---
2024-10-22 16:59:57,873 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.6984742879867554 | PUCT: 0.6984742879867554
2024-10-22 16:59:57,874 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.2609204947948456 | PUCT: 0.2609204947948456
2024-10-22 16:59:57,874 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.2814139127731323 | PUCT: 0.2814139127731323
2024-10-22 16:59:57,875 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.2429291158914566 | PUCT: 0.2429291158914566
2024-10-22 16:59:57,875 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.25996074080467224 | PUCT: 0.25996074080467224
2024-10-22 16:59:57,876 - DEBUG - Selected Child: ((Play 0),) | PUCT: 0.6984742879867554
2024-10-22 16:59:57,876 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 16:59:57,876 - DEBUG - Expanding unexplored child: ((Play 0), (Reveal player +1 rank 2))
2024-10-22 16:59:57,876 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Reveal player +1 rank 2))']
2024-10-22 16:59:57,876 - DEBUG - Move: (Play 0) | Reward: 2 | Depth: 1
2024-10-22 16:59:57,877 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 2 | Depth: 2
2024-10-22 16:59:58,084 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:58,085 - DEBUG - Network Policy Logits: [[ 0.01670421  0.03655342  0.02886925 -0.02203601  0.01844791  0.0135067
   0.00268209  0.02049393 -0.00829954  0.03704365 -0.06165001 -0.00735201
   0.00959333 -0.04263683  0.0337943  -0.00746622  0.02191773  0.03091086
   0.03727547 -0.00268456]]
2024-10-22 16:59:58,085 - DEBUG - Network Policy after Softmax: [[0.05043066 0.05144167 0.0510479  0.04851432 0.05051867 0.05026966
  0.04972845 0.05062214 0.04918534 0.05146689 0.04663005 0.04923197
  0.05007333 0.04752512 0.05129993 0.04922634 0.05069426 0.05115223
  0.05147883 0.04946229]]
2024-10-22 16:59:58,087 - DEBUG - Normalized Policy: [[0.         0.         0.20303164 0.         0.         0.
  0.         0.20133829 0.         0.         0.         0.19580919
  0.         0.         0.20403406 0.19578682 0.         0.
  0.         0.        ]]
2024-10-22 16:59:58,088 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 2), (Reveal player +1 rank 1)) | P=0.19578681886196136
2024-10-22 16:59:58,089 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 2), (Reveal player +1 color B)) | P=0.20403406023979187
2024-10-22 16:59:58,089 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 2), (Play 2)) | P=0.2013382911682129
2024-10-22 16:59:58,090 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 2), (Discard 2)) | P=0.20303164422512054
2024-10-22 16:59:58,090 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 2), (Reveal player +1 color Y)) | P=0.19580918550491333
2024-10-22 16:59:58,090 - DEBUG - Simulating Node: ((Play 0), (Reveal player +1 rank 2)) | Value: 0.0
2024-10-22 16:59:58,091 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:58,091 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 4, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 1, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 4
Fireworks: R1 Y1 G0 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || XX|RYGWB345
XX || X1|RYGWB1
XX || X2|RYGWB2
XX || X2|RYGWB2
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
G1 || GX|G1345
R1 || XX|RYWB12345
Deck size: 35
Discards: B3 R3 R4}
2024-10-22 16:59:58,091 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:58,091 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 16:59:58,091 - DEBUG - --- Rollout #8 ---
2024-10-22 16:59:58,092 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.4813612401485443 | PUCT: 0.4813612401485443
2024-10-22 16:59:58,092 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.2697243392467499 | PUCT: 0.2697243392467499
2024-10-22 16:59:58,093 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.2909092605113983 | PUCT: 0.2909092605113983
2024-10-22 16:59:58,093 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.25112590193748474 | PUCT: 0.25112590193748474
2024-10-22 16:59:58,094 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.2687321901321411 | PUCT: 0.2687321901321411
2024-10-22 16:59:58,094 - DEBUG - Selected Child: ((Play 0),) | PUCT: 0.4813612401485443
2024-10-22 16:59:58,094 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 16:59:58,094 - DEBUG - Expanding unexplored child: ((Play 0), (Reveal player +1 color B))
2024-10-22 16:59:58,094 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Reveal player +1 color B))']
2024-10-22 16:59:58,095 - DEBUG - Move: (Play 0) | Reward: 2 | Depth: 1
2024-10-22 16:59:58,095 - DEBUG - Illegal move encountered: (Reveal player +1 color B)
2024-10-22 16:59:58,095 - DEBUG - Backpropagating reward: 2
2024-10-22 16:59:58,095 - DEBUG - Rollout #8 completed with reward=2
2024-10-22 16:59:58,095 - DEBUG - --- Rollout #9 ---
2024-10-22 16:59:58,096 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.6666666666666666 | U: 0.37110453844070435 | PUCT: 1.037771224975586
2024-10-22 16:59:58,097 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.2772579789161682 | PUCT: 0.2772579789161682
2024-10-22 16:59:58,097 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.29903459548950195 | PUCT: 0.29903459548950195
2024-10-22 16:59:58,098 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.25814005732536316 | PUCT: 0.25814005732536316
2024-10-22 16:59:58,098 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.2762381136417389 | PUCT: 0.2762381136417389
2024-10-22 16:59:58,098 - DEBUG - Selected Child: ((Play 0),) | PUCT: 1.037771224975586
2024-10-22 16:59:58,099 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 16:59:58,099 - DEBUG - Expanding unexplored child: ((Play 0), (Reveal player +1 color Y))
2024-10-22 16:59:58,099 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Reveal player +1 color Y))']
2024-10-22 16:59:58,100 - DEBUG - Move: (Play 0) | Reward: 2 | Depth: 1
2024-10-22 16:59:58,100 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 2 | Depth: 2
2024-10-22 16:59:58,305 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:58,305 - DEBUG - Network Policy Logits: [[-0.00205182  0.06882773  0.0206263  -0.0368766  -0.00858052  0.06040256
   0.01228023  0.02793898 -0.0171013   0.07340138 -0.04249245  0.01233682
   0.00603944 -0.06397042  0.05517726  0.01905829  0.00025434 -0.00412358
   0.03811011 -0.01939345]]
2024-10-22 16:59:58,305 - DEBUG - Network Policy after Softmax: [[0.04936901 0.05299526 0.0505014  0.04767935 0.04904775 0.05255065
  0.05008167 0.05087206 0.0486316  0.0532382  0.04741233 0.05008451
  0.04977009 0.04640487 0.05227677 0.05042228 0.049483   0.04926684
  0.05139213 0.04852026]]
2024-10-22 16:59:58,307 - DEBUG - Normalized Policy: [[0.         0.         0.19870159 0.         0.         0.
  0.         0.20015998 0.         0.         0.         0.19706129
  0.         0.         0.2056869  0.19839028 0.         0.
  0.         0.        ]]
2024-10-22 16:59:58,308 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color Y), (Reveal player +1 rank 1)) | P=0.19839027523994446
2024-10-22 16:59:58,309 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color Y), (Reveal player +1 color B)) | P=0.20568689703941345
2024-10-22 16:59:58,310 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color Y), (Play 2)) | P=0.2001599818468094
2024-10-22 16:59:58,310 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color Y), (Discard 2)) | P=0.19870159029960632
2024-10-22 16:59:58,311 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color Y), (Reveal player +1 color Y)) | P=0.19706128537654877
2024-10-22 16:59:58,311 - DEBUG - Simulating Node: ((Play 0), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 16:59:58,311 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:58,311 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 4, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 1, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'Y', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 4
Fireworks: R0 Y1 G0 W1 B0 
Hands:
Cur player
XX || YX|Y2345
XX || XX|RGWB2345
XX || X1|RGWB1
XX || XX|RGWB2345
XX || XX|RGWB12345
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
G1 || GX|G1345
R1 || XX|RYWB12345
Deck size: 35
Discards: B3 R3 R4}
2024-10-22 16:59:58,311 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:58,312 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 16:59:58,312 - DEBUG - --- Rollout #10 ---
2024-10-22 16:59:58,312 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.5 | U: 0.3039183020591736 | PUCT: 0.8039183020591736
2024-10-22 16:59:58,313 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.28382760286331177 | PUCT: 0.28382760286331177
2024-10-22 16:59:58,313 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.30612021684646606 | PUCT: 0.30612021684646606
2024-10-22 16:59:58,314 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.26425671577453613 | PUCT: 0.26425671577453613
2024-10-22 16:59:58,314 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.282783567905426 | PUCT: 0.282783567905426
2024-10-22 16:59:58,314 - DEBUG - Selected Child: ((Play 0),) | PUCT: 0.8039183020591736
2024-10-22 16:59:58,315 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 16:59:58,315 - DEBUG - Expanding unexplored child: ((Play 0), (Discard 4))
2024-10-22 16:59:58,315 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Discard 4))']
2024-10-22 16:59:58,315 - DEBUG - Move: (Play 0) | Reward: 2 | Depth: 1
2024-10-22 16:59:58,316 - DEBUG - Move: (Discard 4) | Reward: 2 | Depth: 2
2024-10-22 16:59:58,522 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:58,523 - DEBUG - Network Policy Logits: [[ 0.02316123  0.05858825  0.01511294 -0.04285491 -0.013078    0.08529258
   0.01301333  0.07060073 -0.03357416  0.07728399 -0.04773613  0.0048875
  -0.01087282 -0.06360096  0.06377317 -0.00832569  0.02587877 -0.02189239
   0.00863074  0.00156868]]
2024-10-22 16:59:58,523 - DEBUG - Network Policy after Softmax: [[0.05060259 0.05242743 0.05019696 0.04736988 0.04880162 0.05384633
  0.05009168 0.05306101 0.04781156 0.05341681 0.04713922 0.04968629
  0.04890936 0.04639727 0.05269996 0.0490341  0.05074029 0.04837336
  0.04987263 0.04952167]]
2024-10-22 16:59:58,525 - DEBUG - Normalized Policy: [[0.         0.         0.3373619  0.         0.         0.
  0.         0.         0.         0.         0.         0.3339298
  0.32870823 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:58,526 - DEBUG - Added Child Node: ((Play 0), (Discard 4), (Discard 2)) | P=0.3373619019985199
2024-10-22 16:59:58,526 - DEBUG - Added Child Node: ((Play 0), (Discard 4), (Reveal player +1 color Y)) | P=0.33392980694770813
2024-10-22 16:59:58,527 - DEBUG - Added Child Node: ((Play 0), (Discard 4), (Reveal player +1 color G)) | P=0.3287082314491272
2024-10-22 16:59:58,527 - DEBUG - Simulating Node: ((Play 0), (Discard 4)) | Value: 0.0
2024-10-22 16:59:58,527 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:58,527 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y1 G0 W0 B1 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
G1 || GX|G1345
G3 || XX|RYGWB12345
Deck size: 34
Discards: B3 R3 R4 W1}
2024-10-22 16:59:58,527 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:58,527 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 16:59:58,528 - INFO - === MCTS Search Completed ===
2024-10-22 16:59:58,528 - DEBUG - Best node chosen by MCTS: ((Play 0),) | Visit Count: 5
2024-10-22 16:59:58,528 - INFO - Actual Game Score: 2
2024-10-22 16:59:58,528 - DEBUG - === Recording Training Data ===
2024-10-22 16:59:58,528 - DEBUG - State Vector Shape: 658
2024-10-22 16:59:58,528 - DEBUG - Policy Targets: [0.11111111 0.         0.         0.         0.         0.55555556
 0.         0.         0.         0.         0.         0.11111111
 0.         0.         0.11111111 0.11111111 0.         0.
 0.         0.        ]
2024-10-22 16:59:58,529 - DEBUG - === End of Training Data ===
2024-10-22 16:59:58,529 - INFO - Chosen Action: (Play 0) | Visit Count: 5
2024-10-22 17:00:00,205 - DEBUG - Not the current player's turn.
2024-10-22 17:00:00,206 - INFO - Agent state has been reset.
2024-10-22 17:00:00,206 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:00,206 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
G1 || GX|G1345
W1 || XX|RYGWB12345
Deck size: 34
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:00,206 - INFO - Max Rollouts: 10
2024-10-22 17:00:00,207 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:00,207 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:00,207 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:00,393 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:00,393 - DEBUG - Network Policy Logits: [[ 0.02060783  0.05293275  0.02317413 -0.03643645 -0.00939618  0.07339526
  -0.00164888  0.07544103 -0.03364016  0.07597922 -0.04147287  0.00821619
   0.00290136 -0.06057991  0.04163613 -0.01547522  0.0277257  -0.02111578
   0.01421828  0.00140747]]
2024-10-22 17:00:00,393 - DEBUG - Network Policy after Softmax: [[0.05050053 0.05215963 0.0506303  0.04770039 0.04900782 0.05323794
  0.04938897 0.05334697 0.04783396 0.05337568 0.04746076 0.04987861
  0.04961422 0.04656253 0.05157372 0.0487108  0.05086127 0.04843682
  0.05017889 0.04954015]]
2024-10-22 17:00:00,395 - DEBUG - Normalized Policy: [[0.         0.         0.19922177 0.         0.         0.
  0.         0.20991139 0.         0.         0.         0.196264
  0.         0.         0.20293397 0.19166887 0.         0.
  0.         0.        ]]
2024-10-22 17:00:00,395 - DEBUG - Dirichlet Noise Added: [0.         0.         0.14941633 0.         0.         0.
 0.         0.15743354 0.         0.         0.         0.2304969
 0.         0.         0.15220048 0.31045276 0.         0.
 0.         0.        ]
2024-10-22 17:00:00,396 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.31045275926589966
2024-10-22 17:00:00,397 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.15220047533512115
2024-10-22 17:00:00,397 - DEBUG - Added Child Node: ((Play 2),) | P=0.15743353962898254
2024-10-22 17:00:00,398 - DEBUG - Added Child Node: ((Discard 2),) | P=0.14941632747650146
2024-10-22 17:00:00,398 - DEBUG - Added Child Node: ((Reveal player +1 color Y),) | P=0.23049689829349518
2024-10-22 17:00:00,398 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:00,398 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:00,398 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
G1 || GX|G1345
W1 || XX|RYGWB12345
Deck size: 34
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:00,399 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:00,399 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:00,399 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:00,399 - DEBUG - Expanding unexplored child: ((Discard 2),)
2024-10-22 17:00:00,399 - DEBUG - Traversing Path: ['()', '((Discard 2),)']
2024-10-22 17:00:00,400 - DEBUG - Move: (Discard 2) | Reward: 1 | Depth: 1
2024-10-22 17:00:00,612 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:00,613 - DEBUG - Network Policy Logits: [[-0.00855047  0.00630232 -0.03355698 -0.05765841 -0.01691851  0.02558863
   0.01227015  0.00407086  0.08323455  0.03921031 -0.02776957 -0.02812763
  -0.06177656 -0.01122496  0.02717419  0.01377448 -0.0805188  -0.029789
   0.04038635 -0.04831504]]
2024-10-22 17:00:00,613 - DEBUG - Network Policy after Softmax: [[0.04991449 0.05066139 0.04868177 0.0475225  0.04949854 0.05164794
  0.05096463 0.05054847 0.05471272 0.05235629 0.04896434 0.04894681
  0.0473272  0.04978117 0.0517299  0.05104136 0.04644844 0.04886556
  0.0524179  0.0479686 ]]
2024-10-22 17:00:00,615 - DEBUG - Normalized Policy: [[0.34154296 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.3406307  0.         0.         0.31782636 0.
  0.         0.        ]]
2024-10-22 17:00:00,616 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 color W)) | P=0.3406307101249695
2024-10-22 17:00:00,617 - DEBUG - Added Child Node: ((Discard 2), (Discard 0)) | P=0.34154295921325684
2024-10-22 17:00:00,618 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 2)) | P=0.31782636046409607
2024-10-22 17:00:00,618 - DEBUG - Simulating Node: ((Discard 2),) | Value: 0.0
2024-10-22 17:00:00,618 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:00,618 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYGWB12345
-----
Y2 || XX|RYGWB2345
W5 || XX|RYGWB2345
R3 || XX|RYGWB2345
W4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1 Y1}
2024-10-22 17:00:00,618 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:00,618 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:00,618 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:00,619 - DEBUG - Expanding unexplored child: ((Play 2),)
2024-10-22 17:00:00,619 - DEBUG - Traversing Path: ['()', '((Play 2),)']
2024-10-22 17:00:00,619 - DEBUG - Move: (Play 2) | Reward: 2 | Depth: 1
2024-10-22 17:00:00,835 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:00,835 - DEBUG - Network Policy Logits: [[-0.00328383  0.01595373 -0.05178551 -0.04766731 -0.00531041  0.02358906
  -0.00427749  0.01257121  0.07058299  0.05566497 -0.0215218  -0.03493279
  -0.05958177 -0.01276238  0.02204261  0.02673052 -0.08772374 -0.00469108
   0.03535349 -0.05227096]]
2024-10-22 17:00:00,836 - DEBUG - Network Policy after Softmax: [[0.05010477 0.051078   0.0477326  0.04792958 0.05000334 0.05146949
  0.05005502 0.05090553 0.05394598 0.05314719 0.04919925 0.04854384
  0.04736192 0.0496321  0.05138996 0.05163144 0.04604764 0.05003431
  0.05207858 0.04770944]]
2024-10-22 17:00:00,837 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3296871  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.34042162 0.         0.32989132
  0.         0.        ]]
2024-10-22 17:00:00,838 - DEBUG - Added Child Node: ((Play 2), (Discard 4)) | P=0.32968708872795105
2024-10-22 17:00:00,839 - DEBUG - Added Child Node: ((Play 2), (Reveal player +1 rank 1)) | P=0.3404216170310974
2024-10-22 17:00:00,840 - DEBUG - Added Child Node: ((Play 2), (Reveal player +1 rank 3)) | P=0.3298913240432739
2024-10-22 17:00:00,841 - DEBUG - Simulating Node: ((Play 2),) | Value: 0.0
2024-10-22 17:00:00,841 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:00,841 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 1, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 2}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G0 W1 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYGWB12345
-----
G3 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y3 || XX|RYGWB2345
G3 || XX|RYGWB12345
R1 || XX|RYGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:00,841 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:00,841 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:00,841 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:00,841 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:00:00,841 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:00:00,842 - DEBUG - Move: (Reveal player +1 color B) | Reward: 1 | Depth: 1
2024-10-22 17:00:01,043 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:01,044 - DEBUG - Network Policy Logits: [[ 0.00094509 -0.01702062 -0.01252021 -0.03833097 -0.01126022  0.02915448
  -0.00859391 -0.00949202  0.04721203  0.03455433  0.00770908 -0.02740935
  -0.04184848 -0.02815981 -0.02814346  0.00575249 -0.09588134 -0.01070833
   0.03700292 -0.02843767]]
2024-10-22 17:00:01,044 - DEBUG - Network Policy after Softmax: [[0.05051338 0.04961397 0.04983776 0.04856787 0.0499006  0.05195862
  0.05003382 0.04998891 0.05290539 0.05223995 0.05085621 0.04910121
  0.04839734 0.04906438 0.04906518 0.0507568  0.04585168 0.04992814
  0.05236802 0.04905075]]
2024-10-22 17:00:01,045 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33701363 0.
  0.         0.         0.         0.         0.         0.33161485
  0.         0.         0.33137152 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:01,046 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 4)) | P=0.3370136320590973
2024-10-22 17:00:01,047 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color Y)) | P=0.3316148519515991
2024-10-22 17:00:01,047 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color B)) | P=0.3313715159893036
2024-10-22 17:00:01,048 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:00:01,048 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:01,048 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YW2
XX || B2|B2
XX || GX|G1345
XX || XX|RYGW12345
-----
Y3 || XX|RYGWB2345
W2 || XX|RYGWB2345
B1 || X1|RYGWB1
Y4 || XX|RYGWB2345
G4 || XX|RYGWB12345
Deck size: 34
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:01,048 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:01,048 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:01,048 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:01,048 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y),)
2024-10-22 17:00:01,048 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)']
2024-10-22 17:00:01,049 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 1 | Depth: 1
2024-10-22 17:00:01,246 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:01,246 - DEBUG - Network Policy Logits: [[-0.00780889 -0.01398178 -0.00345508 -0.03647987 -0.00603576  0.06472417
  -0.0047648  -0.01614054  0.04603091  0.02007946 -0.00782906 -0.02214642
  -0.0331064  -0.01841006 -0.02645351 -0.00158796 -0.09985723 -0.03113144
   0.04955452 -0.0494018 ]]
2024-10-22 17:00:01,246 - DEBUG - Network Policy after Softmax: [[0.05007362 0.04976548 0.05029211 0.04865835 0.05016249 0.05384058
  0.05022629 0.04965816 0.05284347 0.05148975 0.05007262 0.04936082
  0.04882278 0.04954559 0.04914867 0.0503861  0.0456702  0.04891929
  0.05303    0.04803364]]
2024-10-22 17:00:01,248 - DEBUG - Normalized Policy: [[0.3350559  0.         0.         0.         0.         0.
  0.3360774  0.         0.         0.         0.         0.
  0.         0.         0.32886678 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:01,249 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 0)) | P=0.3350558876991272
2024-10-22 17:00:01,250 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color B)) | P=0.32886677980422974
2024-10-22 17:00:01,250 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Play 1)) | P=0.33607739210128784
2024-10-22 17:00:01,251 - DEBUG - Simulating Node: ((Reveal player +1 color Y),) | Value: 0.0
2024-10-22 17:00:01,251 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:01,251 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 4}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || Y2|Y2
XX || X2|RWB2
XX || GX|G1345
XX || XX|RGWB12345
-----
B4 || XX|RYGWB2345
Y5 || XX|RYGWB2345
B1 || X1|RYGWB1
W3 || XX|RYGWB2345
G1 || XX|RYGWB12345
Deck size: 34
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:01,251 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:01,251 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:01,251 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:01,251 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 17:00:01,251 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 17:00:01,252 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 1 | Depth: 1
2024-10-22 17:00:01,448 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:01,448 - DEBUG - Network Policy Logits: [[-0.00569417 -0.03165488 -0.00491732 -0.01118652  0.01281347  0.02060508
  -0.03473412 -0.00020212  0.0594382   0.03770328 -0.02091848 -0.05819055
  -0.01554995 -0.00376834  0.01412219 -0.01915141 -0.1033731  -0.03096215
   0.0402778  -0.01693455]]
2024-10-22 17:00:01,448 - DEBUG - Network Policy after Softmax: [[0.05011548 0.0488312  0.05015444 0.04984099 0.05105164 0.05145097
  0.04868106 0.05039148 0.05348827 0.05233825 0.04935829 0.04755247
  0.04962399 0.05021209 0.0511185  0.04944559 0.04545174 0.04886504
  0.05247317 0.04955532]]
2024-10-22 17:00:01,450 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.24961264 0.
  0.         0.         0.26152635 0.         0.         0.
  0.         0.         0.24993955 0.         0.         0.23892142
  0.         0.        ]]
2024-10-22 17:00:01,450 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 3)) | P=0.26152634620666504
2024-10-22 17:00:01,451 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.24993954598903656
2024-10-22 17:00:01,452 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 4)) | P=0.24961264431476593
2024-10-22 17:00:01,452 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 3)) | P=0.2389214187860489
2024-10-22 17:00:01,452 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 17:00:01,452 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:01,453 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 2}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || G1|G1
XX || X1|RYGWB1
-----
W3 || XX|RYGWB2345
R2 || XX|RYGWB2345
B1 || X1|RYGWB1
G3 || XX|RYGWB2345
R3 || XX|RYGWB12345
Deck size: 34
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:01,453 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:01,453 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:01,453 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:01,453 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.2605370283126831 | PUCT: 0.2605370283126831
2024-10-22 17:00:01,454 - DEBUG - PUCT Calculation | Child: ((Play 2),) | Q: 0.0 | U: 0.27451661229133606 | PUCT: 0.27451661229133606
2024-10-22 17:00:01,455 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.2653917372226715 | PUCT: 0.2653917372226715
2024-10-22 17:00:01,455 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.40191712975502014 | PUCT: 0.40191712975502014
2024-10-22 17:00:01,455 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.5413359999656677 | PUCT: 0.5413359999656677
2024-10-22 17:00:01,456 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.5413359999656677
2024-10-22 17:00:01,456 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:00:01,456 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 color B))
2024-10-22 17:00:01,456 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 color B))']
2024-10-22 17:00:01,457 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 1 | Depth: 1
2024-10-22 17:00:01,457 - DEBUG - Move: (Reveal player +1 color B) | Reward: 1 | Depth: 2
2024-10-22 17:00:01,672 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:01,672 - DEBUG - Network Policy Logits: [[ 0.02148813  0.03948259  0.00855044 -0.00645457 -0.03391862  0.05242255
  -0.01499909  0.02848527 -0.00072246  0.03797999 -0.01041012 -0.02499388
  -0.01703027 -0.07168092  0.01230646 -0.01958477 -0.01826581 -0.00898849
   0.00681972  0.02700924]]
2024-10-22 17:00:01,673 - DEBUG - Network Policy after Softmax: [[0.05104603 0.05197289 0.05038986 0.0496394  0.04829466 0.05264978
  0.04921706 0.05140445 0.04992476 0.05189485 0.04944344 0.0487276
  0.0491172  0.04650494 0.05057948 0.04899189 0.04905655 0.04951378
  0.05030273 0.05132864]]
2024-10-22 17:00:01,674 - DEBUG - Normalized Policy: [[0.         0.         0.25056943 0.         0.         0.
  0.         0.25561458 0.         0.         0.         0.24230365
  0.         0.         0.25151235 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:01,675 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Discard 2)) | P=0.2505694329738617
2024-10-22 17:00:01,675 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Reveal player +1 color Y)) | P=0.24230365455150604
2024-10-22 17:00:01,676 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Reveal player +1 color B)) | P=0.251512348651886
2024-10-22 17:00:01,677 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Play 2)) | P=0.25561457872390747
2024-10-22 17:00:01,677 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:00:01,677 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:01,677 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': 'B', 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': 'B', 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGW2345
XX || BX|B2345
XX || X1|RYGW1
XX || XX|RYGW2345
XX || BX|B12345
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
G1 || G1|G1
W1 || X1|RYGWB1
Deck size: 34
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:01,677 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:01,677 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:01,677 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:01,678 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.26932793855667114 | PUCT: 0.26932793855667114
2024-10-22 17:00:01,678 - DEBUG - PUCT Calculation | Child: ((Play 2),) | Q: 0.0 | U: 0.28377923369407654 | PUCT: 0.28377923369407654
2024-10-22 17:00:01,678 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.2743464708328247 | PUCT: 0.2743464708328247
2024-10-22 17:00:01,679 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.4154784083366394 | PUCT: 0.4154784083366394
2024-10-22 17:00:01,679 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3730676472187042 | PUCT: 0.3730676472187042
2024-10-22 17:00:01,679 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 0.4154784083366394
2024-10-22 17:00:01,680 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:00:01,680 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Reveal player +1 color B))
2024-10-22 17:00:01,680 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 color B))']
2024-10-22 17:00:01,680 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 1 | Depth: 1
2024-10-22 17:00:01,681 - DEBUG - Move: (Reveal player +1 color B) | Reward: 1 | Depth: 2
2024-10-22 17:00:01,866 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:01,866 - DEBUG - Network Policy Logits: [[ 0.00271075  0.03594135  0.01154074 -0.03396749  0.00325419  0.06091463
   0.0070523   0.02795626 -0.02847096  0.04775665 -0.06034444  0.02014693
   0.00257937 -0.05066542  0.04943178  0.02852697  0.00351206  0.00144025
   0.00324339 -0.02011364]]
2024-10-22 17:00:01,866 - DEBUG - Network Policy after Softmax: [[0.04982992 0.05151361 0.05027186 0.04803535 0.049857   0.05281628
  0.05004672 0.05110391 0.04830011 0.05212587 0.04678489 0.05070638
  0.04982337 0.04723992 0.05221326 0.05113309 0.04986986 0.04976664
  0.04985647 0.04870546]]
2024-10-22 17:00:01,868 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.2440295  0.
  0.         0.25013262 0.         0.         0.         0.
  0.         0.         0.25556245 0.25027543 0.         0.
  0.         0.        ]]
2024-10-22 17:00:01,869 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color B), (Discard 4)) | P=0.24402950704097748
2024-10-22 17:00:01,870 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color B), (Reveal player +1 rank 1)) | P=0.2502754330635071
2024-10-22 17:00:01,871 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color B), (Reveal player +1 color B)) | P=0.2555624544620514
2024-10-22 17:00:01,871 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color B), (Play 2)) | P=0.25013262033462524
2024-10-22 17:00:01,871 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:00:01,871 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:01,872 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': None}, {'color': None, 'rank': None}, {'color': 'B', 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || BX|B2345
XX || XX|RYGW2345
XX || B1|B1
XX || XX|RYGW2345
XX || XX|RYGW12345
-----
G2 || G2|G2
Y2 || Y2|Y2
B2 || X2|RWB2
G1 || GX|G1345
W1 || XX|RGWB12345
Deck size: 34
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:01,872 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:01,872 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:01,872 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:01,873 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.27685049176216125 | PUCT: 0.27685049176216125
2024-10-22 17:00:01,873 - DEBUG - PUCT Calculation | Child: ((Play 2),) | Q: 0.0 | U: 0.2917054295539856 | PUCT: 0.2917054295539856
2024-10-22 17:00:01,873 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.28200918436050415 | PUCT: 0.28200918436050415
2024-10-22 17:00:01,874 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.28472205996513367 | PUCT: 0.28472205996513367
2024-10-22 17:00:01,874 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.383487731218338 | PUCT: 0.383487731218338
2024-10-22 17:00:01,875 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.383487731218338
2024-10-22 17:00:01,875 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:00:01,875 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 rank 3))
2024-10-22 17:00:01,875 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 rank 3))']
2024-10-22 17:00:01,876 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 1 | Depth: 1
2024-10-22 17:00:01,876 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 1 | Depth: 2
2024-10-22 17:00:02,088 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:02,089 - DEBUG - Network Policy Logits: [[ 0.02015426  0.05536769  0.01384783 -0.03138632 -0.03906161  0.02864949
  -0.00058126  0.0130742  -0.02044481  0.04734752 -0.0380049   0.00836657
  -0.01810159 -0.07045874  0.04135899 -0.02729108 -0.00092794 -0.00306941
   0.03284408  0.01488337]]
2024-10-22 17:00:02,089 - DEBUG - Network Policy after Softmax: [[0.05092436 0.05274953 0.05060422 0.04836618 0.04799638 0.05135882
  0.04987929 0.05056509 0.04889828 0.05232816 0.04804712 0.0503276
  0.049013   0.04651284 0.05201573 0.04856466 0.049862   0.04975533
  0.0515747  0.05065665]]
2024-10-22 17:00:02,090 - DEBUG - Normalized Policy: [[0.         0.         0.24865395 0.         0.         0.
  0.         0.24846166 0.         0.         0.         0.24729472
  0.         0.         0.25558966 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:02,091 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 3), (Discard 2)) | P=0.24865394830703735
2024-10-22 17:00:02,091 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 3), (Reveal player +1 color Y)) | P=0.24729472398757935
2024-10-22 17:00:02,092 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 3), (Reveal player +1 color B)) | P=0.25558966398239136
2024-10-22 17:00:02,092 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 3), (Play 2)) | P=0.24846166372299194
2024-10-22 17:00:02,092 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:00:02,092 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:02,092 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': 0}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB245
XX || X3|RYGWB3
XX || X1|RYGWB1
XX || X3|RYGWB3
XX || XX|RYGWB1245
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
G1 || G1|G1
W1 || X1|RYGWB1
Deck size: 34
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:02,093 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:02,093 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:02,093 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:02,093 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.2834104895591736 | PUCT: 0.2834104895591736
2024-10-22 17:00:02,094 - DEBUG - PUCT Calculation | Child: ((Play 2),) | Q: 0.0 | U: 0.2986173927783966 | PUCT: 0.2986173927783966
2024-10-22 17:00:02,094 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.2886914014816284 | PUCT: 0.2886914014816284
2024-10-22 17:00:02,094 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.2914685308933258 | PUCT: 0.2914685308933258
2024-10-22 17:00:02,095 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.2944308817386627 | PUCT: 0.2944308817386627
2024-10-22 17:00:02,095 - DEBUG - Selected Child: ((Play 2),) | PUCT: 0.2986173927783966
2024-10-22 17:00:02,095 - DEBUG - Selected child for exploration: ((Play 2),)
2024-10-22 17:00:02,095 - DEBUG - Expanding unexplored child: ((Play 2), (Reveal player +1 rank 1))
2024-10-22 17:00:02,095 - DEBUG - Traversing Path: ['()', '((Play 2),)', '((Play 2), (Reveal player +1 rank 1))']
2024-10-22 17:00:02,095 - DEBUG - Move: (Play 2) | Reward: 2 | Depth: 1
2024-10-22 17:00:02,096 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:00:02,096 - DEBUG - Backpropagating reward: 2
2024-10-22 17:00:02,096 - DEBUG - Rollout #10 completed with reward=2
2024-10-22 17:00:02,096 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:02,096 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 1),) | Visit Count: 3
2024-10-22 17:00:02,096 - INFO - Actual Game Score: 2
2024-10-22 17:00:02,096 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:02,096 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:02,096 - DEBUG - Policy Targets: [0.         0.         0.11111111 0.         0.         0.
 0.         0.22222222 0.         0.         0.         0.22222222
 0.         0.         0.11111111 0.33333333 0.         0.
 0.         0.        ]
2024-10-22 17:00:02,096 - DEBUG - === End of Training Data ===
2024-10-22 17:00:02,096 - INFO - Chosen Action: (Reveal player +1 rank 1) | Visit Count: 3
2024-10-22 17:00:04,251 - DEBUG - Not the current player's turn.
2024-10-22 17:00:04,252 - INFO - Agent state has been reset.
2024-10-22 17:00:04,252 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:04,252 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
W1 || X1|RYGWB1
R1 || XX|RYGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:04,252 - INFO - Max Rollouts: 10
2024-10-22 17:00:04,252 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:04,253 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:04,253 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:04,458 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:04,458 - DEBUG - Network Policy Logits: [[ 0.01014356  0.04866596  0.01203479 -0.02704337  0.00771799  0.07598493
  -0.00582885  0.06341646 -0.01633022  0.08136036 -0.03206998  0.01984127
   0.00214532 -0.05064562  0.02274272 -0.000397    0.01171888 -0.03769905
   0.01561922 -0.00962789]]
2024-10-22 17:00:04,459 - DEBUG - Network Policy after Softmax: [[0.04999677 0.05196035 0.05009142 0.04817169 0.04987565 0.05339941
  0.04920455 0.05273247 0.04869054 0.05368723 0.04793016 0.05048398
  0.04959848 0.04704804 0.05063067 0.04947254 0.05007559 0.04766111
  0.05027129 0.04901797]]
2024-10-22 17:00:04,460 - DEBUG - Normalized Policy: [[0.         0.         0.24961013 0.         0.         0.
  0.         0.         0.         0.         0.         0.25156632
  0.         0.         0.25229728 0.24652624 0.         0.
  0.         0.        ]]
2024-10-22 17:00:04,460 - DEBUG - Dirichlet Noise Added: [0.         0.         0.187213   0.         0.         0.
 0.         0.         0.         0.         0.         0.43866855
 0.         0.         0.18922298 0.18489547 0.         0.
 0.         0.        ]
2024-10-22 17:00:04,461 - DEBUG - Added Child Node: ((Reveal player +1 color Y),) | P=0.43866854906082153
2024-10-22 17:00:04,461 - DEBUG - Added Child Node: ((Discard 2),) | P=0.1872130036354065
2024-10-22 17:00:04,462 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.18489547073841095
2024-10-22 17:00:04,464 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.18922297656536102
2024-10-22 17:00:04,464 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:04,464 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:04,464 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
W1 || X1|RYGWB1
R1 || XX|RYGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:04,464 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:04,464 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:04,464 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:04,465 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y),)
2024-10-22 17:00:04,465 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)']
2024-10-22 17:00:04,465 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 2 | Depth: 1
2024-10-22 17:00:04,678 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:04,679 - DEBUG - Network Policy Logits: [[-0.01480458 -0.00031405 -0.00827092 -0.03819861  0.01640519  0.03206899
  -0.03456489 -0.0142884   0.02224817  0.02798683  0.01576208 -0.03438783
  -0.02658317 -0.03182358 -0.02201724  0.00515769 -0.08333031 -0.03797882
   0.03875985 -0.03211174]]
2024-10-22 17:00:04,679 - DEBUG - Network Policy after Softmax: [[0.04978863 0.05051535 0.050115   0.04863739 0.05136703 0.05217797
  0.04881445 0.04981434 0.05166804 0.0519654  0.051334   0.0488231
  0.04920563 0.04894845 0.04943082 0.05079251 0.04649111 0.04864809
  0.05252825 0.04893435]]
2024-10-22 17:00:04,680 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24491742 0.         0.26274624
  0.         0.         0.         0.         0.         0.24585253
  0.         0.24648377 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:04,681 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color W)) | P=0.24648377299308777
2024-10-22 17:00:04,682 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | P=0.245852530002594
2024-10-22 17:00:04,682 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Play 0)) | P=0.26274624466896057
2024-10-22 17:00:04,683 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 3)) | P=0.24491742253303528
2024-10-22 17:00:04,683 - DEBUG - Simulating Node: ((Reveal player +1 color Y),) | Value: 0.0
2024-10-22 17:00:04,683 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:04,683 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 3}, {'color': 'B', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 2}, {'color': 'G', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || Y2|Y2
XX || X2|RWB2
XX || X1|RGWB1
XX || XX|RGWB12345
-----
Y4 || XX|RYGWB2345
B3 || XX|RYGWB2345
W1 || X1|RYGWB1
Y3 || XX|RYGWB2345
G2 || XX|RYGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:04,683 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:04,683 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:04,683 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:04,684 - DEBUG - Expanding unexplored child: ((Discard 2),)
2024-10-22 17:00:04,684 - DEBUG - Traversing Path: ['()', '((Discard 2),)']
2024-10-22 17:00:04,684 - DEBUG - Move: (Discard 2) | Reward: 2 | Depth: 1
2024-10-22 17:00:04,870 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:04,871 - DEBUG - Network Policy Logits: [[ 7.8398734e-05  1.1354789e-02 -2.6048493e-02 -5.0689537e-02
  -1.4245261e-02 -2.9797277e-03  2.8396470e-03  1.9201145e-02
   5.5969212e-02  4.0484160e-02 -8.2492577e-03 -4.6456680e-02
  -6.6729799e-02 -1.4772361e-02  4.2345397e-02  1.3663935e-02
  -9.0675272e-02 -3.0094903e-02  2.7869791e-02 -5.2621752e-02]]
2024-10-22 17:00:04,871 - DEBUG - Network Policy after Softmax: [[0.05044479 0.05101684 0.0491439  0.04794773 0.04972739 0.05029076
  0.05058428 0.05141872 0.05334447 0.05252479 0.05002645 0.04815112
  0.04718477 0.04970118 0.05262264 0.05113479 0.04606834 0.04894544
  0.05186639 0.04785518]]
2024-10-22 17:00:04,873 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24393675 0.         0.25585702
  0.         0.         0.         0.         0.         0.
  0.24005514 0.         0.         0.26015106 0.         0.
  0.         0.        ]]
2024-10-22 17:00:04,873 - DEBUG - Added Child Node: ((Discard 2), (Play 0)) | P=0.25585702061653137
2024-10-22 17:00:04,874 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 1)) | P=0.26015105843544006
2024-10-22 17:00:04,875 - DEBUG - Added Child Node: ((Discard 2), (Discard 3)) | P=0.24393674731254578
2024-10-22 17:00:04,875 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 color G)) | P=0.2400551438331604
2024-10-22 17:00:04,875 - DEBUG - Simulating Node: ((Discard 2),) | Value: 0.0
2024-10-22 17:00:04,876 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:04,876 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || X1|RYGWB1
XX || XX|RYGWB12345
-----
R2 || XX|RYGWB2345
G4 || XX|RYGWB2345
G3 || XX|RYGWB2345
B1 || XX|RYGWB12345
B4 || XX|RYGWB12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1 G1}
2024-10-22 17:00:04,876 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:04,876 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:04,876 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:04,877 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 17:00:04,877 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 17:00:04,877 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 2 | Depth: 1
2024-10-22 17:00:05,085 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:05,085 - DEBUG - Network Policy Logits: [[-0.0061935  -0.01205418  0.01329523 -0.00266149  0.02318098  0.02504661
  -0.02037362  0.00199048  0.05990908  0.02062175  0.00470018 -0.05603582
  -0.03319871 -0.01116699  0.01041384 -0.02151051 -0.10304464 -0.03025385
   0.03331056 -0.02394712]]
2024-10-22 17:00:05,085 - DEBUG - Network Policy after Softmax: [[0.04998136 0.0496893  0.05096499 0.05015821 0.05147132 0.05156743
  0.04927762 0.05039209 0.0533969  0.05133976 0.05052882 0.04755124
  0.04864966 0.0497334  0.05081835 0.04922163 0.04536764 0.04879314
  0.05199534 0.04910184]]
2024-10-22 17:00:05,087 - DEBUG - Normalized Policy: [[0.         0.         0.         0.25065482 0.         0.25769708
  0.         0.         0.         0.         0.         0.
  0.24311619 0.2485319  0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:05,087 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color W)) | P=0.24853189289569855
2024-10-22 17:00:05,088 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0)) | P=0.25769707560539246
2024-10-22 17:00:05,088 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 3)) | P=0.25065481662750244
2024-10-22 17:00:05,089 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color G)) | P=0.24311618506908417
2024-10-22 17:00:05,089 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 17:00:05,089 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:05,089 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 4}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || X1|RYGWB1
XX || X1|RYGWB1
-----
R4 || XX|RYGWB2345
W5 || XX|RYGWB2345
G1 || X1|RYGWB1
W3 || XX|RYGWB2345
G1 || XX|RYGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:05,089 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:05,089 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:05,089 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:05,089 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:00:05,089 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:00:05,090 - DEBUG - Move: (Reveal player +1 color B) | Reward: 2 | Depth: 1
2024-10-22 17:00:05,272 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:05,272 - DEBUG - Network Policy Logits: [[-0.00546394 -0.012033   -0.00109363 -0.02977031  0.02356733  0.01456577
  -0.02048053 -0.00440219  0.03384035  0.03873622  0.01662709 -0.03653272
  -0.04905143 -0.04057521 -0.01982988  0.00211439 -0.09327254 -0.02821853
   0.02896875 -0.0297339 ]]
2024-10-22 17:00:05,272 - DEBUG - Network Policy after Softmax: [[0.05023264 0.04990374 0.05045266 0.04902639 0.05171233 0.05124893
  0.04948396 0.05028601 0.05224631 0.05250273 0.05135468 0.04869597
  0.04809016 0.04849951 0.04951616 0.05061477 0.04600989 0.04910253
  0.05199241 0.04902817]]
2024-10-22 17:00:05,274 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24903558 0.         0.26032525
  0.         0.         0.         0.         0.         0.
  0.24427989 0.24635926 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:05,274 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color W)) | P=0.24635925889015198
2024-10-22 17:00:05,275 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 0)) | P=0.26032525300979614
2024-10-22 17:00:05,275 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 3)) | P=0.24903558194637299
2024-10-22 17:00:05,276 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color G)) | P=0.2442798912525177
2024-10-22 17:00:05,276 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:00:05,276 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:05,276 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 2}, {'color': 'G', 'rank': 0}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YW2
XX || B2|B2
XX || X1|RYGW1
XX || XX|RYGW12345
-----
W2 || XX|RYGWB2345
B3 || XX|RYGWB2345
G1 || X1|RYGWB1
R2 || XX|RYGWB2345
W3 || XX|RYGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:05,276 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:05,276 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:05,276 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:05,277 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.73398357629776 | PUCT: 0.73398357629776
2024-10-22 17:00:05,277 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.3132462501525879 | PUCT: 0.3132462501525879
2024-10-22 17:00:05,277 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3093685209751129 | PUCT: 0.3093685209751129
2024-10-22 17:00:05,278 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.31660935282707214 | PUCT: 0.31660935282707214
2024-10-22 17:00:05,278 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 0.73398357629776
2024-10-22 17:00:05,278 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:00:05,278 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Reveal player +1 color W))
2024-10-22 17:00:05,278 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 color W))']
2024-10-22 17:00:05,278 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 2 | Depth: 1
2024-10-22 17:00:05,279 - DEBUG - Illegal move encountered: (Reveal player +1 color W)
2024-10-22 17:00:05,279 - DEBUG - Backpropagating reward: 2
2024-10-22 17:00:05,279 - DEBUG - Rollout #6 completed with reward=2
2024-10-22 17:00:05,279 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:05,279 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 1.0 | U: 0.5099371075630188 | PUCT: 1.509937047958374
2024-10-22 17:00:05,280 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.32644304633140564 | PUCT: 0.32644304633140564
2024-10-22 17:00:05,280 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3224019706249237 | PUCT: 0.3224019706249237
2024-10-22 17:00:05,280 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.329947829246521 | PUCT: 0.329947829246521
2024-10-22 17:00:05,280 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 1.509937047958374
2024-10-22 17:00:05,281 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:00:05,281 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Reveal player +1 color Y))
2024-10-22 17:00:05,281 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 color Y))']
2024-10-22 17:00:05,281 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 2 | Depth: 1
2024-10-22 17:00:05,282 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 2 | Depth: 2
2024-10-22 17:00:05,460 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:05,460 - DEBUG - Network Policy Logits: [[-0.0034671   0.03987925  0.0022167  -0.0305027  -0.00969767  0.05968521
   0.02515288  0.00564753 -0.03490183  0.04646904 -0.01891308  0.01973902
   0.01586451 -0.04231494  0.02526364  0.017324   -0.03134163 -0.0201312
   0.03555967 -0.03783994]]
2024-10-22 17:00:05,461 - DEBUG - Network Policy after Softmax: [[0.04964634 0.05184565 0.04992933 0.04832211 0.04933798 0.05288275
  0.05108775 0.05010092 0.04811    0.05218844 0.04888541 0.05081192
  0.05061543 0.04775468 0.05109341 0.05068935 0.04828159 0.04882589
  0.05162219 0.04796886]]
2024-10-22 17:00:05,462 - DEBUG - Normalized Policy: [[0.         0.         0.20006327 0.         0.         0.
  0.         0.20075084 0.         0.         0.         0.
  0.         0.1913496  0.20472766 0.20310864 0.         0.
  0.         0.        ]]
2024-10-22 17:00:05,463 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color Y), (Reveal player +1 rank 1)) | P=0.20310863852500916
2024-10-22 17:00:05,463 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color Y), (Reveal player +1 color B)) | P=0.2047276645898819
2024-10-22 17:00:05,464 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color Y), (Play 2)) | P=0.20075084269046783
2024-10-22 17:00:05,464 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color Y), (Discard 2)) | P=0.20006327331066132
2024-10-22 17:00:05,465 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color Y), (Reveal player +1 color W)) | P=0.191349595785141
2024-10-22 17:00:05,465 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 17:00:05,465 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:05,465 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': 'Y', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || YX|Y2345
XX || XX|RGWB2345
XX || X1|RGWB1
XX || YX|Y2345
XX || XX|RGWB12345
-----
G2 || G2|G2
Y2 || Y2|Y2
B2 || X2|RWB2
W1 || X1|RGWB1
R1 || XX|RGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:05,465 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:05,465 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:05,465 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:05,466 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.6666666666666666 | U: 0.3953573703765869 | PUCT: 1.0620241165161133
2024-10-22 17:00:05,466 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.33745771646499634 | PUCT: 0.33745771646499634
2024-10-22 17:00:05,466 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3332802951335907 | PUCT: 0.3332802951335907
2024-10-22 17:00:05,467 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.34108078479766846 | PUCT: 0.34108078479766846
2024-10-22 17:00:05,467 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 1.0620241165161133
2024-10-22 17:00:05,467 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:00:05,467 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Play 0))
2024-10-22 17:00:05,467 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Play 0))']
2024-10-22 17:00:05,468 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 2 | Depth: 1
2024-10-22 17:00:05,468 - DEBUG - Move: (Play 0) | Reward: 3 | Depth: 2
2024-10-22 17:00:05,653 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:05,653 - DEBUG - Network Policy Logits: [[ 0.02283396  0.02833354  0.02390363 -0.03102294 -0.00871211  0.09674143
  -0.01018127  0.04468093 -0.0255845   0.05208178 -0.02049098  0.01151656
  -0.03024847 -0.06546009  0.01048969 -0.05166177  0.00243004 -0.0327993
   0.00445638 -0.01468076]]
2024-10-22 17:00:05,653 - DEBUG - Network Policy after Softmax: [[0.05110234 0.05138416 0.05115703 0.04842293 0.04951543 0.05502226
  0.04944273 0.05223106 0.048687   0.05261905 0.04893561 0.05052726
  0.04846044 0.04678377 0.0504754  0.04743378 0.05007022 0.04833699
  0.05017178 0.04922077]]
2024-10-22 17:00:05,655 - DEBUG - Normalized Policy: [[0.         0.         0.2612052  0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.23887552 0.25772482 0.24219446 0.         0.
  0.         0.        ]]
2024-10-22 17:00:05,656 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Play 0), (Reveal player +1 color W)) | P=0.23887552320957184
2024-10-22 17:00:05,657 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Play 0), (Discard 2)) | P=0.26120519638061523
2024-10-22 17:00:05,657 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Play 0), (Reveal player +1 rank 1)) | P=0.24219445884227753
2024-10-22 17:00:05,658 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Play 0), (Reveal player +1 color B)) | P=0.2577248215675354
2024-10-22 17:00:05,658 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Play 0)) | Value: 0.0
2024-10-22 17:00:05,658 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:05,658 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
Y2 || Y2|Y2
B2 || X2|RWB2
W1 || X1|RGWB1
R1 || XX|RGWB12345
Y4 || XX|RYGWB12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:05,658 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:05,658 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:05,658 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:05,659 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.5 | U: 0.3251200318336487 | PUCT: 0.8251200318336487
2024-10-22 17:00:05,659 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.34688320755958557 | PUCT: 0.34688320755958557
2024-10-22 17:00:05,660 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3425890803337097 | PUCT: 0.3425890803337097
2024-10-22 17:00:05,660 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.3506074547767639 | PUCT: 0.3506074547767639
2024-10-22 17:00:05,660 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 0.8251200318336487
2024-10-22 17:00:05,660 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:00:05,661 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Discard 3))
2024-10-22 17:00:05,661 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Discard 3))']
2024-10-22 17:00:05,662 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 2 | Depth: 1
2024-10-22 17:00:05,662 - DEBUG - Move: (Discard 3) | Reward: 2 | Depth: 2
2024-10-22 17:00:05,863 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:05,863 - DEBUG - Network Policy Logits: [[ 0.01780858  0.0452815   0.00334233 -0.04073736  0.00122611  0.09587663
  -0.00710423  0.04121742 -0.0208019   0.06133131 -0.02174343  0.0126394
  -0.03434098 -0.05081591  0.04575802 -0.01592426 -0.00552266 -0.02899468
   0.00862011 -0.01811852]]
2024-10-22 17:00:05,863 - DEBUG - Network Policy after Softmax: [[0.05063818 0.05204865 0.04991091 0.04775864 0.0498054  0.05474981
  0.04939223 0.05183754 0.04872028 0.05289076 0.04867443 0.0503771
  0.0480651  0.04727972 0.05207345 0.0489585  0.04947041 0.04832276
  0.05017502 0.04885119]]
2024-10-22 17:00:05,864 - DEBUG - Normalized Policy: [[0.         0.         0.33066097 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34498784 0.32435122 0.         0.
  0.         0.        ]]
2024-10-22 17:00:05,865 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 3), (Discard 2)) | P=0.33066096901893616
2024-10-22 17:00:05,865 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 3), (Reveal player +1 rank 1)) | P=0.3243512213230133
2024-10-22 17:00:05,866 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 3), (Reveal player +1 color B)) | P=0.3449878394603729
2024-10-22 17:00:05,866 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Discard 3)) | Value: 0.0
2024-10-22 17:00:05,866 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:05,866 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
G2 || G2|G2
Y2 || Y2|Y2
B2 || X2|RWB2
R1 || XX|RGWB12345
B5 || XX|RYGWB12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1 B1}
2024-10-22 17:00:05,866 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:05,866 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:05,866 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:05,867 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.4 | U: 0.2773531377315521 | PUCT: 0.6773531436920166
2024-10-22 17:00:05,867 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.3551025986671448 | PUCT: 0.3551025986671448
2024-10-22 17:00:05,868 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.35070672631263733 | PUCT: 0.35070672631263733
2024-10-22 17:00:05,868 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.3589150905609131 | PUCT: 0.3589150905609131
2024-10-22 17:00:05,868 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 0.6773531436920166
2024-10-22 17:00:05,868 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:00:05,869 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Reveal player +1 color W)) | Q: 2.0 | U: 0.41241857409477234 | PUCT: 2.4124186038970947
2024-10-22 17:00:05,869 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | Q: 0.0 | U: 0.41136232018470764 | PUCT: 0.41136232018470764
2024-10-22 17:00:05,869 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Play 0)) | Q: 0.0 | U: 0.43962904810905457 | PUCT: 0.43962904810905457
2024-10-22 17:00:05,870 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Discard 3)) | Q: 0.0 | U: 0.409797728061676 | PUCT: 0.409797728061676
2024-10-22 17:00:05,870 - DEBUG - Selected Child: ((Reveal player +1 color Y), (Reveal player +1 color W)) | PUCT: 2.4124186038970947
2024-10-22 17:00:05,870 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y), (Reveal player +1 color W))
2024-10-22 17:00:05,870 - DEBUG - Node ((Reveal player +1 color Y), (Reveal player +1 color W)) is a leaf node.
2024-10-22 17:00:05,870 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 color W))']
2024-10-22 17:00:05,870 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 2 | Depth: 1
2024-10-22 17:00:05,871 - DEBUG - Move: (Reveal player +1 color W) | Reward: 2 | Depth: 2
2024-10-22 17:00:06,051 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:06,051 - DEBUG - Network Policy Logits: [[-0.00221703  0.06212803  0.01369296 -0.00833803  0.01426793  0.0395721
  -0.01849864  0.01790084 -0.03728456  0.03408827 -0.04370219 -0.01011276
   0.02930286 -0.01557938  0.0414602   0.01024668 -0.01965261 -0.01534117
   0.01760126 -0.00044054]]
2024-10-22 17:00:06,052 - DEBUG - Network Policy after Softmax: [[0.04960002 0.05289646 0.05039547 0.04929735 0.05042446 0.05171669
  0.048799   0.05060798 0.04789082 0.05143386 0.04758446 0.04920994
  0.05118831 0.04894166 0.05181442 0.05022209 0.04874272 0.04895332
  0.05059282 0.04968822]]
2024-10-22 17:00:06,053 - DEBUG - Normalized Policy: [[0.         0.         0.2502585  0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.24303904 0.25730488 0.24939753 0.         0.
  0.         0.        ]]
2024-10-22 17:00:06,053 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color W), (Reveal player +1 color W)) | P=0.24303904175758362
2024-10-22 17:00:06,054 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color W), (Discard 2)) | P=0.25025850534439087
2024-10-22 17:00:06,054 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color W), (Reveal player +1 rank 1)) | P=0.24939753115177155
2024-10-22 17:00:06,055 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color W), (Reveal player +1 color B)) | P=0.2573048770427704
2024-10-22 17:00:06,055 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Reveal player +1 color W)) | Value: 0.0
2024-10-22 17:00:06,055 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:06,055 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': 'W', 'rank': None}, {'color': 'W', 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || XX|RYGB2345
XX || XX|RYGB2345
XX || X1|RYGB1
XX || WX|W2345
XX || WX|W12345
-----
G2 || G2|G2
Y2 || Y2|Y2
B2 || X2|RWB2
W1 || X1|RGWB1
R1 || XX|RGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:06,055 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:06,055 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:06,055 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:06,055 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color Y),) | Visit Count: 6
2024-10-22 17:00:06,055 - INFO - Actual Game Score: 2
2024-10-22 17:00:06,056 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:06,056 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:06,056 - DEBUG - Policy Targets: [0.         0.         0.11111111 0.         0.         0.
 0.         0.         0.         0.         0.         0.66666667
 0.         0.         0.11111111 0.11111111 0.         0.
 0.         0.        ]
2024-10-22 17:00:06,056 - DEBUG - === End of Training Data ===
2024-10-22 17:00:06,056 - INFO - Chosen Action: (Reveal player +1 color Y) | Visit Count: 6
2024-10-22 17:00:07,858 - DEBUG - Not the current player's turn.
2024-10-22 17:00:07,858 - INFO - Agent state has been reset.
2024-10-22 17:00:07,858 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:07,858 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
Y2 || Y2|Y2
B2 || X2|RWB2
W1 || X1|RGWB1
R1 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:07,858 - INFO - Max Rollouts: 10
2024-10-22 17:00:07,858 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:07,859 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:07,859 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:08,077 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:08,077 - DEBUG - Network Policy Logits: [[ 0.03319117  0.0297442   0.02268888 -0.03933403 -0.0099535   0.10020243
  -0.00385464  0.04876706 -0.02887511  0.05342318 -0.01576189  0.00509883
  -0.01343046 -0.07199632  0.00910578 -0.06613926 -0.00647541 -0.04931628
   0.01015969 -0.01561353]]
2024-10-22 17:00:08,077 - DEBUG - Network Policy after Softmax: [[0.05166594 0.05148815 0.05112617 0.04805151 0.04948423 0.05524678
  0.04978696 0.05247698 0.04855671 0.05272189 0.04919764 0.05023472
  0.04931247 0.04650739 0.05043641 0.04678059 0.04965664 0.04757423
  0.0504896  0.04920494]]
2024-10-22 17:00:08,079 - DEBUG - Normalized Policy: [[0.         0.         0.34528387 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.31409067 0.34062555 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:08,079 - DEBUG - Dirichlet Noise Added: [0.         0.         0.25896287 0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.23556799 0.50546914 0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:08,080 - DEBUG - Added Child Node: ((Reveal player +1 color W),) | P=0.23556798696517944
2024-10-22 17:00:08,080 - DEBUG - Added Child Node: ((Discard 2),) | P=0.25896286964416504
2024-10-22 17:00:08,081 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.5054691433906555
2024-10-22 17:00:08,081 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:08,081 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:08,081 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
Y2 || Y2|Y2
B2 || X2|RWB2
W1 || X1|RGWB1
R1 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:08,081 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:08,081 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:08,081 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:08,081 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W),)
2024-10-22 17:00:08,082 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)']
2024-10-22 17:00:08,082 - DEBUG - Move: (Reveal player +1 color W) | Reward: 3 | Depth: 1
2024-10-22 17:00:08,296 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:08,296 - DEBUG - Network Policy Logits: [[-0.02161245  0.00404366 -0.0012468  -0.02419094 -0.00946045  0.02749699
  -0.01737528  0.02378293  0.03375397  0.0345839   0.0227499  -0.04343817
  -0.03577713 -0.02048726 -0.01037128 -0.00304293 -0.10614463 -0.02038353
   0.03402472 -0.00252659]]
2024-10-22 17:00:08,296 - DEBUG - Network Policy after Softmax: [[0.04923803 0.05051763 0.05025107 0.04911124 0.04984002 0.05171644
  0.0494471  0.05152472 0.05204104 0.05208425 0.05147152 0.04817502
  0.04854551 0.04929346 0.04979464 0.0501609  0.0452469  0.04929858
  0.05205514 0.05018681]]
2024-10-22 17:00:08,298 - DEBUG - Normalized Policy: [[0.         0.         0.         0.20123906 0.         0.2119142
  0.         0.         0.         0.         0.         0.1974028
  0.         0.         0.20403941 0.         0.1854045  0.
  0.         0.        ]]
2024-10-22 17:00:08,298 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Play 0)) | P=0.21191419661045074
2024-10-22 17:00:08,299 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 3)) | P=0.20123906433582306
2024-10-22 17:00:08,300 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color B)) | P=0.20403940975666046
2024-10-22 17:00:08,300 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color Y)) | P=0.19740280508995056
2024-10-22 17:00:08,301 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 2)) | P=0.18540449440479279
2024-10-22 17:00:08,301 - DEBUG - Simulating Node: ((Reveal player +1 color W),) | Value: 0.0
2024-10-22 17:00:08,301 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:08,301 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'B', 'rank': 0}, {'color': 'Y', 'rank': 2}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}, {'color': 'W', 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || X2|RB2
XX || W1|W1
XX || XX|RGB12345
XX || WX|W12345
-----
Y2 || XX|RYGWB2345
R3 || XX|RYGWB2345
B1 || X1|RYGWB1
Y3 || XX|RYGWB2345
B1 || XX|RYGWB12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:08,301 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:08,301 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:08,301 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:08,301 - DEBUG - Expanding unexplored child: ((Discard 2),)
2024-10-22 17:00:08,301 - DEBUG - Traversing Path: ['()', '((Discard 2),)']
2024-10-22 17:00:08,302 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 1
2024-10-22 17:00:08,523 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:08,523 - DEBUG - Network Policy Logits: [[-0.00116836  0.02301455 -0.00648508 -0.06530172 -0.03821155  0.0073701
   0.01279789  0.0310086   0.0366053   0.0718729  -0.01875628 -0.02515673
  -0.04597408 -0.03887877  0.02694315  0.02937135 -0.06482957 -0.01334373
   0.03674145 -0.0403913 ]]
2024-10-22 17:00:08,523 - DEBUG - Network Policy after Softmax: [[0.05011462 0.05134131 0.04984888 0.0470015  0.04829218 0.05054436
  0.05081945 0.05175338 0.05204384 0.05391205 0.04924092 0.04892676
  0.04791876 0.04825997 0.05154341 0.05166872 0.04702369 0.04950816
  0.05205093 0.04818703]]
2024-10-22 17:00:08,524 - DEBUG - Normalized Policy: [[0.         0.         0.33313838 0.         0.         0.33778623
  0.         0.         0.         0.         0.3290754  0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:08,525 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 color R)) | P=0.3290753960609436
2024-10-22 17:00:08,526 - DEBUG - Added Child Node: ((Discard 2), (Discard 2)) | P=0.3331383764743805
2024-10-22 17:00:08,526 - DEBUG - Added Child Node: ((Discard 2), (Play 0)) | P=0.3377862274646759
2024-10-22 17:00:08,526 - DEBUG - Simulating Node: ((Discard 2),) | Value: 0.0
2024-10-22 17:00:08,526 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:08,526 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 31, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 3}, {'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || X2|RWB2
XX || X1|RGWB1
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
R2 || XX|RYGWB2345
W4 || XX|RYGWB2345
R4 || XX|RYGWB2345
B5 || XX|RYGWB12345
G1 || XX|RYGWB12345
Deck size: 31
Discards: B3 R3 R4 Y1 R1 Y1}
2024-10-22 17:00:08,527 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:08,527 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:08,527 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:08,527 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:00:08,527 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:00:08,528 - DEBUG - Move: (Reveal player +1 color B) | Reward: 3 | Depth: 1
2024-10-22 17:00:08,751 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:08,751 - DEBUG - Network Policy Logits: [[-0.01135791 -0.00895777  0.00625035 -0.03656765 -0.02109396  0.01498481
  -0.03272014  0.01574747  0.03749559  0.06084941  0.0164113  -0.01015117
  -0.02320189 -0.05504398 -0.02028009  0.00401012 -0.09793255 -0.01045389
   0.01133225 -0.03690771]]
2024-10-22 17:00:08,752 - DEBUG - Network Policy after Softmax: [[0.04989844 0.05001835 0.05078485 0.04865624 0.04941498 0.05123037
  0.0488438  0.05126945 0.05239668 0.05363474 0.0513035  0.04995869
  0.04931093 0.0477655  0.04945522 0.0506712  0.04576022 0.04994357
  0.05104358 0.04863969]]
2024-10-22 17:00:08,753 - DEBUG - Normalized Policy: [[0.         0.         0.2521416  0.         0.         0.25435355
  0.         0.         0.         0.         0.         0.
  0.         0.         0.24554011 0.         0.         0.24796474
  0.         0.        ]]
2024-10-22 17:00:08,753 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 2)) | P=0.2521415948867798
2024-10-22 17:00:08,754 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 0)) | P=0.2543535530567169
2024-10-22 17:00:08,755 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color B)) | P=0.24554011225700378
2024-10-22 17:00:08,755 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3)) | P=0.2479647397994995
2024-10-22 17:00:08,755 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:00:08,755 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:08,755 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 17, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 0}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || B2|B2
XX || X1|RGW1
XX || XX|RGW12345
XX || XX|RYGW12345
-----
Y5 || XX|RYGWB2345
G3 || XX|RYGWB2345
B1 || X1|RYGWB1
G3 || XX|RYGWB2345
W3 || XX|RYGWB12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:08,755 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:08,756 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:08,756 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:08,756 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.37356263399124146 | PUCT: 0.37356263399124146
2024-10-22 17:00:08,757 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.41066208481788635 | PUCT: 0.41066208481788635
2024-10-22 17:00:08,757 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.8015705943107605 | PUCT: 0.8015705943107605
2024-10-22 17:00:08,757 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.8015705943107605
2024-10-22 17:00:08,757 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:08,757 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 color B))
2024-10-22 17:00:08,757 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 color B))']
2024-10-22 17:00:08,758 - DEBUG - Move: (Reveal player +1 color B) | Reward: 3 | Depth: 1
2024-10-22 17:00:08,758 - DEBUG - Move: (Reveal player +1 color B) | Reward: 3 | Depth: 2
2024-10-22 17:00:08,962 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:08,962 - DEBUG - Network Policy Logits: [[ 0.02529074  0.01979399  0.02093363 -0.0278794  -0.02807169  0.07185726
  -0.00034607  0.04388594 -0.00072918  0.04541596 -0.01575734 -0.00793475
  -0.03598274 -0.0790104  -0.01481969 -0.02726816 -0.0405713  -0.03339852
  -0.02597046 -0.0110782 ]]
2024-10-22 17:00:08,962 - DEBUG - Network Policy after Softmax: [[0.05156266 0.05128002 0.05133849 0.04889268 0.04888328 0.05402054
  0.05025756 0.05253045 0.05023832 0.05261089 0.04948897 0.04987762
  0.04849809 0.04645558 0.04953539 0.04892258 0.04827606 0.04862358
  0.0489861  0.04972108]]
2024-10-22 17:00:08,963 - DEBUG - Normalized Policy: [[0.         0.         0.5249653  0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.47503477 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:08,964 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color B), (Reveal player +1 color W)) | P=0.47503477334976196
2024-10-22 17:00:08,965 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color B), (Discard 2)) | P=0.5249652862548828
2024-10-22 17:00:08,965 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:00:08,965 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:08,965 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': 'B', 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGW2345
XX || BX|B2345
XX || X1|RYGW1
XX || XX|RYGW2345
XX || XX|RYGW12345
-----
Y2 || Y2|Y2
B2 || B2|B2
W1 || X1|RGW1
R1 || XX|RGW12345
W3 || XX|RYGW12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:08,965 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:08,965 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:08,965 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:08,966 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.3941541910171509 | PUCT: 0.3941541910171509
2024-10-22 17:00:08,966 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.43329867720603943 | PUCT: 0.43329867720603943
2024-10-22 17:00:08,967 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.5638365745544434 | PUCT: 0.5638365745544434
2024-10-22 17:00:08,967 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.5638365745544434
2024-10-22 17:00:08,967 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:08,967 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Discard 2))
2024-10-22 17:00:08,967 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Discard 2))']
2024-10-22 17:00:08,967 - DEBUG - Move: (Reveal player +1 color B) | Reward: 3 | Depth: 1
2024-10-22 17:00:08,968 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 2
2024-10-22 17:00:09,171 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:09,171 - DEBUG - Network Policy Logits: [[ 0.02423127  0.0434522   0.0089132  -0.02404412 -0.02063879  0.09990551
   0.0254705   0.05006563 -0.0149762   0.07172965 -0.03284234  0.00165702
  -0.03277371 -0.06210307  0.02859491 -0.01634973  0.02886389 -0.0328541
   0.00538501 -0.00176799]]
2024-10-22 17:00:09,172 - DEBUG - Network Policy after Softmax: [[0.05080546 0.05179144 0.05003315 0.04841107 0.0485762  0.05479934
  0.05086846 0.05213509 0.04885205 0.05327686 0.047987   0.04967142
  0.0479903  0.04660321 0.05102764 0.048785   0.05104137 0.04798644
  0.04985693 0.04950158]]
2024-10-22 17:00:09,173 - DEBUG - Normalized Policy: [[0.         0.         0.333867   0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.32553822 0.34059477 0.
  0.         0.        ]]
2024-10-22 17:00:09,173 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 2), (Discard 2)) | P=0.33386701345443726
2024-10-22 17:00:09,174 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 2), (Reveal player +1 rank 1)) | P=0.3255382180213928
2024-10-22 17:00:09,175 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 2), (Reveal player +1 rank 2)) | P=0.3405947685241699
2024-10-22 17:00:09,175 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Discard 2)) | Value: 0.0
2024-10-22 17:00:09,175 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:09,175 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 31, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
Y2 || Y2|Y2
B2 || B2|B2
R1 || XX|RGW12345
W3 || XX|RYGW12345
B2 || XX|RYGWB12345
Deck size: 31
Discards: B3 R3 R4 Y1 R1 R1}
2024-10-22 17:00:09,175 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:09,175 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:09,175 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:09,176 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.4107595682144165 | PUCT: 0.4107595682144165
2024-10-22 17:00:09,176 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.45155319571495056 | PUCT: 0.45155319571495056
2024-10-22 17:00:09,176 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4406929016113281 | PUCT: 0.4406929016113281
2024-10-22 17:00:09,177 - DEBUG - Selected Child: ((Discard 2),) | PUCT: 0.45155319571495056
2024-10-22 17:00:09,177 - DEBUG - Selected child for exploration: ((Discard 2),)
2024-10-22 17:00:09,177 - DEBUG - Expanding unexplored child: ((Discard 2), (Reveal player +1 color R))
2024-10-22 17:00:09,177 - DEBUG - Traversing Path: ['()', '((Discard 2),)', '((Discard 2), (Reveal player +1 color R))']
2024-10-22 17:00:09,177 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 1
2024-10-22 17:00:09,177 - DEBUG - Illegal move encountered: (Reveal player +1 color R)
2024-10-22 17:00:09,178 - DEBUG - Backpropagating reward: 3
2024-10-22 17:00:09,178 - DEBUG - Rollout #7 completed with reward=3
2024-10-22 17:00:09,178 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:09,178 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.42461922764778137 | PUCT: 0.42461922764778137
2024-10-22 17:00:09,179 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 1.5 | U: 0.3111928403377533 | PUCT: 1.8111928701400757
2024-10-22 17:00:09,179 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4555625319480896 | PUCT: 0.4555625319480896
2024-10-22 17:00:09,179 - DEBUG - Selected Child: ((Discard 2),) | PUCT: 1.8111928701400757
2024-10-22 17:00:09,179 - DEBUG - Selected child for exploration: ((Discard 2),)
2024-10-22 17:00:09,179 - DEBUG - Expanding unexplored child: ((Discard 2), (Discard 2))
2024-10-22 17:00:09,179 - DEBUG - Traversing Path: ['()', '((Discard 2),)', '((Discard 2), (Discard 2))']
2024-10-22 17:00:09,180 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 1
2024-10-22 17:00:09,180 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 2
2024-10-22 17:00:09,391 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:09,391 - DEBUG - Network Policy Logits: [[ 0.0300618   0.02950382 -0.00679109  0.00325499 -0.01351239  0.09919791
   0.01561822  0.04388376 -0.02063728  0.08605014 -0.02963708 -0.04578431
  -0.03877304 -0.01890943  0.06320715 -0.00099113  0.02243641 -0.07069331
   0.03014146 -0.03037466]]
2024-10-22 17:00:09,392 - DEBUG - Network Policy after Softmax: [[0.05110046 0.05107196 0.04925155 0.04974882 0.04892162 0.05475834
  0.0503677  0.05181168 0.04857429 0.0540431  0.0481391  0.04736803
  0.04770131 0.0486583  0.05282259 0.04953803 0.05071228 0.04620271
  0.05110453 0.0481036 ]]
2024-10-22 17:00:09,393 - DEBUG - Normalized Policy: [[0.         0.         0.         0.2477929  0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.24236114 0.26310298 0.24674296 0.         0.
  0.         0.        ]]
2024-10-22 17:00:09,394 - DEBUG - Added Child Node: ((Discard 2), (Discard 2), (Reveal player +1 color W)) | P=0.2423611432313919
2024-10-22 17:00:09,394 - DEBUG - Added Child Node: ((Discard 2), (Discard 2), (Reveal player +1 rank 1)) | P=0.24674296379089355
2024-10-22 17:00:09,395 - DEBUG - Added Child Node: ((Discard 2), (Discard 2), (Reveal player +1 color B)) | P=0.2631029784679413
2024-10-22 17:00:09,395 - DEBUG - Added Child Node: ((Discard 2), (Discard 2), (Discard 3)) | P=0.24779289960861206
2024-10-22 17:00:09,395 - DEBUG - Simulating Node: ((Discard 2), (Discard 2)) | Value: 0.0
2024-10-22 17:00:09,396 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:09,396 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 30, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
Y2 || Y2|Y2
B2 || X2|RWB2
R1 || XX|RGWB12345
W3 || XX|RYGWB12345
W3 || XX|RYGWB12345
Deck size: 30
Discards: B3 R3 R4 Y1 R1 W1 B1}
2024-10-22 17:00:09,396 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:09,396 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:09,396 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:09,396 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.4364791810512543 | PUCT: 0.4364791810512543
2024-10-22 17:00:09,397 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 1.0 | U: 0.23991353809833527 | PUCT: 1.2399135828018188
2024-10-22 17:00:09,397 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.46828678250312805 | PUCT: 0.46828678250312805
2024-10-22 17:00:09,397 - DEBUG - Selected Child: ((Discard 2),) | PUCT: 1.2399135828018188
2024-10-22 17:00:09,397 - DEBUG - Selected child for exploration: ((Discard 2),)
2024-10-22 17:00:09,397 - DEBUG - Expanding unexplored child: ((Discard 2), (Play 0))
2024-10-22 17:00:09,398 - DEBUG - Traversing Path: ['()', '((Discard 2),)', '((Discard 2), (Play 0))']
2024-10-22 17:00:09,398 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 1
2024-10-22 17:00:09,399 - DEBUG - Move: (Play 0) | Reward: 4 | Depth: 2
2024-10-22 17:00:09,615 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:09,615 - DEBUG - Network Policy Logits: [[ 0.03004239  0.04173064 -0.00478506 -0.01632306  0.0048741   0.09638926
   0.00389411  0.01273222 -0.01218538  0.07845375 -0.02125529 -0.01714573
  -0.06980899 -0.0011147   0.07484312  0.02674506  0.01629982 -0.05875959
   0.02698705 -0.0219094 ]]
2024-10-22 17:00:09,615 - DEBUG - Network Policy after Softmax: [[0.05099523 0.05159477 0.04924977 0.04868479 0.04972779 0.05449337
  0.04967908 0.05012009 0.04888665 0.05352471 0.04844526 0.04864476
  0.04614925 0.04943087 0.0533318  0.05082736 0.05029922 0.046662
  0.05083966 0.04841358]]
2024-10-22 17:00:09,617 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24068637 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.2443748  0.26366013 0.25127873 0.         0.
  0.         0.        ]]
2024-10-22 17:00:09,617 - DEBUG - Added Child Node: ((Discard 2), (Play 0), (Reveal player +1 color W)) | P=0.24437479674816132
2024-10-22 17:00:09,618 - DEBUG - Added Child Node: ((Discard 2), (Play 0), (Reveal player +1 rank 1)) | P=0.25127872824668884
2024-10-22 17:00:09,619 - DEBUG - Added Child Node: ((Discard 2), (Play 0), (Reveal player +1 color B)) | P=0.26366013288497925
2024-10-22 17:00:09,619 - DEBUG - Added Child Node: ((Discard 2), (Play 0), (Discard 3)) | P=0.24068637192249298
2024-10-22 17:00:09,619 - DEBUG - Simulating Node: ((Discard 2), (Play 0)) | Value: 0.0
2024-10-22 17:00:09,619 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:09,619 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 30, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || X2|RWB2
W1 || X1|RGWB1
R1 || XX|RGWB12345
W3 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 30
Discards: B3 R3 R4 Y1 R1 B1}
2024-10-22 17:00:09,620 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:09,620 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:09,620 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:09,620 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.44682157039642334 | PUCT: 0.44682157039642334
2024-10-22 17:00:09,621 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.75 | U: 0.19647863507270813 | PUCT: 0.9464786052703857
2024-10-22 17:00:09,621 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.47938284277915955 | PUCT: 0.47938284277915955
2024-10-22 17:00:09,621 - DEBUG - Selected Child: ((Discard 2),) | PUCT: 0.9464786052703857
2024-10-22 17:00:09,621 - DEBUG - Selected child for exploration: ((Discard 2),)
2024-10-22 17:00:09,622 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Reveal player +1 color R)) | Q: 3.0 | U: 0.5218461751937866 | PUCT: 3.521846294403076
2024-10-22 17:00:09,622 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Discard 2)) | Q: 0.0 | U: 0.528289258480072 | PUCT: 0.528289258480072
2024-10-22 17:00:09,623 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Play 0)) | Q: 0.0 | U: 0.5356597900390625 | PUCT: 0.5356597900390625
2024-10-22 17:00:09,623 - DEBUG - Selected Child: ((Discard 2), (Reveal player +1 color R)) | PUCT: 3.521846294403076
2024-10-22 17:00:09,623 - DEBUG - Selected child for exploration: ((Discard 2), (Reveal player +1 color R))
2024-10-22 17:00:09,623 - DEBUG - Node ((Discard 2), (Reveal player +1 color R)) is a leaf node.
2024-10-22 17:00:09,623 - DEBUG - Traversing Path: ['()', '((Discard 2),)', '((Discard 2), (Reveal player +1 color R))']
2024-10-22 17:00:09,624 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 1
2024-10-22 17:00:09,624 - DEBUG - Move: (Reveal player +1 color R) | Reward: 3 | Depth: 2
2024-10-22 17:00:09,836 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:09,837 - DEBUG - Network Policy Logits: [[ 0.04611171 -0.00057176  0.0279858  -0.01683107  0.00756458  0.07414723
   0.00741649  0.05075691 -0.05139438  0.03485237 -0.0222793  -0.02498848
  -0.01732312 -0.05785783  0.03427324 -0.05421057  0.00717776 -0.06099293
  -0.0008953  -0.03507529]]
2024-10-22 17:00:09,837 - DEBUG - Network Policy after Softmax: [[0.05245813 0.05006549 0.05151585 0.04925804 0.0504745  0.05394964
  0.05046703 0.05270238 0.0475846  0.0518708  0.0489904  0.04885786
  0.04923381 0.04727804 0.05184077 0.04745079 0.05045498 0.04713005
  0.05004929 0.04836752]]
2024-10-22 17:00:09,838 - DEBUG - Normalized Policy: [[0.         0.         0.         0.3319793  0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.31863484 0.34938586 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:09,839 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 color R), (Reveal player +1 color W)) | P=0.31863483786582947
2024-10-22 17:00:09,840 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 color R), (Reveal player +1 color B)) | P=0.3493858575820923
2024-10-22 17:00:09,840 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 color R), (Discard 3)) | P=0.33197930455207825
2024-10-22 17:00:09,840 - DEBUG - Simulating Node: ((Discard 2), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:00:09,840 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:09,840 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 31, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': 'R', 'rank': None}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|YGWB2345
XX || RX|R2345
XX || RX|R2345
XX || XX|YGWB12345
XX || XX|YGWB12345
-----
Y2 || Y2|Y2
B2 || X2|RWB2
W1 || X1|RGWB1
R1 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 31
Discards: B3 R3 R4 Y1 R1 B1}
2024-10-22 17:00:09,840 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:09,840 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:09,841 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:09,841 - DEBUG - Best node chosen by MCTS: ((Discard 2),) | Visit Count: 5
2024-10-22 17:00:09,841 - INFO - Actual Game Score: 3
2024-10-22 17:00:09,841 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:09,841 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:09,841 - DEBUG - Policy Targets: [0.         0.         0.55555556 0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.11111111 0.33333333 0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:09,841 - DEBUG - === End of Training Data ===
2024-10-22 17:00:09,841 - INFO - Chosen Action: (Discard 2) | Visit Count: 5
2024-10-22 17:00:11,214 - DEBUG - Not the current player's turn.
2024-10-22 17:00:11,215 - INFO - Agent state has been reset.
2024-10-22 17:00:11,215 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:11,215 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 30, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
Y2 || Y2|Y2
B2 || X2|RWB2
R1 || XX|RGWB12345
W3 || XX|RYGWB12345
G4 || XX|RYGWB12345
Deck size: 30
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:11,215 - INFO - Max Rollouts: 10
2024-10-22 17:00:11,215 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:11,216 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:11,216 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:11,437 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:11,438 - DEBUG - Network Policy Logits: [[ 0.0331202   0.02572528 -0.01382057 -0.00314386 -0.01167635  0.09031963
   0.02361031  0.0543568  -0.01201202  0.06900442 -0.02615008 -0.04030694
  -0.02708751 -0.00578646  0.06341179 -0.00191102  0.02521826 -0.05582535
   0.019469   -0.03166024]]
2024-10-22 17:00:11,438 - DEBUG - Network Policy after Softmax: [[0.05119604 0.05081884 0.04884838 0.04937272 0.04895324 0.05420979
  0.05071148 0.05229489 0.04893681 0.05306653 0.04824981 0.04757155
  0.0482046  0.04924242 0.05277057 0.04943363 0.05079309 0.04683902
  0.0505019  0.04798467]]
2024-10-22 17:00:11,440 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32572713 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34814385 0.326129   0.         0.
  0.         0.        ]]
2024-10-22 17:00:11,440 - DEBUG - Dirichlet Noise Added: [0.        0.        0.        0.2970792 0.        0.        0.
 0.        0.        0.        0.        0.        0.        0.
 0.2611079 0.4418129 0.        0.        0.        0.       ]
2024-10-22 17:00:11,441 - DEBUG - Added Child Node: ((Discard 3),) | P=0.2970792055130005
2024-10-22 17:00:11,442 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.4418129026889801
2024-10-22 17:00:11,443 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.2611078917980194
2024-10-22 17:00:11,443 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:11,443 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:11,443 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 30, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
Y2 || Y2|Y2
B2 || X2|RWB2
R1 || XX|RGWB12345
W3 || XX|RYGWB12345
G4 || XX|RYGWB12345
Deck size: 30
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:11,443 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:11,443 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:11,443 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:11,443 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 17:00:11,443 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 17:00:11,444 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 3 | Depth: 1
2024-10-22 17:00:11,655 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:11,656 - DEBUG - Network Policy Logits: [[ 0.00064766  0.01778476 -0.01922452 -0.06958272 -0.01587101  0.03236425
   0.00249779  0.04299176  0.04511017  0.06654771 -0.02341132 -0.02739262
  -0.07135696 -0.00654066  0.0255964   0.03459598 -0.07093953 -0.00137153
   0.03617196 -0.01738267]]
2024-10-22 17:00:11,656 - DEBUG - Network Policy after Softmax: [[0.05004191 0.05090687 0.04905729 0.04664802 0.04922208 0.05165451
  0.05013458 0.0522064  0.05231711 0.05345077 0.04885232 0.04865821
  0.04656534 0.04968349 0.0513061  0.05176992 0.04658477 0.04994097
  0.05185157 0.04914773]]
2024-10-22 17:00:11,658 - DEBUG - Normalized Policy: [[0.         0.         0.25035006 0.         0.         0.26360422
  0.         0.         0.         0.         0.         0.24831349
  0.         0.         0.         0.         0.23773226 0.
  0.         0.        ]]
2024-10-22 17:00:11,659 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0)) | P=0.26360422372817993
2024-10-22 17:00:11,659 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 2)) | P=0.25035005807876587
2024-10-22 17:00:11,660 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color Y)) | P=0.24831348657608032
2024-10-22 17:00:11,661 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 2)) | P=0.23773226141929626
2024-10-22 17:00:11,661 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 17:00:11,661 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:11,661 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 30, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 1}, {'color': 'G', 'rank': 4}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || X2|RWB2
XX || X1|RGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
-----
B4 || XX|RYGWB2345
Y2 || XX|RYGWB2345
G5 || XX|RYGWB2345
Y3 || XX|RYGWB12345
W1 || XX|RYGWB12345
Deck size: 30
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:11,661 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:11,662 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:11,662 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:11,662 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:00:11,662 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:00:11,663 - DEBUG - Move: (Discard 3) | Reward: 3 | Depth: 1
2024-10-22 17:00:11,878 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:11,878 - DEBUG - Network Policy Logits: [[ 0.01195121 -0.00809189 -0.0160795  -0.05546562 -0.00892728  0.02029623
   0.01679618  0.02667491  0.04183983  0.09037612 -0.02316958 -0.05126563
  -0.0476182   0.00431775  0.03968675  0.03622353 -0.07230622 -0.02707553
   0.03859885 -0.0325961 ]]
2024-10-22 17:00:11,878 - DEBUG - Network Policy after Softmax: [[0.0506009  0.0495968  0.04920222 0.047302   0.04955538 0.05102493
  0.05084665 0.05135145 0.05213612 0.05472903 0.0488546  0.04750109
  0.04767466 0.05021611 0.05202399 0.05184413 0.04651207 0.04866416
  0.05196742 0.04839624]]
2024-10-22 17:00:11,880 - DEBUG - Normalized Policy: [[0.         0.         0.24881536 0.         0.         0.25803283
  0.         0.         0.         0.         0.24705748 0.
  0.         0.         0.         0.         0.         0.24609438
  0.         0.        ]]
2024-10-22 17:00:11,881 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R)) | P=0.2470574826002121
2024-10-22 17:00:11,882 - DEBUG - Added Child Node: ((Discard 3), (Discard 2)) | P=0.2488153576850891
2024-10-22 17:00:11,882 - DEBUG - Added Child Node: ((Discard 3), (Play 0)) | P=0.25803282856941223
2024-10-22 17:00:11,883 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3)) | P=0.24609437584877014
2024-10-22 17:00:11,883 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:00:11,883 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:11,883 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 4}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || X2|RWB2
XX || XX|RGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
W5 || XX|RYGWB2345
G3 || XX|RYGWB2345
R2 || XX|RYGWB2345
R4 || XX|RYGWB12345
R1 || XX|RYGWB12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1 Y1}
2024-10-22 17:00:11,883 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:11,883 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:11,883 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:11,884 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:00:11,884 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:00:11,884 - DEBUG - Move: (Reveal player +1 color B) | Reward: 3 | Depth: 1
2024-10-22 17:00:12,093 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:12,094 - DEBUG - Network Policy Logits: [[ 0.0121666  -0.00805886 -0.02603    -0.05016812 -0.02155469  0.00147432
   0.00824665  0.02807436  0.04484732  0.07108527 -0.02773907 -0.05596436
  -0.05816789 -0.0191959   0.05320284  0.02219976 -0.06607725  0.0019546
   0.03053136 -0.01171643]]
2024-10-22 17:00:12,094 - DEBUG - Network Policy after Softmax: [[0.05075622 0.04973996 0.04885406 0.04768894 0.04907319 0.05021641
  0.05055765 0.05157009 0.05244237 0.05383656 0.04877064 0.04741332
  0.04730896 0.04918908 0.05288239 0.05126803 0.04693625 0.05024053
  0.05169696 0.04955837]]
2024-10-22 17:00:12,095 - DEBUG - Normalized Policy: [[0.         0.         0.24611609 0.         0.         0.25297928
  0.         0.         0.         0.         0.         0.
  0.         0.24780382 0.         0.         0.         0.2531008
  0.         0.        ]]
2024-10-22 17:00:12,097 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color W)) | P=0.24780382215976715
2024-10-22 17:00:12,097 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 2)) | P=0.24611608684062958
2024-10-22 17:00:12,098 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 0)) | P=0.2529792785644531
2024-10-22 17:00:12,098 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3)) | P=0.25310081243515015
2024-10-22 17:00:12,099 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:00:12,099 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:12,099 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 30, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 4}, {'color': 'G', 'rank': 2}, {'color': 'G', 'rank': 4}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || B2|B2
XX || XX|RGW12345
XX || XX|RYGW12345
XX || XX|RYGW12345
-----
W4 || XX|RYGWB2345
W5 || XX|RYGWB2345
G3 || XX|RYGWB2345
G5 || XX|RYGWB12345
Y1 || XX|RYGWB12345
Deck size: 30
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:12,099 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:12,099 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:12,099 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:12,100 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.7006248235702515 | PUCT: 0.7006248235702515
2024-10-22 17:00:12,101 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.47110679745674133 | PUCT: 0.47110679745674133
2024-10-22 17:00:12,101 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4140636622905731 | PUCT: 0.4140636622905731
2024-10-22 17:00:12,101 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.7006248235702515
2024-10-22 17:00:12,101 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:00:12,101 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 rank 2))
2024-10-22 17:00:12,101 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 rank 2))']
2024-10-22 17:00:12,102 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 3 | Depth: 1
2024-10-22 17:00:12,103 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 3 | Depth: 2
2024-10-22 17:00:12,318 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:12,318 - DEBUG - Network Policy Logits: [[-0.00354464  0.04770918  0.02367399  0.01694922 -0.00736265  0.07945193
   0.03002612  0.08022965 -0.01979942  0.05252252 -0.03914271 -0.02081925
   0.00157349 -0.05045658  0.03198263 -0.04432055 -0.00092824 -0.01773801
   0.01782617 -0.02447493]]
2024-10-22 17:00:12,319 - DEBUG - Network Policy after Softmax: [[0.04940831 0.05200669 0.0507716  0.05043131 0.04922002 0.053684
  0.05109513 0.05372577 0.04861168 0.05225762 0.0476804  0.04856212
  0.04966183 0.04714399 0.0511952  0.04743416 0.04953774 0.04871199
  0.05047556 0.04838492]]
2024-10-22 17:00:12,321 - DEBUG - Normalized Policy: [[0.33320075 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.32154807 0.
  0.         0.         0.34525123 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:12,322 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 2), (Reveal player +1 color R)) | P=0.32154807448387146
2024-10-22 17:00:12,322 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 2), (Discard 0)) | P=0.33320075273513794
2024-10-22 17:00:12,323 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 2), (Reveal player +1 color B)) | P=0.3452512323856354
2024-10-22 17:00:12,323 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 2)) | Value: 0.0
2024-10-22 17:00:12,323 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:12,323 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 30, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || XX|RYGWB345
XX || X2|RYGWB2
XX || XX|RYGWB1345
XX || XX|RYGWB1345
-----
Y2 || Y2|Y2
B2 || X2|RWB2
R1 || X1|RGWB1
W3 || XX|RYGWB2345
G4 || XX|RYGWB2345
Deck size: 30
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:12,323 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:12,323 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:12,323 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:12,324 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.492829829454422 | PUCT: 0.492829829454422
2024-10-22 17:00:12,324 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.49707522988319397 | PUCT: 0.49707522988319397
2024-10-22 17:00:12,325 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4368877410888672 | PUCT: 0.4368877410888672
2024-10-22 17:00:12,326 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.49707522988319397
2024-10-22 17:00:12,326 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:12,326 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 2))
2024-10-22 17:00:12,326 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 2))']
2024-10-22 17:00:12,326 - DEBUG - Move: (Discard 3) | Reward: 3 | Depth: 1
2024-10-22 17:00:12,327 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 2
2024-10-22 17:00:12,543 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:12,543 - DEBUG - Network Policy Logits: [[ 0.02698588  0.02301496 -0.00065961 -0.01025566 -0.02060355  0.08902124
   0.00367447  0.0482831  -0.01059865  0.1000935  -0.04208511 -0.04177085
  -0.04758905 -0.00565401  0.06766196 -0.02229115  0.03870035 -0.04778935
   0.02156109 -0.02582265]]
2024-10-22 17:00:12,544 - DEBUG - Network Policy after Softmax: [[0.05095194 0.05075001 0.04956263 0.04908931 0.04858395 0.05421286
  0.04977791 0.05204871 0.04907247 0.05481645 0.04755143 0.04756637
  0.04729042 0.04931572 0.05306719 0.04850203 0.05155232 0.04728095
  0.05067628 0.04833105]]
2024-10-22 17:00:12,545 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:12,546 - DEBUG - Added Child Node: ((Discard 3), (Discard 2), (Reveal player +1 color B)) | P=1.0
2024-10-22 17:00:12,546 - DEBUG - Simulating Node: ((Discard 3), (Discard 2)) | Value: 0.0
2024-10-22 17:00:12,546 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:12,546 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 8, 'num_players': 2, 'deck_size': 28, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 8
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
Y2 || Y2|Y2
B2 || X2|RWB2
W3 || XX|RYGWB12345
G4 || XX|RYGWB12345
R5 || XX|RYGWB12345
Deck size: 28
Discards: B3 R3 R4 Y1 R1 G1 W1 G1 G4}
2024-10-22 17:00:12,546 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:12,546 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:12,546 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:12,547 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.5135923624038696 | PUCT: 0.5135923624038696
2024-10-22 17:00:12,547 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3453443944454193 | PUCT: 0.3453443944454193
2024-10-22 17:00:12,548 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4552934765815735 | PUCT: 0.4552934765815735
2024-10-22 17:00:12,549 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.5135923624038696
2024-10-22 17:00:12,549 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:00:12,549 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 color Y))
2024-10-22 17:00:12,549 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 color Y))']
2024-10-22 17:00:12,549 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 3 | Depth: 1
2024-10-22 17:00:12,550 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 3 | Depth: 2
2024-10-22 17:00:12,774 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:12,774 - DEBUG - Network Policy Logits: [[ 0.02206035  0.01915654 -0.00712331 -0.00428237  0.03685081  0.07901414
   0.00992406  0.0128267  -0.0100215   0.05619625 -0.04346206 -0.02912691
  -0.01456373 -0.02330472  0.03458549 -0.03879936  0.00136786 -0.02084916
   0.05241672 -0.02779226]]
2024-10-22 17:00:12,775 - DEBUG - Network Policy after Softmax: [[0.05081977 0.05067242 0.0493581  0.04949852 0.05157701 0.05379816
  0.05020674 0.05035268 0.04921526 0.0525845  0.04759668 0.0482839
  0.04899222 0.04856584 0.0514603  0.04781913 0.04977899 0.04868525
  0.05238613 0.04834839]]
2024-10-22 17:00:12,776 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33319885 0.         0.
  0.         0.         0.         0.         0.32039663 0.
  0.         0.         0.34640452 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:12,777 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color Y), (Reveal player +1 color R)) | P=0.32039663195610046
2024-10-22 17:00:12,778 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color Y), (Reveal player +1 color B)) | P=0.3464045226573944
2024-10-22 17:00:12,778 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color Y), (Discard 3)) | P=0.3331988453865051
2024-10-22 17:00:12,779 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 17:00:12,779 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:12,779 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 30, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'Y', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RGWB2345
XX || XX|RGWB2345
XX || XX|RGWB2345
XX || YX|Y12345
XX || XX|RGWB12345
-----
Y2 || Y2|Y2
B2 || X2|RWB2
R1 || X1|RGWB1
W3 || XX|RYGWB2345
G4 || XX|RYGWB2345
Deck size: 30
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:12,779 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:12,779 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:12,779 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:12,780 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.39819130301475525 | PUCT: 0.39819130301475525
2024-10-22 17:00:12,780 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3569968044757843 | PUCT: 0.3569968044757843
2024-10-22 17:00:12,781 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.47065573930740356 | PUCT: 0.47065573930740356
2024-10-22 17:00:12,781 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.47065573930740356
2024-10-22 17:00:12,781 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:12,781 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 rank 3))
2024-10-22 17:00:12,781 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 rank 3))']
2024-10-22 17:00:12,782 - DEBUG - Move: (Reveal player +1 color B) | Reward: 3 | Depth: 1
2024-10-22 17:00:12,782 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:12,782 - DEBUG - Backpropagating reward: 3
2024-10-22 17:00:12,782 - DEBUG - Rollout #8 completed with reward=3
2024-10-22 17:00:12,782 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:12,783 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4093131124973297 | PUCT: 0.4093131124973297
2024-10-22 17:00:12,784 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.366968035697937 | PUCT: 0.366968035697937
2024-10-22 17:00:12,784 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 1.5 | U: 0.32253435254096985 | PUCT: 1.8225343227386475
2024-10-22 17:00:12,784 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 1.8225343227386475
2024-10-22 17:00:12,784 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:12,784 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 color W))
2024-10-22 17:00:12,784 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 color W))']
2024-10-22 17:00:12,785 - DEBUG - Move: (Reveal player +1 color B) | Reward: 3 | Depth: 1
2024-10-22 17:00:12,785 - DEBUG - Illegal move encountered: (Reveal player +1 color W)
2024-10-22 17:00:12,785 - DEBUG - Backpropagating reward: 3
2024-10-22 17:00:12,785 - DEBUG - Rollout #9 completed with reward=3
2024-10-22 17:00:12,785 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:12,786 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.41901177167892456 | PUCT: 0.41901177167892456
2024-10-22 17:00:12,786 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3756633698940277 | PUCT: 0.3756633698940277
2024-10-22 17:00:12,787 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 2.0 | U: 0.24763262271881104 | PUCT: 2.2476325035095215
2024-10-22 17:00:12,787 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 2.2476325035095215
2024-10-22 17:00:12,787 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:12,787 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Discard 2))
2024-10-22 17:00:12,787 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Discard 2))']
2024-10-22 17:00:12,788 - DEBUG - Move: (Reveal player +1 color B) | Reward: 3 | Depth: 1
2024-10-22 17:00:12,789 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 2
2024-10-22 17:00:13,002 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:13,002 - DEBUG - Network Policy Logits: [[ 0.0290564   0.0287603   0.02164052 -0.01940877 -0.00316044  0.09602117
   0.03829254  0.03632377 -0.03805608  0.10761268 -0.04602187 -0.04209977
  -0.0661329  -0.00108886  0.06729206  0.00286289  0.02110464 -0.04908778
   0.01947623 -0.02098165]]
2024-10-22 17:00:13,002 - DEBUG - Network Policy after Softmax: [[0.05095247 0.05093739 0.05057601 0.04854194 0.0493371  0.05448133
  0.05142526 0.05132411 0.04764515 0.05511652 0.04726712 0.04745287
  0.04632603 0.04943942 0.05293839 0.04963518 0.05054891 0.04712243
  0.05046667 0.04846564]]
2024-10-22 17:00:13,004 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32122406 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.35031742 0.32845852 0.         0.
  0.         0.        ]]
2024-10-22 17:00:13,005 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 2), (Discard 3)) | P=0.32122406363487244
2024-10-22 17:00:13,006 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 2), (Reveal player +1 rank 1)) | P=0.3284585177898407
2024-10-22 17:00:13,006 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 2), (Reveal player +1 color B)) | P=0.35031741857528687
2024-10-22 17:00:13,006 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Discard 2)) | Value: 0.0
2024-10-22 17:00:13,006 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:13,007 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
Y2 || Y2|Y2
B2 || B2|B2
W3 || XX|RYGW12345
G4 || XX|RYGW12345
B1 || XX|RYGWB12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1 W4}
2024-10-22 17:00:13,007 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:13,007 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:13,007 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:13,007 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color B),) | Visit Count: 4
2024-10-22 17:00:13,007 - INFO - Actual Game Score: 3
2024-10-22 17:00:13,007 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:13,008 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:13,008 - DEBUG - Policy Targets: [0.         0.         0.         0.22222222 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.44444444 0.33333333 0.         0.
 0.         0.        ]
2024-10-22 17:00:13,008 - DEBUG - === End of Training Data ===
2024-10-22 17:00:13,008 - INFO - Chosen Action: (Reveal player +1 color B) | Visit Count: 4
2024-10-22 17:00:14,946 - DEBUG - Not the current player's turn.
2024-10-22 17:00:14,947 - INFO - Agent state has been reset.
2024-10-22 17:00:14,947 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:14,948 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
R1 || XX|RGW12345
W3 || XX|RYGW12345
G4 || XX|RYGW12345
G4 || XX|RYGWB12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:14,948 - INFO - Max Rollouts: 10
2024-10-22 17:00:14,948 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:14,948 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:14,948 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:15,140 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:15,141 - DEBUG - Network Policy Logits: [[ 0.02593956  0.02542081  0.02137972 -0.04781043  0.00825989  0.07733223
   0.00971412  0.01537262 -0.02122957  0.11548625 -0.0476432  -0.02759929
  -0.07654929  0.02075457  0.06293692  0.01714796  0.01511474 -0.06359313
   0.04700913 -0.01559151]]
2024-10-22 17:00:15,141 - DEBUG - Network Policy after Softmax: [[0.05084522 0.05081885 0.0506139  0.04723032 0.04995419 0.0535266
  0.05002689 0.05031077 0.04850258 0.05560832 0.04723822 0.04819461
  0.04589229 0.05058227 0.05276159 0.05040016 0.0502978  0.04649075
  0.05192787 0.04877681]]
2024-10-22 17:00:15,143 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32907888 0.         0.
  0.         0.         0.         0.         0.         0.
  0.31975615 0.         0.         0.3511649  0.         0.
  0.         0.        ]]
2024-10-22 17:00:15,143 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.24680917 0.         0.
 0.         0.         0.         0.         0.         0.
 0.23981713 0.         0.         0.51337373 0.         0.
 0.         0.        ]
2024-10-22 17:00:15,144 - DEBUG - Added Child Node: ((Discard 3),) | P=0.24680916965007782
2024-10-22 17:00:15,146 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.5133737325668335
2024-10-22 17:00:15,146 - DEBUG - Added Child Node: ((Reveal player +1 color G),) | P=0.23981712758541107
2024-10-22 17:00:15,147 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:15,147 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:15,147 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
R1 || XX|RGW12345
W3 || XX|RYGW12345
G4 || XX|RYGW12345
G4 || XX|RYGWB12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:15,147 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:15,147 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:15,147 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:15,147 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G),)
2024-10-22 17:00:15,147 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)']
2024-10-22 17:00:15,148 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:15,344 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:15,344 - DEBUG - Network Policy Logits: [[-0.003848    0.0010856  -0.06527191 -0.02704026  0.01393736  0.01830311
   0.00070234 -0.0032132   0.02959572  0.06285198 -0.06933071 -0.03406904
  -0.015062   -0.00558601  0.02965941  0.02749252 -0.07996181  0.02269276
   0.03654503 -0.01477199]]
2024-10-22 17:00:15,344 - DEBUG - Network Policy after Softmax: [[0.04996303 0.05021013 0.04698646 0.0488176  0.05085959 0.05108211
  0.05019089 0.04999475 0.05166223 0.05340921 0.04679613 0.04847568
  0.04940587 0.04987627 0.05166552 0.05155369 0.04630127 0.05130684
  0.0520225  0.0494202 ]]
2024-10-22 17:00:15,345 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32644168 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.3430871
  0.         0.33047122]]
2024-10-22 17:00:15,346 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 3)) | P=0.3264416754245758
2024-10-22 17:00:15,346 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 5)) | P=0.3304712176322937
2024-10-22 17:00:15,347 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 3)) | P=0.3430871069431305
2024-10-22 17:00:15,347 - DEBUG - Simulating Node: ((Reveal player +1 color G),) | Value: 0.0
2024-10-22 17:00:15,347 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:15,347 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 17, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'G', 'rank': 4}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RW12345
XX || XX|RYW12345
XX || GX|G12345
XX || GX|G12345
-----
B5 || XX|RYGWB2345
R3 || XX|RYGWB2345
Y3 || XX|RYGWB2345
G5 || XX|RYGWB12345
R1 || XX|RYGWB12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:15,347 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:15,347 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:15,347 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:15,347 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 17:00:15,347 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 17:00:15,348 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:15,554 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:15,554 - DEBUG - Network Policy Logits: [[-0.01735772  0.00952817 -0.05190811 -0.06419718 -0.00974562  0.04695713
   0.0036208   0.00013179  0.03025045  0.05579605 -0.03837479 -0.02766079
  -0.05178916  0.02536822  0.037678    0.05919174 -0.07256193  0.02360319
   0.03551523 -0.05300084]]
2024-10-22 17:00:15,554 - DEBUG - Network Policy after Softmax: [[0.04924319 0.0505851  0.04757088 0.04698985 0.04961947 0.05251433
  0.05028715 0.05011201 0.05164427 0.05298055 0.04821904 0.04873844
  0.04757654 0.05139275 0.05202929 0.05316076 0.04659843 0.05130212
  0.05191689 0.04751892]]
2024-10-22 17:00:15,556 - DEBUG - Normalized Policy: [[0.         0.24548447 0.         0.         0.         0.
  0.24403857 0.         0.         0.         0.         0.
  0.         0.         0.252493   0.25798392 0.         0.
  0.         0.        ]]
2024-10-22 17:00:15,557 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1)) | P=0.24548447132110596
2024-10-22 17:00:15,558 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.257983922958374
2024-10-22 17:00:15,558 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.2524929940700531
2024-10-22 17:00:15,559 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 1)) | P=0.24403856694698334
2024-10-22 17:00:15,559 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 17:00:15,559 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:15,559 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 4}, {'color': 'B', 'rank': 4}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || X1|RGW1
XX || XX|RYGW2345
XX || XX|RYGW2345
XX || XX|RYGWB2345
-----
W5 || XX|RYGWB2345
B5 || XX|RYGWB2345
W2 || XX|RYGWB2345
B1 || XX|RYGWB12345
B4 || XX|RYGWB12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:15,559 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:15,559 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:15,559 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:15,560 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:00:15,560 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:00:15,560 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:15,749 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:15,749 - DEBUG - Network Policy Logits: [[-0.00175316  0.00295961 -0.05140794 -0.07079321 -0.0088828   0.0403132
   0.00366454  0.03707542  0.00939781  0.0627263  -0.04729156  0.0057946
  -0.06275264 -0.00451244  0.05027241  0.03626721 -0.05454281  0.00790409
   0.02983844 -0.04866422]]
2024-10-22 17:00:15,750 - DEBUG - Network Policy after Softmax: [[0.05003475 0.05027111 0.04761096 0.0466969  0.04967929 0.05218444
  0.05030656 0.05201575 0.05059581 0.05336725 0.04780735 0.05041383
  0.04707388 0.04989688 0.05270674 0.05197372 0.04746195 0.05052029
  0.05164067 0.04774177]]
2024-10-22 17:00:15,751 - DEBUG - Normalized Policy: [[0.         0.         0.31564304 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34942615 0.         0.         0.3349308
  0.         0.        ]]
2024-10-22 17:00:15,751 - DEBUG - Added Child Node: ((Discard 3), (Discard 2)) | P=0.3156430423259735
2024-10-22 17:00:15,752 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color B)) | P=0.34942615032196045
2024-10-22 17:00:15,753 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3)) | P=0.33493080735206604
2024-10-22 17:00:15,753 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:00:15,753 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:15,753 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 28, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 3}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 2}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RGW12345
XX || XX|RYGW12345
XX || XX|RYGW12345
XX || XX|RYGWB12345
-----
Y4 || XX|RYGWB2345
B2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y3 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 28
Discards: B3 R3 R4 Y1 R1 G1 W1 W3}
2024-10-22 17:00:15,753 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:15,753 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:15,753 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:15,754 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.3803008496761322 | PUCT: 0.3803008496761322
2024-10-22 17:00:15,755 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.8141056895256042 | PUCT: 0.8141056895256042
2024-10-22 17:00:15,756 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.39138883352279663 | PUCT: 0.39138883352279663
2024-10-22 17:00:15,756 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.8141056895256042
2024-10-22 17:00:15,756 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:00:15,756 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 color B))
2024-10-22 17:00:15,756 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 color B))']
2024-10-22 17:00:15,757 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:15,757 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:00:15,967 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:15,967 - DEBUG - Network Policy Logits: [[ 0.0127324   0.05194128 -0.01542976 -0.03291098 -0.00782297  0.03978681
   0.00867494  0.04418417  0.00089933  0.09836945 -0.04439631 -0.02145253
  -0.07464817  0.02669455  0.064165    0.03289932 -0.00684363 -0.02228259
   0.00865219 -0.00099134]]
2024-10-22 17:00:15,968 - DEBUG - Network Policy after Softmax: [[0.0501929  0.0522     0.04879908 0.04795343 0.0491717  0.05156938
  0.04998966 0.05179664 0.04960247 0.05468069 0.04740582 0.04850606
  0.04599318 0.05089862 0.05284199 0.05121542 0.04921988 0.04846581
  0.04998852 0.04950878]]
2024-10-22 17:00:15,969 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33924732 0.         0.
  0.         0.         0.         0.         0.3353732  0.
  0.32537946 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:15,970 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Reveal player +1 color R)) | P=0.335373193025589
2024-10-22 17:00:15,970 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Discard 3)) | P=0.33924731612205505
2024-10-22 17:00:15,971 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Reveal player +1 color G)) | P=0.32537946105003357
2024-10-22 17:00:15,971 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:00:15,971 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:15,971 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGW2345
XX || BX|B2345
XX || XX|RYGW2345
XX || XX|RYGW12345
XX || XX|RYGW12345
-----
B2 || B2|B2
R1 || X1|RGW1
W3 || XX|RYGW2345
G4 || XX|RYGW2345
G4 || XX|RYGWB2345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:15,971 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:15,971 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:15,971 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:15,972 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.40126386284828186 | PUCT: 0.40126386284828186
2024-10-22 17:00:15,972 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.5726539492607117 | PUCT: 0.5726539492607117
2024-10-22 17:00:15,973 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.41296300292015076 | PUCT: 0.41296300292015076
2024-10-22 17:00:15,973 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.5726539492607117
2024-10-22 17:00:15,973 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:00:15,973 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Discard 1))
2024-10-22 17:00:15,973 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Discard 1))']
2024-10-22 17:00:15,974 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:15,974 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:16,169 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:16,169 - DEBUG - Network Policy Logits: [[ 0.02632228  0.02046274  0.00677145 -0.02924891  0.02302155  0.079051
   0.01899006  0.01467776 -0.00388821  0.09002121 -0.0382154  -0.01375005
  -0.09220087  0.02369606  0.05360532  0.02853907  0.0199022  -0.03884345
   0.0438587  -0.02273087]]
2024-10-22 17:00:16,169 - DEBUG - Network Policy after Softmax: [[0.0507543  0.05045777 0.04977165 0.04801077 0.05058705 0.05350232
  0.05038352 0.05016672 0.04924392 0.05409249 0.0475822  0.04876067
  0.04508156 0.05062119 0.0521581  0.05086694 0.0504295  0.04755232
  0.0516522  0.04832472]]
2024-10-22 17:00:16,171 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33350244 0.         0.
  0.         0.         0.         0.         0.         0.
  0.31315497 0.         0.         0.35334256 0.         0.
  0.         0.        ]]
2024-10-22 17:00:16,172 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1), (Discard 3)) | P=0.3335024416446686
2024-10-22 17:00:16,173 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1), (Reveal player +1 rank 1)) | P=0.35334256291389465
2024-10-22 17:00:16,173 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1), (Reveal player +1 color G)) | P=0.3131549656391144
2024-10-22 17:00:16,173 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Discard 1)) | Value: 0.0
2024-10-22 17:00:16,173 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:16,174 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 28, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
W3 || XX|RYGW2345
G4 || XX|RYGW2345
G4 || XX|RYGWB2345
B1 || XX|RYGWB12345
Deck size: 28
Discards: B3 R3 R4 Y1 R1 G1 W1 W1}
2024-10-22 17:00:16,174 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:16,174 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:16,174 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:16,174 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.4181687533855438 | PUCT: 0.4181687533855438
2024-10-22 17:00:16,175 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4475845396518707 | PUCT: 0.4475845396518707
2024-10-22 17:00:16,175 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4303607940673828 | PUCT: 0.4303607940673828
2024-10-22 17:00:16,175 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.4475845396518707
2024-10-22 17:00:16,175 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:00:16,176 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Play 1))
2024-10-22 17:00:16,176 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Play 1))']
2024-10-22 17:00:16,177 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:16,177 - DEBUG - Move: (Play 1) | Reward: 5 | Depth: 2
2024-10-22 17:00:16,373 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:16,373 - DEBUG - Network Policy Logits: [[ 0.02141934  0.02456236  0.00280901 -0.040055    0.01984048  0.07733893
   0.01182371  0.0118476  -0.00143993  0.09576471 -0.04215363 -0.01301419
  -0.09545612  0.02789643  0.05132083  0.02506584  0.02155631 -0.03900316
   0.04428193 -0.0242043 ]]
2024-10-22 17:00:16,373 - DEBUG - Network Policy after Softmax: [[0.05057833 0.05073754 0.04964575 0.0475627  0.05049853 0.05348722
  0.05009532 0.05009651 0.04943526 0.0544819  0.04746298 0.04886638
  0.04499933 0.05090699 0.05211353 0.0507631  0.05058525 0.04761275
  0.051748   0.04832261]]
2024-10-22 17:00:16,375 - DEBUG - Normalized Policy: [[0.         0.         0.         0.51384676 0.         0.
  0.         0.         0.         0.         0.         0.
  0.48615327 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:16,375 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 1), (Discard 3)) | P=0.513846755027771
2024-10-22 17:00:16,376 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 1), (Reveal player +1 color G)) | P=0.4861532747745514
2024-10-22 17:00:16,376 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Play 1)) | Value: 0.0
2024-10-22 17:00:16,376 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:16,376 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 28, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 1, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W1 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
W3 || XX|RYGW2345
G4 || XX|RYGW2345
G4 || XX|RYGWB2345
G1 || XX|RYGWB12345
Deck size: 28
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:16,376 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:16,376 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:16,376 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:16,377 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.4322783946990967 | PUCT: 0.4322783946990967
2024-10-22 17:00:16,378 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3701493740081787 | PUCT: 0.3701493740081787
2024-10-22 17:00:16,378 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4448818266391754 | PUCT: 0.4448818266391754
2024-10-22 17:00:16,378 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.4448818266391754
2024-10-22 17:00:16,378 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:16,378 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 2))
2024-10-22 17:00:16,378 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 2))']
2024-10-22 17:00:16,379 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:16,379 - DEBUG - Move: (Discard 2) | Reward: 4 | Depth: 2
2024-10-22 17:00:16,571 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:16,572 - DEBUG - Network Policy Logits: [[ 0.01539497  0.01609347  0.01584118 -0.04582227  0.01086054  0.07446568
  -0.00085806  0.01468567  0.00023593  0.09928307 -0.04181279 -0.02417225
  -0.09017384  0.02160353  0.08130313  0.02584005  0.01159385 -0.05384821
   0.04822279 -0.03229349]]
2024-10-22 17:00:16,572 - DEBUG - Network Policy after Softmax: [[0.0503522  0.05038739 0.05037468 0.04736223 0.0501244  0.05341615
  0.04954045 0.0503165  0.04959467 0.05475838 0.04755251 0.04839881
  0.04530754 0.05066579 0.05378263 0.05088089 0.05016118 0.04698363
  0.05203259 0.04800734]]
2024-10-22 17:00:16,574 - DEBUG - Normalized Policy: [[0.         0.         0.         0.31516895 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.3385836  0.         0.
  0.34624752 0.        ]]
2024-10-22 17:00:16,575 - DEBUG - Added Child Node: ((Discard 3), (Discard 2), (Discard 3)) | P=0.31516894698143005
2024-10-22 17:00:16,575 - DEBUG - Added Child Node: ((Discard 3), (Discard 2), (Reveal player +1 rank 1)) | P=0.3385835886001587
2024-10-22 17:00:16,576 - DEBUG - Added Child Node: ((Discard 3), (Discard 2), (Reveal player +1 rank 4)) | P=0.34624752402305603
2024-10-22 17:00:16,576 - DEBUG - Simulating Node: ((Discard 3), (Discard 2)) | Value: 0.0
2024-10-22 17:00:16,576 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:16,576 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
R1 || XX|RGW12345
G4 || XX|RYGW12345
G4 || XX|RYGWB12345
W4 || XX|RYGWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 B1 W1}
2024-10-22 17:00:16,576 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:16,576 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:16,576 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:16,578 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.44435229897499084 | PUCT: 0.44435229897499084
2024-10-22 17:00:16,578 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.38048794865608215 | PUCT: 0.38048794865608215
2024-10-22 17:00:16,578 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3048718273639679 | PUCT: 0.3048718273639679
2024-10-22 17:00:16,579 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.44435229897499084
2024-10-22 17:00:16,579 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:16,579 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Reveal player +1 rank 5))
2024-10-22 17:00:16,579 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 rank 5))']
2024-10-22 17:00:16,579 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:16,580 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 2
2024-10-22 17:00:16,773 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:16,773 - DEBUG - Network Policy Logits: [[ 0.03442192  0.03061686 -0.00261924 -0.01841211  0.02060461  0.01633095
   0.00031888 -0.00306752 -0.02477418  0.05306916 -0.04681564 -0.03606438
  -0.06351768  0.04959421  0.05022911  0.01486579 -0.02767336 -0.03686425
   0.03105141  0.0106059 ]]
2024-10-22 17:00:16,773 - DEBUG - Network Policy after Softmax: [[0.05158812 0.05139219 0.04971219 0.04893326 0.05088021 0.05066323
  0.04985847 0.04968991 0.04862293 0.05255912 0.04756294 0.04807706
  0.04677513 0.0523768  0.05241006 0.05058905 0.04848217 0.04803862
  0.05141453 0.05037401]]
2024-10-22 17:00:16,775 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32419693 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.33516705 0.         0.
  0.34063604 0.        ]]
2024-10-22 17:00:16,775 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 5), (Discard 3)) | P=0.3241969347000122
2024-10-22 17:00:16,776 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 5), (Reveal player +1 rank 1)) | P=0.3351670503616333
2024-10-22 17:00:16,777 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 5), (Reveal player +1 rank 4)) | P=0.3406360447406769
2024-10-22 17:00:16,777 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Reveal player +1 rank 5)) | Value: 0.0
2024-10-22 17:00:16,777 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:16,777 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB234
XX || XX|RYGWB234
XX || XX|RYGWB234
XX || XX|RYGWB1234
XX || X5|RYGWB5
-----
B2 || B2|B2
R1 || XX|RW12345
W3 || XX|RYW12345
G4 || GX|G12345
G4 || GX|G12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:16,777 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:16,777 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:16,777 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:16,778 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.3032541573047638 | PUCT: 0.3032541573047638
2024-10-22 17:00:16,779 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3895036280155182 | PUCT: 0.3895036280155182
2024-10-22 17:00:16,779 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3120957612991333 | PUCT: 0.3120957612991333
2024-10-22 17:00:16,779 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.3895036280155182
2024-10-22 17:00:16,779 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:00:16,779 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 rank 1))
2024-10-22 17:00:16,779 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 rank 1))']
2024-10-22 17:00:16,780 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:16,781 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:16,972 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:16,972 - DEBUG - Network Policy Logits: [[ 0.02893158  0.04872318 -0.00276308 -0.00839646  0.03542145  0.06639819
  -0.00434331  0.03605774 -0.01386344  0.10473141 -0.05829094 -0.02003697
  -0.07092936  0.05174318  0.08589987  0.02837393  0.00748848 -0.02322173
   0.02001356  0.00450528]]
2024-10-22 17:00:16,973 - DEBUG - Network Policy after Softmax: [[0.05061276 0.05162445 0.04903376 0.04875831 0.0509423  0.05254502
  0.04895634 0.05097472 0.04849248 0.05459834 0.04638523 0.04819403
  0.04580269 0.05178059 0.05357979 0.05058454 0.04953902 0.04804079
  0.0501634  0.04939145]]
2024-10-22 17:00:16,974 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.25763753 0.
  0.         0.         0.         0.27612776 0.23459046 0.
  0.23164426 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:16,975 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1), (Reveal player +1 color R)) | P=0.23459045588970184
2024-10-22 17:00:16,975 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1), (Play 4)) | P=0.27612775564193726
2024-10-22 17:00:16,976 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1), (Discard 4)) | P=0.25763753056526184
2024-10-22 17:00:16,977 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1), (Reveal player +1 color G)) | P=0.23164425790309906
2024-10-22 17:00:16,977 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:00:16,977 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:16,977 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
-----
B2 || B2|B2
R1 || X1|RGW1
W3 || XX|RYGW2345
G4 || XX|RYGW2345
G4 || XX|RYGWB2345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:16,977 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:16,977 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:16,977 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:16,977 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 1),) | Visit Count: 5
2024-10-22 17:00:16,977 - INFO - Actual Game Score: 4
2024-10-22 17:00:16,977 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:16,977 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:16,978 - DEBUG - Policy Targets: [0.         0.         0.         0.22222222 0.         0.
 0.         0.         0.         0.         0.         0.
 0.22222222 0.         0.         0.55555556 0.         0.
 0.         0.        ]
2024-10-22 17:00:16,978 - DEBUG - === End of Training Data ===
2024-10-22 17:00:16,978 - INFO - Chosen Action: (Reveal player +1 rank 1) | Visit Count: 5
2024-10-22 17:00:18,438 - DEBUG - Not the current player's turn.
2024-10-22 17:00:18,439 - INFO - Agent state has been reset.
2024-10-22 17:00:18,439 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:18,439 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 28, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
W3 || XX|RYGW2345
G4 || XX|RYGW2345
G4 || XX|RYGWB2345
B5 || XX|RYGWB12345
Deck size: 28
Discards: B3 R3 R4 Y1 R1 G1 W1 R1}
2024-10-22 17:00:18,439 - INFO - Max Rollouts: 10
2024-10-22 17:00:18,439 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:18,440 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:18,440 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:18,637 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:18,638 - DEBUG - Network Policy Logits: [[ 2.4191108e-02  5.5247042e-03  9.0622343e-05 -3.4051295e-02
   1.1806469e-02  6.4677738e-02  2.4140695e-02  2.9243434e-02
  -1.1524856e-03  9.8467097e-02 -3.3289891e-02 -2.2156866e-02
  -7.4597061e-02  3.8470548e-02  5.3057112e-02  1.7483456e-02
   3.2687485e-02 -4.5890890e-02  4.7605779e-02 -1.9832946e-02]]
2024-10-22 17:00:18,638 - DEBUG - Network Policy after Softmax: [[0.05063174 0.04969539 0.04942608 0.04776705 0.05000855 0.05272371
  0.05062919 0.0508882  0.04936467 0.05453565 0.04780344 0.04833861
  0.04586904 0.05135992 0.05211457 0.05029326 0.05106376 0.04720485
  0.05183125 0.04845108]]
2024-10-22 17:00:18,639 - DEBUG - Normalized Policy: [[0.         0.         0.         0.51013505 0.         0.
  0.         0.         0.         0.         0.         0.
  0.48986495 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:18,639 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.63260126 0.         0.
 0.         0.         0.         0.         0.         0.
 0.3673987  0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:18,640 - DEBUG - Added Child Node: ((Discard 3),) | P=0.632601261138916
2024-10-22 17:00:18,641 - DEBUG - Added Child Node: ((Reveal player +1 color G),) | P=0.3673987090587616
2024-10-22 17:00:18,641 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:18,641 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:18,641 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 28, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
W3 || XX|RYGW2345
G4 || XX|RYGW2345
G4 || XX|RYGWB2345
B5 || XX|RYGWB12345
Deck size: 28
Discards: B3 R3 R4 Y1 R1 G1 W1 R1}
2024-10-22 17:00:18,641 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:18,641 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:18,641 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:18,641 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G),)
2024-10-22 17:00:18,641 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)']
2024-10-22 17:00:18,642 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:18,846 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:18,846 - DEBUG - Network Policy Logits: [[ 0.01831949 -0.00568311 -0.04804535 -0.04144949 -0.01179767  0.02567938
   0.03587719  0.01338755  0.02224572  0.04345009 -0.00713117 -0.03827293
  -0.0236356   0.00201914  0.02192922  0.02300404 -0.04213849  0.02234174
   0.03473795 -0.04352619]]
2024-10-22 17:00:18,846 - DEBUG - Network Policy after Softmax: [[0.05089887 0.04969171 0.04763062 0.04794583 0.04938879 0.05127486
  0.05180043 0.05064846 0.0510991  0.0521942  0.04961981 0.04809837
  0.04880758 0.05007593 0.05108293 0.05113787 0.0479128  0.05110401
  0.05174145 0.04784636]]
2024-10-22 17:00:18,848 - DEBUG - Normalized Policy: [[0.         0.         0.32494405 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.34864008
  0.         0.32641584]]
2024-10-22 17:00:18,849 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 2)) | P=0.32494404911994934
2024-10-22 17:00:18,849 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 5)) | P=0.3264158368110657
2024-10-22 17:00:18,850 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 3)) | P=0.3486400842666626
2024-10-22 17:00:18,850 - DEBUG - Simulating Node: ((Reveal player +1 color G),) | Value: 0.0
2024-10-22 17:00:18,850 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:18,851 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 28, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 4}, {'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW2345
XX || GX|G2345
XX || GX|G2345
XX || XX|RYWB12345
-----
Y5 || XX|RYGWB2345
R4 || XX|RYGWB2345
B2 || XX|RYGWB2345
G3 || XX|RYGWB12345
R5 || XX|RYGWB12345
Deck size: 28
Discards: B3 R3 R4 Y1 R1 G1 W1 R1}
2024-10-22 17:00:18,851 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:18,851 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:18,851 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:18,851 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:00:18,851 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:00:18,852 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:19,050 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:19,050 - DEBUG - Network Policy Logits: [[-0.01610152 -0.00176928 -0.0402323  -0.05548861  0.00390109  0.04364053
   0.03692172  0.01917193  0.02904004  0.07492943 -0.04910659 -0.02255568
  -0.08048525  0.01655978  0.06053036  0.04814009 -0.04396616  0.01249313
   0.03623661 -0.04675911]]
2024-10-22 17:00:19,050 - DEBUG - Network Policy after Softmax: [[0.04909522 0.04980393 0.04792469 0.04719909 0.05008714 0.05211765
  0.05176865 0.05085788 0.05136224 0.05377413 0.04750128 0.04877937
  0.04603389 0.0507252  0.05300539 0.05235269 0.04774608 0.05051934
  0.0517332  0.04761291]]
2024-10-22 17:00:19,052 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.34156442 0.
  0.         0.         0.         0.         0.         0.
  0.3139237  0.         0.         0.         0.         0.34451184
  0.         0.        ]]
2024-10-22 17:00:19,053 - DEBUG - Added Child Node: ((Discard 3), (Discard 4)) | P=0.341564416885376
2024-10-22 17:00:19,053 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3)) | P=0.34451183676719666
2024-10-22 17:00:19,054 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color G)) | P=0.3139236867427826
2024-10-22 17:00:19,054 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:00:19,054 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:19,054 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'G', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYGW2345
XX || XX|RYGW2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
G2 || XX|RYGWB2345
G3 || XX|RYGWB2345
Y3 || XX|RYGWB2345
Y1 || XX|RYGWB12345
W4 || XX|RYGWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 Y4}
2024-10-22 17:00:19,054 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:19,054 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:19,054 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:19,055 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.5407236814498901 | PUCT: 0.5407236814498901
2024-10-22 17:00:19,055 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.9310387969017029 | PUCT: 0.9310387969017029
2024-10-22 17:00:19,056 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.9310387969017029
2024-10-22 17:00:19,056 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:19,056 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4))
2024-10-22 17:00:19,056 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))']
2024-10-22 17:00:19,056 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:19,057 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:19,282 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:19,282 - DEBUG - Network Policy Logits: [[ 0.01002104  0.00632087 -0.0118863  -0.04239162  0.00554264  0.08192086
   0.02259992  0.03926888  0.01722969  0.09474128 -0.04053742 -0.01510351
  -0.08323822  0.02760896  0.04193311  0.02345981  0.02249242 -0.04649293
   0.03162023 -0.0373436 ]]
2024-10-22 17:00:19,282 - DEBUG - Network Policy after Softmax: [[0.05008675 0.04990177 0.04900141 0.04752918 0.04986294 0.0538206
  0.05072077 0.05157331 0.05044911 0.05451505 0.04761739 0.04884402
  0.04562689 0.05097546 0.0517109  0.0507644  0.05071531 0.04733465
  0.05118036 0.04776972]]
2024-10-22 17:00:19,285 - DEBUG - Normalized Policy: [[0.         0.         0.         0.5010253  0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.49897465
  0.         0.        ]]
2024-10-22 17:00:19,285 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Discard 3)) | P=0.5010253190994263
2024-10-22 17:00:19,286 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 rank 3)) | P=0.49897465109825134
2024-10-22 17:00:19,286 - DEBUG - Simulating Node: ((Discard 3), (Discard 4)) | Value: 0.0
2024-10-22 17:00:19,286 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:19,286 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
W3 || XX|RYGW2345
G4 || XX|RYGW2345
G4 || XX|RYGWB2345
Y3 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 W3 R4}
2024-10-22 17:00:19,286 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:19,286 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:19,287 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:19,287 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.5826191306114197 | PUCT: 0.5826191306114197
2024-10-22 17:00:19,288 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.6687840819358826 | PUCT: 0.6687840819358826
2024-10-22 17:00:19,288 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.6687840819358826
2024-10-22 17:00:19,288 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:19,288 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 3))
2024-10-22 17:00:19,288 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 3))']
2024-10-22 17:00:19,289 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:19,289 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:19,496 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:19,496 - DEBUG - Network Policy Logits: [[-0.01065494 -0.01019816  0.03083546 -0.01480591  0.04379866  0.02868579
  -0.0005547   0.04002517  0.04885426  0.07865466 -0.04202032 -0.0257736
  -0.03832483  0.02085118  0.02349953  0.00984644  0.01122518 -0.04614945
   0.00332528 -0.00713108]]
2024-10-22 17:00:19,496 - DEBUG - Network Policy after Softmax: [[0.0490899  0.04911233 0.05116951 0.04888656 0.05183715 0.05105963
  0.04958824 0.05164191 0.05209988 0.05367584 0.04757408 0.04835331
  0.04775021 0.05066116 0.0507955  0.0501067  0.05017583 0.04737804
  0.04978101 0.04926319]]
2024-10-22 17:00:19,498 - DEBUG - Normalized Policy: [[0.         0.         0.         0.50587946 0.         0.
  0.         0.         0.         0.         0.         0.
  0.4941205  0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:19,499 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Discard 3)) | P=0.5058794617652893
2024-10-22 17:00:19,499 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Reveal player +1 color G)) | P=0.4941205084323883
2024-10-22 17:00:19,499 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:00:19,499 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:19,500 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB245
XX || XX|RYGWB245
XX || X3|RYGWB3
XX || XX|RYGWB1245
XX || X3|RYGWB3
-----
B2 || B2|B2
W3 || XX|RYGW2345
G4 || XX|RYGW2345
G4 || XX|RYGWB2345
B5 || XX|RYGWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R4}
2024-10-22 17:00:19,500 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:19,500 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:19,500 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:19,501 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.6147343516349792 | PUCT: 0.6147343516349792
2024-10-22 17:00:19,502 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5292366743087769 | PUCT: 0.5292366743087769
2024-10-22 17:00:19,502 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.6147343516349792
2024-10-22 17:00:19,502 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:19,502 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Discard 2))
2024-10-22 17:00:19,502 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Discard 2))']
2024-10-22 17:00:19,503 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:19,504 - DEBUG - Move: (Discard 2) | Reward: 4 | Depth: 2
2024-10-22 17:00:19,693 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:19,694 - DEBUG - Network Policy Logits: [[ 0.01491035  0.01535718  0.00755773 -0.01260464 -0.00566607  0.08133966
   0.01316951  0.02752379 -0.00735971  0.10540909 -0.00298768 -0.00362135
  -0.06135591  0.02251474  0.03364649  0.02268245  0.02794326 -0.06088159
   0.0456902  -0.0462597 ]]
2024-10-22 17:00:19,694 - DEBUG - Network Policy after Softmax: [[0.05016349 0.0501859  0.04979601 0.04880206 0.04914185 0.05360898
  0.05007624 0.05080023 0.04905869 0.05491498 0.04927364 0.04924243
  0.04647996 0.0505464  0.05111221 0.05055488 0.05082154 0.04650201
  0.05173152 0.04718695]]
2024-10-22 17:00:19,695 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32181612 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.33705002 0.         0.         0.
  0.34113392 0.        ]]
2024-10-22 17:00:19,696 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 2), (Discard 3)) | P=0.3218161165714264
2024-10-22 17:00:19,697 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 2), (Reveal player +1 color B)) | P=0.33705002069473267
2024-10-22 17:00:19,697 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 2), (Reveal player +1 rank 4)) | P=0.3411339223384857
2024-10-22 17:00:19,697 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Discard 2)) | Value: 0.0
2024-10-22 17:00:19,697 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:19,697 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
W3 || XX|RYW2345
G4 || GX|G2345
B5 || XX|RYWB12345
Y2 || XX|RYGWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 G4}
2024-10-22 17:00:19,698 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:19,698 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:19,698 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:19,698 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.4270884096622467 | PUCT: 0.4270884096622467
2024-10-22 17:00:19,699 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5515329837799072 | PUCT: 0.5515329837799072
2024-10-22 17:00:19,699 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.5515329837799072
2024-10-22 17:00:19,699 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:19,699 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 color G))
2024-10-22 17:00:19,699 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 color G))']
2024-10-22 17:00:19,700 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:19,700 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 2
2024-10-22 17:00:19,882 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:19,882 - DEBUG - Network Policy Logits: [[-0.00694565  0.00588636 -0.00119057 -0.00071747  0.02577662  0.0388078
   0.02111334  0.04485612  0.03213015  0.09385686 -0.04992755 -0.04344894
  -0.05033609  0.02073583  0.03511924  0.01110628  0.02378381 -0.0380056
   0.03518518  0.01357134]]
2024-10-22 17:00:19,882 - DEBUG - Network Policy after Softmax: [[0.04910194 0.04973607 0.04938534 0.0494087  0.05073524 0.05140071
  0.05049919 0.05171254 0.05105861 0.0543096  0.04703615 0.04734187
  0.04701694 0.05048014 0.05121146 0.04999637 0.05063423 0.04760027
  0.05121484 0.05011976]]
2024-10-22 17:00:19,884 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.519019   0.
  0.         0.         0.         0.         0.         0.
  0.48098102 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:19,885 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color G), (Discard 4)) | P=0.5190190076828003
2024-10-22 17:00:19,885 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color G), (Reveal player +1 color G)) | P=0.4809810221195221
2024-10-22 17:00:19,885 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 color G)) | Value: 0.0
2024-10-22 17:00:19,885 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:19,886 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYWB2345
XX || XX|RYWB2345
XX || GX|G2345
XX || XX|RYWB12345
XX || GX|G12345
-----
B2 || B2|B2
W3 || XX|RYGW2345
G4 || XX|RYGW2345
G4 || XX|RYGWB2345
B5 || XX|RYGWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 Y1}
2024-10-22 17:00:19,886 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:19,886 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:19,886 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:19,886 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.4414989948272705 | PUCT: 0.4414989948272705
2024-10-22 17:00:19,887 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4561139941215515 | PUCT: 0.4561139941215515
2024-10-22 17:00:19,887 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.4561139941215515
2024-10-22 17:00:19,887 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:19,887 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.5416512489318848 | PUCT: 0.5416512489318848
2024-10-22 17:00:19,888 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3)) | Q: 0.0 | U: 0.5463252663612366 | PUCT: 0.5463252663612366
2024-10-22 17:00:19,888 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 color G)) | Q: 0.0 | U: 0.4978187084197998 | PUCT: 0.4978187084197998
2024-10-22 17:00:19,888 - DEBUG - Selected Child: ((Discard 3), (Reveal player +1 rank 3)) | PUCT: 0.5463252663612366
2024-10-22 17:00:19,888 - DEBUG - Selected child for exploration: ((Discard 3), (Reveal player +1 rank 3))
2024-10-22 17:00:19,888 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 3), (Reveal player +1 color G))
2024-10-22 17:00:19,889 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 3))', '((Discard 3), (Reveal player +1 rank 3), (Reveal player +1 color G))']
2024-10-22 17:00:19,889 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:19,889 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:19,889 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:19,889 - DEBUG - Rollout #8 completed with reward=4
2024-10-22 17:00:19,889 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:19,890 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.45383045077323914 | PUCT: 0.45383045077323914
2024-10-22 17:00:19,891 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.8 | U: 0.39071139693260193 | PUCT: 1.1907113790512085
2024-10-22 17:00:19,891 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 1.1907113790512085
2024-10-22 17:00:19,891 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:19,891 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.5715082287788391 | PUCT: 0.5715082287788391
2024-10-22 17:00:19,891 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3)) | Q: 2.0 | U: 0.38429322838783264 | PUCT: 2.3842933177948
2024-10-22 17:00:19,892 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 color G)) | Q: 0.0 | U: 0.5252595543861389 | PUCT: 0.5252595543861389
2024-10-22 17:00:19,892 - DEBUG - Selected Child: ((Discard 3), (Reveal player +1 rank 3)) | PUCT: 2.3842933177948
2024-10-22 17:00:19,892 - DEBUG - Selected child for exploration: ((Discard 3), (Reveal player +1 rank 3))
2024-10-22 17:00:19,892 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 3), (Discard 3))
2024-10-22 17:00:19,892 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 3))', '((Discard 3), (Reveal player +1 rank 3), (Discard 3))']
2024-10-22 17:00:19,893 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:19,893 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:19,893 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:19,893 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:00:19,893 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:19,894 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.46458396315574646 | PUCT: 0.46458396315574646
2024-10-22 17:00:19,894 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 1.3333333333333333 | U: 0.3428308367729187 | PUCT: 1.676164150238037
2024-10-22 17:00:19,894 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 1.676164150238037
2024-10-22 17:00:19,894 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:19,895 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.5955854058265686 | PUCT: 0.5955854058265686
2024-10-22 17:00:19,895 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3)) | Q: 2.6666666666666665 | U: 0.30036240816116333 | PUCT: 2.967029094696045
2024-10-22 17:00:19,895 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 color G)) | Q: 0.0 | U: 0.5473883152008057 | PUCT: 0.5473883152008057
2024-10-22 17:00:19,896 - DEBUG - Selected Child: ((Discard 3), (Reveal player +1 rank 3)) | PUCT: 2.967029094696045
2024-10-22 17:00:19,896 - DEBUG - Selected child for exploration: ((Discard 3), (Reveal player +1 rank 3))
2024-10-22 17:00:19,896 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3), (Reveal player +1 color G)) | Q: 4.0 | U: 0.727228045463562 | PUCT: 4.727228164672852
2024-10-22 17:00:19,896 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3), (Discard 3)) | Q: 4.0 | U: 0.744534432888031 | PUCT: 4.744534492492676
2024-10-22 17:00:19,897 - DEBUG - Selected Child: ((Discard 3), (Reveal player +1 rank 3), (Discard 3)) | PUCT: 4.744534492492676
2024-10-22 17:00:19,897 - DEBUG - Selected child for exploration: ((Discard 3), (Reveal player +1 rank 3), (Discard 3))
2024-10-22 17:00:19,897 - DEBUG - Node ((Discard 3), (Reveal player +1 rank 3), (Discard 3)) is a leaf node.
2024-10-22 17:00:19,897 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 3))', '((Discard 3), (Reveal player +1 rank 3), (Discard 3))']
2024-10-22 17:00:19,897 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:19,898 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:19,899 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 3
2024-10-22 17:00:20,101 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:20,102 - DEBUG - Network Policy Logits: [[ 0.01472629  0.01894273 -0.02435143 -0.06498243  0.02987634  0.03401703
   0.05336805  0.03943427  0.00968584  0.05090434 -0.03337086 -0.00912613
  -0.06353047  0.03642088  0.0473125   0.0622717  -0.03863079 -0.00283331
   0.02855454 -0.07711311]]
2024-10-22 17:00:20,102 - DEBUG - Network Policy after Softmax: [[0.05041589 0.05062892 0.04848376 0.04655329 0.05118551 0.05139789
  0.05240218 0.05167709 0.05016241 0.05227324 0.04804843 0.04922758
  0.04662094 0.0515216  0.05208582 0.05287084 0.04779636 0.04953834
  0.0511179  0.04599198]]
2024-10-22 17:00:20,104 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.34277228 0.
  0.         0.         0.         0.         0.         0.
  0.31220484 0.34502292 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:20,104 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Discard 3), (Reveal player +1 color W)) | P=0.34502291679382324
2024-10-22 17:00:20,106 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Discard 3), (Discard 4)) | P=0.3427722752094269
2024-10-22 17:00:20,106 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Discard 3), (Reveal player +1 color G)) | P=0.31220483779907227
2024-10-22 17:00:20,106 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 3), (Discard 3)) | Value: 0.0
2024-10-22 17:00:20,106 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:20,107 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 4}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYGW2345
XX || XX|RYGW2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
W5 || XX|RYGWB245
B2 || XX|RYGWB245
W4 || XX|RYGWB245
G3 || X3|RYGWB3
Y2 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 Y4 B1}
2024-10-22 17:00:20,107 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:20,107 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:20,107 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:20,107 - DEBUG - Best node chosen by MCTS: ((Discard 3),) | Visit Count: 7
2024-10-22 17:00:20,107 - INFO - Actual Game Score: 4
2024-10-22 17:00:20,107 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:20,107 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:20,107 - DEBUG - Policy Targets: [0.         0.         0.         0.77777778 0.         0.
 0.         0.         0.         0.         0.         0.
 0.22222222 0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:20,107 - DEBUG - === End of Training Data ===
2024-10-22 17:00:20,107 - INFO - Chosen Action: (Discard 3) | Visit Count: 7
2024-10-22 17:00:21,971 - DEBUG - Not the current player's turn.
2024-10-22 17:00:21,972 - INFO - Agent state has been reset.
2024-10-22 17:00:21,972 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:21,972 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || XX|RYGWB345
XX || XX|RYGWB345
XX || X2|RYGWB2
XX || XX|RYGWB1345
-----
B2 || B2|B2
W3 || XX|RYGW2345
G4 || XX|RYGW2345
G4 || XX|RYGWB2345
B5 || XX|RYGWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:21,972 - INFO - Max Rollouts: 10
2024-10-22 17:00:21,972 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:21,973 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:21,973 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:22,172 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:22,172 - DEBUG - Network Policy Logits: [[-0.00033093  0.01839665  0.00262067 -0.04395932  0.03090069  0.03734225
   0.04549054  0.01039133  0.03122052  0.07043058 -0.03156821 -0.02283909
  -0.05804438  0.02391856  0.04277216  0.03783514  0.02517879  0.00374169
   0.04143351 -0.04174476]]
2024-10-22 17:00:22,172 - DEBUG - Network Policy after Softmax: [[0.04940043 0.0503343  0.04954645 0.04729151 0.05096763 0.051297
  0.0517167  0.04993296 0.05098394 0.05302273 0.04788115 0.04830094
  0.04663007 0.05061301 0.0515763  0.05132229 0.05067683 0.04960203
  0.0515073  0.04739635]]
2024-10-22 17:00:22,174 - DEBUG - Normalized Policy: [[0.5144244  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.48557565 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:22,174 - DEBUG - Dirichlet Noise Added: [0.38904664 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.61095333 0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:22,175 - DEBUG - Added Child Node: ((Discard 0),) | P=0.38904663920402527
2024-10-22 17:00:22,176 - DEBUG - Added Child Node: ((Reveal player +1 color G),) | P=0.6109533309936523
2024-10-22 17:00:22,176 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:22,176 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:22,176 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || XX|RYGWB345
XX || XX|RYGWB345
XX || X2|RYGWB2
XX || XX|RYGWB1345
-----
B2 || B2|B2
W3 || XX|RYGW2345
G4 || XX|RYGW2345
G4 || XX|RYGWB2345
B5 || XX|RYGWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:22,176 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:22,176 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:22,176 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:22,177 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G),)
2024-10-22 17:00:22,177 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)']
2024-10-22 17:00:22,178 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:22,390 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:22,390 - DEBUG - Network Policy Logits: [[ 0.02535897 -0.00893577 -0.01427751 -0.02151504 -0.01246826  0.02811621
   0.06040888 -0.01583839  0.00959993 -0.00392796 -0.02638219 -0.00283057
  -0.02354373 -0.02136703  0.0302884   0.0067323  -0.03514232  0.01023332
   0.01338495 -0.04912761]]
2024-10-22 17:00:22,390 - DEBUG - Network Policy after Softmax: [[0.05139915 0.04966632 0.04940172 0.04904547 0.04949118 0.05154107
  0.05323263 0.04932467 0.0505955  0.04991566 0.04880733 0.04997047
  0.04894607 0.04905272 0.05165315 0.05045062 0.04838164 0.05062756
  0.05078737 0.04770972]]
2024-10-22 17:00:22,392 - DEBUG - Normalized Policy: [[0.         0.         0.24747388 0.         0.         0.
  0.         0.         0.         0.         0.24449636 0.
  0.         0.         0.         0.         0.         0.2536146
  0.25441518 0.        ]]
2024-10-22 17:00:22,392 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color R)) | P=0.24449636042118073
2024-10-22 17:00:22,393 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 2)) | P=0.24747388064861298
2024-10-22 17:00:22,394 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 3)) | P=0.253614604473114
2024-10-22 17:00:22,394 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 4)) | P=0.2544151842594147
2024-10-22 17:00:22,394 - DEBUG - Simulating Node: ((Reveal player +1 color G),) | Value: 0.0
2024-10-22 17:00:22,394 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:22,394 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW2345
XX || GX|G2345
XX || GX|G2345
XX || XX|RYWB12345
-----
R2 || X2|RYGWB2
B4 || XX|RYGWB345
Y4 || XX|RYGWB345
W2 || X2|RYGWB2
G3 || XX|RYGWB1345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:22,394 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:22,395 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:22,395 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:22,395 - DEBUG - Expanding unexplored child: ((Discard 0),)
2024-10-22 17:00:22,395 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 17:00:22,396 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:22,581 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:22,582 - DEBUG - Network Policy Logits: [[-0.02564469  0.02098275 -0.01198505 -0.0746007  -0.00118736  0.05795973
   0.01605215  0.01811532 -0.00125151  0.09232637 -0.04309052 -0.01313442
  -0.06924482 -0.00679025  0.06826632  0.07197502 -0.02184461 -0.01986176
   0.02320826 -0.02871906]]
2024-10-22 17:00:22,582 - DEBUG - Network Policy after Softmax: [[0.04856219 0.05088014 0.04923008 0.04624203 0.04976453 0.05279675
  0.05062988 0.05073445 0.04976134 0.05464273 0.04772233 0.04917353
  0.04649036 0.04948648 0.05334371 0.05354192 0.04874708 0.04884383
  0.0509935  0.04841312]]
2024-10-22 17:00:22,584 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3360315  0.
  0.         0.         0.         0.         0.         0.
  0.         0.33415398 0.         0.         0.         0.32981452
  0.         0.        ]]
2024-10-22 17:00:22,584 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color W)) | P=0.3341539800167084
2024-10-22 17:00:22,585 - DEBUG - Added Child Node: ((Discard 0), (Discard 4)) | P=0.3360314965248108
2024-10-22 17:00:22,585 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 3)) | P=0.32981452345848083
2024-10-22 17:00:22,586 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 17:00:22,586 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:22,586 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 3}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYGW2345
XX || XX|RYGW2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
W4 || XX|RYGWB345
R3 || XX|RYGWB345
W2 || X2|RYGWB2
G3 || XX|RYGWB1345
B4 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 R2}
2024-10-22 17:00:22,586 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:22,586 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:22,586 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:22,587 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.8991782069206238 | PUCT: 0.8991782069206238
2024-10-22 17:00:22,587 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.5725842714309692 | PUCT: 0.5725842714309692
2024-10-22 17:00:22,587 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.8991782069206238
2024-10-22 17:00:22,587 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:22,587 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Reveal player +1 color R))
2024-10-22 17:00:22,587 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 color R))']
2024-10-22 17:00:22,588 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:22,588 - DEBUG - Illegal move encountered: (Reveal player +1 color R)
2024-10-22 17:00:22,588 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:22,588 - DEBUG - Rollout #4 completed with reward=4
2024-10-22 17:00:22,588 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:22,589 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 2.0 | U: 0.6458979249000549 | PUCT: 2.64589786529541
2024-10-22 17:00:22,589 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.6169483065605164 | PUCT: 0.6169483065605164
2024-10-22 17:00:22,589 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 2.64589786529541
2024-10-22 17:00:22,589 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:22,589 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Discard 2))
2024-10-22 17:00:22,589 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Discard 2))']
2024-10-22 17:00:22,590 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:22,591 - DEBUG - Move: (Discard 2) | Reward: 4 | Depth: 2
2024-10-22 17:00:22,773 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:22,774 - DEBUG - Network Policy Logits: [[-0.01493266  0.02334585 -0.00961852 -0.03841818  0.00802536  0.04702916
   0.04711139 -0.00101036  0.01751571  0.08523166 -0.00709836  0.01017391
  -0.04877186  0.02030566  0.01955915  0.02664501  0.01543104 -0.01064162
   0.04793907 -0.06502092]]
2024-10-22 17:00:22,774 - DEBUG - Network Policy after Softmax: [[0.0488061  0.05071055 0.04906616 0.04767323 0.04993956 0.05192587
  0.05193015 0.04949035 0.05041576 0.05394795 0.04918997 0.05004697
  0.04718218 0.05055661 0.05051889 0.05087813 0.05031077 0.04901598
  0.05197315 0.04642171]]
2024-10-22 17:00:22,775 - DEBUG - Normalized Policy: [[0.3225019  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.33406892 0.         0.         0.         0.
  0.34342915 0.        ]]
2024-10-22 17:00:22,776 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 2), (Reveal player +1 color W)) | P=0.3340689241886139
2024-10-22 17:00:22,776 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 2), (Discard 0)) | P=0.32250189781188965
2024-10-22 17:00:22,777 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 2), (Reveal player +1 rank 4)) | P=0.3434291481971741
2024-10-22 17:00:22,777 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Discard 2)) | Value: 0.0
2024-10-22 17:00:22,777 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:22,777 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || XX|RYGWB345
XX || XX|RYGWB345
XX || X2|RYGWB2
XX || XX|RYGWB1345
-----
B2 || B2|B2
W3 || XX|RYW2345
G4 || GX|G2345
B5 || XX|RYWB12345
W4 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2}
2024-10-22 17:00:22,777 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:22,777 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:22,777 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:22,778 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 1.3333333333333333 | U: 0.511125922203064 | PUCT: 1.8444592952728271
2024-10-22 17:00:22,779 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.650955855846405 | PUCT: 0.650955855846405
2024-10-22 17:00:22,779 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 1.8444592952728271
2024-10-22 17:00:22,779 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:22,779 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Reveal player +1 rank 4))
2024-10-22 17:00:22,779 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 rank 4))']
2024-10-22 17:00:22,779 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:22,780 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:22,963 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:22,963 - DEBUG - Network Policy Logits: [[ 0.00900947  0.02569278  0.01626852 -0.04460365  0.05057374  0.02400831
   0.00461039  0.00184125  0.01417679  0.06266302 -0.02814023  0.02452101
  -0.03078636  0.02426869  0.0168954   0.04377417  0.01232995 -0.02131965
   0.04912773 -0.03581726]]
2024-10-22 17:00:22,963 - DEBUG - Network Policy after Softmax: [[0.04988129 0.05072046 0.0502447  0.04727743 0.05199827 0.0506351
  0.04966234 0.04952501 0.05013971 0.0526307  0.04806222 0.05066106
  0.04793521 0.05064828 0.05027621 0.0516459  0.0500472  0.04839115
  0.05192313 0.04769466]]
2024-10-22 17:00:22,965 - DEBUG - Normalized Policy: [[0.4899718 0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.5100282 0.       ]]
2024-10-22 17:00:22,965 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 4), (Discard 0)) | P=0.489971786737442
2024-10-22 17:00:22,966 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 4), (Reveal player +1 rank 4)) | P=0.5100281834602356
2024-10-22 17:00:22,966 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:00:22,966 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:22,966 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || X4|RYGWB4
XX || XX|RYGWB35
XX || X2|RYGWB2
XX || XX|RYGWB135
-----
B2 || B2|B2
W3 || XX|RYW2345
G4 || GX|G2345
G4 || GX|G2345
B5 || XX|RYWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:22,966 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:22,966 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:22,966 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:22,967 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 1.0 | U: 0.4261273741722107 | PUCT: 1.4261274337768555
2024-10-22 17:00:22,967 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.6783800721168518 | PUCT: 0.6783800721168518
2024-10-22 17:00:22,967 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 1.4261274337768555
2024-10-22 17:00:22,968 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:22,968 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Reveal player +1 rank 3))
2024-10-22 17:00:22,968 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 rank 3))']
2024-10-22 17:00:22,968 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:22,968 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:22,968 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:22,968 - DEBUG - Rollout #7 completed with reward=4
2024-10-22 17:00:22,968 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:22,969 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 1.6 | U: 0.3670879602432251 | PUCT: 1.967087984085083
2024-10-22 17:00:22,970 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.7012696266174316 | PUCT: 0.7012696266174316
2024-10-22 17:00:22,970 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 1.967087984085083
2024-10-22 17:00:22,970 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:22,970 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Reveal player +1 color R)) | Q: 4.0 | U: 0.4090932011604309 | PUCT: 4.409093379974365
2024-10-22 17:00:22,970 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Discard 2)) | Q: 0.0 | U: 0.41407522559165955 | PUCT: 0.41407522559165955
2024-10-22 17:00:22,971 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.4256894290447235 | PUCT: 0.4256894290447235
2024-10-22 17:00:22,971 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Reveal player +1 rank 3)) | Q: 4.0 | U: 0.42434993386268616 | PUCT: 4.424349784851074
2024-10-22 17:00:22,971 - DEBUG - Selected Child: ((Reveal player +1 color G), (Reveal player +1 rank 3)) | PUCT: 4.424349784851074
2024-10-22 17:00:22,971 - DEBUG - Selected child for exploration: ((Reveal player +1 color G), (Reveal player +1 rank 3))
2024-10-22 17:00:22,972 - DEBUG - Node ((Reveal player +1 color G), (Reveal player +1 rank 3)) is a leaf node.
2024-10-22 17:00:22,972 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 rank 3))']
2024-10-22 17:00:22,972 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:22,973 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:23,177 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:23,178 - DEBUG - Network Policy Logits: [[-0.00049585  0.02908586 -0.02039379 -0.06809118  0.01286584  0.04018985
   0.00688754  0.00116507  0.0093243   0.06792024 -0.02420389 -0.01423063
  -0.05106999  0.02215717  0.03096077  0.02982918  0.00777776 -0.00179379
   0.05407488 -0.01544267]]
2024-10-22 17:00:23,178 - DEBUG - Network Policy after Softmax: [[0.04965928 0.05115023 0.04868093 0.04641348 0.05032727 0.05172137
  0.05002729 0.04974183 0.05014935 0.0531757  0.04849581 0.04898189
  0.04721026 0.05079705 0.05124623 0.05118827 0.05007185 0.04959487
  0.05244453 0.04892255]]
2024-10-22 17:00:23,180 - DEBUG - Normalized Policy: [[0.4863607  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.51363933 0.        ]]
2024-10-22 17:00:23,180 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 3), (Discard 0)) | P=0.48636069893836975
2024-10-22 17:00:23,181 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 3), (Reveal player +1 rank 4)) | P=0.5136393308639526
2024-10-22 17:00:23,181 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:00:23,181 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:23,181 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || X3|RYGWB3
XX || XX|RYGWB45
XX || X2|RYGWB2
XX || XX|RYGWB145
-----
B2 || B2|B2
W3 || XX|RYW2345
G4 || GX|G2345
G4 || GX|G2345
B5 || XX|RYWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:23,181 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:23,181 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:23,181 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:23,182 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 1.3333333333333333 | U: 0.3234351575374603 | PUCT: 1.656768560409546
2024-10-22 17:00:23,183 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.7208566665649414 | PUCT: 0.7208566665649414
2024-10-22 17:00:23,183 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 1.656768560409546
2024-10-22 17:00:23,183 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:23,183 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Reveal player +1 color R)) | Q: 4.0 | U: 0.42632797360420227 | PUCT: 4.426328182220459
2024-10-22 17:00:23,184 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Discard 2)) | Q: 0.0 | U: 0.43151986598968506 | PUCT: 0.43151986598968506
2024-10-22 17:00:23,185 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.4436233937740326 | PUCT: 0.4436233937740326
2024-10-22 17:00:23,185 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Reveal player +1 rank 3)) | Q: 2.0 | U: 0.29481831192970276 | PUCT: 2.29481840133667
2024-10-22 17:00:23,185 - DEBUG - Selected Child: ((Reveal player +1 color G), (Reveal player +1 color R)) | PUCT: 4.426328182220459
2024-10-22 17:00:23,185 - DEBUG - Selected child for exploration: ((Reveal player +1 color G), (Reveal player +1 color R))
2024-10-22 17:00:23,185 - DEBUG - Node ((Reveal player +1 color G), (Reveal player +1 color R)) is a leaf node.
2024-10-22 17:00:23,185 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 color R))']
2024-10-22 17:00:23,186 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:23,186 - DEBUG - Illegal move encountered: (Reveal player +1 color R)
2024-10-22 17:00:23,186 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:23,186 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:00:23,187 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:23,188 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 1.7142857142857142 | U: 0.289711594581604 | PUCT: 2.003997325897217
2024-10-22 17:00:23,188 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.7379373908042908 | PUCT: 0.7379373908042908
2024-10-22 17:00:23,188 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 2.003997325897217
2024-10-22 17:00:23,188 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:23,189 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Reveal player +1 color R)) | Q: 4.0 | U: 0.29380860924720764 | PUCT: 4.293808460235596
2024-10-22 17:00:23,189 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Discard 2)) | Q: 0.0 | U: 0.44607996940612793 | PUCT: 0.44607996940612793
2024-10-22 17:00:23,190 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.45859190821647644 | PUCT: 0.45859190821647644
2024-10-22 17:00:23,190 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Reveal player +1 rank 3)) | Q: 2.0 | U: 0.304765909910202 | PUCT: 2.3047659397125244
2024-10-22 17:00:23,190 - DEBUG - Selected Child: ((Reveal player +1 color G), (Reveal player +1 color R)) | PUCT: 4.293808460235596
2024-10-22 17:00:23,190 - DEBUG - Selected child for exploration: ((Reveal player +1 color G), (Reveal player +1 color R))
2024-10-22 17:00:23,190 - DEBUG - Node ((Reveal player +1 color G), (Reveal player +1 color R)) is a leaf node.
2024-10-22 17:00:23,190 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 color R))']
2024-10-22 17:00:23,191 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:23,192 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:00:23,389 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:23,390 - DEBUG - Network Policy Logits: [[ 0.00691843  0.01244686 -0.00493333 -0.03148962  0.02107774  0.02753412
   0.00426099 -0.01041463  0.01368962  0.06045408 -0.02397653 -0.01646357
  -0.03346297  0.03465766 -0.00878491  0.05573261  0.00356179 -0.00387112
   0.06020623 -0.02635765]]
2024-10-22 17:00:23,390 - DEBUG - Network Policy after Softmax: [[0.04997375 0.05025078 0.04938497 0.04809074 0.05068637 0.05101468
  0.04984112 0.04911501 0.05031328 0.05272203 0.04845342 0.04881882
  0.04799594 0.05137939 0.04919512 0.05247369 0.04980629 0.04943745
  0.05270897 0.04833818]]
2024-10-22 17:00:23,392 - DEBUG - Normalized Policy: [[0.        0.        0.        0.4770921 0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.5229079 0.       ]]
2024-10-22 17:00:23,392 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color R), (Discard 3)) | P=0.47709208726882935
2024-10-22 17:00:23,393 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color R), (Reveal player +1 rank 4)) | P=0.5229079127311707
2024-10-22 17:00:23,393 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:00:23,393 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:23,393 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': 'R', 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || XX|YGWB345
XX || XX|YGWB345
XX || X2|YGWB2
XX || RX|R1345
-----
B2 || B2|B2
W3 || XX|RYW2345
G4 || GX|G2345
G4 || GX|G2345
B5 || XX|RYWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:23,393 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:23,393 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:23,393 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:23,393 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color G),) | Visit Count: 8
2024-10-22 17:00:23,393 - INFO - Actual Game Score: 4
2024-10-22 17:00:23,394 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:23,394 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:23,394 - DEBUG - Policy Targets: [0.11111111 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.88888889 0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:23,394 - DEBUG - === End of Training Data ===
2024-10-22 17:00:23,394 - INFO - Chosen Action: (Reveal player +1 color G) | Visit Count: 8
2024-10-22 17:00:25,443 - DEBUG - Not the current player's turn.
2024-10-22 17:00:25,445 - INFO - Agent state has been reset.
2024-10-22 17:00:25,445 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:25,445 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || X4|RYGWB4
XX || X4|RYGWB4
XX || X2|RYGWB2
XX || XX|RYGWB135
-----
B2 || B2|B2
W3 || XX|RYW2345
G4 || GX|G2345
G4 || GX|G2345
B5 || XX|RYWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:25,445 - INFO - Max Rollouts: 10
2024-10-22 17:00:25,445 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:25,445 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:25,445 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:25,668 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:25,669 - DEBUG - Network Policy Logits: [[ 0.01467439  0.01672457  0.02225731 -0.06690824  0.02488591  0.01962858
   0.01949774  0.00316716  0.0254927   0.0433321  -0.02060367 -0.00312421
  -0.03266488  0.02495208  0.01775106  0.04008652  0.00645918 -0.03529973
   0.04281053 -0.01071034]]
2024-10-22 17:00:25,669 - DEBUG - Network Policy after Softmax: [[0.05033461 0.05043791 0.05071774 0.04639122 0.05085124 0.0505846
  0.05057798 0.04975872 0.0508821  0.05179795 0.04858986 0.04944665
  0.04800732 0.0508546  0.05048971 0.05163011 0.04992279 0.047881
  0.05177094 0.04907296]]
2024-10-22 17:00:25,671 - DEBUG - Normalized Policy: [[0.4929664 0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.5070335 0.       ]]
2024-10-22 17:00:25,671 - DEBUG - Dirichlet Noise Added: [0.36972484 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.6302752  0.        ]
2024-10-22 17:00:25,672 - DEBUG - Added Child Node: ((Discard 0),) | P=0.369724839925766
2024-10-22 17:00:25,674 - DEBUG - Added Child Node: ((Reveal player +1 rank 4),) | P=0.6302751898765564
2024-10-22 17:00:25,674 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:25,674 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:25,674 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || X4|RYGWB4
XX || X4|RYGWB4
XX || X2|RYGWB2
XX || XX|RYGWB135
-----
B2 || B2|B2
W3 || XX|RYW2345
G4 || GX|G2345
G4 || GX|G2345
B5 || XX|RYWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:25,674 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:25,674 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:25,674 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:25,674 - DEBUG - Expanding unexplored child: ((Discard 0),)
2024-10-22 17:00:25,674 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 17:00:25,675 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:25,942 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:25,945 - DEBUG - Network Policy Logits: [[ 0.00972812  0.01933431 -0.01926545 -0.062065   -0.02174883  0.04904362
   0.03111025  0.02313161 -0.0226187   0.0200342   0.00063518 -0.05438428
  -0.02528317 -0.0313573   0.04244602  0.02533322 -0.00831689 -0.01063609
   0.02724267 -0.04510313]]
2024-10-22 17:00:25,945 - DEBUG - Network Policy after Softmax: [[0.05059705 0.05108544 0.04915113 0.04709186 0.04902922 0.05262592
  0.05169058 0.0512798  0.04898659 0.05112121 0.05013906 0.04745496
  0.04885624 0.04856038 0.05227986 0.05139282 0.04969222 0.04957711
  0.05149104 0.04789744]]
2024-10-22 17:00:25,948 - DEBUG - Normalized Policy: [[0.         0.         0.3254867  0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34620568 0.         0.         0.3283076
  0.         0.        ]]
2024-10-22 17:00:25,949 - DEBUG - Added Child Node: ((Discard 0), (Discard 2)) | P=0.3254866898059845
2024-10-22 17:00:25,950 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B)) | P=0.3462056815624237
2024-10-22 17:00:25,950 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 3)) | P=0.3283075988292694
2024-10-22 17:00:25,950 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 17:00:25,951 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:25,951 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW2345
XX || GX|G2345
XX || GX|G2345
XX || XX|RYWB12345
-----
B4 || X4|RYGWB4
Y4 || X4|RYGWB4
W2 || X2|RYGWB2
Y3 || XX|RYGWB135
B1 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 R2}
2024-10-22 17:00:25,951 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:25,951 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:25,951 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:25,952 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4),)
2024-10-22 17:00:25,952 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)']
2024-10-22 17:00:25,953 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:26,195 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:26,195 - DEBUG - Network Policy Logits: [[ 0.02619971 -0.01184184  0.01552272 -0.03110776  0.00350248  0.03578589
   0.0591202  -0.02498557  0.02817879 -0.02773781 -0.00561044 -0.02576526
  -0.02099958 -0.04443594  0.01919942  0.00223579 -0.01267331  0.00361564
   0.02155674 -0.05605078]]
2024-10-22 17:00:26,195 - DEBUG - Network Policy after Softmax: [[0.05142541 0.04950585 0.05087927 0.04856121 0.05027135 0.05192076
  0.05314654 0.04885942 0.05152729 0.04872513 0.0498153  0.04882134
  0.04905456 0.04791827 0.05106668 0.05020771 0.04946471 0.05027704
  0.0511872  0.04736493]]
2024-10-22 17:00:26,197 - DEBUG - Normalized Policy: [[0.         0.49844217 0.         0.         0.         0.
  0.         0.         0.         0.         0.5015578  0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:26,197 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color R)) | P=0.5015578269958496
2024-10-22 17:00:26,198 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 1)) | P=0.4984421730041504
2024-10-22 17:00:26,198 - DEBUG - Simulating Node: ((Reveal player +1 rank 4),) | Value: 0.0
2024-10-22 17:00:26,198 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:26,198 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 3}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
-----
R2 || X2|RYGWB2
W4 || X4|RYGWB4
R4 || X4|RYGWB4
W2 || X2|RYGWB2
G1 || XX|RYGWB135
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:26,199 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:26,199 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:26,199 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:26,200 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.5441471934318542 | PUCT: 0.5441471934318542
2024-10-22 17:00:26,200 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.9276154041290283 | PUCT: 0.9276154041290283
2024-10-22 17:00:26,201 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.9276154041290283
2024-10-22 17:00:26,201 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:00:26,201 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Reveal player +1 color R))
2024-10-22 17:00:26,201 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 color R))']
2024-10-22 17:00:26,201 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:26,202 - DEBUG - Illegal move encountered: (Reveal player +1 color R)
2024-10-22 17:00:26,202 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:26,202 - DEBUG - Rollout #4 completed with reward=4
2024-10-22 17:00:26,202 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:26,203 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.586307942867279 | PUCT: 0.586307942867279
2024-10-22 17:00:26,204 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 2.0 | U: 0.6663249731063843 | PUCT: 2.666325092315674
2024-10-22 17:00:26,204 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 2.666325092315674
2024-10-22 17:00:26,204 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:00:26,204 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Discard 1))
2024-10-22 17:00:26,204 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Discard 1))']
2024-10-22 17:00:26,205 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:26,205 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:26,416 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:26,417 - DEBUG - Network Policy Logits: [[-0.00508801  0.01917817  0.03232972 -0.040616    0.02552784  0.02356992
   0.03779706  0.01201111  0.01879895  0.04502871 -0.00881741  0.00719805
  -0.06132936  0.00420263  0.01843623  0.03640008 -0.02471588 -0.02806138
   0.03084135 -0.04206965]]
2024-10-22 17:00:26,417 - DEBUG - Network Policy after Softmax: [[0.04947518 0.05069043 0.05136149 0.04774828 0.05101332 0.05091354
  0.05164308 0.05032843 0.05067122 0.05201789 0.04929101 0.05008678
  0.04676943 0.04993698 0.05065284 0.05157098 0.04851355 0.04835152
  0.05128511 0.04767892]]
2024-10-22 17:00:26,419 - DEBUG - Normalized Policy: [[0.32614043 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.33390355 0.33995596 0.         0.
  0.         0.        ]]
2024-10-22 17:00:26,420 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 1), (Discard 0)) | P=0.326140433549881
2024-10-22 17:00:26,421 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 1), (Reveal player +1 rank 1)) | P=0.3399559557437897
2024-10-22 17:00:26,421 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 1), (Reveal player +1 color B)) | P=0.33390355110168457
2024-10-22 17:00:26,421 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Discard 1)) | Value: 0.0
2024-10-22 17:00:26,421 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:26,422 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || X4|RYGWB4
XX || X4|RYGWB4
XX || X2|RYGWB2
XX || XX|RYGWB135
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
B1 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 W2}
2024-10-22 17:00:26,422 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:26,422 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:26,422 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:26,422 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.6186264753341675 | PUCT: 0.6186264753341675
2024-10-22 17:00:26,424 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 1.3333333333333333 | U: 0.5272906422615051 | PUCT: 1.860624074935913
2024-10-22 17:00:26,424 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 1.860624074935913
2024-10-22 17:00:26,424 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:00:26,424 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 color R)) | Q: 4.0 | U: 0.7381740212440491 | PUCT: 4.738173961639404
2024-10-22 17:00:26,425 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Discard 1)) | Q: 0.0 | U: 0.7335885167121887 | PUCT: 0.7335885167121887
2024-10-22 17:00:26,425 - DEBUG - Selected Child: ((Reveal player +1 rank 4), (Reveal player +1 color R)) | PUCT: 4.738173961639404
2024-10-22 17:00:26,425 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4), (Reveal player +1 color R))
2024-10-22 17:00:26,425 - DEBUG - Node ((Reveal player +1 rank 4), (Reveal player +1 color R)) is a leaf node.
2024-10-22 17:00:26,425 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 color R))']
2024-10-22 17:00:26,426 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:26,426 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:00:26,638 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:26,638 - DEBUG - Network Policy Logits: [[-0.01858949  0.00597511  0.0312932  -0.05594754  0.02994103  0.01911741
   0.01549502  0.02728302  0.03835096  0.02222629 -0.01037746 -0.00767235
  -0.02083898 -0.00142617  0.01694225  0.01248435  0.00475432 -0.04677505
   0.02931654 -0.01482866]]
2024-10-22 17:00:26,639 - DEBUG - Network Policy after Softmax: [[0.04887573 0.05009121 0.05137561 0.04708351 0.05130619 0.05075387
  0.05057035 0.05117    0.05173949 0.0509119  0.04927875 0.04941224
  0.04876591 0.04972183 0.05064359 0.05041833 0.05003009 0.04751737
  0.05127416 0.04905989]]
2024-10-22 17:00:26,640 - DEBUG - Normalized Policy: [[0.49111804 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.508882   0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:26,641 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0)) | P=0.49111804366111755
2024-10-22 17:00:26,641 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B)) | P=0.5088819861412048
2024-10-22 17:00:26,641 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:00:26,641 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:26,642 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|YGWB2
XX || R4|R4
XX || X4|YGWB4
XX || X2|YGWB2
XX || XX|YGWB135
-----
B2 || B2|B2
W3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:26,642 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:26,642 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:26,642 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:26,643 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.6446886658668518 | PUCT: 0.6446886658668518
2024-10-22 17:00:26,643 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 1.0 | U: 0.4396039843559265 | PUCT: 1.4396040439605713
2024-10-22 17:00:26,643 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 1.4396040439605713
2024-10-22 17:00:26,643 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:00:26,644 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 color R)) | Q: 2.0 | U: 0.5302453637123108 | PUCT: 2.530245304107666
2024-10-22 17:00:26,644 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Discard 1)) | Q: 0.0 | U: 0.7904272675514221 | PUCT: 0.7904272675514221
2024-10-22 17:00:26,644 - DEBUG - Selected Child: ((Reveal player +1 rank 4), (Reveal player +1 color R)) | PUCT: 2.530245304107666
2024-10-22 17:00:26,644 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4), (Reveal player +1 color R))
2024-10-22 17:00:26,645 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0))
2024-10-22 17:00:26,645 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 color R))', '((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0))']
2024-10-22 17:00:26,645 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:26,646 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:00:26,647 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 3
2024-10-22 17:00:26,852 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:26,853 - DEBUG - Network Policy Logits: [[ 0.03284421 -0.00822735 -0.00375255 -0.03941635  0.03446627  0.0343757
   0.01215088  0.00734113 -0.0285001   0.02161693 -0.0297149  -0.04216002
  -0.0184585  -0.01280868  0.02209801  0.0171728   0.00747719 -0.00175983
   0.0154385  -0.01102354]]
2024-10-22 17:00:26,853 - DEBUG - Network Policy after Softmax: [[0.05163173 0.0495541  0.04977634 0.04803241 0.05171555 0.05171087
  0.05057428 0.05033162 0.04855962 0.05105529 0.04850066 0.0479008
  0.04904969 0.04932759 0.05107986 0.0508289  0.05033847 0.04987563
  0.05074082 0.04941573]]
2024-10-22 17:00:26,855 - DEBUG - Normalized Policy: [[0.         0.20041215 0.         0.         0.         0.
  0.         0.         0.         0.         0.19615173 0.
  0.19837216 0.1994961  0.         0.20556785 0.         0.
  0.         0.        ]]
2024-10-22 17:00:26,856 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 1)) | P=0.2055678516626358
2024-10-22 17:00:26,857 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0), (Reveal player +1 color G)) | P=0.19837215542793274
2024-10-22 17:00:26,857 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0), (Reveal player +1 color R)) | P=0.1961517333984375
2024-10-22 17:00:26,858 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0), (Reveal player +1 color W)) | P=0.1994961053133011
2024-10-22 17:00:26,859 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0), (Discard 1)) | P=0.20041215419769287
2024-10-22 17:00:26,859 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0)) | Value: 0.0
2024-10-22 17:00:26,859 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:26,859 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 3}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': None, 'rank': 3}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
-----
W4 || X4|YGWB4
R4 || R4|R4
G2 || X2|YGWB2
R1 || RX|R135
R3 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 W2}
2024-10-22 17:00:26,859 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:26,859 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:26,859 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:26,861 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.6664414405822754 | PUCT: 0.6664414405822754
2024-10-22 17:00:26,861 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.8 | U: 0.37869739532470703 | PUCT: 1.1786973476409912
2024-10-22 17:00:26,861 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 1.1786973476409912
2024-10-22 17:00:26,861 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:00:26,862 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 color R)) | Q: 1.3333333333333333 | U: 0.41960522532463074 | PUCT: 1.7529386281967163
2024-10-22 17:00:26,862 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Discard 1)) | Q: 0.0 | U: 0.8339973092079163 | PUCT: 0.8339973092079163
2024-10-22 17:00:26,862 - DEBUG - Selected Child: ((Reveal player +1 rank 4), (Reveal player +1 color R)) | PUCT: 1.7529386281967163
2024-10-22 17:00:26,862 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4), (Reveal player +1 color R))
2024-10-22 17:00:26,862 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B))
2024-10-22 17:00:26,862 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 color R))', '((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B))']
2024-10-22 17:00:26,863 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:26,864 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:00:26,864 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 3
2024-10-22 17:00:27,088 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:27,088 - DEBUG - Network Policy Logits: [[ 0.00671655 -0.00214069  0.00617747  0.01162142  0.01184666  0.03427772
   0.01008877 -0.01976672  0.00126466 -0.03323454 -0.00301676 -0.04281411
  -0.01898448 -0.03255757  0.03001017  0.01359275 -0.0211064   0.01488906
   0.01398268 -0.02853706]]
2024-10-22 17:00:27,088 - DEBUG - Network Policy after Softmax: [[0.05044574 0.0500009  0.05041855 0.05069378 0.05070519 0.05185542
  0.05061614 0.04912731 0.05017146 0.0484701  0.04995712 0.048008
  0.04916575 0.04850293 0.05163459 0.05079381 0.04906153 0.05085969
  0.05081362 0.04869832]]
2024-10-22 17:00:27,089 - DEBUG - Normalized Policy: [[0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:27,091 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B), (Discard 1)) | P=1.0
2024-10-22 17:00:27,091 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:00:27,091 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:27,091 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || BX|B1235
-----
R2 || R2|R2
B4 || X4|YGWB4
W4 || X4|YGWB4
R2 || R2|R2
R3 || RX|R135
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:27,091 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:27,091 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:27,091 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:27,092 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.6850557327270508 | PUCT: 0.6850557327270508
2024-10-22 17:00:27,092 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.6666666666666666 | U: 0.33366402983665466 | PUCT: 1.0003306865692139
2024-10-22 17:00:27,092 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 1.0003306865692139
2024-10-22 17:00:27,092 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:00:27,093 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 color R)) | Q: 1.0 | U: 0.34982627630233765 | PUCT: 1.3498263359069824
2024-10-22 17:00:27,093 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Discard 1)) | Q: 0.0 | U: 0.8691328763961792 | PUCT: 0.8691328763961792
2024-10-22 17:00:27,093 - DEBUG - Selected Child: ((Reveal player +1 rank 4), (Reveal player +1 color R)) | PUCT: 1.3498263359069824
2024-10-22 17:00:27,093 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4), (Reveal player +1 color R))
2024-10-22 17:00:27,094 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0)) | Q: 0.0 | U: 0.7788127064704895 | PUCT: 0.7788127064704895
2024-10-22 17:00:27,095 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B)) | Q: 0.0 | U: 0.806982696056366 | PUCT: 0.806982696056366
2024-10-22 17:00:27,095 - DEBUG - Selected Child: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B)) | PUCT: 0.806982696056366
2024-10-22 17:00:27,095 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B))
2024-10-22 17:00:27,095 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B), (Discard 1))
2024-10-22 17:00:27,095 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 color R))', '((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B))', '((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B), (Discard 1))']
2024-10-22 17:00:27,096 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:27,096 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:00:27,097 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 3
2024-10-22 17:00:27,097 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 4
2024-10-22 17:00:27,306 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:27,306 - DEBUG - Network Policy Logits: [[ 0.01606957  0.00762167  0.01709757 -0.06648597  0.03431299  0.03117497
   0.0395572   0.03916482  0.00118866  0.021805   -0.02992659 -0.0174896
  -0.01141375  0.01303821  0.01392352  0.00433287 -0.02318396 -0.02352243
   0.02904557 -0.04810602]]
2024-10-22 17:00:27,306 - DEBUG - Network Policy after Softmax: [[0.05066677 0.05024054 0.05071888 0.04665194 0.05159958 0.05143792
  0.05187089 0.05185054 0.04991838 0.0509582  0.04838907 0.04899465
  0.04929323 0.05051341 0.05055815 0.05007558 0.04871644 0.04869996
  0.0513285  0.04751733]]
2024-10-22 17:00:27,308 - DEBUG - Normalized Policy: [[0.5160384  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.48396158]]
2024-10-22 17:00:27,308 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B), (Discard 1), (Reveal player +1 rank 5)) | P=0.4839615821838379
2024-10-22 17:00:27,309 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B), (Discard 1), (Discard 0)) | P=0.5160384178161621
2024-10-22 17:00:27,309 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B), (Discard 1)) | Value: 0.0
2024-10-22 17:00:27,309 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:27,309 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|YGWB2
XX || R4|R4
XX || X4|YGWB4
XX || X2|YGWB2
XX || XX|YGWB135
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || BX|B1235
W3 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 W3}
2024-10-22 17:00:27,309 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:27,310 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:27,310 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:27,310 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.701288104057312 | PUCT: 0.701288104057312
2024-10-22 17:00:27,311 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.5714285714285714 | U: 0.2988739609718323 | PUCT: 0.8703025579452515
2024-10-22 17:00:27,311 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.8703025579452515
2024-10-22 17:00:27,311 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:00:27,311 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 color R)) | Q: 0.8 | U: 0.30135828256607056 | PUCT: 1.1013582944869995
2024-10-22 17:00:27,312 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Discard 1)) | Q: 0.0 | U: 0.89845871925354 | PUCT: 0.89845871925354
2024-10-22 17:00:27,312 - DEBUG - Selected Child: ((Reveal player +1 rank 4), (Reveal player +1 color R)) | PUCT: 1.1013582944869995
2024-10-22 17:00:27,312 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4), (Reveal player +1 color R))
2024-10-22 17:00:27,313 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0)) | Q: 0.0 | U: 0.8217425346374512 | PUCT: 0.8217425346374512
2024-10-22 17:00:27,313 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Reveal player +1 color B)) | Q: 0.0 | U: 0.5676435232162476 | PUCT: 0.5676435232162476
2024-10-22 17:00:27,313 - DEBUG - Selected Child: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0)) | PUCT: 0.8217425346374512
2024-10-22 17:00:27,313 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0))
2024-10-22 17:00:27,313 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0), (Discard 1))
2024-10-22 17:00:27,313 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 color R))', '((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0))', '((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0), (Discard 1))']
2024-10-22 17:00:27,315 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:27,315 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:00:27,316 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 3
2024-10-22 17:00:27,316 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 4
2024-10-22 17:00:27,538 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:27,539 - DEBUG - Network Policy Logits: [[-0.01427227  0.01294583  0.02853448 -0.02124424 -0.01338263  0.04574901
   0.05411836  0.01940858 -0.0074326   0.05071692 -0.01080115 -0.00155385
  -0.04944434 -0.01614804  0.03232615  0.02651694 -0.0202353  -0.0676133
   0.0215556  -0.04471187]]
2024-10-22 17:00:27,539 - DEBUG - Network Policy after Softmax: [[0.04920301 0.05056062 0.05135496 0.04886116 0.0492468  0.05224667
  0.05268577 0.05088843 0.04954069 0.05250687 0.0493741  0.04983279
  0.04750252 0.0491108  0.05155005 0.05125145 0.04891048 0.04664724
  0.05099781 0.04772785]]
2024-10-22 17:00:27,540 - DEBUG - Normalized Policy: [[0.         0.         0.4990521  0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.50094795 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:27,541 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0), (Discard 1), (Discard 2)) | P=0.49905210733413696
2024-10-22 17:00:27,542 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0), (Discard 1), (Reveal player +1 color B)) | P=0.5009479522705078
2024-10-22 17:00:27,542 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Reveal player +1 color R), (Discard 0), (Discard 1)) | Value: 0.0
2024-10-22 17:00:27,542 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:27,542 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 25, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X4|YGWB4
XX || X4|YGWB4
XX || X2|YGWB2
XX || XX|YGWB135
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
B3 || XX|RYGWB12345
Deck size: 25
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 R2 Y3}
2024-10-22 17:00:27,542 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:27,543 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:27,543 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:27,543 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 4),) | Visit Count: 8
2024-10-22 17:00:27,543 - INFO - Actual Game Score: 4
2024-10-22 17:00:27,543 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:27,543 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:27,543 - DEBUG - Policy Targets: [0.11111111 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.88888889 0.        ]
2024-10-22 17:00:27,543 - DEBUG - === End of Training Data ===
2024-10-22 17:00:27,544 - INFO - Chosen Action: (Reveal player +1 rank 4) | Visit Count: 8
2024-10-22 17:00:29,710 - DEBUG - Not the current player's turn.
2024-10-22 17:00:29,711 - INFO - Agent state has been reset.
2024-10-22 17:00:29,711 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:29,711 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGW2
XX || B4|B4
XX || X4|RYGW4
XX || X2|RYGW2
XX || XX|RYGW135
-----
B2 || B2|B2
W3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:29,711 - INFO - Max Rollouts: 10
2024-10-22 17:00:29,712 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:29,712 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:29,712 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:29,928 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:29,928 - DEBUG - Network Policy Logits: [[ 0.00289023  0.01951148  0.01491455 -0.05215973  0.00500095  0.01794013
   0.00223902  0.02712334  0.0517465   0.01244375 -0.01291543 -0.00827331
  -0.01831662 -0.01657073  0.00399207  0.04250357  0.018891   -0.05236233
   0.00718753 -0.02190027]]
2024-10-22 17:00:29,929 - DEBUG - Network Policy after Softmax: [[0.05001804 0.05085636 0.0506231  0.04733897 0.05012373 0.0507765
  0.04998548 0.05124494 0.05252242 0.05049818 0.04923369 0.04946277
  0.04896849 0.04905405 0.05007319 0.05203919 0.05082481 0.04732938
  0.05023345 0.04879332]]
2024-10-22 17:00:29,930 - DEBUG - Normalized Policy: [[0.4997245  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.50027543 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:29,931 - DEBUG - Dirichlet Noise Added: [0.37479338 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.6252066  0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:29,931 - DEBUG - Added Child Node: ((Discard 0),) | P=0.3747933804988861
2024-10-22 17:00:29,932 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.6252065896987915
2024-10-22 17:00:29,932 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:29,932 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:29,932 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGW2
XX || B4|B4
XX || X4|RYGW4
XX || X2|RYGW2
XX || XX|RYGW135
-----
B2 || B2|B2
W3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:29,932 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:29,932 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:29,932 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:29,932 - DEBUG - Expanding unexplored child: ((Discard 0),)
2024-10-22 17:00:29,932 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 17:00:29,933 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:30,140 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:30,141 - DEBUG - Network Policy Logits: [[-0.00562137  0.0143584  -0.00497106 -0.06420994  0.02097237  0.04044129
   0.01580152  0.01286399 -0.01421015  0.01172436 -0.03199233 -0.05426294
  -0.01407999 -0.02417216  0.03371391  0.02537318 -0.02455269 -0.00790367
   0.02353487 -0.02408772]]
2024-10-22 17:00:30,141 - DEBUG - Network Policy after Softmax: [[0.04987825 0.05088483 0.04991069 0.04703991 0.05122249 0.05222951
  0.05095831 0.05080884 0.04945169 0.05075097 0.0485801  0.04751015
  0.04945813 0.04896149 0.05187932 0.05144841 0.04894287 0.04976454
  0.05135392 0.04896563]]
2024-10-22 17:00:30,142 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.34681466 0.
  0.         0.         0.         0.         0.         0.32167935
  0.         0.331506   0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:30,143 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color W)) | P=0.33150601387023926
2024-10-22 17:00:30,144 - DEBUG - Added Child Node: ((Discard 0), (Discard 4)) | P=0.34681466221809387
2024-10-22 17:00:30,145 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color Y)) | P=0.32167935371398926
2024-10-22 17:00:30,145 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 17:00:30,145 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:30,145 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
-----
B4 || B4|B4
W4 || X4|RYGW4
Y2 || X2|RYGW2
W3 || XX|RYGW135
W4 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 R2}
2024-10-22 17:00:30,145 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:30,145 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:30,145 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:30,146 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:00:30,146 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:00:30,146 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:30,353 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:30,353 - DEBUG - Network Policy Logits: [[ 0.01420859  0.00778354  0.02610394  0.00564035  0.00415864  0.04106051
   0.04534478 -0.01411751  0.01621716 -0.00744117 -0.00538449 -0.04841693
  -0.00814159 -0.05669755  0.02694521  0.00270453 -0.00622044  0.00655839
   0.0168213  -0.03587564]]
2024-10-22 17:00:30,353 - DEBUG - Network Policy after Softmax: [[0.05061964 0.05029545 0.05122537 0.05018777 0.05011346 0.05199729
  0.05222053 0.0492059  0.05072141 0.04953551 0.0496375  0.04754679
  0.04950083 0.04715469 0.05126848 0.05004064 0.04959602 0.05023386
  0.05075207 0.04814683]]
2024-10-22 17:00:30,354 - DEBUG - Normalized Policy: [[1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:30,355 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0)) | P=1.0
2024-10-22 17:00:30,355 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:00:30,355 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:30,355 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}], [{'color': None, 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || BX|B1235
-----
R2 || X2|RYGW2
B4 || B4|B4
Y4 || X4|RYGW4
Y2 || X2|RYGW2
R1 || XX|RYGW135
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:30,355 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:30,356 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:30,356 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:30,356 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.5516068339347839 | PUCT: 0.5516068339347839
2024-10-22 17:00:30,357 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.9201555848121643 | PUCT: 0.9201555848121643
2024-10-22 17:00:30,357 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.9201555848121643
2024-10-22 17:00:30,357 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:30,357 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Discard 0))
2024-10-22 17:00:30,357 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Discard 0))']
2024-10-22 17:00:30,358 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:30,358 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:00:30,560 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:30,561 - DEBUG - Network Policy Logits: [[ 0.02829129  0.00354958 -0.01256894 -0.05517431  0.04139303 -0.00484601
   0.0161462   0.03797681  0.03216784  0.03390954 -0.01715474 -0.03692152
  -0.02457504 -0.00556314 -0.00660242  0.03345999 -0.00639261 -0.01270812
   0.01921903 -0.04333124]]
2024-10-22 17:00:30,561 - DEBUG - Network Policy after Softmax: [[0.05136275 0.05010754 0.04930636 0.04724976 0.05204012 0.04968862
  0.05074272 0.05186265 0.05156225 0.05165214 0.04908077 0.04812013
  0.04871792 0.049653   0.04960142 0.05162892 0.04961183 0.04929949
  0.05089888 0.04781267]]
2024-10-22 17:00:30,562 - DEBUG - Normalized Policy: [[0.34224883 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.33915788 0.31859335]]
2024-10-22 17:00:30,563 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0), (Reveal player +1 rank 5)) | P=0.3185933530330658
2024-10-22 17:00:30,564 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0), (Discard 0)) | P=0.3422488272190094
2024-10-22 17:00:30,564 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0), (Reveal player +1 rank 4)) | P=0.3391578793525696
2024-10-22 17:00:30,565 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Discard 0)) | Value: 0.0
2024-10-22 17:00:30,565 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:30,565 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGW2
XX || B4|B4
XX || X4|RYGW4
XX || X2|RYGW2
XX || XX|RYGW135
-----
W3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
B5 || BX|B1235
Y4 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 B2}
2024-10-22 17:00:30,565 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:30,565 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:30,565 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:30,566 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.5943455696105957 | PUCT: 0.5943455696105957
2024-10-22 17:00:30,566 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.6609663963317871 | PUCT: 0.6609663963317871
2024-10-22 17:00:30,566 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.6609663963317871
2024-10-22 17:00:30,566 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:30,567 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Discard 0)) | Q: 0.0 | U: 1.3101838827133179 | PUCT: 1.3101838827133179
2024-10-22 17:00:30,567 - DEBUG - Selected Child: ((Reveal player +1 color B), (Discard 0)) | PUCT: 1.3101838827133179
2024-10-22 17:00:30,567 - DEBUG - Selected child for exploration: ((Reveal player +1 color B), (Discard 0))
2024-10-22 17:00:30,567 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Discard 0), (Reveal player +1 rank 4))
2024-10-22 17:00:30,567 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Discard 0))', '((Reveal player +1 color B), (Discard 0), (Reveal player +1 rank 4))']
2024-10-22 17:00:30,568 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:30,569 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:00:30,569 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 3
2024-10-22 17:00:30,778 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:30,778 - DEBUG - Network Policy Logits: [[ 0.02765544  0.01811039  0.05608368 -0.0407346   0.02605112  0.04578781
   0.02028596  0.00089478  0.03950491  0.03673691  0.00543607 -0.00417089
  -0.03282398 -0.04233561  0.02019801  0.01739328  0.01478706 -0.04674665
   0.01633723 -0.01140004]]
2024-10-22 17:00:30,779 - DEBUG - Network Policy after Softmax: [[0.05095294 0.0504689  0.05242223 0.04758475 0.05087126 0.05188526
  0.05057882 0.04960749 0.05156029 0.05141777 0.04983328 0.04935683
  0.04796267 0.04750863 0.05057437 0.05043273 0.05030146 0.04729953
  0.05037949 0.04900131]]
2024-10-22 17:00:30,780 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:30,780 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0), (Reveal player +1 rank 4), (Discard 4)) | P=1.0
2024-10-22 17:00:30,781 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Discard 0), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:00:30,781 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:30,781 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || BX|B1235
XX || XX|RYGWB1235
-----
W2 || X2|RYGW2
B4 || B4|B4
W4 || X4|RYGW4
R2 || X2|RYGW2
G3 || XX|RYGW135
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 B2}
2024-10-22 17:00:30,781 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:30,781 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:30,781 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:30,782 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.6271072030067444 | PUCT: 0.6271072030067444
2024-10-22 17:00:30,782 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.5230502486228943 | PUCT: 0.5230502486228943
2024-10-22 17:00:30,782 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.6271072030067444
2024-10-22 17:00:30,783 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:00:30,783 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 color Y))
2024-10-22 17:00:30,783 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 color Y))']
2024-10-22 17:00:30,783 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:30,784 - DEBUG - Illegal move encountered: (Reveal player +1 color Y)
2024-10-22 17:00:30,784 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:30,784 - DEBUG - Rollout #6 completed with reward=4
2024-10-22 17:00:30,784 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:30,785 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 2.0 | U: 0.4356844425201416 | PUCT: 2.4356844425201416
2024-10-22 17:00:30,785 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.5450859069824219 | PUCT: 0.5450859069824219
2024-10-22 17:00:30,785 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 2.4356844425201416
2024-10-22 17:00:30,785 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:00:30,785 - DEBUG - Expanding unexplored child: ((Discard 0), (Discard 4))
2024-10-22 17:00:30,785 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Discard 4))']
2024-10-22 17:00:30,787 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:30,787 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:31,000 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:31,000 - DEBUG - Network Policy Logits: [[-0.03094568  0.01598406  0.04596677 -0.0466202  -0.00910458  0.05639873
   0.02518255  0.01599758  0.0081538   0.04402249 -0.03507939  0.01247552
  -0.02519507 -0.02480139  0.02937824  0.02204279 -0.00620107 -0.05634605
   0.02079714 -0.01412597]]
2024-10-22 17:00:31,001 - DEBUG - Network Policy after Softmax: [[0.04833688 0.05065939 0.0522013  0.04758513 0.04940423 0.05274871
  0.05112753 0.05066007 0.05026426 0.0520999  0.04813748 0.05048196
  0.04861565 0.04863479 0.05134249 0.05096725 0.04954788 0.04712456
  0.0509038  0.04915677]]
2024-10-22 17:00:31,003 - DEBUG - Normalized Policy: [[0.       0.       0.517783 0.       0.       0.       0.       0.
  0.       0.       0.       0.       0.482217 0.       0.       0.
  0.       0.       0.       0.      ]]
2024-10-22 17:00:31,004 - DEBUG - Added Child Node: ((Discard 0), (Discard 4), (Discard 2)) | P=0.517782986164093
2024-10-22 17:00:31,004 - DEBUG - Added Child Node: ((Discard 0), (Discard 4), (Reveal player +1 color G)) | P=0.482217013835907
2024-10-22 17:00:31,005 - DEBUG - Simulating Node: ((Discard 0), (Discard 4)) | Value: 0.0
2024-10-22 17:00:31,005 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:31,005 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 25, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || X4|RYGW4
XX || X2|RYGW2
XX || XX|RYGW135
XX || XX|RYGWB12345
-----
B2 || B2|B2
W3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
G1 || XX|RYGWB12345
Deck size: 25
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 R2 R1}
2024-10-22 17:00:31,005 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:31,005 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:31,005 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:31,007 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 1.3333333333333333 | U: 0.33778882026672363 | PUCT: 1.6711221933364868
2024-10-22 17:00:31,007 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.5634779334068298 | PUCT: 0.5634779334068298
2024-10-22 17:00:31,007 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 1.6711221933364868
2024-10-22 17:00:31,007 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:00:31,007 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 color W))
2024-10-22 17:00:31,007 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 color W))']
2024-10-22 17:00:31,009 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:31,009 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 2
2024-10-22 17:00:31,236 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:31,237 - DEBUG - Network Policy Logits: [[-0.02680676  0.02103646  0.04881021 -0.03084387  0.01708537  0.02889446
  -0.00216412  0.00699233  0.03459829  0.03589744 -0.01103925  0.04089269
  -0.02762297 -0.04221005  0.01643774  0.018941    0.00520493 -0.05563957
   0.02051804 -0.01563234]]
2024-10-22 17:00:31,237 - DEBUG - Network Policy after Softmax: [[0.04845504 0.05082963 0.05226115 0.04825981 0.05062919 0.05123062
  0.04966393 0.05012076 0.05152367 0.05159065 0.04922511 0.051849
  0.0484155  0.04771439 0.05059642 0.05072323 0.05003126 0.04707789
  0.05080329 0.04899953]]
2024-10-22 17:00:31,239 - DEBUG - Normalized Policy: [[0.        0.        0.5080924 0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.4919076 0.        0.        0.        0.        0.       ]]
2024-10-22 17:00:31,240 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color W), (Discard 2)) | P=0.5080924034118652
2024-10-22 17:00:31,241 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color W), (Reveal player +1 color B)) | P=0.49190759658813477
2024-10-22 17:00:31,241 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 color W)) | Value: 0.0
2024-10-22 17:00:31,241 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:31,241 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || X4|RYG4
XX || X2|RYG2
XX || WX|W135
XX || XX|RYGB12345
-----
B2 || B2|B2
W3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 R2}
2024-10-22 17:00:31,242 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:31,242 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:31,242 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:31,242 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 1.0 | U: 0.27777883410453796 | PUCT: 1.2777788639068604
2024-10-22 17:00:31,244 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.5792163014411926 | PUCT: 0.5792163014411926
2024-10-22 17:00:31,244 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 1.2777788639068604
2024-10-22 17:00:31,244 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:00:31,245 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 color Y)) | Q: 4.0 | U: 0.5101175904273987 | PUCT: 4.510117530822754
2024-10-22 17:00:31,245 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Discard 4)) | Q: 0.0 | U: 0.5499770641326904 | PUCT: 0.5499770641326904
2024-10-22 17:00:31,246 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 color W)) | Q: 0.0 | U: 0.5257006883621216 | PUCT: 0.5257006883621216
2024-10-22 17:00:31,246 - DEBUG - Selected Child: ((Discard 0), (Reveal player +1 color Y)) | PUCT: 4.510117530822754
2024-10-22 17:00:31,246 - DEBUG - Selected child for exploration: ((Discard 0), (Reveal player +1 color Y))
2024-10-22 17:00:31,246 - DEBUG - Node ((Discard 0), (Reveal player +1 color Y)) is a leaf node.
2024-10-22 17:00:31,246 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 color Y))']
2024-10-22 17:00:31,247 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:31,248 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 2
2024-10-22 17:00:31,475 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:31,476 - DEBUG - Network Policy Logits: [[-0.04171098  0.0149439   0.03391831 -0.05206437  0.01507886  0.04649555
   0.00022271 -0.00605764  0.02631338  0.0116241  -0.01702131  0.01692912
  -0.01245859 -0.01953525  0.02036677  0.03747024  0.00827993 -0.05725865
   0.03417435 -0.00759005]]
2024-10-22 17:00:31,476 - DEBUG - Network Policy after Softmax: [[0.04781298 0.05060002 0.05156929 0.04732051 0.05060685 0.05222199
  0.04986059 0.04954842 0.0511786  0.05043232 0.04900816 0.05070058
  0.04923229 0.04888511 0.05087516 0.05175279 0.05026395 0.04707535
  0.0515825  0.04947256]]
2024-10-22 17:00:31,478 - DEBUG - Normalized Policy: [[0.         0.         0.50338787 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.4966122  0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:31,479 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color Y), (Discard 2)) | P=0.5033878684043884
2024-10-22 17:00:31,480 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color Y), (Reveal player +1 color B)) | P=0.49661219120025635
2024-10-22 17:00:31,480 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 17:00:31,480 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:31,480 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': 'Y', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || X4|RGW4
XX || X2|RGW2
XX || YX|Y135
XX || XX|RGWB12345
-----
B2 || B2|B2
W3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 R2}
2024-10-22 17:00:31,480 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:31,481 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:31,481 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:31,481 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.8 | U: 0.23696734011173248 | PUCT: 1.036967396736145
2024-10-22 17:00:31,482 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.5929408669471741 | PUCT: 0.5929408669471741
2024-10-22 17:00:31,482 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 1.036967396736145
2024-10-22 17:00:31,482 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:00:31,482 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 color Y)) | Q: 2.0 | U: 0.3588242530822754 | PUCT: 2.3588242530822754
2024-10-22 17:00:31,483 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Discard 4)) | Q: 0.0 | U: 0.5802929401397705 | PUCT: 0.5802929401397705
2024-10-22 17:00:31,483 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 color W)) | Q: 0.0 | U: 0.5546784400939941 | PUCT: 0.5546784400939941
2024-10-22 17:00:31,483 - DEBUG - Selected Child: ((Discard 0), (Reveal player +1 color Y)) | PUCT: 2.3588242530822754
2024-10-22 17:00:31,484 - DEBUG - Selected child for exploration: ((Discard 0), (Reveal player +1 color Y))
2024-10-22 17:00:31,484 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 color Y), (Reveal player +1 color B))
2024-10-22 17:00:31,484 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 color Y))', '((Discard 0), (Reveal player +1 color Y), (Reveal player +1 color B))']
2024-10-22 17:00:31,485 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:31,486 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 2
2024-10-22 17:00:31,487 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 3
2024-10-22 17:00:31,693 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:31,693 - DEBUG - Network Policy Logits: [[-2.2232337e-03  1.2409120e-02 -4.1694278e-03 -2.1442723e-02
   4.4118147e-03  3.5732105e-02 -1.2700684e-02  8.7986118e-05
  -6.5544932e-03 -8.3556958e-03 -2.6503380e-02 -6.8702482e-02
  -2.0627890e-02 -3.1289935e-02  4.1119590e-02  2.4822127e-02
  -4.6614647e-02 -1.3022448e-03  2.3039779e-02 -1.6216910e-02]]
2024-10-22 17:00:31,693 - DEBUG - Network Policy after Softmax: [[0.05018502 0.05092474 0.05008744 0.0492297  0.05051911 0.05212642
  0.04966196 0.05030114 0.04996812 0.0498782  0.04898119 0.04695724
  0.04926983 0.0487473  0.05240801 0.05156081 0.04800596 0.05023126
  0.05146899 0.04948764]]
2024-10-22 17:00:31,695 - DEBUG - Normalized Policy: [[1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:31,696 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color Y), (Reveal player +1 color B), (Discard 0)) | P=1.0
2024-10-22 17:00:31,696 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 color Y), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:00:31,696 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:31,696 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'Y', 'rank': 1}, {'color': 'G', 'rank': 4}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'Y', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || BX|B1235
-----
B4 || B4|B4
Y4 || Y4|Y4
Y2 || Y2|Y2
G5 || XX|RGW135
Y3 || YX|Y12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 W2}
2024-10-22 17:00:31,696 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:31,696 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:31,696 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:31,696 - DEBUG - Best node chosen by MCTS: ((Discard 0),) | Visit Count: 6
2024-10-22 17:00:31,696 - INFO - Actual Game Score: 4
2024-10-22 17:00:31,696 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:31,696 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:31,697 - DEBUG - Policy Targets: [0.66666667 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.33333333 0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:31,697 - DEBUG - === End of Training Data ===
2024-10-22 17:00:31,697 - INFO - Chosen Action: (Discard 0) | Visit Count: 6
2024-10-22 17:00:33,241 - DEBUG - Not the current player's turn.
2024-10-22 17:00:33,242 - INFO - Agent state has been reset.
2024-10-22 17:00:33,242 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:33,242 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': 'Y', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || YX|Y135
XX || XX|RGWB12345
-----
B2 || B2|B2
W3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2}
2024-10-22 17:00:33,242 - INFO - Max Rollouts: 10
2024-10-22 17:00:33,242 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:33,242 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:33,242 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:33,453 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:33,453 - DEBUG - Network Policy Logits: [[-0.03515635  0.01846327  0.03100506 -0.03812082 -0.00016085  0.05079027
   0.00550914  0.00515115  0.03220358 -0.00578996 -0.01518873  0.00637217
   0.00650673 -0.01919871  0.02489287  0.03271539  0.00629156 -0.08248462
   0.03283636 -0.03063959]]
2024-10-22 17:00:33,454 - DEBUG - Network Policy after Softmax: [[0.04818744 0.05084176 0.05148342 0.0480448  0.04990364 0.05251217
  0.05018739 0.05016943 0.05154516 0.04962351 0.0491593  0.05023073
  0.05023748 0.04896256 0.0511697  0.05157155 0.05022667 0.04595994
  0.05157778 0.04840558]]
2024-10-22 17:00:33,455 - DEBUG - Normalized Policy: [[0.         0.         0.         0.48425177 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.51574826 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:33,455 - DEBUG - Dirichlet Noise Added: [0.        0.        0.        0.6131888 0.        0.        0.
 0.        0.        0.        0.        0.        0.        0.
 0.3868112 0.        0.        0.        0.        0.       ]
2024-10-22 17:00:33,456 - DEBUG - Added Child Node: ((Discard 3),) | P=0.6131888031959534
2024-10-22 17:00:33,457 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.38681119680404663
2024-10-22 17:00:33,457 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:33,457 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:33,457 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': 'Y', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || YX|Y135
XX || XX|RGWB12345
-----
B2 || B2|B2
W3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2}
2024-10-22 17:00:33,457 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:33,457 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:33,457 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:33,458 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:00:33,458 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:00:33,458 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:33,665 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:33,665 - DEBUG - Network Policy Logits: [[ 0.01207836  0.01165576 -0.01682004 -0.06448507  0.00535342  0.04520281
   0.03124178  0.00698865 -0.00584357  0.00197487 -0.01064836 -0.05634355
  -0.03222161 -0.0278136   0.04423793 -0.00666957 -0.02719587 -0.00328781
   0.012319   -0.02237732]]
2024-10-22 17:00:33,666 - DEBUG - Network Policy after Softmax: [[0.0508479  0.05082642 0.04939951 0.04710012 0.0505071  0.05256042
  0.05183171 0.05058976 0.04994472 0.05033675 0.04970533 0.04748514
  0.04864451 0.0488594  0.05250973 0.04990349 0.0488896  0.05007254
  0.05086014 0.04912574]]
2024-10-22 17:00:33,668 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.336454   0.
  0.         0.         0.         0.         0.33111298 0.
  0.         0.         0.         0.33243304 0.         0.
  0.         0.        ]]
2024-10-22 17:00:33,669 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R)) | P=0.33111298084259033
2024-10-22 17:00:33,670 - DEBUG - Added Child Node: ((Discard 3), (Discard 4)) | P=0.33645400404930115
2024-10-22 17:00:33,671 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1)) | P=0.3324330449104309
2024-10-22 17:00:33,671 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:00:33,671 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:33,671 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 25, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R1 || XX|RGWB12345
B1 || XX|RYGWB12345
Deck size: 25
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y5}
2024-10-22 17:00:33,671 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:33,672 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:33,672 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:33,672 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:00:33,672 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:00:33,673 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:33,895 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:33,895 - DEBUG - Network Policy Logits: [[-0.00212087  0.02624221 -0.0190561  -0.01869934 -0.00528245  0.01691024
   0.03547361  0.00631785 -0.02118014  0.00782544  0.00381327 -0.06023186
   0.00099624 -0.01597292  0.04407921  0.01617056 -0.01421626 -0.0119558
   0.0288887   0.00020354]]
2024-10-22 17:00:33,895 - DEBUG - Network Policy after Softmax: [[0.04983526 0.05126898 0.0489984  0.04901588 0.04967795 0.05079276
  0.05174446 0.05025759 0.04889444 0.05033341 0.05013187 0.04702182
  0.04999085 0.0491497  0.05219167 0.05075521 0.04923612 0.04934754
  0.05140484 0.04995124]]
2024-10-22 17:00:33,896 - DEBUG - Normalized Policy: [[0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:33,897 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1)) | P=1.0
2024-10-22 17:00:33,897 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:00:33,897 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:33,898 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': 'Y', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || BX|B1235
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
Y3 || YX|Y135
G5 || XX|RGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2}
2024-10-22 17:00:33,898 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:33,898 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:33,898 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:33,898 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.9024682641029358 | PUCT: 0.9024682641029358
2024-10-22 17:00:33,899 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.5692942142486572 | PUCT: 0.5692942142486572
2024-10-22 17:00:33,899 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.9024682641029358
2024-10-22 17:00:33,899 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:33,899 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4))
2024-10-22 17:00:33,899 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))']
2024-10-22 17:00:33,900 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:33,901 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:34,118 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:34,119 - DEBUG - Network Policy Logits: [[-0.01349491  0.02545952  0.04523209 -0.04830899 -0.0266813   0.05025401
   0.01649997  0.02382213  0.01599438  0.06736106 -0.01488107  0.01105233
  -0.02422252 -0.02392118  0.03162421  0.01886029 -0.00350948 -0.07995889
  -0.00518069 -0.03029255]]
2024-10-22 17:00:34,119 - DEBUG - Network Policy after Softmax: [[0.04921207 0.05116693 0.0521887  0.04752828 0.0485674  0.05245144
  0.05071054 0.05108321 0.05068491 0.05335645 0.04914391 0.05043504
  0.04868696 0.04870164 0.05148333 0.05083038 0.04970594 0.04604757
  0.04962294 0.04839233]]
2024-10-22 17:00:34,120 - DEBUG - Normalized Policy: [[0.5026065  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.49739343 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:34,121 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 color W)) | P=0.4973934292793274
2024-10-22 17:00:34,122 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Discard 0)) | P=0.5026065111160278
2024-10-22 17:00:34,122 - DEBUG - Simulating Node: ((Discard 3), (Discard 4)) | Value: 0.0
2024-10-22 17:00:34,122 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:34,122 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
W3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
Y1 || XX|RYGWB12345
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 B3}
2024-10-22 17:00:34,122 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:34,123 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:34,123 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:34,123 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.6482612490653992 | PUCT: 0.6482612490653992
2024-10-22 17:00:34,124 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.6134033799171448 | PUCT: 0.6134033799171448
2024-10-22 17:00:34,124 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.6482612490653992
2024-10-22 17:00:34,124 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:34,124 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 1))
2024-10-22 17:00:34,124 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 1))']
2024-10-22 17:00:34,125 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:34,125 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:34,333 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:34,334 - DEBUG - Network Policy Logits: [[-0.02419976  0.01946082  0.03151961 -0.02683191  0.00437478  0.04230233
  -0.01969166  0.02569942  0.05843373  0.03536836 -0.01622503  0.00833132
  -0.02391021 -0.02363303  0.03550429  0.01315432 -0.01053409 -0.06444586
  -0.0079593  -0.01249147]]
2024-10-22 17:00:34,334 - DEBUG - Network Policy after Softmax: [[0.04867547 0.05084774 0.05146461 0.04854751 0.05008641 0.05202255
  0.0488954  0.05116595 0.05286855 0.05166307 0.04906519 0.05028497
  0.04868956 0.04870306 0.0516701  0.05052808 0.04934521 0.04675537
  0.04947243 0.04924872]]
2024-10-22 17:00:34,336 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.32646686 0.
  0.         0.         0.         0.33674365 0.         0.
  0.         0.         0.33678946 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:34,336 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Play 4)) | P=0.33674365282058716
2024-10-22 17:00:34,337 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Discard 4)) | P=0.3264668583869934
2024-10-22 17:00:34,337 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.33678945899009705
2024-10-22 17:00:34,338 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:00:34,338 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:34,338 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 25, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB2345
XX || X1|RYGWB1
-----
B2 || B2|B2
W3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
Deck size: 25
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3}
2024-10-22 17:00:34,338 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:34,338 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:34,338 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:34,339 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5129961371421814 | PUCT: 0.5129961371421814
2024-10-22 17:00:34,339 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.6472154855728149 | PUCT: 0.6472154855728149
2024-10-22 17:00:34,339 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.6472154855728149
2024-10-22 17:00:34,339 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:34,339 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Discard 1))
2024-10-22 17:00:34,339 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Discard 1))']
2024-10-22 17:00:34,340 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:34,340 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:34,560 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:34,560 - DEBUG - Network Policy Logits: [[-0.00125254  0.01492394  0.00563108 -0.0555448   0.01199854  0.05165032
   0.02832591  0.0064316  -0.0029203   0.00555186 -0.02987288 -0.00346926
  -0.00027872 -0.02110562  0.01314041  0.01710618 -0.01855482 -0.04199718
   0.02771538 -0.05007347]]
2024-10-22 17:00:34,561 - DEBUG - Network Policy after Softmax: [[0.05002624 0.05084207 0.05037178 0.04738261 0.05069355 0.05274402
  0.05152803 0.05041213 0.04994288 0.0503678  0.04861476 0.04991547
  0.05007498 0.04904286 0.05075147 0.05095313 0.04916811 0.0480289
  0.05149659 0.04764257]]
2024-10-22 17:00:34,562 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32655105 0.         0.
  0.         0.         0.         0.         0.         0.
  0.34510627 0.         0.         0.         0.         0.
  0.         0.32834265]]
2024-10-22 17:00:34,563 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1), (Discard 3)) | P=0.32655104994773865
2024-10-22 17:00:34,563 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1), (Reveal player +1 rank 5)) | P=0.32834264636039734
2024-10-22 17:00:34,564 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1), (Reveal player +1 color G)) | P=0.3451062738895416
2024-10-22 17:00:34,564 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Discard 1)) | Value: 0.0
2024-10-22 17:00:34,564 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:34,564 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 25, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': 'Y', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || YX|Y135
XX || XX|RGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || BX|B1235
G5 || XX|RYGWB12345
Deck size: 25
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 W3}
2024-10-22 17:00:34,564 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:34,564 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:34,564 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:34,565 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5346081852912903 | PUCT: 0.5346081852912903
2024-10-22 17:00:34,565 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.44965478777885437 | PUCT: 0.44965478777885437
2024-10-22 17:00:34,565 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.5346081852912903
2024-10-22 17:00:34,565 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:34,565 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 color R))
2024-10-22 17:00:34,565 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 color R))']
2024-10-22 17:00:34,566 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:34,566 - DEBUG - Illegal move encountered: (Reveal player +1 color R)
2024-10-22 17:00:34,567 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:34,567 - DEBUG - Rollout #7 completed with reward=4
2024-10-22 17:00:34,567 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:34,568 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 1.0 | U: 0.4421173632144928 | PUCT: 1.4421173334121704
2024-10-22 17:00:34,568 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4648267924785614 | PUCT: 0.4648267924785614
2024-10-22 17:00:34,568 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 1.4421173334121704
2024-10-22 17:00:34,568 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:34,569 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.5335471630096436 | PUCT: 0.5335471630096436
2024-10-22 17:00:34,569 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.527170717716217 | PUCT: 0.527170717716217
2024-10-22 17:00:34,570 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 color R)) | Q: 4.0 | U: 0.5250774025917053 | PUCT: 4.5250773429870605
2024-10-22 17:00:34,570 - DEBUG - Selected Child: ((Discard 3), (Reveal player +1 color R)) | PUCT: 4.5250773429870605
2024-10-22 17:00:34,570 - DEBUG - Selected child for exploration: ((Discard 3), (Reveal player +1 color R))
2024-10-22 17:00:34,570 - DEBUG - Node ((Discard 3), (Reveal player +1 color R)) is a leaf node.
2024-10-22 17:00:34,570 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 color R))']
2024-10-22 17:00:34,571 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:34,571 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:00:34,803 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:34,804 - DEBUG - Network Policy Logits: [[-0.01337741  0.02570738  0.03135877 -0.05067144 -0.01253641  0.04890405
   0.00716952  0.02613826  0.03625648  0.02947895 -0.01782024  0.0201151
  -0.03646163 -0.02135211  0.0420754   0.00228092  0.01910316 -0.0806421
  -0.01110847 -0.0462833 ]]
2024-10-22 17:00:34,804 - DEBUG - Network Policy after Softmax: [[0.04931119 0.05127667 0.05156727 0.04750604 0.04935268 0.05248002
  0.05033486 0.05129876 0.05182045 0.05147042 0.04909259 0.05099071
  0.04818591 0.04891951 0.05212287 0.0500894  0.05093914 0.04610338
  0.0494232  0.04771497]]
2024-10-22 17:00:34,805 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.48635045 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.5136496  0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:34,806 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R), (Discard 4)) | P=0.4863504469394684
2024-10-22 17:00:34,807 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R), (Reveal player +1 color B)) | P=0.513649582862854
2024-10-22 17:00:34,807 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:00:34,807 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:34,807 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 25, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || XX|GWB12345
XX || XX|YGWB12345
-----
B2 || B2|B2
W3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
Deck size: 25
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3}
2024-10-22 17:00:34,807 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:34,807 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:34,807 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:34,808 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.8 | U: 0.3787217140197754 | PUCT: 1.1787216663360596
2024-10-22 17:00:34,808 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4778097867965698 | PUCT: 0.4778097867965698
2024-10-22 17:00:34,808 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 1.1787216663360596
2024-10-22 17:00:34,808 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:34,809 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.5629574656486511 | PUCT: 0.5629574656486511
2024-10-22 17:00:34,809 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5562295317649841 | PUCT: 0.5562295317649841
2024-10-22 17:00:34,809 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 color R)) | Q: 2.0 | U: 0.3693472146987915 | PUCT: 2.369347095489502
2024-10-22 17:00:34,810 - DEBUG - Selected Child: ((Discard 3), (Reveal player +1 color R)) | PUCT: 2.369347095489502
2024-10-22 17:00:34,810 - DEBUG - Selected child for exploration: ((Discard 3), (Reveal player +1 color R))
2024-10-22 17:00:34,810 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 color R), (Discard 4))
2024-10-22 17:00:34,810 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 color R))', '((Discard 3), (Reveal player +1 color R), (Discard 4))']
2024-10-22 17:00:34,810 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:34,811 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:00:34,812 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:00:35,058 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:35,058 - DEBUG - Network Policy Logits: [[ 0.03246465  0.00398524 -0.01158809 -0.0797051  -0.01043046  0.04531155
   0.02317126  0.0214863  -0.01100213  0.00721328 -0.00195489 -0.05929582
  -0.01961077 -0.03025146  0.04103112 -0.00870481 -0.02724434 -0.01899768
   0.01132702 -0.03639873]]
2024-10-22 17:00:35,058 - DEBUG - Network Policy after Softmax: [[0.05195976 0.05050084 0.04972047 0.04644644 0.04977806 0.05263158
  0.05147911 0.05139244 0.04974961 0.05066413 0.05020175 0.04740411
  0.04932318 0.04880112 0.05240678 0.04986404 0.0489481  0.04935342
  0.05087298 0.04850205]]
2024-10-22 17:00:35,060 - DEBUG - Normalized Policy: [[0.         0.33056423 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34303993 0.32639587 0.         0.
  0.         0.        ]]
2024-10-22 17:00:35,061 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R), (Discard 4), (Discard 1)) | P=0.3305642306804657
2024-10-22 17:00:35,061 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R), (Discard 4), (Reveal player +1 rank 1)) | P=0.3263958692550659
2024-10-22 17:00:35,062 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R), (Discard 4), (Reveal player +1 color B)) | P=0.34303992986679077
2024-10-22 17:00:35,062 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 color R), (Discard 4)) | Value: 0.0
2024-10-22 17:00:35,062 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:35,062 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || R2|R2
B1 || XX|GWB12345
G3 || XX|RYGWB12345
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y5 G3}
2024-10-22 17:00:35,062 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:35,062 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:35,062 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:35,063 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.6666666666666666 | U: 0.3323104679584503 | PUCT: 0.9989771842956543
2024-10-22 17:00:35,064 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.48913148045539856 | PUCT: 0.48913148045539856
2024-10-22 17:00:35,064 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.9989771842956543
2024-10-22 17:00:35,064 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:35,064 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.5866743922233582 | PUCT: 0.5866743922233582
2024-10-22 17:00:35,065 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5796629786491394 | PUCT: 0.5796629786491394
2024-10-22 17:00:35,065 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 color R)) | Q: 1.3333333333333333 | U: 0.2886806130409241 | PUCT: 1.622014045715332
2024-10-22 17:00:35,065 - DEBUG - Selected Child: ((Discard 3), (Reveal player +1 color R)) | PUCT: 1.622014045715332
2024-10-22 17:00:35,065 - DEBUG - Selected child for exploration: ((Discard 3), (Reveal player +1 color R))
2024-10-22 17:00:35,066 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 color R), (Reveal player +1 color B))
2024-10-22 17:00:35,066 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 color R))', '((Discard 3), (Reveal player +1 color R), (Reveal player +1 color B))']
2024-10-22 17:00:35,066 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:35,067 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:00:35,068 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 3
2024-10-22 17:00:35,296 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:35,297 - DEBUG - Network Policy Logits: [[ 0.01815646  0.0021974  -0.02641007 -0.05467491 -0.01572631  0.02687565
   0.01408436  0.01062256 -0.00921276  0.00092113 -0.00488099 -0.07592198
  -0.01680644 -0.03599271  0.03686248 -0.01528753 -0.0342054  -0.02121682
   0.03395768 -0.02312746]]
2024-10-22 17:00:35,297 - DEBUG - Network Policy after Softmax: [[0.05138127 0.05056778 0.04914166 0.04777213 0.0496695  0.05183123
  0.05117247 0.05099563 0.04999408 0.05050329 0.05021111 0.04676782
  0.04961587 0.04867301 0.05235146 0.04969129 0.04876008 0.04939753
  0.05219961 0.04930324]]
2024-10-22 17:00:35,298 - DEBUG - Normalized Policy: [[0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:35,300 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R), (Reveal player +1 color B), (Discard 1)) | P=1.0
2024-10-22 17:00:35,300 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 color R), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:00:35,300 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:35,300 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 25, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || BX|B1235
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || R2|R2
B4 || XX|GWB12345
G3 || XX|YGWB12345
Deck size: 25
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y5}
2024-10-22 17:00:35,300 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:35,300 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:35,300 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:35,300 - DEBUG - Best node chosen by MCTS: ((Discard 3),) | Visit Count: 7
2024-10-22 17:00:35,300 - INFO - Actual Game Score: 4
2024-10-22 17:00:35,301 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:35,301 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:35,301 - DEBUG - Policy Targets: [0.         0.         0.         0.77777778 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.22222222 0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:35,301 - DEBUG - === End of Training Data ===
2024-10-22 17:00:35,301 - INFO - Chosen Action: (Discard 3) | Visit Count: 7
2024-10-22 17:00:36,794 - DEBUG - Not the current player's turn.
2024-10-22 17:00:36,795 - INFO - Agent state has been reset.
2024-10-22 17:00:36,795 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:36,795 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
Y3 || XX|RYGWB12345
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3}
2024-10-22 17:00:36,795 - INFO - Max Rollouts: 10
2024-10-22 17:00:36,795 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:36,796 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:36,796 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:37,009 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:37,010 - DEBUG - Network Policy Logits: [[ 0.00256226  0.0015635   0.03313792 -0.04850746 -0.0323872   0.04887681
   0.035598    0.03020266  0.02141346  0.0497124  -0.00172265  0.0106893
  -0.02911928 -0.01342149  0.04185252  0.02176642 -0.02084871 -0.05720982
   0.00408711 -0.06612296]]
2024-10-22 17:00:37,010 - DEBUG - Network Policy after Softmax: [[0.05001867 0.04996873 0.05157164 0.04752836 0.04830074 0.05238974
  0.05169867 0.05142049 0.05097052 0.05243354 0.0498048  0.05042683
  0.04845884 0.04922554 0.05202303 0.05098852 0.04886128 0.04711655
  0.050095   0.04669845]]
2024-10-22 17:00:37,012 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3275952  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.35284132 0.         0.         0.31956354
  0.         0.        ]]
2024-10-22 17:00:37,013 - DEBUG - Dirichlet Noise Added: [0.        0.        0.        0.        0.2456964 0.        0.
 0.        0.        0.        0.        0.        0.        0.
 0.2648862 0.        0.        0.4894174 0.        0.       ]
2024-10-22 17:00:37,013 - DEBUG - Added Child Node: ((Discard 4),) | P=0.24569639563560486
2024-10-22 17:00:37,014 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.26488620042800903
2024-10-22 17:00:37,015 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.4894174039363861
2024-10-22 17:00:37,015 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:37,015 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:37,015 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
Y3 || XX|RYGWB12345
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3}
2024-10-22 17:00:37,015 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:37,015 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:37,015 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:37,016 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:00:37,016 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:00:37,016 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:37,229 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:37,229 - DEBUG - Network Policy Logits: [[-0.00351885  0.00871767  0.00283452 -0.09376685 -0.01960624  0.06740431
   0.03551251  0.02356834 -0.01373674  0.06382981 -0.00128767 -0.03940277
  -0.04890705 -0.03538831  0.02948868  0.01084448 -0.02192699 -0.04529605
   0.01700861 -0.02873693]]
2024-10-22 17:00:37,229 - DEBUG - Network Policy after Softmax: [[0.0500184  0.05063421 0.0503372  0.04570203 0.04922017 0.05369468
  0.05200928 0.05139177 0.04950992 0.0535031  0.05013012 0.04825536
  0.0477989  0.04844947 0.05169693 0.05074201 0.04910607 0.04797181
  0.05105576 0.0487728 ]]
2024-10-22 17:00:37,231 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33094662 0.
  0.         0.         0.         0.         0.         0.
  0.         0.3257646  0.         0.         0.         0.
  0.34328875 0.        ]]
2024-10-22 17:00:37,231 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color W)) | P=0.32576459646224976
2024-10-22 17:00:37,232 - DEBUG - Added Child Node: ((Discard 4), (Discard 4)) | P=0.3309466242790222
2024-10-22 17:00:37,233 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4)) | P=0.34328874945640564
2024-10-22 17:00:37,233 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:00:37,233 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:37,233 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 13, 14, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
XX || XX|RYGWB12345
-----
B4 || B4|B4
Y4 || Y4|Y4
W2 || X2|RGW2
W4 || XX|RGWB12345
W4 || XX|RYGWB12345
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 G3}
2024-10-22 17:00:37,234 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:37,234 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:37,234 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:37,234 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:00:37,234 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:00:37,235 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:37,437 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:37,437 - DEBUG - Network Policy Logits: [[ 0.00388827 -0.00398479  0.01245845 -0.06492575  0.01098263  0.04406847
   0.01046718  0.03092049 -0.00614644  0.04981845 -0.00324982 -0.05819679
  -0.0201884  -0.01317612  0.03847147  0.01142249 -0.05202113 -0.04660001
   0.00473143 -0.013741  ]]
2024-10-22 17:00:37,437 - DEBUG - Network Policy after Softmax: [[0.05033246 0.04993775 0.05076568 0.04698537 0.05069081 0.05239601
  0.05066469 0.05171162 0.04982992 0.05269816 0.04997447 0.0473026
  0.0491351  0.04948086 0.05210357 0.05071311 0.04759563 0.04785435
  0.05037493 0.04945292]]
2024-10-22 17:00:37,439 - DEBUG - Normalized Policy: [[0.         0.         0.         0.31890213 0.         0.
  0.         0.         0.         0.         0.33918995 0.
  0.         0.         0.         0.         0.         0.
  0.34190795 0.        ]]
2024-10-22 17:00:37,440 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color R)) | P=0.33918994665145874
2024-10-22 17:00:37,441 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3)) | P=0.3189021348953247
2024-10-22 17:00:37,441 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 4)) | P=0.34190794825553894
2024-10-22 17:00:37,442 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:00:37,442 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:37,442 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || XX|RYWB125
XX || X3|RYGWB3
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R4 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3}
2024-10-22 17:00:37,442 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:37,442 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:37,442 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:37,442 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:00:37,442 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:00:37,443 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:37,645 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:37,645 - DEBUG - Network Policy Logits: [[ 0.00802359  0.01060817  0.00571803 -0.06356244 -0.01168196  0.03009388
   0.01887135  0.0242936  -0.00027332  0.06530322 -0.01630364 -0.03687999
  -0.04086609 -0.02317455  0.02219001  0.03174669 -0.03519144 -0.02387916
   0.02644111 -0.03595341]]
2024-10-22 17:00:37,646 - DEBUG - Network Policy after Softmax: [[0.05049033 0.050621   0.05037405 0.04700226 0.04950513 0.05161705
  0.05104101 0.05131853 0.05007315 0.05346683 0.04927686 0.04827328
  0.04808124 0.04893944 0.05121069 0.05170244 0.04835486 0.04890497
  0.05142885 0.04831803]]
2024-10-22 17:00:37,648 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.32971102 0.
  0.         0.         0.         0.         0.         0.
  0.         0.3259435  0.         0.34434542 0.         0.
  0.         0.        ]]
2024-10-22 17:00:37,648 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color W)) | P=0.3259434998035431
2024-10-22 17:00:37,649 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 4)) | P=0.32971101999282837
2024-10-22 17:00:37,650 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | P=0.34434542059898376
2024-10-22 17:00:37,650 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:00:37,650 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:37,650 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 13, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || BX|B1235
XX || XX|RYGW12345
-----
B4 || B4|B4
Y4 || Y4|Y4
W2 || X2|RGW2
W4 || XX|RGWB12345
W1 || XX|RYGWB12345
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3}
2024-10-22 17:00:37,650 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:37,650 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:37,650 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:37,651 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3896242082118988 | PUCT: 0.3896242082118988
2024-10-22 17:00:37,652 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.7761158347129822 | PUCT: 0.7761158347129822
2024-10-22 17:00:37,652 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4200552701950073 | PUCT: 0.4200552701950073
2024-10-22 17:00:37,652 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.7761158347129822
2024-10-22 17:00:37,653 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:00:37,653 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Reveal player +1 rank 4))
2024-10-22 17:00:37,653 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 rank 4))']
2024-10-22 17:00:37,653 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:37,654 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:37,857 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:37,857 - DEBUG - Network Policy Logits: [[ 0.01058518  0.00771819  0.05362821 -0.03473845 -0.02669028  0.05410687
   0.02769558  0.01898901  0.03056843  0.0430806  -0.00496814  0.0316082
  -0.03189452 -0.02154281  0.01536818  0.01947181 -0.02720121 -0.04606437
  -0.01376571 -0.0512672 ]]
2024-10-22 17:00:37,857 - DEBUG - Network Policy after Softmax: [[0.05036833 0.05022413 0.05258367 0.04813641 0.04852539 0.05260884
  0.05123756 0.0507934  0.05138498 0.05203195 0.04959099 0.05143843
  0.0482735  0.04877581 0.05060982 0.05081793 0.0485006  0.0475943
  0.04915662 0.04734732]]
2024-10-22 17:00:37,859 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.32227015 0.
  0.         0.         0.         0.         0.         0.34161645
  0.         0.         0.3361134  0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:37,859 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 4), (Discard 4)) | P=0.32227015495300293
2024-10-22 17:00:37,860 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 4), (Reveal player +1 color Y)) | P=0.3416164517402649
2024-10-22 17:00:37,861 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 4), (Reveal player +1 color B)) | P=0.3361133933067322
2024-10-22 17:00:37,861 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:00:37,861 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:37,861 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB1235
XX || XX|RYGWB1235
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB125
Y3 || X3|RYGWB3
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3}
2024-10-22 17:00:37,861 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:37,861 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:37,861 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:37,862 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4111011326313019 | PUCT: 0.4111011326313019
2024-10-22 17:00:37,863 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.545931339263916 | PUCT: 0.545931339263916
2024-10-22 17:00:37,863 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.44320961833000183 | PUCT: 0.44320961833000183
2024-10-22 17:00:37,863 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.545931339263916
2024-10-22 17:00:37,863 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:00:37,863 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Discard 3))
2024-10-22 17:00:37,863 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Discard 3))']
2024-10-22 17:00:37,864 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:37,865 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:38,068 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:38,068 - DEBUG - Network Policy Logits: [[ 0.01023782  0.03429731  0.02677193 -0.0478673  -0.00303356  0.04017393
   0.01370145  0.02789762 -0.00647384  0.04260173 -0.01164593  0.01405124
  -0.04325211 -0.01809835  0.02766009  0.01201628 -0.02052542 -0.06084803
   0.00703335 -0.05258391]]
2024-10-22 17:00:38,069 - DEBUG - Network Policy after Softmax: [[0.05051043 0.05174043 0.05135252 0.04765916 0.04984452 0.05204538
  0.05068569 0.05141036 0.04967334 0.05217189 0.04941708 0.05070342
  0.04787962 0.04909925 0.05139815 0.05060034 0.04898023 0.0470445
  0.05034883 0.0474349 ]]
2024-10-22 17:00:38,071 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.49572888 0.
  0.         0.         0.         0.         0.         0.5042711
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:38,071 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3), (Discard 4)) | P=0.49572888016700745
2024-10-22 17:00:38,072 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3), (Reveal player +1 color Y)) | P=0.5042710900306702
2024-10-22 17:00:38,072 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Discard 3)) | Value: 0.0
2024-10-22 17:00:38,072 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:38,072 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
Y3 || X3|RYGWB3
W1 || XX|RYGWB12345
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 W1}
2024-10-22 17:00:38,072 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:38,072 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:38,072 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:38,073 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.42842045426368713 | PUCT: 0.42842045426368713
2024-10-22 17:00:38,074 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4266982078552246 | PUCT: 0.4266982078552246
2024-10-22 17:00:38,075 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4618816673755646 | PUCT: 0.4618816673755646
2024-10-22 17:00:38,075 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.4618816673755646
2024-10-22 17:00:38,075 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:38,075 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 color W))
2024-10-22 17:00:38,075 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 color W))']
2024-10-22 17:00:38,076 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:38,076 - DEBUG - Illegal move encountered: (Reveal player +1 color W)
2024-10-22 17:00:38,076 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:38,076 - DEBUG - Rollout #7 completed with reward=4
2024-10-22 17:00:38,076 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:38,077 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.44287601113319397 | PUCT: 0.44287601113319397
2024-10-22 17:00:38,077 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.44109565019607544 | PUCT: 0.44109565019607544
2024-10-22 17:00:38,078 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 2.0 | U: 0.31831082701683044 | PUCT: 2.3183107376098633
2024-10-22 17:00:38,078 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 2.3183107376098633
2024-10-22 17:00:38,078 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:38,079 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Discard 4))
2024-10-22 17:00:38,079 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Discard 4))']
2024-10-22 17:00:38,079 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:38,080 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:38,285 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:38,286 - DEBUG - Network Policy Logits: [[ 0.01470117  0.02929052  0.0258926  -0.06173066 -0.01802262  0.05586698
   0.0371502   0.0267661  -0.00611759  0.05184287 -0.01788288  0.0039287
  -0.02988362 -0.01764926  0.02382172  0.01756426 -0.0142254  -0.05132516
  -0.00586971 -0.06091519]]
2024-10-22 17:00:38,286 - DEBUG - Network Policy after Softmax: [[0.05070351 0.05144867 0.05127415 0.04697255 0.04907116 0.05283432
  0.05185463 0.05131895 0.04965885 0.05262214 0.04907802 0.05016024
  0.04849257 0.04908948 0.05116808 0.05084889 0.04925785 0.04746388
  0.04967115 0.04701087]]
2024-10-22 17:00:38,288 - DEBUG - Normalized Policy: [[0.         0.         0.26397118 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.24965096 0.         0.         0.         0.         0.24435501
  0.         0.24202284]]
2024-10-22 17:00:38,288 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 4), (Discard 2)) | P=0.2639711797237396
2024-10-22 17:00:38,289 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 4), (Reveal player +1 rank 5)) | P=0.24202284216880798
2024-10-22 17:00:38,290 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 4), (Reveal player +1 rank 3)) | P=0.2443550080060959
2024-10-22 17:00:38,290 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 4), (Reveal player +1 color G)) | P=0.2496509552001953
2024-10-22 17:00:38,290 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Discard 4)) | Value: 0.0
2024-10-22 17:00:38,290 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:38,291 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || BX|B1235
G3 || XX|RYGWB12345
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 R1}
2024-10-22 17:00:38,291 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:38,291 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:38,291 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:38,292 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4552459120750427 | PUCT: 0.4552459120750427
2024-10-22 17:00:38,292 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.45341581106185913 | PUCT: 0.45341581106185913
2024-10-22 17:00:38,293 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 1.3333333333333333 | U: 0.24540114402770996 | PUCT: 1.5787345170974731
2024-10-22 17:00:38,293 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 1.5787345170974731
2024-10-22 17:00:38,293 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:38,293 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 rank 1))
2024-10-22 17:00:38,293 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 rank 1))']
2024-10-22 17:00:38,294 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:38,294 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:00:38,294 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:38,294 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:00:38,294 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:38,295 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4660329818725586 | PUCT: 0.4660329818725586
2024-10-22 17:00:38,296 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4641595184803009 | PUCT: 0.4641595184803009
2024-10-22 17:00:38,296 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 2.0 | U: 0.2009727507829666 | PUCT: 2.20097279548645
2024-10-22 17:00:38,296 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 2.20097279548645
2024-10-22 17:00:38,296 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:38,297 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Reveal player +1 color W)) | Q: 4.0 | U: 0.516879677772522 | PUCT: 4.516879558563232
2024-10-22 17:00:38,297 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Discard 4)) | Q: 0.0 | U: 0.5228541493415833 | PUCT: 0.5228541493415833
2024-10-22 17:00:38,298 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.5460613369941711 | PUCT: 4.5460615158081055
2024-10-22 17:00:38,298 - DEBUG - Selected Child: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | PUCT: 4.5460615158081055
2024-10-22 17:00:38,298 - DEBUG - Selected child for exploration: ((Reveal player +1 color B), (Reveal player +1 rank 1))
2024-10-22 17:00:38,298 - DEBUG - Node ((Reveal player +1 color B), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:00:38,298 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 rank 1))']
2024-10-22 17:00:38,299 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:38,299 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:38,512 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:38,513 - DEBUG - Network Policy Logits: [[-0.00060473  0.01299723  0.02813967 -0.06477321 -0.0103891   0.03405891
   0.03505209  0.02036377  0.00421088  0.00717706 -0.01208742 -0.02032067
  -0.00995867 -0.00076273  0.01429234  0.02092187 -0.01419482 -0.03363549
   0.00491525 -0.0629826 ]]
2024-10-22 17:00:38,513 - DEBUG - Network Policy after Softmax: [[0.0500706  0.05075631 0.05153073 0.04695856 0.04958308 0.05183666
  0.05188817 0.05113159 0.0503123  0.05046175 0.04949894 0.04909308
  0.04960442 0.05006269 0.05082209 0.05116013 0.04939474 0.04844374
  0.05034775 0.04704272]]
2024-10-22 17:00:38,515 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24361491 0.         0.
  0.         0.         0.2610137  0.         0.         0.
  0.         0.         0.         0.         0.         0.25131986
  0.         0.24405153]]
2024-10-22 17:00:38,516 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 1), (Discard 3)) | P=0.24361491203308105
2024-10-22 17:00:38,517 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 1), (Reveal player +1 rank 5)) | P=0.24405153095722198
2024-10-22 17:00:38,518 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 1), (Play 3)) | P=0.2610136866569519
2024-10-22 17:00:38,518 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 1), (Reveal player +1 rank 3)) | P=0.25131985545158386
2024-10-22 17:00:38,518 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:00:38,518 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:38,519 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || X1|RGWB1
XX || XX|RYGWB2345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || BX|B1235
Y3 || XX|RYGW12345
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3}
2024-10-22 17:00:38,519 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:38,519 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:38,519 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:38,519 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color B),) | Visit Count: 5
2024-10-22 17:00:38,519 - INFO - Actual Game Score: 4
2024-10-22 17:00:38,519 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:38,519 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:38,519 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.11111111 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.55555556 0.         0.         0.33333333
 0.         0.        ]
2024-10-22 17:00:38,520 - DEBUG - === End of Training Data ===
2024-10-22 17:00:38,520 - INFO - Chosen Action: (Reveal player +1 color B) | Visit Count: 5
2024-10-22 17:00:40,586 - DEBUG - Not the current player's turn.
2024-10-22 17:00:40,587 - INFO - Agent state has been reset.
2024-10-22 17:00:40,587 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:40,587 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || BX|B1235
Y1 || XX|RYGWB12345
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3}
2024-10-22 17:00:40,587 - INFO - Max Rollouts: 10
2024-10-22 17:00:40,587 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:40,587 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:40,587 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:40,776 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:40,776 - DEBUG - Network Policy Logits: [[ 0.02178342  0.02017561  0.02922645 -0.05636668 -0.00711979  0.040483
   0.04087995  0.04109666  0.01091358  0.03515372 -0.00282097  0.00588014
  -0.00288037 -0.02593788  0.01772421  0.01193574 -0.00125614 -0.05217299
   0.00547324 -0.05480024]]
2024-10-22 17:00:40,776 - DEBUG - Network Policy after Softmax: [[0.05088115 0.05079941 0.05126127 0.04705619 0.04943157 0.05184156
  0.05186214 0.05187338 0.05033108 0.05156602 0.04964453 0.05007838
  0.04964158 0.04851006 0.05067503 0.05038255 0.04972227 0.04725395
  0.050058   0.04712996]]
2024-10-22 17:00:40,777 - DEBUG - Normalized Policy: [[0.         0.5187352  0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.48126483]]
2024-10-22 17:00:40,778 - DEBUG - Dirichlet Noise Added: [0.         0.3969104  0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.60308963]
2024-10-22 17:00:40,778 - DEBUG - Added Child Node: ((Reveal player +1 rank 5),) | P=0.6030896306037903
2024-10-22 17:00:40,779 - DEBUG - Added Child Node: ((Discard 1),) | P=0.3969103991985321
2024-10-22 17:00:40,779 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:40,779 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:40,779 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || BX|B1235
Y1 || XX|RYGWB12345
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3}
2024-10-22 17:00:40,779 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:40,779 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:40,779 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:40,780 - DEBUG - Expanding unexplored child: ((Discard 1),)
2024-10-22 17:00:40,780 - DEBUG - Traversing Path: ['()', '((Discard 1),)']
2024-10-22 17:00:40,780 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:40,966 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:40,967 - DEBUG - Network Policy Logits: [[-0.00984636  0.01414445  0.00477925 -0.03803143 -0.02628996  0.05679471
   0.00295193  0.00623157  0.02042978  0.05310748 -0.01357212 -0.02978797
  -0.04960186  0.00656985  0.03040218  0.00763     0.00687753 -0.04559693
   0.04215189 -0.00704742]]
2024-10-22 17:00:40,967 - DEBUG - Network Policy after Softmax: [[0.04940866 0.05060835 0.05013661 0.04803552 0.04860285 0.0528135
  0.05004508 0.05020948 0.05092745 0.05261913 0.04922493 0.04843314
  0.04748293 0.05022646 0.05143785 0.05027974 0.05024192 0.04767348
  0.0520458  0.04954715]]
2024-10-22 17:00:40,968 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.24235155 0.
  0.         0.         0.         0.         0.         0.
  0.         0.25044748 0.2564879  0.2507131  0.         0.
  0.         0.        ]]
2024-10-22 17:00:40,969 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color W)) | P=0.25044748187065125
2024-10-22 17:00:40,970 - DEBUG - Added Child Node: ((Discard 1), (Discard 4)) | P=0.24235154688358307
2024-10-22 17:00:40,970 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1)) | P=0.2507131099700928
2024-10-22 17:00:40,971 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color B)) | P=0.2564879059791565
2024-10-22 17:00:40,971 - DEBUG - Simulating Node: ((Discard 1),) | Value: 0.0
2024-10-22 17:00:40,971 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:40,971 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || BX|B1235
XX || XX|RYGWB12345
-----
B4 || B4|B4
W2 || X2|RGW2
B4 || XX|RGWB12345
R1 || XX|RYGWB12345
B3 || XX|RYGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y4}
2024-10-22 17:00:40,971 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:40,971 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:40,971 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:40,972 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5),)
2024-10-22 17:00:40,972 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)']
2024-10-22 17:00:40,972 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:00:41,158 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:41,158 - DEBUG - Network Policy Logits: [[ 0.00132759  0.00944671 -0.00642602 -0.0802646  -0.01669623  0.04848721
   0.02064819  0.0113792  -0.00410078  0.03816818 -0.00972176 -0.04475003
  -0.03084422 -0.03645663  0.03647085  0.01164694 -0.02901509 -0.02132871
   0.0243239  -0.03437491]]
2024-10-22 17:00:41,158 - DEBUG - Network Policy after Softmax: [[0.0503233  0.05073355 0.04993463 0.04638036 0.04942441 0.05275338
  0.05130503 0.05083169 0.05005087 0.05221182 0.04977033 0.04805714
  0.04873008 0.04845735 0.05212327 0.0508453  0.04881929 0.04919598
  0.05149397 0.04855833]]
2024-10-22 17:00:41,160 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.24684924 0.
  0.         0.         0.         0.         0.         0.
  0.         0.24201928 0.         0.25394586 0.         0.
  0.2571856  0.        ]]
2024-10-22 17:00:41,160 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 color W)) | P=0.24201928079128265
2024-10-22 17:00:41,161 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4)) | P=0.24684923887252808
2024-10-22 17:00:41,161 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1)) | P=0.25394585728645325
2024-10-22 17:00:41,162 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 4)) | P=0.25718560814857483
2024-10-22 17:00:41,162 - DEBUG - Simulating Node: ((Reveal player +1 rank 5),) | Value: 0.0
2024-10-22 17:00:41,162 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:41,162 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 13, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || XX|RYGWB1234
-----
B4 || B4|B4
Y4 || Y4|Y4
W2 || X2|RGW2
B1 || XX|RGWB12345
W4 || XX|RYGWB12345
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3}
2024-10-22 17:00:41,162 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:41,162 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:41,162 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:41,163 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.5841578245162964 | PUCT: 0.5841578245162964
2024-10-22 17:00:41,164 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.8876047134399414 | PUCT: 0.8876047134399414
2024-10-22 17:00:41,164 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 0.8876047134399414
2024-10-22 17:00:41,164 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:00:41,164 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5), (Reveal player +1 color W))
2024-10-22 17:00:41,164 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Reveal player +1 color W))']
2024-10-22 17:00:41,165 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:00:41,165 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 2
2024-10-22 17:00:41,369 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:41,370 - DEBUG - Network Policy Logits: [[ 0.00730713  0.02178805  0.04889994 -0.06250004 -0.03486192  0.02942529
   0.0577972   0.02804125 -0.00264972  0.04468256 -0.0014295   0.00688494
  -0.02225662 -0.03530265 -0.00892513  0.00968961 -0.03104251 -0.04241064
  -0.00501865 -0.01180589]]
2024-10-22 17:00:41,370 - DEBUG - Network Policy after Softmax: [[0.05035088 0.05108532 0.05248928 0.0469559  0.04827178 0.05147696
  0.05295837 0.05140576 0.04985203 0.05226838 0.0499129  0.05032963
  0.04888411 0.04825051 0.04954017 0.05047099 0.0484565  0.04790876
  0.04973408 0.04939766]]
2024-10-22 17:00:41,371 - DEBUG - Normalized Policy: [[0.         0.5037257  0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.49627426
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:41,372 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 color W), (Reveal player +1 color Y)) | P=0.49627426266670227
2024-10-22 17:00:41,372 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 color W), (Discard 1)) | P=0.5037257075309753
2024-10-22 17:00:41,372 - DEBUG - Simulating Node: ((Reveal player +1 rank 5), (Reveal player +1 color W)) | Value: 0.0
2024-10-22 17:00:41,372 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:41,373 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || W2|W2
XX || XX|RGB12345
XX || XX|RYGB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
Y1 || XX|RYGWB1234
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3}
2024-10-22 17:00:41,373 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:41,373 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:41,373 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:41,373 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.629418671131134 | PUCT: 0.629418671131134
2024-10-22 17:00:41,374 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.6375844478607178 | PUCT: 0.6375844478607178
2024-10-22 17:00:41,374 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 0.6375844478607178
2024-10-22 17:00:41,374 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:00:41,374 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5), (Discard 4))
2024-10-22 17:00:41,374 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Discard 4))']
2024-10-22 17:00:41,375 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:00:41,375 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:41,609 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:41,609 - DEBUG - Network Policy Logits: [[ 0.00235745  0.0191103   0.04134349 -0.05239134 -0.00488506  0.04883595
   0.04338859  0.01850618 -0.00127649  0.05311835 -0.02565362 -0.0001346
  -0.0290247  -0.02943282  0.02825149  0.02899118 -0.00144689 -0.04752216
  -0.00801253 -0.04116424]]
2024-10-22 17:00:41,610 - DEBUG - Network Policy after Softmax: [[0.04998523 0.05082968 0.05197245 0.04732217 0.04962452 0.05236331
  0.05207884 0.05079898 0.04980392 0.05258803 0.04860452 0.04986082
  0.04844094 0.04842118 0.05129645 0.05133441 0.04979543 0.04755315
  0.04946956 0.04785645]]
2024-10-22 17:00:41,611 - DEBUG - Normalized Policy: [[0.        0.5067803 0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.4932197 0.       ]]
2024-10-22 17:00:41,612 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4), (Discard 1)) | P=0.5067803263664246
2024-10-22 17:00:41,613 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4), (Reveal player +1 rank 4)) | P=0.4932197034358978
2024-10-22 17:00:41,613 - DEBUG - Simulating Node: ((Reveal player +1 rank 5), (Discard 4)) | Value: 0.0
2024-10-22 17:00:41,613 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:41,613 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
Y4 || XX|RYGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 R2}
2024-10-22 17:00:41,613 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:41,613 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:41,613 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:41,614 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.6641135811805725 | PUCT: 0.6641135811805725
2024-10-22 17:00:41,615 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.504547119140625 | PUCT: 0.504547119140625
2024-10-22 17:00:41,615 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.6641135811805725
2024-10-22 17:00:41,615 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:41,615 - DEBUG - Expanding unexplored child: ((Discard 1), (Discard 4))
2024-10-22 17:00:41,615 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Discard 4))']
2024-10-22 17:00:41,616 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:41,616 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:41,801 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:41,801 - DEBUG - Network Policy Logits: [[ 0.03445482 -0.01720635  0.01299086 -0.0645103   0.00065098  0.05928069
   0.04463716  0.03043124 -0.01171899  0.05028212 -0.02591383 -0.02496629
  -0.05875291  0.00503756  0.03798314  0.01055184 -0.00840664 -0.05386309
   0.01674504 -0.03463253]]
2024-10-22 17:00:41,801 - DEBUG - Network Policy after Softmax: [[0.05171166 0.04910801 0.05061355 0.04683909 0.04999282 0.05301151
  0.05224089 0.05150401 0.04937822 0.05253663 0.04868226 0.04872841
  0.04710954 0.0502126  0.05189443 0.05049025 0.04954205 0.04734046
  0.05080392 0.04825966]]
2024-10-22 17:00:41,803 - DEBUG - Normalized Policy: [[0.25554794 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.2564512  0.24951202 0.         0.
  0.         0.2384889 ]]
2024-10-22 17:00:41,803 - DEBUG - Added Child Node: ((Discard 1), (Discard 4), (Reveal player +1 rank 5)) | P=0.23848889768123627
2024-10-22 17:00:41,804 - DEBUG - Added Child Node: ((Discard 1), (Discard 4), (Discard 0)) | P=0.2555479407310486
2024-10-22 17:00:41,804 - DEBUG - Added Child Node: ((Discard 1), (Discard 4), (Reveal player +1 rank 1)) | P=0.24951201677322388
2024-10-22 17:00:41,805 - DEBUG - Added Child Node: ((Discard 1), (Discard 4), (Reveal player +1 color B)) | P=0.25645118951797485
2024-10-22 17:00:41,805 - DEBUG - Simulating Node: ((Discard 1), (Discard 4)) | Value: 0.0
2024-10-22 17:00:41,805 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:41,805 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 3}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || BX|B1235
B1 || XX|RYGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y4 B3}
2024-10-22 17:00:41,805 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:41,805 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:41,805 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:41,806 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.4613947570323944 | PUCT: 0.4613947570323944
2024-10-22 17:00:41,807 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.52580326795578 | PUCT: 0.52580326795578
2024-10-22 17:00:41,807 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 0.52580326795578
2024-10-22 17:00:41,807 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:00:41,807 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5), (Reveal player +1 rank 4))
2024-10-22 17:00:41,807 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Reveal player +1 rank 4))']
2024-10-22 17:00:41,807 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:00:41,808 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:42,009 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:42,009 - DEBUG - Network Policy Logits: [[-0.00127519  0.0233556   0.03859451 -0.03044067 -0.02271769  0.01921772
   0.04124225  0.02409532 -0.00248773  0.03247898 -0.01654594 -0.02604423
   0.00156544 -0.00840663  0.00450909  0.00688402 -0.02522105 -0.03136055
  -0.01585015 -0.0226128 ]]
2024-10-22 17:00:42,009 - DEBUG - Network Policy after Softmax: [[0.04995045 0.05119605 0.0519822  0.04851466 0.04889079 0.05098464
  0.05212002 0.05123393 0.04988993 0.05166527 0.04919347 0.04872843
  0.05009255 0.0495955  0.05024022 0.05035968 0.04876855 0.04847006
  0.04922771 0.04889592]]
2024-10-22 17:00:42,011 - DEBUG - Normalized Policy: [[0.         0.51234746 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.48765254
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:42,011 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 4), (Reveal player +1 color Y)) | P=0.4876525402069092
2024-10-22 17:00:42,012 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 4), (Discard 1)) | P=0.5123474597930908
2024-10-22 17:00:42,012 - DEBUG - Simulating Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:00:42,012 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:42,012 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 3}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB1235
XX || X4|RYGWB4
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
Y1 || XX|RYGWB1234
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3}
2024-10-22 17:00:42,012 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:42,012 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:42,012 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:42,013 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.4769628942012787 | PUCT: 0.4769628942012787
2024-10-22 17:00:42,014 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.4348357319831848 | PUCT: 0.4348357319831848
2024-10-22 17:00:42,014 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.4769628942012787
2024-10-22 17:00:42,014 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:42,014 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:00:42,014 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 1))']
2024-10-22 17:00:42,015 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:42,015 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:42,206 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:42,206 - DEBUG - Network Policy Logits: [[ 0.03079926 -0.00549527  0.00031584 -0.06177474  0.01986427  0.00542975
   0.0512528  -0.0046658  -0.00763518  0.02762019 -0.0111221  -0.053957
  -0.02610156  0.02131399  0.0322541   0.0007763  -0.00037447 -0.04437598
   0.03095905 -0.04525253]]
2024-10-22 17:00:42,206 - DEBUG - Network Policy after Softmax: [[0.05164341 0.04980265 0.0500929  0.04707719 0.05108177 0.05034973
  0.05271058 0.04984397 0.04969619 0.0514795  0.0495232  0.04744667
  0.0487869  0.05115588 0.0517186  0.05011597 0.05005833 0.04790344
  0.05165167 0.04786148]]
2024-10-22 17:00:42,207 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3436623  0.
  0.         0.         0.3343405  0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.32199714]]
2024-10-22 17:00:42,208 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Reveal player +1 rank 5)) | P=0.32199713587760925
2024-10-22 17:00:42,208 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Play 3)) | P=0.33434051275253296
2024-10-22 17:00:42,209 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Discard 4)) | P=0.343662291765213
2024-10-22 17:00:42,209 - DEBUG - Simulating Node: ((Discard 1), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:00:42,209 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:42,209 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || X2|RGW2
XX || XX|RGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || BX|B1235
Y1 || XX|RYGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y4}
2024-10-22 17:00:42,209 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:42,210 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:42,210 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:42,210 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3677136301994324 | PUCT: 0.3677136301994324
2024-10-22 17:00:42,211 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.4469810426235199 | PUCT: 0.4469810426235199
2024-10-22 17:00:42,211 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 0.4469810426235199
2024-10-22 17:00:42,211 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:00:42,211 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5), (Reveal player +1 rank 1))
2024-10-22 17:00:42,211 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Reveal player +1 rank 1))']
2024-10-22 17:00:42,211 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:00:42,211 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:00:42,211 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:42,211 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:00:42,212 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:42,212 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.376426637172699 | PUCT: 0.376426637172699
2024-10-22 17:00:42,212 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.8 | U: 0.38131022453308105 | PUCT: 1.1813101768493652
2024-10-22 17:00:42,213 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 1.1813101768493652
2024-10-22 17:00:42,213 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:00:42,213 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Reveal player +1 color W)) | Q: 0.0 | U: 0.40494850277900696 | PUCT: 0.40494850277900696
2024-10-22 17:00:42,213 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Discard 4)) | Q: 0.0 | U: 0.41303008794784546 | PUCT: 0.41303008794784546
2024-10-22 17:00:42,214 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.4303249418735504 | PUCT: 0.4303249418735504
2024-10-22 17:00:42,214 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.4249041676521301 | PUCT: 4.4249043464660645
2024-10-22 17:00:42,214 - DEBUG - Selected Child: ((Reveal player +1 rank 5), (Reveal player +1 rank 1)) | PUCT: 4.4249043464660645
2024-10-22 17:00:42,215 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5), (Reveal player +1 rank 1))
2024-10-22 17:00:42,215 - DEBUG - Node ((Reveal player +1 rank 5), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:00:42,215 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Reveal player +1 rank 1))']
2024-10-22 17:00:42,216 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:00:42,216 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:42,428 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:42,428 - DEBUG - Network Policy Logits: [[ 0.00520097  0.01485184  0.03623544 -0.06462607 -0.0146942   0.00858447
   0.05295459  0.01035612 -0.00276459  0.01146573 -0.01071784 -0.02157158
  -0.00097102 -0.01945345  0.00855989  0.00353263 -0.01822791 -0.03322506
   0.00338525 -0.02948425]]
2024-10-22 17:00:42,429 - DEBUG - Network Policy after Softmax: [[0.05039785 0.05088659 0.05198644 0.04699877 0.04940508 0.05056866
  0.05286292 0.05065832 0.04999799 0.05071457 0.04960192 0.04906647
  0.05008775 0.04917051 0.05056741 0.05031383 0.04923081 0.04849799
  0.05030642 0.04867975]]
2024-10-22 17:00:42,430 - DEBUG - Normalized Policy: [[0.         0.33935466 0.         0.         0.         0.
  0.         0.         0.33342877 0.         0.         0.3272166
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:42,430 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1), (Play 3)) | P=0.3334287703037262
2024-10-22 17:00:42,431 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1), (Reveal player +1 color Y)) | P=0.32721659541130066
2024-10-22 17:00:42,432 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1), (Discard 1)) | P=0.33935466408729553
2024-10-22 17:00:42,432 - DEBUG - Simulating Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:00:42,432 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:42,432 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || X1|RGWB1
XX || XX|RYGWB2345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
Y1 || XX|RYGWB1234
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3}
2024-10-22 17:00:42,432 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:42,432 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:42,432 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:42,432 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 5),) | Visit Count: 6
2024-10-22 17:00:42,432 - INFO - Actual Game Score: 4
2024-10-22 17:00:42,432 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:42,432 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:42,433 - DEBUG - Policy Targets: [0.         0.33333333 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.66666667]
2024-10-22 17:00:42,433 - DEBUG - === End of Training Data ===
2024-10-22 17:00:42,433 - INFO - Chosen Action: (Reveal player +1 rank 5) | Visit Count: 6
2024-10-22 17:00:43,833 - DEBUG - Not the current player's turn.
2024-10-22 17:00:43,834 - INFO - Agent state has been reset.
2024-10-22 17:00:43,834 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:43,834 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || XX|RYGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1}
2024-10-22 17:00:43,834 - INFO - Max Rollouts: 10
2024-10-22 17:00:43,834 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:43,834 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:43,834 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:44,026 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:44,026 - DEBUG - Network Policy Logits: [[ 0.01267614  0.01192014  0.03722187 -0.05799254 -0.00239305  0.03757091
   0.05428196  0.01757836  0.01172656  0.04513916 -0.02622748 -0.00048885
  -0.00556826 -0.01971331  0.02526339  0.00607848 -0.00482121 -0.05248489
  -0.01533686 -0.0508577 ]]
2024-10-22 17:00:44,027 - DEBUG - Network Policy after Softmax: [[0.05055393 0.05051572 0.05181017 0.04710466 0.04979784 0.05182826
  0.05270164 0.05080237 0.05050595 0.05222199 0.04862497 0.04989275
  0.04963997 0.04894275 0.05119429 0.05022149 0.04967706 0.04736482
  0.04915741 0.04744195]]
2024-10-22 17:00:44,028 - DEBUG - Normalized Policy: [[0.         0.50418526 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.49581477 0.
  0.         0.        ]]
2024-10-22 17:00:44,028 - DEBUG - Dirichlet Noise Added: [0.         0.37813896 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.62186104 0.
 0.         0.        ]
2024-10-22 17:00:44,028 - DEBUG - Added Child Node: ((Discard 1),) | P=0.3781389594078064
2024-10-22 17:00:44,029 - DEBUG - Added Child Node: ((Reveal player +1 rank 2),) | P=0.6218610405921936
2024-10-22 17:00:44,029 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:44,029 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:44,029 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || XX|RYGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1}
2024-10-22 17:00:44,029 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:44,029 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:44,029 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:44,030 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2),)
2024-10-22 17:00:44,030 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)']
2024-10-22 17:00:44,030 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:44,218 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:44,218 - DEBUG - Network Policy Logits: [[ 0.0017104  -0.00430539 -0.00718673 -0.07619238 -0.00763092  0.01310601
   0.0045858  -0.0060054   0.009499    0.02675959 -0.03778311 -0.04871332
  -0.01212516 -0.00886545  0.03070464 -0.0030448  -0.02408798 -0.01474977
   0.03097272  0.00040837]]
2024-10-22 17:00:44,219 - DEBUG - Network Policy after Softmax: [[0.05040359 0.05010128 0.04995713 0.04662606 0.04993494 0.05098125
  0.05054873 0.05001618 0.05079769 0.0516821  0.04845177 0.04792506
  0.04971103 0.04987333 0.05188639 0.05016448 0.04911989 0.04958072
  0.0519003  0.050338  ]]
2024-10-22 17:00:44,220 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33226386 0.
  0.         0.         0.         0.         0.3223949  0.
  0.         0.         0.         0.         0.         0.
  0.34534124 0.        ]]
2024-10-22 17:00:44,220 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color R)) | P=0.3223949074745178
2024-10-22 17:00:44,221 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 4)) | P=0.33226385712623596
2024-10-22 17:00:44,221 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 4)) | P=0.3453412353992462
2024-10-22 17:00:44,221 - DEBUG - Simulating Node: ((Reveal player +1 rank 2),) | Value: 0.0
2024-10-22 17:00:44,222 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:44,222 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': 1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || X2|RYGWB2
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
W2 || XX|RGWB12345
W4 || XX|RYGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1}
2024-10-22 17:00:44,222 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:44,222 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:44,222 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:44,222 - DEBUG - Expanding unexplored child: ((Discard 1),)
2024-10-22 17:00:44,222 - DEBUG - Traversing Path: ['()', '((Discard 1),)']
2024-10-22 17:00:44,223 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:44,414 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:44,414 - DEBUG - Network Policy Logits: [[-0.02011967  0.01915291 -0.00617525 -0.03908647 -0.02576014  0.05623669
   0.00047323 -0.00893604  0.03190523  0.05284083 -0.03408527 -0.01526563
  -0.04046366 -0.0119464   0.02992046  0.00784604 -0.00865979 -0.04624265
   0.0415657   0.00427265]]
2024-10-22 17:00:44,414 - DEBUG - Network Policy after Softmax: [[0.04901247 0.05097561 0.0497007  0.04809162 0.04873679 0.05290147
  0.05003224 0.04956368 0.05162983 0.05272213 0.04833274 0.04925095
  0.04802543 0.0494147  0.05152746 0.05040248 0.04957737 0.04774869
  0.05213101 0.05022269]]
2024-10-22 17:00:44,416 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.24358478 0.
  0.         0.         0.         0.         0.         0.
  0.         0.24697295 0.25753242 0.25190982 0.         0.
  0.         0.        ]]
2024-10-22 17:00:44,416 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color W)) | P=0.2469729483127594
2024-10-22 17:00:44,417 - DEBUG - Added Child Node: ((Discard 1), (Discard 4)) | P=0.2435847818851471
2024-10-22 17:00:44,417 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1)) | P=0.2519098222255707
2024-10-22 17:00:44,418 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color B)) | P=0.25753241777420044
2024-10-22 17:00:44,418 - DEBUG - Simulating Node: ((Discard 1),) | Value: 0.0
2024-10-22 17:00:44,418 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:44,418 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 4}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || XX|RYGWB12345
-----
B4 || B4|B4
W2 || X2|RGW2
R3 || XX|RGWB12345
Y5 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 Y4}
2024-10-22 17:00:44,418 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:44,418 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:44,418 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:44,419 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.9152317643165588 | PUCT: 0.9152317643165588
2024-10-22 17:00:44,419 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.556530773639679 | PUCT: 0.556530773639679
2024-10-22 17:00:44,419 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.9152317643165588
2024-10-22 17:00:44,419 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:00:44,420 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Reveal player +1 rank 4))
2024-10-22 17:00:44,420 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 rank 4))']
2024-10-22 17:00:44,420 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:44,421 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:44,609 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:44,609 - DEBUG - Network Policy Logits: [[ 0.01235284  0.02548356  0.03947668 -0.0522902  -0.00992302  0.02700246
   0.01915829  0.02137931  0.01243169  0.04263227 -0.01850902  0.02445377
  -0.00065886 -0.00453317  0.00834245  0.01501031 -0.00102954 -0.05321297
  -0.02195111 -0.05033882]]
2024-10-22 17:00:44,610 - DEBUG - Network Policy after Softmax: [[0.05051249 0.05118012 0.05190133 0.04735051 0.04939972 0.05125792
  0.05085742 0.0509705  0.05051647 0.05206537 0.04897739 0.05112745
  0.04985949 0.0496667  0.05031032 0.0506469  0.04984101 0.04730684
  0.0488091  0.047443  ]]
2024-10-22 17:00:44,611 - DEBUG - Normalized Policy: [[0.         0.51099634 0.         0.         0.         0.
  0.         0.         0.         0.         0.48900366 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:44,612 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 4), (Reveal player +1 color R)) | P=0.48900365829467773
2024-10-22 17:00:44,612 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 4), (Discard 1)) | P=0.5109963417053223
2024-10-22 17:00:44,612 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:00:44,612 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:44,613 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': 1}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB1235
XX || XX|RYGWB1235
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || X2|RYGWB2
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1}
2024-10-22 17:00:44,613 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:44,613 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:44,613 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:44,613 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.6574295163154602 | PUCT: 0.6574295163154602
2024-10-22 17:00:44,614 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.5996509790420532 | PUCT: 0.5996509790420532
2024-10-22 17:00:44,614 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.6574295163154602
2024-10-22 17:00:44,614 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:00:44,614 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Reveal player +1 color R))
2024-10-22 17:00:44,614 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 color R))']
2024-10-22 17:00:44,615 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:44,615 - DEBUG - Illegal move encountered: (Reveal player +1 color R)
2024-10-22 17:00:44,615 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:44,615 - DEBUG - Rollout #5 completed with reward=4
2024-10-22 17:00:44,615 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:44,616 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 1.3333333333333333 | U: 0.5202513337135315 | PUCT: 1.8535847663879395
2024-10-22 17:00:44,616 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.63270503282547 | PUCT: 0.63270503282547
2024-10-22 17:00:44,616 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 1.8535847663879395
2024-10-22 17:00:44,616 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:00:44,617 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Discard 4))
2024-10-22 17:00:44,617 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Discard 4))']
2024-10-22 17:00:44,617 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:44,618 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:44,825 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:44,826 - DEBUG - Network Policy Logits: [[ 0.00170639  0.01893571  0.04168131 -0.04827803 -0.00244329  0.04497428
   0.04780051  0.02040293 -0.00349963  0.05322961 -0.03024443  0.01640764
  -0.03089686 -0.02775543  0.02519673  0.02517017 -0.00970227 -0.04891312
  -0.01364656 -0.03806095]]
2024-10-22 17:00:44,826 - DEBUG - Network Policy after Softmax: [[0.04995492 0.05082307 0.05199232 0.04751933 0.04974805 0.05216381
  0.05231144 0.05089769 0.04969553 0.05259622 0.04838405 0.05069475
  0.04835249 0.04850462 0.05114227 0.05114091 0.04938824 0.04748916
  0.04919382 0.04800733]]
2024-10-22 17:00:44,827 - DEBUG - Normalized Policy: [[0.         0.33194643 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.33403125 0.33402237 0.         0.
  0.         0.        ]]
2024-10-22 17:00:44,828 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 4), (Discard 1)) | P=0.3319464325904846
2024-10-22 17:00:44,828 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 4), (Reveal player +1 rank 1)) | P=0.3340223729610443
2024-10-22 17:00:44,829 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 4), (Reveal player +1 color B)) | P=0.33403125405311584
2024-10-22 17:00:44,829 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Discard 4)) | Value: 0.0
2024-10-22 17:00:44,829 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:44,829 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
B1 || XX|RYGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 R2}
2024-10-22 17:00:44,829 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:44,829 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:44,829 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:44,830 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 1.0 | U: 0.43373528122901917 | PUCT: 1.4337352514266968
2024-10-22 17:00:44,830 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.659360408782959 | PUCT: 0.659360408782959
2024-10-22 17:00:44,831 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 1.4337352514266968
2024-10-22 17:00:44,831 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:00:44,831 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.5476405024528503 | PUCT: 0.5476405024528503
2024-10-22 17:00:44,831 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 color R)) | Q: 4.0 | U: 0.5112522840499878 | PUCT: 4.511252403259277
2024-10-22 17:00:44,832 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Discard 4)) | Q: 0.0 | U: 0.526902437210083 | PUCT: 0.526902437210083
2024-10-22 17:00:44,832 - DEBUG - Selected Child: ((Reveal player +1 rank 2), (Reveal player +1 color R)) | PUCT: 4.511252403259277
2024-10-22 17:00:44,832 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2), (Reveal player +1 color R))
2024-10-22 17:00:44,832 - DEBUG - Node ((Reveal player +1 rank 2), (Reveal player +1 color R)) is a leaf node.
2024-10-22 17:00:44,832 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 color R))']
2024-10-22 17:00:44,833 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:44,833 - DEBUG - Illegal move encountered: (Reveal player +1 color R)
2024-10-22 17:00:44,833 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:44,833 - DEBUG - Rollout #7 completed with reward=4
2024-10-22 17:00:44,833 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:44,834 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 1.6 | U: 0.37364181876182556 | PUCT: 1.9736418724060059
2024-10-22 17:00:44,834 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.6816082000732422 | PUCT: 0.6816082000732422
2024-10-22 17:00:44,834 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 1.9736418724060059
2024-10-22 17:00:44,834 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:00:44,835 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.5778276324272156 | PUCT: 0.5778276324272156
2024-10-22 17:00:44,835 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 color R)) | Q: 4.0 | U: 0.35962244868278503 | PUCT: 4.359622478485107
2024-10-22 17:00:44,835 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Discard 4)) | Q: 0.0 | U: 0.5559464693069458 | PUCT: 0.5559464693069458
2024-10-22 17:00:44,836 - DEBUG - Selected Child: ((Reveal player +1 rank 2), (Reveal player +1 color R)) | PUCT: 4.359622478485107
2024-10-22 17:00:44,836 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2), (Reveal player +1 color R))
2024-10-22 17:00:44,836 - DEBUG - Node ((Reveal player +1 rank 2), (Reveal player +1 color R)) is a leaf node.
2024-10-22 17:00:44,836 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 color R))']
2024-10-22 17:00:44,836 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:44,836 - DEBUG - Illegal move encountered: (Reveal player +1 color R)
2024-10-22 17:00:44,836 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:44,837 - DEBUG - Rollout #8 completed with reward=4
2024-10-22 17:00:44,837 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:44,837 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 2.0 | U: 0.3292096257209778 | PUCT: 2.329209566116333
2024-10-22 17:00:44,838 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.7006460428237915 | PUCT: 0.7006460428237915
2024-10-22 17:00:44,838 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 2.329209566116333
2024-10-22 17:00:44,838 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:00:44,838 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.602171003818512 | PUCT: 0.602171003818512
2024-10-22 17:00:44,839 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 color R)) | Q: 4.0 | U: 0.2810797691345215 | PUCT: 4.2810797691345215
2024-10-22 17:00:44,839 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Discard 4)) | Q: 0.0 | U: 0.579367995262146 | PUCT: 0.579367995262146
2024-10-22 17:00:44,839 - DEBUG - Selected Child: ((Reveal player +1 rank 2), (Reveal player +1 color R)) | PUCT: 4.2810797691345215
2024-10-22 17:00:44,839 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2), (Reveal player +1 color R))
2024-10-22 17:00:44,839 - DEBUG - Node ((Reveal player +1 rank 2), (Reveal player +1 color R)) is a leaf node.
2024-10-22 17:00:44,839 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 color R))']
2024-10-22 17:00:44,840 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:44,840 - DEBUG - Illegal move encountered: (Reveal player +1 color R)
2024-10-22 17:00:44,840 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:44,840 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:00:44,840 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:44,841 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 2.2857142857142856 | U: 0.29488399624824524 | PUCT: 2.5805983543395996
2024-10-22 17:00:44,841 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.7172479033470154 | PUCT: 0.7172479033470154
2024-10-22 17:00:44,842 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 2.5805983543395996
2024-10-22 17:00:44,842 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:00:44,842 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.6224891543388367 | PUCT: 0.6224891543388367
2024-10-22 17:00:44,842 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 color R)) | Q: 4.0 | U: 0.23245105147361755 | PUCT: 4.23245096206665
2024-10-22 17:00:44,843 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Discard 4)) | Q: 0.0 | U: 0.59891676902771 | PUCT: 0.59891676902771
2024-10-22 17:00:44,843 - DEBUG - Selected Child: ((Reveal player +1 rank 2), (Reveal player +1 color R)) | PUCT: 4.23245096206665
2024-10-22 17:00:44,843 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2), (Reveal player +1 color R))
2024-10-22 17:00:44,843 - DEBUG - Node ((Reveal player +1 rank 2), (Reveal player +1 color R)) is a leaf node.
2024-10-22 17:00:44,843 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 color R))']
2024-10-22 17:00:44,844 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:44,844 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:00:45,029 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:45,029 - DEBUG - Network Policy Logits: [[ 0.01289996  0.032428    0.02891605 -0.05227596 -0.0226199   0.0255466
   0.02728498  0.03015696  0.00619585  0.02339794 -0.02096306  0.01683246
  -0.02250343  0.00296239  0.03068885  0.00189366  0.01052401 -0.05680668
  -0.02965497 -0.06329142]]
2024-10-22 17:00:45,029 - DEBUG - Network Policy after Softmax: [[0.0506724  0.05167165 0.0514905  0.0474751  0.04890411 0.0513173
  0.05140659 0.05155444 0.05033382 0.05120716 0.04898521 0.05087206
  0.04890981 0.05017133 0.05158187 0.05011774 0.05055214 0.04726049
  0.04856128 0.04695501]]
2024-10-22 17:00:45,030 - DEBUG - Normalized Policy: [[0.        0.5133446 0.        0.        0.        0.        0.
  0.        0.        0.        0.4866554 0.        0.        0.
  0.        0.        0.        0.        0.        0.       ]]
2024-10-22 17:00:45,031 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color R), (Reveal player +1 color R)) | P=0.48665541410446167
2024-10-22 17:00:45,032 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color R), (Discard 1)) | P=0.5133445858955383
2024-10-22 17:00:45,032 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:00:45,032 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:45,032 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': 1}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || XX|GWB12345
XX || XX|YGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || X2|RYGWB2
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1}
2024-10-22 17:00:45,032 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:45,032 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:45,032 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:45,032 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 2),) | Visit Count: 8
2024-10-22 17:00:45,032 - INFO - Actual Game Score: 4
2024-10-22 17:00:45,032 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:45,032 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:45,033 - DEBUG - Policy Targets: [0.         0.11111111 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.88888889 0.
 0.         0.        ]
2024-10-22 17:00:45,033 - DEBUG - === End of Training Data ===
2024-10-22 17:00:45,033 - INFO - Chosen Action: (Reveal player +1 rank 2) | Visit Count: 8
2024-10-22 17:00:46,417 - DEBUG - Not the current player's turn.
2024-10-22 17:00:46,418 - INFO - Agent state has been reset.
2024-10-22 17:00:46,418 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:46,418 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': 1}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || X2|RYGWB2
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1}
2024-10-22 17:00:46,418 - INFO - Max Rollouts: 10
2024-10-22 17:00:46,418 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:46,418 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:46,418 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:46,602 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:46,603 - DEBUG - Network Policy Logits: [[-0.00714991  0.01051609  0.05026235 -0.05899406 -0.02806733  0.01575218
   0.02718791  0.02383909  0.01963825 -0.00576804 -0.00376892  0.01416772
  -0.01230759  0.01496379  0.04811992 -0.00317877 -0.00205206 -0.04925718
  -0.02620401 -0.05889152]]
2024-10-22 17:00:46,603 - DEBUG - Network Policy after Softmax: [[0.04969851 0.05058428 0.0526353  0.04718758 0.04866974 0.05084983
  0.05143468 0.05126272 0.05104783 0.04976723 0.04986682 0.05076933
  0.04944284 0.05080976 0.05252266 0.04989626 0.04995251 0.04764928
  0.04876051 0.04719242]]
2024-10-22 17:00:46,604 - DEBUG - Normalized Policy: [[0.         0.50357115 0.         0.         0.         0.
  0.         0.         0.         0.         0.49642882 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:46,604 - DEBUG - Dirichlet Noise Added: [0.        0.3776785 0.        0.        0.        0.        0.
 0.        0.        0.        0.6223215 0.        0.        0.
 0.        0.        0.        0.        0.        0.       ]
2024-10-22 17:00:46,605 - DEBUG - Added Child Node: ((Reveal player +1 color R),) | P=0.6223214864730835
2024-10-22 17:00:46,606 - DEBUG - Added Child Node: ((Discard 1),) | P=0.3776785135269165
2024-10-22 17:00:46,606 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:46,606 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:46,606 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': 1}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || X2|RYGWB2
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1}
2024-10-22 17:00:46,606 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:46,606 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:46,606 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:46,606 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R),)
2024-10-22 17:00:46,606 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)']
2024-10-22 17:00:46,607 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:46,810 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:46,810 - DEBUG - Network Policy Logits: [[-0.01075319  0.00999951  0.02179579 -0.05271171 -0.00971095  0.00333445
   0.00425334 -0.00149057  0.02047404  0.03003012 -0.01170412 -0.03938628
  -0.01272629 -0.007103    0.0065892   0.01620906 -0.00960114 -0.02966399
   0.01884746  0.03105487]]
2024-10-22 17:00:46,810 - DEBUG - Network Policy after Softmax: [[0.04950874 0.05054692 0.05114671 0.04747441 0.04956037 0.05021114
  0.0502573  0.04996945 0.05107915 0.05156961 0.04946169 0.04811126
  0.04941115 0.04968979 0.05037483 0.05086177 0.04956581 0.04858129
  0.05099614 0.05162248]]
2024-10-22 17:00:46,812 - DEBUG - Normalized Policy: [[1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:46,813 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0)) | P=1.0
2024-10-22 17:00:46,813 - DEBUG - Simulating Node: ((Reveal player +1 color R),) | Value: 0.0
2024-10-22 17:00:46,813 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:46,813 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || R2|R2
R4 || RX|R12345
Y4 || XX|YGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1}
2024-10-22 17:00:46,813 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:46,813 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:46,813 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:46,813 - DEBUG - Expanding unexplored child: ((Discard 1),)
2024-10-22 17:00:46,814 - DEBUG - Traversing Path: ['()', '((Discard 1),)']
2024-10-22 17:00:46,814 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:47,014 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:47,015 - DEBUG - Network Policy Logits: [[-0.02006366 -0.01548089  0.01627208 -0.05544276 -0.00553163  0.00451697
  -0.01183125  0.02220715  0.01601937  0.03544124 -0.00915892 -0.03395981
  -0.01878466 -0.00260773  0.00905262 -0.01181156  0.00524218 -0.03131866
   0.06466421 -0.0129937 ]]
2024-10-22 17:00:47,015 - DEBUG - Network Policy after Softmax: [[0.04912688 0.04935253 0.05094477 0.04741921 0.049846   0.05034941
  0.04953298 0.05124803 0.0509319  0.05193076 0.04966553 0.04844893
  0.04918975 0.04999197 0.0505783  0.04953396 0.05038594 0.04857706
  0.05347072 0.04947544]]
2024-10-22 17:00:47,016 - DEBUG - Normalized Policy: [[0.33173692 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.34023893 0.32802415
  0.         0.        ]]
2024-10-22 17:00:47,017 - DEBUG - Added Child Node: ((Discard 1), (Discard 0)) | P=0.3317369222640991
2024-10-22 17:00:47,018 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 2)) | P=0.34023892879486084
2024-10-22 17:00:47,018 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 3)) | P=0.32802414894104004
2024-10-22 17:00:47,018 - DEBUG - Simulating Node: ((Discard 1),) | Value: 0.0
2024-10-22 17:00:47,018 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:47,018 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': 1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || X2|RYGWB2
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
Y2 || XX|YGWB12345
W5 || XX|RYGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 Y4}
2024-10-22 17:00:47,018 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:47,018 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:47,019 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:47,019 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.915909469127655 | PUCT: 0.915909469127655
2024-10-22 17:00:47,020 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.5558530688285828 | PUCT: 0.5558530688285828
2024-10-22 17:00:47,020 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.915909469127655
2024-10-22 17:00:47,020 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:00:47,020 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 0))
2024-10-22 17:00:47,020 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 0))']
2024-10-22 17:00:47,020 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:47,021 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:00:47,207 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:47,208 - DEBUG - Network Policy Logits: [[-0.01915392  0.00474528  0.02718096 -0.06148216 -0.00220364  0.03316886
   0.01422226  0.01534801 -0.0156859   0.01670499 -0.01872625  0.01025082
  -0.02708848 -0.00705436  0.03272287 -0.02017271 -0.00026032 -0.03906554
  -0.02016945 -0.04151993]]
2024-10-22 17:00:47,208 - DEBUG - Network Policy after Softmax: [[0.0493267  0.05051976 0.05166602 0.04728236 0.05016992 0.05197632
  0.05100081 0.05105826 0.04949806 0.05112759 0.0493478  0.05079867
  0.04893686 0.04992715 0.05195314 0.04927647 0.05026751 0.04835423
  0.04927663 0.0482357 ]]
2024-10-22 17:00:47,209 - DEBUG - Normalized Policy: [[0.         0.5062284  0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.49377167 0.        ]]
2024-10-22 17:00:47,210 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Discard 1)) | P=0.5062283873558044
2024-10-22 17:00:47,210 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4)) | P=0.49377167224884033
2024-10-22 17:00:47,211 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 0)) | Value: 0.0
2024-10-22 17:00:47,211 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:47,211 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
R4 || XX|RYGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2}
2024-10-22 17:00:47,211 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:47,211 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:47,211 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:47,212 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.6579163670539856 | PUCT: 0.6579163670539856
2024-10-22 17:00:47,212 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.5989208221435547 | PUCT: 0.5989208221435547
2024-10-22 17:00:47,212 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.6579163670539856
2024-10-22 17:00:47,212 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:00:47,213 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 0)) | Q: 0.0 | U: 1.3101838827133179 | PUCT: 1.3101838827133179
2024-10-22 17:00:47,213 - DEBUG - Selected Child: ((Reveal player +1 color R), (Discard 0)) | PUCT: 1.3101838827133179
2024-10-22 17:00:47,213 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Discard 0))
2024-10-22 17:00:47,213 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 0), (Discard 1))
2024-10-22 17:00:47,213 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 0))', '((Reveal player +1 color R), (Discard 0), (Discard 1))']
2024-10-22 17:00:47,213 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:47,214 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:00:47,215 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 3
2024-10-22 17:00:47,406 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:47,406 - DEBUG - Network Policy Logits: [[-0.02433209 -0.00555652  0.0245991  -0.06167882 -0.00724217  0.03270414
   0.00410177  0.01908207  0.0238017   0.02764837  0.02008429 -0.00500719
  -0.02646532 -0.02335363  0.01738174 -0.03023463  0.02997802 -0.04435786
   0.04531538 -0.03755542]]
2024-10-22 17:00:47,406 - DEBUG - Network Policy after Softmax: [[0.04882879 0.04975424 0.05127746 0.04703883 0.04967044 0.05169475
  0.05023711 0.05099534 0.05123659 0.05143406 0.05104648 0.04978158
  0.04872474 0.04887659 0.0509087  0.04854142 0.05155402 0.04786068
  0.05235082 0.04818736]]
2024-10-22 17:00:47,408 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.5092779  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.49072215
  0.         0.        ]]
2024-10-22 17:00:47,408 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Discard 1), (Discard 4)) | P=0.509277880191803
2024-10-22 17:00:47,409 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Discard 1), (Reveal player +1 rank 3)) | P=0.4907221496105194
2024-10-22 17:00:47,409 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 0), (Discard 1)) | Value: 0.0
2024-10-22 17:00:47,409 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:47,409 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
Y4 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4}
2024-10-22 17:00:47,409 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:47,409 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:47,409 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:47,410 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5206365585327148 | PUCT: 0.5206365585327148
2024-10-22 17:00:47,411 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.6319345831871033 | PUCT: 0.6319345831871033
2024-10-22 17:00:47,411 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.6319345831871033
2024-10-22 17:00:47,411 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:47,411 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 rank 3))
2024-10-22 17:00:47,411 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 3))']
2024-10-22 17:00:47,411 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:47,412 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:47,597 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:47,597 - DEBUG - Network Policy Logits: [[ 0.02646115 -0.00126052  0.01131478 -0.06000474  0.00158947  0.0233179
   0.02696035  0.02763778  0.00519474  0.020643   -0.01057417  0.01063147
  -0.0334878  -0.00284897  0.01384006 -0.01049002  0.01074539 -0.04599941
  -0.00965554 -0.04315571]]
2024-10-22 17:00:47,597 - DEBUG - Network Policy after Softmax: [[0.0514251  0.05001908 0.05065206 0.04716539 0.05016184 0.0512637
  0.05145077 0.05148564 0.05034301 0.05112676 0.04955539 0.05061746
  0.0484328  0.04993969 0.05078014 0.04955956 0.05062323 0.0478306
  0.04960093 0.04796682]]
2024-10-22 17:00:47,599 - DEBUG - Normalized Policy: [[0.         0.         0.         0.48764485 0.         0.
  0.         0.         0.         0.         0.51235515 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:47,599 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 3), (Reveal player +1 color R)) | P=0.5123551487922668
2024-10-22 17:00:47,600 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 3), (Discard 3)) | P=0.48764485120773315
2024-10-22 17:00:47,600 - DEBUG - Simulating Node: ((Discard 1), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:00:47,600 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:47,600 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': 1}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || XX|YGWB1245
XX || XX|RYGWB1245
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || X2|RYGWB2
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 Y4}
2024-10-22 17:00:47,600 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:47,600 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:47,600 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:47,601 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5425705909729004 | PUCT: 0.5425705909729004
2024-10-22 17:00:47,601 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.43903830647468567 | PUCT: 0.43903830647468567
2024-10-22 17:00:47,602 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.5425705909729004
2024-10-22 17:00:47,602 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:00:47,602 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 0)) | Q: 0.0 | U: 0.9811750054359436 | PUCT: 0.9811750054359436
2024-10-22 17:00:47,602 - DEBUG - Selected Child: ((Reveal player +1 color R), (Discard 0)) | PUCT: 0.9811750054359436
2024-10-22 17:00:47,602 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Discard 0))
2024-10-22 17:00:47,602 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4))
2024-10-22 17:00:47,602 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 0))', '((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4))']
2024-10-22 17:00:47,603 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:47,603 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:00:47,604 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 3
2024-10-22 17:00:47,794 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:47,794 - DEBUG - Network Policy Logits: [[ 0.01026432 -0.00539473  0.04052992 -0.07574022 -0.00795582  0.01122956
   0.01221811 -0.00569669  0.01473476  0.01135987 -0.00593354  0.00898163
  -0.02235305 -0.03310592  0.0212394  -0.01587747  0.01091955 -0.03454038
  -0.00164855  0.00433722]]
2024-10-22 17:00:47,794 - DEBUG - Network Policy after Softmax: [[0.05065901 0.04987191 0.05221567 0.04648421 0.04974435 0.05070793
  0.05075809 0.04985686 0.05088599 0.05071454 0.04984505 0.05059407
  0.0490333  0.04850888 0.05121806 0.04935185 0.05069221 0.04843935
  0.0500591  0.05035964]]
2024-10-22 17:00:47,795 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:47,796 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4), (Discard 4)) | P=1.0
2024-10-22 17:00:47,796 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:00:47,796 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:47,796 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB1235
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || R2|R2
R3 || RX|R12345
B2 || XX|YGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2}
2024-10-22 17:00:47,796 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:47,796 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:47,796 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:47,797 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.4487021565437317 | PUCT: 0.4487021565437317
2024-10-22 17:00:47,797 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.4538521468639374 | PUCT: 0.4538521468639374
2024-10-22 17:00:47,797 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.4538521468639374
2024-10-22 17:00:47,797 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:47,797 - DEBUG - Expanding unexplored child: ((Discard 1), (Discard 0))
2024-10-22 17:00:47,797 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Discard 0))']
2024-10-22 17:00:47,798 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:47,798 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:00:48,008 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:48,008 - DEBUG - Network Policy Logits: [[ 0.03035026 -0.02493228  0.014233   -0.06573594  0.01307982  0.05625347
   0.02459818  0.0340986  -0.01630192  0.03057041 -0.03396828 -0.00193925
  -0.04214933 -0.02998673  0.01336709 -0.01555742  0.01647485 -0.04197904
  -0.01299498 -0.02376176]]
2024-10-22 17:00:48,008 - DEBUG - Network Policy after Softmax: [[0.05171304 0.0489318  0.05088625 0.04697539 0.0508276  0.05307008
  0.05141644 0.05190725 0.04935592 0.05172443 0.04849164 0.05006992
  0.04809655 0.0486851  0.05084221 0.04939269 0.05100046 0.04810474
  0.04951941 0.04898911]]
2024-10-22 17:00:48,010 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24508683 0.         0.
  0.         0.         0.         0.         0.25299767 0.
  0.25093633 0.         0.         0.         0.         0.25097907
  0.         0.        ]]
2024-10-22 17:00:48,010 - DEBUG - Added Child Node: ((Discard 1), (Discard 0), (Reveal player +1 color R)) | P=0.25299766659736633
2024-10-22 17:00:48,011 - DEBUG - Added Child Node: ((Discard 1), (Discard 0), (Discard 3)) | P=0.24508683383464813
2024-10-22 17:00:48,012 - DEBUG - Added Child Node: ((Discard 1), (Discard 0), (Reveal player +1 rank 3)) | P=0.25097906589508057
2024-10-22 17:00:48,012 - DEBUG - Added Child Node: ((Discard 1), (Discard 0), (Reveal player +1 color G)) | P=0.2509363293647766
2024-10-22 17:00:48,012 - DEBUG - Simulating Node: ((Discard 1), (Discard 0)) | Value: 0.0
2024-10-22 17:00:48,012 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:48,012 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || X2|RYGWB2
G3 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 Y4 B2}
2024-10-22 17:00:48,012 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:48,013 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:48,013 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:48,013 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.46123480796813965 | PUCT: 0.46123480796813965
2024-10-22 17:00:48,014 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.34989646077156067 | PUCT: 0.34989646077156067
2024-10-22 17:00:48,014 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.46123480796813965
2024-10-22 17:00:48,014 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:00:48,014 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 0)) | Q: 0.0 | U: 0.792897641658783 | PUCT: 0.792897641658783
2024-10-22 17:00:48,014 - DEBUG - Selected Child: ((Reveal player +1 color R), (Discard 0)) | PUCT: 0.792897641658783
2024-10-22 17:00:48,014 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Discard 0))
2024-10-22 17:00:48,015 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 0), (Discard 1)) | Q: 0.0 | U: 0.7450479865074158 | PUCT: 0.7450479865074158
2024-10-22 17:00:48,015 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.7267146110534668 | PUCT: 0.7267146110534668
2024-10-22 17:00:48,015 - DEBUG - Selected Child: ((Reveal player +1 color R), (Discard 0), (Discard 1)) | PUCT: 0.7450479865074158
2024-10-22 17:00:48,015 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Discard 0), (Discard 1))
2024-10-22 17:00:48,015 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 0), (Discard 1), (Discard 4))
2024-10-22 17:00:48,015 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 0))', '((Reveal player +1 color R), (Discard 0), (Discard 1))', '((Reveal player +1 color R), (Discard 0), (Discard 1), (Discard 4))']
2024-10-22 17:00:48,016 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:48,017 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:00:48,017 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 3
2024-10-22 17:00:48,018 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 4
2024-10-22 17:00:48,219 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:48,219 - DEBUG - Network Policy Logits: [[ 0.04086806 -0.01973165  0.01686262 -0.05456941  0.01823114  0.05715124
   0.02515349  0.02522513 -0.03318644  0.0282667  -0.03421785 -0.00037002
  -0.03428803 -0.02346762  0.01156841 -0.00831406  0.0183839  -0.04946103
  -0.01701173 -0.0234613 ]]
2024-10-22 17:00:48,219 - DEBUG - Network Policy after Softmax: [[0.05220836 0.04913851 0.05097    0.04745611 0.0510398  0.05306544
  0.05139435 0.05139803 0.04848179 0.0515546  0.04843181 0.05009918
  0.04842841 0.04895527 0.05070087 0.04970276 0.0510476  0.04769915
  0.04927234 0.04895558]]
2024-10-22 17:00:48,221 - DEBUG - Normalized Policy: [[0.         0.         0.         0.4922252  0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.50777483 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:48,222 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Discard 1), (Discard 4), (Reveal player +1 color W)) | P=0.507774829864502
2024-10-22 17:00:48,222 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Discard 1), (Discard 4), (Discard 3)) | P=0.49222519993782043
2024-10-22 17:00:48,222 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 0), (Discard 1), (Discard 4)) | Value: 0.0
2024-10-22 17:00:48,223 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:48,223 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 19, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W3 || XX|RYGWB12345
Deck size: 19
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 Y2}
2024-10-22 17:00:48,223 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:48,223 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:48,223 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:48,224 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.39346981048583984 | PUCT: 0.39346981048583984
2024-10-22 17:00:48,224 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3581872582435608 | PUCT: 0.3581872582435608
2024-10-22 17:00:48,224 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.39346981048583984
2024-10-22 17:00:48,224 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:00:48,225 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 0)) | Q: 0.0 | U: 0.6692830920219421 | PUCT: 0.6692830920219421
2024-10-22 17:00:48,225 - DEBUG - Selected Child: ((Reveal player +1 color R), (Discard 0)) | PUCT: 0.6692830920219421
2024-10-22 17:00:48,225 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Discard 0))
2024-10-22 17:00:48,225 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 0), (Discard 1)) | Q: 0.0 | U: 0.5351830720901489 | PUCT: 0.5351830720901489
2024-10-22 17:00:48,226 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.7830207347869873 | PUCT: 0.7830207347869873
2024-10-22 17:00:48,226 - DEBUG - Selected Child: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4)) | PUCT: 0.7830207347869873
2024-10-22 17:00:48,226 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4))
2024-10-22 17:00:48,226 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4), (Discard 4))
2024-10-22 17:00:48,226 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 0))', '((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4))', '((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4), (Discard 4))']
2024-10-22 17:00:48,227 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:48,228 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:00:48,228 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 3
2024-10-22 17:00:48,229 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 4
2024-10-22 17:00:48,434 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:48,434 - DEBUG - Network Policy Logits: [[-0.01899     0.00014787  0.02176046 -0.06779031  0.00959503  0.03533639
   0.01246402  0.02269837 -0.00916874  0.01340174 -0.02336163  0.01571272
  -0.02461322 -0.00334522  0.04713747 -0.02408234  0.0024175  -0.03642493
  -0.02147579 -0.03249674]]
2024-10-22 17:00:48,434 - DEBUG - Network Policy after Softmax: [[0.04924101 0.05019245 0.05128904 0.04689572 0.05066887 0.05199009
  0.05081445 0.05133718 0.049727   0.05086212 0.04902621 0.0509798
  0.04896489 0.05001743 0.05260726 0.04899089 0.0503065  0.04838993
  0.04911875 0.04858039]]
2024-10-22 17:00:48,435 - DEBUG - Normalized Policy: [[0.         0.49943256 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.5005674  0.
  0.         0.        ]]
2024-10-22 17:00:48,437 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4), (Discard 4), (Discard 1)) | P=0.4994325637817383
2024-10-22 17:00:48,437 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4), (Discard 4), (Reveal player +1 rank 2)) | P=0.5005673766136169
2024-10-22 17:00:48,437 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 4), (Discard 4)) | Value: 0.0
2024-10-22 17:00:48,437 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:48,437 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W2 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y5}
2024-10-22 17:00:48,437 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:48,438 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:48,438 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:48,438 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color R),) | Visit Count: 6
2024-10-22 17:00:48,438 - INFO - Actual Game Score: 4
2024-10-22 17:00:48,438 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:48,438 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:48,438 - DEBUG - Policy Targets: [0.         0.33333333 0.         0.         0.         0.
 0.         0.         0.         0.         0.66666667 0.
 0.         0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:48,438 - DEBUG - === End of Training Data ===
2024-10-22 17:00:48,438 - INFO - Chosen Action: (Reveal player +1 color R) | Visit Count: 6
2024-10-22 17:00:50,615 - DEBUG - Not the current player's turn.
2024-10-22 17:00:50,616 - INFO - Agent state has been reset.
2024-10-22 17:00:50,616 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:50,617 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G1 || XX|RYGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2}
2024-10-22 17:00:50,617 - INFO - Max Rollouts: 10
2024-10-22 17:00:50,617 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:50,617 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:50,617 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:50,831 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:50,832 - DEBUG - Network Policy Logits: [[ 5.5035250e-04  7.5291377e-05  3.0886281e-02 -7.0840433e-02
  -6.9801165e-03  2.6153479e-02  2.3573473e-02  2.4681028e-02
   4.6629864e-03  1.3658783e-02 -2.3648128e-02  1.8420849e-02
  -2.8730284e-02 -8.2240133e-03  4.5504428e-02 -2.4828825e-02
  -3.9017163e-03 -3.7456591e-02 -9.8625952e-03 -5.2316494e-02]]
2024-10-22 17:00:50,832 - DEBUG - Network Policy after Softmax: [[0.05020396 0.05018011 0.05175028 0.0467448  0.04982731 0.05150593
  0.05137322 0.05143014 0.05041085 0.05086638 0.04900368 0.05110919
  0.04875527 0.04976537 0.05251233 0.04894585 0.04998094 0.04833166
  0.0496839  0.04761877]]
2024-10-22 17:00:50,833 - DEBUG - Normalized Policy: [[0.        0.5072009 0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.4927991 0.
  0.        0.        0.        0.        0.        0.       ]]
2024-10-22 17:00:50,834 - DEBUG - Dirichlet Noise Added: [0.         0.63040066 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.36959934 0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:50,835 - DEBUG - Added Child Node: ((Discard 1),) | P=0.6304006576538086
2024-10-22 17:00:50,835 - DEBUG - Added Child Node: ((Reveal player +1 color G),) | P=0.3695993423461914
2024-10-22 17:00:50,835 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:50,835 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:50,836 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G1 || XX|RYGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2}
2024-10-22 17:00:50,836 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:50,836 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:50,836 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:50,836 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G),)
2024-10-22 17:00:50,836 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)']
2024-10-22 17:00:50,837 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:51,044 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:51,044 - DEBUG - Network Policy Logits: [[-0.01043719 -0.00922315  0.01791189 -0.04558684  0.00339602 -0.01070905
   0.00533834 -0.00841294  0.02711161  0.01011056 -0.02118021 -0.01843804
  -0.00705802 -0.00933847  0.00874967 -0.02137745  0.00609472 -0.03509257
   0.00575606  0.01626227]]
2024-10-22 17:00:51,045 - DEBUG - Network Policy after Softmax: [[0.04971153 0.04977192 0.05114097 0.04799454 0.05040398 0.04969802
  0.05050197 0.04981226 0.05161363 0.05074356 0.04918034 0.04931538
  0.0498798  0.04976618 0.05067455 0.04917064 0.05054019 0.04850086
  0.05052307 0.05105668]]
2024-10-22 17:00:51,046 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:51,047 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4)) | P=1.0
2024-10-22 17:00:51,047 - DEBUG - Simulating Node: ((Reveal player +1 color G),) | Value: 0.0
2024-10-22 17:00:51,047 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:51,047 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || GX|G12345
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || R2|R2
R1 || RX|R12345
W4 || XX|YGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2}
2024-10-22 17:00:51,047 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:51,047 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:51,047 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:51,048 - DEBUG - Expanding unexplored child: ((Discard 1),)
2024-10-22 17:00:51,048 - DEBUG - Traversing Path: ['()', '((Discard 1),)']
2024-10-22 17:00:51,048 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:51,263 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:51,264 - DEBUG - Network Policy Logits: [[-0.02502587 -0.01270914  0.02488036 -0.05986953 -0.0069014   0.02429625
   0.00177068  0.01558149  0.01176415  0.02923609  0.02051306 -0.01222351
  -0.02317422 -0.02573082  0.01551385 -0.03216238  0.02659992 -0.04230352
   0.04125155 -0.03553961]]
2024-10-22 17:00:51,264 - DEBUG - Network Policy after Softmax: [[0.04890259 0.04950864 0.05140506 0.04722799 0.04979701 0.05137505
  0.05023073 0.05092927 0.05073522 0.05162946 0.05118105 0.04953269
  0.04899323 0.04886813 0.05092582 0.04855485 0.05149353 0.04806493
  0.05225355 0.04839114]]
2024-10-22 17:00:51,266 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.25233784 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.25805792 0.24604338 0.         0.24356084
  0.         0.        ]]
2024-10-22 17:00:51,266 - DEBUG - Added Child Node: ((Discard 1), (Discard 4)) | P=0.25233784317970276
2024-10-22 17:00:51,267 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1)) | P=0.2460433840751648
2024-10-22 17:00:51,268 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color B)) | P=0.25805792212486267
2024-10-22 17:00:51,268 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 3)) | P=0.24356083571910858
2024-10-22 17:00:51,268 - DEBUG - Simulating Node: ((Discard 1),) | Value: 0.0
2024-10-22 17:00:51,268 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:51,269 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W1 || XX|YGWB12345
B2 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4}
2024-10-22 17:00:51,269 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:51,269 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:51,269 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:51,270 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.5439624786376953 | PUCT: 0.5439624786376953
2024-10-22 17:00:51,270 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.9278000593185425 | PUCT: 0.9278000593185425
2024-10-22 17:00:51,270 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.9278000593185425
2024-10-22 17:00:51,270 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:51,271 - DEBUG - Expanding unexplored child: ((Discard 1), (Discard 4))
2024-10-22 17:00:51,271 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Discard 4))']
2024-10-22 17:00:51,271 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:51,272 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:51,492 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:51,492 - DEBUG - Network Policy Logits: [[ 0.04332925 -0.01345707  0.02630616 -0.05455485  0.01882856  0.05597087
   0.03343497  0.02199161 -0.02309331  0.02343644 -0.04088245  0.00290851
  -0.03794037 -0.01944792  0.01253048 -0.01260061  0.0217391  -0.03720715
  -0.01218184 -0.03230003]]
2024-10-22 17:00:51,492 - DEBUG - Network Policy after Softmax: [[0.05225018 0.04936576 0.05136825 0.04737806 0.05098557 0.0529149
  0.05173575 0.0511471  0.04889234 0.05122105 0.04803028 0.0501803
  0.0481718  0.0490709  0.05066546 0.04940806 0.05113418 0.04820713
  0.04942875 0.04844427]]
2024-10-22 17:00:51,494 - DEBUG - Normalized Policy: [[0.         0.         0.         0.49584645 0.         0.
  0.         0.         0.         0.         0.         0.
  0.50415355 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:51,495 - DEBUG - Added Child Node: ((Discard 1), (Discard 4), (Discard 3)) | P=0.4958464503288269
2024-10-22 17:00:51,495 - DEBUG - Added Child Node: ((Discard 1), (Discard 4), (Reveal player +1 color G)) | P=0.5041535496711731
2024-10-22 17:00:51,495 - DEBUG - Simulating Node: ((Discard 1), (Discard 4)) | Value: 0.0
2024-10-22 17:00:51,496 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:51,496 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 19, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G1 || XX|RYGWB12345
Deck size: 19
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 W3}
2024-10-22 17:00:51,496 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:51,496 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:51,496 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:51,497 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.586108922958374 | PUCT: 0.586108922958374
2024-10-22 17:00:51,497 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.6664575934410095 | PUCT: 0.6664575934410095
2024-10-22 17:00:51,497 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.6664575934410095
2024-10-22 17:00:51,497 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:51,497 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:00:51,498 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 1))']
2024-10-22 17:00:51,498 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:51,499 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:51,707 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:51,707 - DEBUG - Network Policy Logits: [[ 0.02058228 -0.00772798  0.0172558  -0.06912765  0.02110897  0.02073834
   0.01350699  0.01034712 -0.01969502  0.00354458 -0.03043038 -0.00915457
  -0.02086823 -0.0093562   0.02237699 -0.01768879  0.01893664 -0.03040239
  -0.01064741 -0.02679957]]
2024-10-22 17:00:51,707 - DEBUG - Network Policy after Softmax: [[0.05129051 0.04985882 0.05112018 0.0468896  0.05131753 0.05129852
  0.0509289  0.05076822 0.04926572 0.05042404 0.04873966 0.04978774
  0.04920796 0.04977771 0.05138265 0.04936466 0.05120618 0.04874103
  0.04971348 0.04891695]]
2024-10-22 17:00:51,709 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.34259373 0.
  0.         0.         0.32889593 0.         0.         0.
  0.3285103  0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:51,710 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Play 3)) | P=0.3288959264755249
2024-10-22 17:00:51,711 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Discard 4)) | P=0.3425937294960022
2024-10-22 17:00:51,711 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Reveal player +1 color G)) | P=0.3285103142261505
2024-10-22 17:00:51,711 - DEBUG - Simulating Node: ((Discard 1), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:00:51,711 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:51,711 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R2345
XX || X1|YGWB1
XX || XX|RYGWB2345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G1 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4}
2024-10-22 17:00:51,712 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:51,712 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:51,712 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:51,712 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.6184164881706238 | PUCT: 0.6184164881706238
2024-10-22 17:00:51,713 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.5273956060409546 | PUCT: 0.5273956060409546
2024-10-22 17:00:51,713 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.6184164881706238
2024-10-22 17:00:51,713 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:51,713 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Discard 4))
2024-10-22 17:00:51,713 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Discard 4))']
2024-10-22 17:00:51,714 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:51,715 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:51,926 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:51,926 - DEBUG - Network Policy Logits: [[-0.01657409  0.00310111  0.02559441 -0.05706368 -0.00393903  0.03697135
   0.01362502  0.02163523 -0.01075436  0.02106566 -0.02647456  0.01862918
  -0.02290142 -0.01059976  0.03586421 -0.02234745  0.00192244 -0.03746338
  -0.01955884 -0.03392369]]
2024-10-22 17:00:51,926 - DEBUG - Network Policy after Softmax: [[0.04936726 0.05034819 0.05149351 0.04740832 0.04999497 0.0520827
  0.05088084 0.05129004 0.0496554  0.05126084 0.0488809  0.0511361
  0.04905588 0.04966307 0.05202506 0.04908306 0.05028887 0.0483467
  0.04922012 0.04851814]]
2024-10-22 17:00:51,928 - DEBUG - Normalized Policy: [[0.         0.33769354 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.33309835 0.         0.32920814 0.         0.
  0.         0.        ]]
2024-10-22 17:00:51,929 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Reveal player +1 color W)) | P=0.3330983519554138
2024-10-22 17:00:51,929 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Reveal player +1 rank 1)) | P=0.3292081356048584
2024-10-22 17:00:51,930 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Discard 1)) | P=0.33769354224205017
2024-10-22 17:00:51,930 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Discard 4)) | Value: 0.0
2024-10-22 17:00:51,930 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:51,930 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W1 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 G1}
2024-10-22 17:00:51,930 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:51,930 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:51,931 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:51,931 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.4296465814113617 | PUCT: 0.4296465814113617
2024-10-22 17:00:51,932 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.5496143698692322 | PUCT: 0.5496143698692322
2024-10-22 17:00:51,932 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.5496143698692322
2024-10-22 17:00:51,932 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:51,932 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 color B))
2024-10-22 17:00:51,932 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 color B))']
2024-10-22 17:00:51,933 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:51,934 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:00:52,144 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:52,144 - DEBUG - Network Policy Logits: [[ 0.0315957  -0.02292589  0.0116333  -0.06379294  0.02114587  0.04421782
   0.00778484  0.02985949 -0.0133885   0.00957291 -0.04682824  0.00575271
  -0.0265423  -0.03251174  0.00866465 -0.01641055  0.01666871 -0.02362826
  -0.02519428 -0.02366895]]
2024-10-22 17:00:52,144 - DEBUG - Network Policy after Softmax: [[0.05186482 0.04911277 0.05083974 0.04714613 0.05132566 0.05252361
  0.05064446 0.05177484 0.04958342 0.05073509 0.04795277 0.05054164
  0.04893548 0.04864423 0.05068903 0.0494338  0.05109638 0.04907829
  0.04900149 0.04907629]]
2024-10-22 17:00:52,146 - DEBUG - Normalized Policy: [[0.         0.         0.         0.4906884  0.         0.
  0.         0.         0.         0.         0.         0.
  0.50931156 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:52,147 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color B), (Discard 3)) | P=0.49068841338157654
2024-10-22 17:00:52,147 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color B), (Reveal player +1 color G)) | P=0.5093115568161011
2024-10-22 17:00:52,147 - DEBUG - Simulating Node: ((Discard 1), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:00:52,148 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:52,148 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|YGW12345
XX || XX|RYGW12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G1 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4}
2024-10-22 17:00:52,148 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:52,148 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:52,148 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:52,149 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.44414350390434265 | PUCT: 0.44414350390434265
2024-10-22 17:00:52,149 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.4545273184776306 | PUCT: 0.4545273184776306
2024-10-22 17:00:52,150 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.4545273184776306
2024-10-22 17:00:52,150 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:52,150 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 rank 3))
2024-10-22 17:00:52,150 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 3))']
2024-10-22 17:00:52,151 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:52,151 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:52,356 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:52,357 - DEBUG - Network Policy Logits: [[ 0.02475934 -0.00765843  0.01429379 -0.06181983  0.01976755  0.05023434
   0.01919933  0.02770616 -0.01758982  0.02022742 -0.02260885  0.01259121
  -0.03295756 -0.01525672  0.02164445 -0.02192701  0.01938194 -0.04415272
   0.00433575 -0.02322864]]
2024-10-22 17:00:52,357 - DEBUG - Network Policy after Softmax: [[0.05126738 0.04963205 0.05073364 0.04701541 0.0510121  0.0525902
  0.05098313 0.05141868 0.04914158 0.05103556 0.04889556 0.05064733
  0.04839216 0.04925637 0.05110794 0.04892891 0.05099244 0.04785343
  0.05023094 0.04886526]]
2024-10-22 17:00:52,358 - DEBUG - Normalized Policy: [[0.         0.         0.         0.49278492 0.         0.
  0.         0.         0.         0.         0.         0.
  0.5072151  0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:52,359 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 3), (Discard 3)) | P=0.49278491735458374
2024-10-22 17:00:52,360 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 3), (Reveal player +1 color G)) | P=0.5072150826454163
2024-10-22 17:00:52,360 - DEBUG - Simulating Node: ((Discard 1), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:00:52,360 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:52,361 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || XX|YGWB1245
XX || XX|RYGWB1245
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G1 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4}
2024-10-22 17:00:52,361 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:52,361 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:52,361 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:52,361 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.4565487802028656 | PUCT: 0.4565487802028656
2024-10-22 17:00:52,362 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3893522024154663 | PUCT: 0.3893522024154663
2024-10-22 17:00:52,362 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.4565487802028656
2024-10-22 17:00:52,362 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:52,363 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Discard 4)) | Q: 0.0 | U: 1.3101838827133179 | PUCT: 1.3101838827133179
2024-10-22 17:00:52,363 - DEBUG - Selected Child: ((Reveal player +1 color G), (Discard 4)) | PUCT: 1.3101838827133179
2024-10-22 17:00:52,363 - DEBUG - Selected child for exploration: ((Reveal player +1 color G), (Discard 4))
2024-10-22 17:00:52,363 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Discard 4), (Reveal player +1 color W))
2024-10-22 17:00:52,363 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Discard 4))', '((Reveal player +1 color G), (Discard 4), (Reveal player +1 color W))']
2024-10-22 17:00:52,364 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:52,365 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:52,365 - DEBUG - Illegal move encountered: (Reveal player +1 color W)
2024-10-22 17:00:52,365 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:52,365 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:00:52,365 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:52,365 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 1.3333333333333333 | U: 0.35052502155303955 | PUCT: 1.6838583946228027
2024-10-22 17:00:52,366 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3985779285430908 | PUCT: 0.3985779285430908
2024-10-22 17:00:52,366 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 1.6838583946228027
2024-10-22 17:00:52,366 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:52,366 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Discard 4)) | Q: 2.0 | U: 0.9811750054359436 | PUCT: 2.981174945831299
2024-10-22 17:00:52,367 - DEBUG - Selected Child: ((Reveal player +1 color G), (Discard 4)) | PUCT: 2.981174945831299
2024-10-22 17:00:52,367 - DEBUG - Selected child for exploration: ((Reveal player +1 color G), (Discard 4))
2024-10-22 17:00:52,367 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Discard 4), (Discard 1))
2024-10-22 17:00:52,367 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Discard 4))', '((Reveal player +1 color G), (Discard 4), (Discard 1))']
2024-10-22 17:00:52,367 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:52,368 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:52,369 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 3
2024-10-22 17:00:52,579 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:52,579 - DEBUG - Network Policy Logits: [[-0.02311217 -0.01334034  0.02024812 -0.05993544 -0.00409791  0.02904594
  -0.00037175  0.02235968  0.01439401  0.02689391  0.01859194 -0.00632226
  -0.02964437 -0.02050518  0.02174499 -0.03969583  0.03279854 -0.04043535
   0.03582402 -0.04509124]]
2024-10-22 17:00:52,580 - DEBUG - Network Policy after Softmax: [[0.04898579 0.04946681 0.05115655 0.04721478 0.04992612 0.0516086
  0.05011251 0.05126468 0.05085794 0.05149765 0.05107189 0.0498152
  0.04866685 0.04911366 0.05123318 0.04818012 0.05180263 0.0481445
  0.05195959 0.04792087]]
2024-10-22 17:00:52,582 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33920828 0.
  0.         0.         0.         0.         0.         0.
  0.         0.3336882  0.         0.         0.         0.32710359
  0.         0.        ]]
2024-10-22 17:00:52,583 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Discard 1), (Reveal player +1 color W)) | P=0.3336881995201111
2024-10-22 17:00:52,583 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Discard 1), (Discard 4)) | P=0.3392082750797272
2024-10-22 17:00:52,584 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Discard 1), (Reveal player +1 rank 3)) | P=0.3271035850048065
2024-10-22 17:00:52,584 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Discard 4), (Discard 1)) | Value: 0.0
2024-10-22 17:00:52,584 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:52,584 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 19, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 4}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W4 || XX|YGWB12345
W2 || XX|RYGWB12345
Deck size: 19
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 G5 Y4}
2024-10-22 17:00:52,584 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:52,585 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:52,585 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:52,585 - DEBUG - Best node chosen by MCTS: ((Discard 1),) | Visit Count: 5
2024-10-22 17:00:52,585 - INFO - Actual Game Score: 4
2024-10-22 17:00:52,585 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:52,585 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:52,586 - DEBUG - Policy Targets: [0.         0.55555556 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.44444444 0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:52,586 - DEBUG - === End of Training Data ===
2024-10-22 17:00:52,586 - INFO - Chosen Action: (Discard 1) | Visit Count: 5
2024-10-22 17:00:54,380 - DEBUG - Not the current player's turn.
2024-10-22 17:00:54,382 - INFO - Agent state has been reset.
2024-10-22 17:00:54,382 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:54,382 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 19, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W1 || XX|RYGWB12345
Deck size: 19
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1}
2024-10-22 17:00:54,382 - INFO - Max Rollouts: 10
2024-10-22 17:00:54,382 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:54,382 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:54,383 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:54,599 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:54,599 - DEBUG - Network Policy Logits: [[ 3.5580777e-02 -2.6825456e-02  1.5204821e-02 -5.3842869e-02
   1.6141981e-02  4.3955520e-02  2.5001051e-02  3.4150884e-02
  -1.5734538e-02  3.0037560e-02 -4.2548005e-02  5.1834229e-03
  -1.4653807e-02 -2.6920486e-02  9.7461976e-05 -2.0548303e-02
   2.9900135e-02 -3.1896252e-02 -2.3668028e-02 -2.1169189e-02]]
2024-10-22 17:00:54,600 - DEBUG - Network Policy after Softmax: [[0.05190029 0.04876038 0.05085348 0.04746064 0.05090116 0.05233677
  0.0513541  0.05182614 0.04930419 0.05161339 0.04799974 0.0503464
  0.04935751 0.04875575 0.05009099 0.04906743 0.0516063  0.04851376
  0.04891459 0.04903697]]
2024-10-22 17:00:54,601 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32667536 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.3355897  0.         0.33773497 0.         0.
  0.         0.        ]]
2024-10-22 17:00:54,602 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.48989883 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.25679868 0.         0.25330248 0.         0.
 0.         0.        ]
2024-10-22 17:00:54,602 - DEBUG - Added Child Node: ((Reveal player +1 color W),) | P=0.2567986845970154
2024-10-22 17:00:54,603 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.2533024847507477
2024-10-22 17:00:54,604 - DEBUG - Added Child Node: ((Discard 3),) | P=0.48989883065223694
2024-10-22 17:00:54,604 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:54,604 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:54,604 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 19, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W1 || XX|RYGWB12345
Deck size: 19
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1}
2024-10-22 17:00:54,604 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:54,604 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:54,604 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:54,604 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W),)
2024-10-22 17:00:54,604 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)']
2024-10-22 17:00:54,605 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:00:54,818 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:54,818 - DEBUG - Network Policy Logits: [[-0.03346767 -0.01981818  0.01594294 -0.0439558  -0.00804215  0.02499503
  -0.00351206  0.02125756  0.00957706 -0.00034376  0.00295697 -0.03259078
  -0.0123581  -0.00215425  0.02382919 -0.03528043  0.02017663 -0.03057723
   0.03299406 -0.01761125]]
2024-10-22 17:00:54,819 - DEBUG - Network Policy after Softmax: [[0.04855495 0.04922224 0.05101434 0.04804836 0.04980531 0.05147822
  0.05003145 0.05128618 0.05069062 0.05019021 0.05035615 0.04859754
  0.04959082 0.05009943 0.05141824 0.04846701 0.05123078 0.0486955
  0.05189165 0.04933099]]
2024-10-22 17:00:54,821 - DEBUG - Normalized Policy: [[0.32606122 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.3254707  0.         0.
  0.34846818 0.        ]]
2024-10-22 17:00:54,822 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 0)) | P=0.3260612189769745
2024-10-22 17:00:54,822 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 1)) | P=0.3254706859588623
2024-10-22 17:00:54,823 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 4)) | P=0.34846818447113037
2024-10-22 17:00:54,823 - DEBUG - Simulating Node: ((Reveal player +1 color W),) | Value: 0.0
2024-10-22 17:00:54,823 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:54,823 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 19, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || WX|W12345
-----
B4 || B4|B4
R2 || R2|R2
R4 || RX|R12345
Y4 || XX|YGWB12345
B1 || XX|RYGWB12345
Deck size: 19
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1}
2024-10-22 17:00:54,823 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:54,823 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:54,823 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:54,824 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:00:54,824 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:00:54,825 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:55,026 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:55,027 - DEBUG - Network Policy Logits: [[-0.02567719 -0.01025116  0.03307919 -0.05496345 -0.01510991  0.03079138
   0.01309342 -0.00481942  0.02321082  0.04405042  0.00261744 -0.00517377
  -0.03315008 -0.01919411  0.03141122 -0.02206576  0.02329549 -0.04893781
   0.0266521  -0.0357099 ]]
2024-10-22 17:00:55,027 - DEBUG - Network Policy after Softmax: [[0.04882663 0.04958568 0.05178147 0.04741742 0.04934533 0.05166314
  0.05075685 0.04985575 0.05127298 0.0523527  0.0502279  0.04983808
  0.04846312 0.04914421 0.05169517 0.04900329 0.05127733 0.047704
  0.05144973 0.04833922]]
2024-10-22 17:00:55,028 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.5084561  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.49154383
  0.         0.        ]]
2024-10-22 17:00:55,029 - DEBUG - Added Child Node: ((Discard 3), (Discard 4)) | P=0.5084561109542847
2024-10-22 17:00:55,030 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3)) | P=0.49154382944107056
2024-10-22 17:00:55,030 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:00:55,030 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:55,030 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 18, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'G', 'rank': 2}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
G3 || XX|RYGWB12345
Y5 || XX|RYGWB12345
Deck size: 18
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 B1}
2024-10-22 17:00:55,030 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:55,030 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:55,030 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:55,031 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 17:00:55,031 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 17:00:55,031 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:55,237 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:55,237 - DEBUG - Network Policy Logits: [[-0.01513165 -0.01811292  0.02527892 -0.0320617  -0.00027478  0.01892537
  -0.01438422  0.02750862  0.02092823  0.02057902  0.00920472 -0.03271549
  -0.00874826 -0.02095142  0.03394113 -0.0480038   0.02181461 -0.03941891
   0.01787485 -0.01955503]]
2024-10-22 17:00:55,237 - DEBUG - Network Policy after Softmax: [[0.04936561 0.04921865 0.05140135 0.04853688 0.0501045  0.05107581
  0.04940252 0.05151609 0.05117821 0.05116034 0.05058172 0.04850516
  0.04968173 0.04907914 0.05184854 0.04776923 0.05122359 0.04818109
  0.05102218 0.04914773]]
2024-10-22 17:00:55,239 - DEBUG - Normalized Policy: [[0.2466508  0.         0.         0.         0.         0.
  0.         0.         0.         0.25561804 0.         0.
  0.         0.         0.25905654 0.23867467 0.         0.
  0.         0.        ]]
2024-10-22 17:00:55,240 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 4)) | P=0.25561803579330444
2024-10-22 17:00:55,240 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0)) | P=0.2466508001089096
2024-10-22 17:00:55,241 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.23867467045783997
2024-10-22 17:00:55,242 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.25905653834342957
2024-10-22 17:00:55,242 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 17:00:55,242 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:55,242 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 19, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X1|RYGWB1
-----
B4 || B4|B4
R2 || R2|R2
R1 || RX|R12345
B1 || XX|YGWB12345
B2 || XX|RYGWB12345
Deck size: 19
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1}
2024-10-22 17:00:55,242 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:55,242 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:55,242 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:55,243 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.4072301685810089 | PUCT: 0.4072301685810089
2024-10-22 17:00:55,243 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.7768792510032654 | PUCT: 0.7768792510032654
2024-10-22 17:00:55,244 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4016858637332916 | PUCT: 0.4016858637332916
2024-10-22 17:00:55,244 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.7768792510032654
2024-10-22 17:00:55,244 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:55,244 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4))
2024-10-22 17:00:55,244 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))']
2024-10-22 17:00:55,245 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:55,246 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:55,435 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:55,436 - DEBUG - Network Policy Logits: [[ 0.04496106 -0.01947913  0.03273575 -0.05120881  0.01364164  0.05865683
   0.01620134  0.03350341 -0.02976756  0.02937116 -0.03630496 -0.00051038
  -0.04060305 -0.01463354  0.01533888 -0.00464502  0.0157265  -0.04579751
  -0.0299756  -0.02217617]]
2024-10-22 17:00:55,436 - DEBUG - Network Policy after Softmax: [[0.05236468 0.04909672 0.05172841 0.04756335 0.05075007 0.05308679
  0.05088014 0.05176814 0.04859418 0.05155466 0.04827754 0.05003691
  0.04807049 0.0493352  0.05083628 0.04983046 0.05085599 0.04782143
  0.04858407 0.04896449]]
2024-10-22 17:00:55,437 - DEBUG - Normalized Policy: [[0.         0.         0.         0.3241578  0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.33623344 0.         0.33960876 0.         0.
  0.         0.        ]]
2024-10-22 17:00:55,438 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 color W)) | P=0.3362334370613098
2024-10-22 17:00:55,439 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 rank 1)) | P=0.339608758687973
2024-10-22 17:00:55,439 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Discard 3)) | P=0.32415780425071716
2024-10-22 17:00:55,439 - DEBUG - Simulating Node: ((Discard 3), (Discard 4)) | Value: 0.0
2024-10-22 17:00:55,439 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:55,439 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 17, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'B', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W1 || XX|RYGWB12345
Deck size: 17
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 B1 Y4}
2024-10-22 17:00:55,439 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:55,440 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:55,440 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:55,440 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.4296775758266449 | PUCT: 0.4296775758266449
2024-10-22 17:00:55,441 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5464683175086975 | PUCT: 0.5464683175086975
2024-10-22 17:00:55,441 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4238276779651642 | PUCT: 0.4238276779651642
2024-10-22 17:00:55,441 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.5464683175086975
2024-10-22 17:00:55,441 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:55,441 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 3))
2024-10-22 17:00:55,441 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 3))']
2024-10-22 17:00:55,442 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:55,443 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:55,654 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:55,654 - DEBUG - Network Policy Logits: [[ 0.02141771 -0.01391745  0.0169863  -0.04539096  0.01849655  0.04477943
   0.01464815  0.02290295 -0.01697756  0.03523546 -0.02454366  0.00495536
  -0.03293126 -0.00490747  0.02091883 -0.01015711  0.01410808 -0.047792
  -0.00056809 -0.02846232]]
2024-10-22 17:00:55,654 - DEBUG - Network Policy after Softmax: [[0.05109424 0.04932034 0.05086832 0.04779223 0.0509452  0.05230194
  0.05074953 0.05117019 0.04916965 0.05180515 0.04879903 0.05026
  0.04839144 0.04976673 0.05106876 0.04950615 0.05072212 0.04767762
  0.04998315 0.04860818]]
2024-10-22 17:00:55,656 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32497332 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.3383993  0.         0.33662748 0.         0.
  0.         0.        ]]
2024-10-22 17:00:55,657 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Reveal player +1 color W)) | P=0.3383992910385132
2024-10-22 17:00:55,657 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Reveal player +1 rank 1)) | P=0.3366274833679199
2024-10-22 17:00:55,659 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Discard 3)) | P=0.32497331500053406
2024-10-22 17:00:55,659 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:00:55,659 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:55,659 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 18, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || XX|RYGWB1245
XX || XX|RYGWB1245
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W1 || XX|RYGWB12345
Deck size: 18
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W1}
2024-10-22 17:00:55,659 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:55,659 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:55,659 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:55,660 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.44777950644493103 | PUCT: 0.44777950644493103
2024-10-22 17:00:55,660 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4271179437637329 | PUCT: 0.4271179437637329
2024-10-22 17:00:55,661 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.44168317317962646 | PUCT: 0.44168317317962646
2024-10-22 17:00:55,661 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.44777950644493103
2024-10-22 17:00:55,661 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:00:55,661 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Reveal player +1 rank 4))
2024-10-22 17:00:55,661 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Reveal player +1 rank 4))']
2024-10-22 17:00:55,662 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:00:55,663 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:55,882 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:55,883 - DEBUG - Network Policy Logits: [[ 0.04806968 -0.01055653  0.02109217 -0.05280706  0.00039319  0.04532932
   0.00682976  0.02341456 -0.01764967  0.02235558 -0.0457987   0.02938133
  -0.02045125 -0.0105042   0.00116561 -0.0087902   0.02202839 -0.04574155
  -0.0187006  -0.02160212]]
2024-10-22 17:00:55,883 - DEBUG - Network Policy after Softmax: [[0.05252658 0.04953568 0.05112849 0.04748636 0.05008106 0.05238284
  0.05040445 0.05124737 0.04918556 0.05119313 0.04782034 0.05155407
  0.04904795 0.04953827 0.05011976 0.04962325 0.05117638 0.04782307
  0.04913389 0.04899153]]
2024-10-22 17:00:55,885 - DEBUG - Normalized Policy: [[0.         0.         0.         0.48899755 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.5110024  0.         0.
  0.         0.        ]]
2024-10-22 17:00:55,886 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 4), (Discard 3)) | P=0.48899754881858826
2024-10-22 17:00:55,887 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 4), (Reveal player +1 rank 1)) | P=0.5110024213790894
2024-10-22 17:00:55,887 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:00:55,887 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:55,887 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 19, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R1235
XX || XX|YGWB1235
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W1 || WX|W12345
Deck size: 19
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1}
2024-10-22 17:00:55,887 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:55,887 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:55,887 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:55,888 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.30859217047691345 | PUCT: 0.30859217047691345
2024-10-22 17:00:55,888 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4415295422077179 | PUCT: 0.4415295422077179
2024-10-22 17:00:55,889 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.45658621191978455 | PUCT: 0.45658621191978455
2024-10-22 17:00:55,889 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.45658621191978455
2024-10-22 17:00:55,889 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:00:55,889 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Play 4))
2024-10-22 17:00:55,889 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Play 4))']
2024-10-22 17:00:55,890 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:55,891 - DEBUG - Move: (Play 4) | Reward: 5 | Depth: 2
2024-10-22 17:00:56,084 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:56,085 - DEBUG - Network Policy Logits: [[ 0.04949488 -0.02395432  0.011493   -0.06305017  0.0208103   0.04481818
   0.01704662  0.02114376 -0.03319293  0.02106358 -0.04565622 -0.00029894
  -0.03252508 -0.02280114  0.0158627  -0.01985107  0.02155538 -0.03611803
  -0.03260747 -0.03132187]]
2024-10-22 17:00:56,085 - DEBUG - Network Policy after Softmax: [[0.05282265 0.04908193 0.05085295 0.04720005 0.05132898 0.05257619
  0.05113615 0.05134609 0.04863057 0.05134198 0.04802823 0.05025681
  0.04866305 0.04913855 0.05107565 0.04928373 0.05136723 0.04848852
  0.04865904 0.04872164]]
2024-10-22 17:00:56,086 - DEBUG - Normalized Policy: [[0.        0.        0.        0.4788612 0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.5211388 0.        0.        0.       ]]
2024-10-22 17:00:56,087 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 4), (Discard 3)) | P=0.4788612127304077
2024-10-22 17:00:56,087 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 4), (Reveal player +1 rank 2)) | P=0.5211387872695923
2024-10-22 17:00:56,088 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Play 4)) | Value: 0.0
2024-10-22 17:00:56,088 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:56,088 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 18, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B1 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W2 || XX|RYGWB12345
Deck size: 18
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1}
2024-10-22 17:00:56,088 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:56,088 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:56,088 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:56,088 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.31721141934394836 | PUCT: 0.31721141934394836
2024-10-22 17:00:56,089 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4538618326187134 | PUCT: 0.4538618326187134
2024-10-22 17:00:56,089 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.31289270520210266 | PUCT: 0.31289270520210266
2024-10-22 17:00:56,090 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.4538618326187134
2024-10-22 17:00:56,090 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:56,090 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.7483266592025757 | PUCT: 0.7483266592025757
2024-10-22 17:00:56,091 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3)) | Q: 0.0 | U: 0.7234357595443726 | PUCT: 0.7234357595443726
2024-10-22 17:00:56,091 - DEBUG - Selected Child: ((Discard 3), (Discard 4)) | PUCT: 0.7483266592025757
2024-10-22 17:00:56,091 - DEBUG - Selected child for exploration: ((Discard 3), (Discard 4))
2024-10-22 17:00:56,091 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4), (Reveal player +1 color W))
2024-10-22 17:00:56,091 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))', '((Discard 3), (Discard 4), (Reveal player +1 color W))']
2024-10-22 17:00:56,092 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:56,092 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:56,092 - DEBUG - Illegal move encountered: (Reveal player +1 color W)
2024-10-22 17:00:56,092 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:56,093 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:00:56,093 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:56,093 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.32472774386405945 | PUCT: 0.32472774386405945
2024-10-22 17:00:56,094 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 1.0 | U: 0.37169286608695984 | PUCT: 1.3716928958892822
2024-10-22 17:00:56,094 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3203066885471344 | PUCT: 0.3203066885471344
2024-10-22 17:00:56,094 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 1.3716928958892822
2024-10-22 17:00:56,094 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:56,095 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 2.0 | U: 0.5375382304191589 | PUCT: 2.5375382900238037
2024-10-22 17:00:56,095 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3)) | Q: 0.0 | U: 0.7794878482818604 | PUCT: 0.7794878482818604
2024-10-22 17:00:56,095 - DEBUG - Selected Child: ((Discard 3), (Discard 4)) | PUCT: 2.5375382900238037
2024-10-22 17:00:56,095 - DEBUG - Selected child for exploration: ((Discard 3), (Discard 4))
2024-10-22 17:00:56,095 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4), (Discard 3))
2024-10-22 17:00:56,095 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))', '((Discard 3), (Discard 4), (Discard 3))']
2024-10-22 17:00:56,096 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:56,097 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:56,097 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 3
2024-10-22 17:00:56,303 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:56,303 - DEBUG - Network Policy Logits: [[-0.0249047  -0.01538963  0.03750288 -0.05937986 -0.0230366   0.03849462
   0.02659238  0.00614894  0.01853283  0.03587457  0.02139122 -0.0039854
  -0.03701489 -0.01707387  0.02298285 -0.03181676  0.01642065 -0.04609179
   0.02006361 -0.031406  ]]
2024-10-22 17:00:56,303 - DEBUG - Network Policy after Softmax: [[0.04886131 0.04932844 0.05200778 0.04720551 0.04895267 0.05205939
  0.05144344 0.05040243 0.05103049 0.05192317 0.05117657 0.04989422
  0.04827316 0.04924544 0.05125808 0.04852474 0.05092282 0.04783697
  0.05110867 0.04854467]]
2024-10-22 17:00:56,305 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3314052  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.3447429  0.32385194
  0.         0.        ]]
2024-10-22 17:00:56,306 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Discard 3), (Discard 4)) | P=0.3314051926136017
2024-10-22 17:00:56,306 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Discard 3), (Reveal player +1 rank 2)) | P=0.34474289417266846
2024-10-22 17:00:56,307 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Discard 3), (Reveal player +1 rank 3)) | P=0.32385194301605225
2024-10-22 17:00:56,307 - DEBUG - Simulating Node: ((Discard 3), (Discard 4), (Discard 3)) | Value: 0.0
2024-10-22 17:00:56,307 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:56,308 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
Y2 || XX|RYGWB12345
W5 || XX|RYGWB12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W4 G3 B1}
2024-10-22 17:00:56,308 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:56,308 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:56,308 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:56,308 - DEBUG - Best node chosen by MCTS: ((Discard 3),) | Visit Count: 5
2024-10-22 17:00:56,308 - INFO - Actual Game Score: 4
2024-10-22 17:00:56,308 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:56,308 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:56,308 - DEBUG - Policy Targets: [0.         0.         0.         0.55555556 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.22222222 0.         0.22222222 0.         0.
 0.         0.        ]
2024-10-22 17:00:56,309 - DEBUG - === End of Training Data ===
2024-10-22 17:00:56,309 - INFO - Chosen Action: (Discard 3) | Visit Count: 5
2024-10-22 17:00:58,028 - DEBUG - Not the current player's turn.
2024-10-22 17:00:58,030 - INFO - Agent state has been reset.
2024-10-22 17:00:58,030 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:58,030 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 17, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 17
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1}
2024-10-22 17:00:58,030 - INFO - Max Rollouts: 10
2024-10-22 17:00:58,031 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:58,031 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:58,031 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:58,226 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:58,226 - DEBUG - Network Policy Logits: [[ 0.04270248 -0.01934115  0.03106044 -0.04864305  0.01893047  0.06097938
   0.02828008  0.0348582  -0.01146821  0.01552094 -0.02363621  0.00048809
  -0.02826922 -0.01893701  0.01928335 -0.01274626  0.02054384 -0.03666947
  -0.02734519 -0.02875814]]
2024-10-22 17:00:58,227 - DEBUG - Network Policy after Softmax: [[0.05211452 0.04897941 0.05151132 0.04756504 0.05089026 0.05307577
  0.0513683  0.05170732 0.04936654 0.05071704 0.04876949 0.04996033
  0.04854406 0.04899921 0.05090822 0.04930349 0.05097243 0.04813799
  0.04858894 0.04852033]]
2024-10-22 17:00:58,228 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32187095 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34449413 0.33363497 0.         0.
  0.         0.        ]]
2024-10-22 17:00:58,229 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.49140316 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.2583706  0.2502262  0.         0.
 0.         0.        ]
2024-10-22 17:00:58,229 - DEBUG - Added Child Node: ((Discard 3),) | P=0.49140316247940063
2024-10-22 17:00:58,230 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.2502261996269226
2024-10-22 17:00:58,230 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.25837060809135437
2024-10-22 17:00:58,231 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:58,231 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:58,231 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 17, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 17
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1}
2024-10-22 17:00:58,231 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:58,231 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:58,231 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:58,231 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 17:00:58,231 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 17:00:58,232 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:58,415 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:58,416 - DEBUG - Network Policy Logits: [[-0.01737881 -0.01663886  0.03111742 -0.02849389  0.00702803  0.02338845
  -0.00560982  0.00226758  0.02474347  0.02489231 -0.00294243 -0.03346789
  -0.01652819 -0.01386683  0.05043004 -0.03221134  0.01099106 -0.0356745
   0.01859098 -0.01800181]]
2024-10-22 17:00:58,416 - DEBUG - Network Policy after Softmax: [[0.04919176 0.04922817 0.05163617 0.04864802 0.05040715 0.05123861
  0.04977412 0.05016776 0.05130809 0.05131573 0.04990706 0.04840664
  0.04923362 0.04936483 0.05264309 0.04846751 0.05060731 0.04829995
  0.05099338 0.04916112]]
2024-10-22 17:00:58,417 - DEBUG - Normalized Policy: [[0.2459977  0.         0.         0.         0.         0.
  0.         0.         0.         0.25661922 0.         0.
  0.         0.         0.         0.24237587 0.         0.
  0.25500724 0.        ]]
2024-10-22 17:00:58,418 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 4)) | P=0.2566192150115967
2024-10-22 17:00:58,419 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.24237586557865143
2024-10-22 17:00:58,419 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0)) | P=0.24599769711494446
2024-10-22 17:00:58,420 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 4)) | P=0.25500723719596863
2024-10-22 17:00:58,420 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 17:00:58,420 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:58,420 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 17, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X1|RYGWB1
-----
B4 || B4|B4
R2 || R2|R2
R4 || RX|R12345
B1 || XX|RYGWB12345
W2 || XX|RYGWB12345
Deck size: 17
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1}
2024-10-22 17:00:58,420 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:58,420 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:58,420 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:58,421 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:00:58,421 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:00:58,421 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:58,627 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:58,627 - DEBUG - Network Policy Logits: [[-0.02103981 -0.00980604  0.02791184 -0.04373714 -0.01018391  0.04056919
   0.02694348 -0.00633413  0.01748081  0.02795127  0.00927244 -0.02141408
  -0.03150165 -0.01300693  0.02584819 -0.0245984   0.01921113 -0.04053907
   0.01942945 -0.03661733]]
2024-10-22 17:00:58,628 - DEBUG - Network Policy after Softmax: [[0.04905074 0.04960487 0.05151159 0.04794995 0.04958613 0.05216774
  0.05146173 0.04977739 0.05097707 0.05151362 0.05056034 0.04903238
  0.04854025 0.04944634 0.0514054  0.04887649 0.05106535 0.04810355
  0.0510765  0.04829257]]
2024-10-22 17:00:58,629 - DEBUG - Normalized Policy: [[0.         0.         0.34125292 0.         0.         0.
  0.         0.         0.         0.         0.33495107 0.
  0.         0.         0.         0.32379597 0.         0.
  0.         0.        ]]
2024-10-22 17:00:58,629 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R)) | P=0.3349510729312897
2024-10-22 17:00:58,630 - DEBUG - Added Child Node: ((Discard 3), (Discard 2)) | P=0.3412529230117798
2024-10-22 17:00:58,631 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1)) | P=0.32379597425460815
2024-10-22 17:00:58,631 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:00:58,631 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:58,631 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'Y', 'rank': 4}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R1 || RX|R12345
Y5 || XX|RYGWB12345
R4 || XX|RYGWB12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 B2}
2024-10-22 17:00:58,631 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:58,631 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:58,632 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:58,632 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:00:58,632 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:00:58,632 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:58,836 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:58,836 - DEBUG - Network Policy Logits: [[-2.9444888e-02 -1.0289736e-02  4.3435961e-02 -3.1356901e-02
  -2.2236723e-04  2.6830079e-02  6.5193279e-05 -1.3163172e-02
   3.3489157e-02  2.1992944e-02  7.4454984e-03 -4.2097673e-02
  -2.5742013e-02 -1.1149919e-02  2.1654628e-02 -2.0898199e-02
   1.4461698e-02 -3.6584582e-02  3.4924876e-02 -1.1767071e-02]]
2024-10-22 17:00:58,836 - DEBUG - Network Policy after Softmax: [[0.04860276 0.04954273 0.05227725 0.04850992 0.05004402 0.05141631
  0.05005841 0.04940058 0.05175983 0.0511682  0.05042922 0.04799168
  0.04878307 0.04950013 0.05115089 0.04901994 0.05078429 0.04825699
  0.0518342  0.04946959]]
2024-10-22 17:00:58,838 - DEBUG - Normalized Policy: [[0.5017849  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.49821508
  0.         0.        ]]
2024-10-22 17:00:58,839 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0)) | P=0.5017849206924438
2024-10-22 17:00:58,839 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3)) | P=0.49821507930755615
2024-10-22 17:00:58,839 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:00:58,839 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:58,840 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 17, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'B', 'rank': 2}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
B3 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 17
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1}
2024-10-22 17:00:58,840 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:58,840 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:58,840 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:58,841 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.39680755138397217 | PUCT: 0.39680755138397217
2024-10-22 17:00:58,841 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.7792648077011108 | PUCT: 0.7792648077011108
2024-10-22 17:00:58,842 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4097228944301605 | PUCT: 0.4097228944301605
2024-10-22 17:00:58,842 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.7792648077011108
2024-10-22 17:00:58,842 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:58,842 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 2))
2024-10-22 17:00:58,842 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 2))']
2024-10-22 17:00:58,843 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:58,844 - DEBUG - Move: (Discard 2) | Reward: 4 | Depth: 2
2024-10-22 17:00:59,058 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:59,059 - DEBUG - Network Policy Logits: [[ 0.00084511 -0.03203223  0.00238621 -0.064014   -0.02289049  0.0632318
   0.00790036  0.06507186  0.00143877  0.04607806 -0.02418536 -0.02237218
  -0.03052657 -0.02534305  0.0435216  -0.02302541  0.03270012 -0.04385441
  -0.02523109 -0.03395992]]
2024-10-22 17:00:59,059 - DEBUG - Network Policy after Softmax: [[0.0502212  0.0485969  0.05029865 0.04706727 0.0490432  0.05345412
  0.05057677 0.05355258 0.05025102 0.05254501 0.04897974 0.04906863
  0.04867012 0.04892307 0.05241085 0.04903658 0.05184675 0.04802576
  0.04892854 0.04850331]]
2024-10-22 17:00:59,060 - DEBUG - Normalized Policy: [[0.33890575 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.33091167 0.         0.
  0.33018258 0.        ]]
2024-10-22 17:00:59,061 - DEBUG - Added Child Node: ((Discard 3), (Discard 2), (Discard 0)) | P=0.3389057517051697
2024-10-22 17:00:59,062 - DEBUG - Added Child Node: ((Discard 3), (Discard 2), (Reveal player +1 rank 1)) | P=0.33091166615486145
2024-10-22 17:00:59,063 - DEBUG - Added Child Node: ((Discard 3), (Discard 2), (Reveal player +1 rank 4)) | P=0.33018258213996887
2024-10-22 17:00:59,063 - DEBUG - Simulating Node: ((Discard 3), (Discard 2)) | Value: 0.0
2024-10-22 17:00:59,063 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:59,063 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 15, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
R2 || R2|R2
B1 || XX|RYGWB12345
R4 || XX|RYGWB12345
Deck size: 15
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 B3 B5}
2024-10-22 17:00:59,063 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:59,063 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:59,064 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:59,064 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.41868042945861816 | PUCT: 0.41868042945861816
2024-10-22 17:00:59,065 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5481463670730591 | PUCT: 0.5481463670730591
2024-10-22 17:00:59,065 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.43230772018432617 | PUCT: 0.43230772018432617
2024-10-22 17:00:59,066 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.5481463670730591
2024-10-22 17:00:59,066 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:59,066 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 1))
2024-10-22 17:00:59,066 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 1))']
2024-10-22 17:00:59,067 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:59,068 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:59,272 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:59,272 - DEBUG - Network Policy Logits: [[ 2.4750322e-02 -9.6105691e-04  2.7002297e-02 -5.4208133e-02
   1.9408047e-02  6.8901308e-02  3.3412967e-02  2.4725001e-02
  -8.9148898e-03  1.5664708e-02 -2.2240466e-02  1.1474656e-02
  -4.4382401e-02  3.1933188e-05  9.6344333e-03  2.4309061e-03
   6.4672213e-03 -2.2120003e-02 -1.6244479e-02 -2.3875531e-02]]
2024-10-22 17:00:59,272 - DEBUG - Network Policy after Softmax: [[0.05110287 0.04980569 0.05121808 0.04722305 0.05083059 0.05340966
  0.05154748 0.05110157 0.04941112 0.05064067 0.04875705 0.05042893
  0.04768934 0.04985517 0.05033621 0.04997492 0.05017704 0.04876292
  0.04905028 0.0486774 ]]
2024-10-22 17:00:59,274 - DEBUG - Normalized Policy: [[0.         0.         0.         0.23773691 0.         0.
  0.         0.2572627  0.         0.         0.         0.
  0.         0.         0.25340962 0.25159076 0.         0.
  0.         0.        ]]
2024-10-22 17:00:59,274 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Discard 3)) | P=0.23773691058158875
2024-10-22 17:00:59,275 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.251590758562088
2024-10-22 17:00:59,276 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.25340962409973145
2024-10-22 17:00:59,276 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Play 2)) | P=0.2572627067565918
2024-10-22 17:00:59,276 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:00:59,276 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:59,276 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R1|R1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 G5}
2024-10-22 17:00:59,276 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:59,277 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:59,277 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:59,277 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4363190829753876 | PUCT: 0.4363190829753876
2024-10-22 17:00:59,278 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4284294843673706 | PUCT: 0.4284294843673706
2024-10-22 17:00:59,278 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.45052045583724976 | PUCT: 0.45052045583724976
2024-10-22 17:00:59,278 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.45052045583724976
2024-10-22 17:00:59,278 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:59,278 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 rank 3))
2024-10-22 17:00:59,278 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 rank 3))']
2024-10-22 17:00:59,279 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:59,279 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:59,485 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:59,485 - DEBUG - Network Policy Logits: [[ 0.0348865  -0.00991502  0.01096284 -0.02080522  0.01736267  0.02859488
   0.00635059 -0.00171038 -0.00070215  0.01408305  0.00254146  0.03000697
  -0.04426325 -0.0050292   0.0391627  -0.01808794 -0.00474893 -0.0325468
  -0.00239784 -0.02580317]]
2024-10-22 17:00:59,485 - DEBUG - Network Policy after Softmax: [[0.05171612 0.0494503  0.05049357 0.04891469 0.05081775 0.05139177
  0.05026121 0.04985769 0.04990798 0.05065136 0.05007013 0.05146439
  0.0477806  0.04969249 0.05193774 0.04904779 0.04970642 0.04834372
  0.04982343 0.04867083]]
2024-10-22 17:00:59,487 - DEBUG - Normalized Policy: [[0.        0.        0.        0.4993207 0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.5006794 0.        0.        0.        0.       ]]
2024-10-22 17:00:59,488 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3), (Discard 3)) | P=0.4993206858634949
2024-10-22 17:00:59,489 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3), (Reveal player +1 rank 1)) | P=0.5006793737411499
2024-10-22 17:00:59,489 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:00:59,489 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:59,489 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 17, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || XX|RYGWB1245
XX || XX|RYGWB1245
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || BX|B12345
Deck size: 17
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1}
2024-10-22 17:00:59,489 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:59,489 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:59,489 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:59,490 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4510411322116852 | PUCT: 0.4510411322116852
2024-10-22 17:00:59,491 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4428853392601013 | PUCT: 0.4428853392601013
2024-10-22 17:00:59,491 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.31048113107681274 | PUCT: 0.31048113107681274
2024-10-22 17:00:59,492 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.4510411322116852
2024-10-22 17:00:59,492 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:00:59,492 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Play 4))
2024-10-22 17:00:59,492 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Play 4))']
2024-10-22 17:00:59,493 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:59,494 - DEBUG - Move: (Play 4) | Reward: 5 | Depth: 2
2024-10-22 17:00:59,703 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:59,703 - DEBUG - Network Policy Logits: [[ 0.03970637 -0.01940816  0.0302155  -0.06618734  0.01878364  0.05764823
   0.02329236  0.02035474 -0.02635779  0.02941598 -0.03471471 -0.00298054
  -0.03124988 -0.02049244  0.02834656 -0.00949059  0.02241645 -0.04366812
  -0.01969654 -0.01791884]]
2024-10-22 17:00:59,704 - DEBUG - Network Policy after Softmax: [[0.05205643 0.04906832 0.0515647  0.04682581 0.05097858 0.05299884
  0.05120895 0.05105873 0.0487285  0.05152349 0.04832298 0.04988106
  0.0484907  0.04901515 0.05146842 0.04955738 0.05116411 0.04789225
  0.04905418 0.04914146]]
2024-10-22 17:00:59,705 - DEBUG - Normalized Policy: [[0.         0.         0.         0.48793522 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.51206475]]
2024-10-22 17:00:59,706 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 4), (Discard 3)) | P=0.48793521523475647
2024-10-22 17:00:59,707 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 4), (Reveal player +1 rank 5)) | P=0.5120647549629211
2024-10-22 17:00:59,707 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Play 4)) | Value: 0.0
2024-10-22 17:00:59,707 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:59,707 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B1 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y5 || XX|RYGWB12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1}
2024-10-22 17:00:59,707 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:59,707 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:59,707 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:59,708 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3090927302837372 | PUCT: 0.3090927302837372
2024-10-22 17:00:59,709 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4552554786205292 | PUCT: 0.4552554786205292
2024-10-22 17:00:59,709 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.3191531300544739 | PUCT: 0.3191531300544739
2024-10-22 17:00:59,709 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.4552554786205292
2024-10-22 17:00:59,709 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:59,709 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 color R))
2024-10-22 17:00:59,709 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 color R))']
2024-10-22 17:00:59,710 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:59,711 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:00:59,903 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:59,903 - DEBUG - Network Policy Logits: [[ 0.03873774 -0.01388751  0.03345862 -0.0416282   0.01932187  0.05802905
   0.04241651  0.0251181  -0.02674867  0.00967957 -0.0409784  -0.00977578
  -0.03863799 -0.006634    0.03240701 -0.02242782  0.02258492 -0.04503411
  -0.02542835 -0.03172326]]
2024-10-22 17:00:59,903 - DEBUG - Network Policy after Softmax: [[0.0520031  0.04933718 0.05172929 0.04798735 0.05100315 0.05301604
  0.05219476 0.05129964 0.04870671 0.05051373 0.04801854 0.04954046
  0.04813105 0.04969635 0.05167492 0.04891763 0.05116985 0.04782418
  0.04877106 0.04846502]]
2024-10-22 17:00:59,905 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32297334 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34779215 0.32923448 0.         0.
  0.         0.        ]]
2024-10-22 17:00:59,906 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R), (Discard 3)) | P=0.3229733407497406
2024-10-22 17:00:59,907 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R), (Reveal player +1 rank 1)) | P=0.3292344808578491
2024-10-22 17:00:59,908 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R), (Reveal player +1 color B)) | P=0.3477921485900879
2024-10-22 17:00:59,908 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:00:59,908 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:59,908 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
XX || XX|YGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 W5}
2024-10-22 17:00:59,908 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:59,908 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:59,908 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:59,909 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3164167106151581 | PUCT: 0.3164167106151581
2024-10-22 17:00:59,909 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3728342354297638 | PUCT: 0.3728342354297638
2024-10-22 17:00:59,910 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.32671546936035156 | PUCT: 0.32671546936035156
2024-10-22 17:00:59,910 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.3728342354297638
2024-10-22 17:00:59,910 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:59,910 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 2)) | Q: 0.0 | U: 0.5411573052406311 | PUCT: 0.5411573052406311
2024-10-22 17:00:59,911 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.51347416639328 | PUCT: 0.51347416639328
2024-10-22 17:00:59,911 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 color R)) | Q: 0.0 | U: 0.5311638116836548 | PUCT: 0.5311638116836548
2024-10-22 17:00:59,912 - DEBUG - Selected Child: ((Discard 3), (Discard 2)) | PUCT: 0.5411573052406311
2024-10-22 17:00:59,912 - DEBUG - Selected child for exploration: ((Discard 3), (Discard 2))
2024-10-22 17:00:59,912 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 2), (Reveal player +1 rank 4))
2024-10-22 17:00:59,912 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 2))', '((Discard 3), (Discard 2), (Reveal player +1 rank 4))']
2024-10-22 17:00:59,913 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:59,913 - DEBUG - Move: (Discard 2) | Reward: 4 | Depth: 2
2024-10-22 17:00:59,914 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 3
2024-10-22 17:01:00,119 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:00,119 - DEBUG - Network Policy Logits: [[-0.0192362  -0.01319669  0.0377344  -0.01301661 -0.04081368  0.03123584
   0.00697044  0.03382524  0.02261432  0.0384962  -0.01685356 -0.043564
  -0.01240506  0.00241402  0.01603169 -0.00935429  0.01504567 -0.05412822
   0.0035619  -0.02002507]]
2024-10-22 17:01:00,120 - DEBUG - Network Policy after Softmax: [[0.0491151  0.04941263 0.05199445 0.04942152 0.04806667 0.05165766
  0.05041926 0.0517916  0.05121421 0.05203408 0.04923226 0.04793465
  0.04945176 0.05019004 0.05087819 0.04960285 0.05082805 0.04743093
  0.05024769 0.04907637]]
2024-10-22 17:01:00,121 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.24734212 0.
  0.         0.         0.         0.         0.25334007 0.
  0.         0.         0.         0.25524706 0.         0.24407071
  0.         0.        ]]
2024-10-22 17:01:00,122 - DEBUG - Added Child Node: ((Discard 3), (Discard 2), (Reveal player +1 rank 4), (Reveal player +1 color R)) | P=0.25334006547927856
2024-10-22 17:01:00,122 - DEBUG - Added Child Node: ((Discard 3), (Discard 2), (Reveal player +1 rank 4), (Discard 4)) | P=0.24734212458133698
2024-10-22 17:01:00,123 - DEBUG - Added Child Node: ((Discard 3), (Discard 2), (Reveal player +1 rank 4), (Reveal player +1 rank 1)) | P=0.2552470564842224
2024-10-22 17:01:00,124 - DEBUG - Added Child Node: ((Discard 3), (Discard 2), (Reveal player +1 rank 4), (Reveal player +1 rank 3)) | P=0.24407070875167847
2024-10-22 17:01:00,124 - DEBUG - Simulating Node: ((Discard 3), (Discard 2), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:00,124 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:00,124 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 15, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 3}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || R2|R2
XX || XX|RYGWB1235
XX || X4|RYGWB4
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W2 || XX|RYGWB12345
R1 || XX|RYGWB12345
Deck size: 15
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 B1 B5}
2024-10-22 17:01:00,124 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:00,124 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:00,124 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:00,124 - DEBUG - Best node chosen by MCTS: ((Discard 3),) | Visit Count: 5
2024-10-22 17:01:00,124 - INFO - Actual Game Score: 4
2024-10-22 17:01:00,124 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:00,124 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:00,125 - DEBUG - Policy Targets: [0.         0.         0.         0.55555556 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.22222222 0.22222222 0.         0.
 0.         0.        ]
2024-10-22 17:01:00,125 - DEBUG - === End of Training Data ===
2024-10-22 17:01:00,125 - INFO - Chosen Action: (Discard 3) | Visit Count: 5
2024-10-22 17:01:02,276 - DEBUG - Not the current player's turn.
2024-10-22 17:01:02,278 - INFO - Agent state has been reset.
2024-10-22 17:01:02,278 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:02,278 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': 'W', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || WX|W12345
XX || WX|W12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4}
2024-10-22 17:01:02,278 - INFO - Max Rollouts: 10
2024-10-22 17:01:02,278 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:02,278 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:02,279 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:02,504 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:02,504 - DEBUG - Network Policy Logits: [[ 0.04132418 -0.01185502  0.03871687 -0.01698371  0.04656534  0.03393438
   0.0119531   0.0256501  -0.0128173  -0.03466859 -0.04920277 -0.01080843
   0.00854912  0.01113756  0.04977489 -0.00670418  0.00551215 -0.02949108
  -0.01569052 -0.01817476]]
2024-10-22 17:01:02,505 - DEBUG - Network Policy after Softmax: [[0.05191563 0.04922692 0.05178045 0.0489751  0.05218844 0.0515334
  0.05041299 0.05110824 0.04917958 0.0481166  0.04742232 0.04927848
  0.05024167 0.05037189 0.05235621 0.04948114 0.05008932 0.04836637
  0.04903848 0.0489168 ]]
2024-10-22 17:01:02,507 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32474175 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34716108 0.3280972  0.         0.
  0.         0.        ]]
2024-10-22 17:01:02,508 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.4935563  0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.26037082 0.24607289 0.         0.
 0.         0.        ]
2024-10-22 17:01:02,509 - DEBUG - Added Child Node: ((Discard 3),) | P=0.49355629086494446
2024-10-22 17:01:02,510 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.2460728883743286
2024-10-22 17:01:02,510 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.26037082076072693
2024-10-22 17:01:02,511 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:02,511 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:02,511 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': 'W', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || WX|W12345
XX || WX|W12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4}
2024-10-22 17:01:02,511 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:02,511 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:02,511 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:02,511 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 17:01:02,511 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 17:01:02,512 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 1
2024-10-22 17:01:02,706 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:02,706 - DEBUG - Network Policy Logits: [[-0.0031964  -0.0202232   0.04640537 -0.01583621 -0.00321609  0.01541516
   0.01489832 -0.01291233  0.0437113  -0.00721384 -0.00936805 -0.0150434
  -0.01346775  0.00855471  0.04438812 -0.03086767 -0.00230135 -0.05927787
   0.02620991 -0.00256287]]
2024-10-22 17:01:02,707 - DEBUG - Network Policy after Softmax: [[0.04981387 0.04897288 0.05234703 0.0491882  0.04981289 0.05074967
  0.05072344 0.04933222 0.0522062  0.04961415 0.04950738 0.04922721
  0.04930483 0.05040269 0.05224154 0.04845436 0.04985847 0.04709712
  0.05130046 0.04984544]]
2024-10-22 17:01:02,708 - DEBUG - Normalized Policy: [[0.33048746 0.         0.         0.         0.         0.
  0.         0.         0.         0.3291624  0.         0.
  0.         0.         0.         0.         0.         0.
  0.34035015 0.        ]]
2024-10-22 17:01:02,709 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 4)) | P=0.3291623890399933
2024-10-22 17:01:02,710 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0)) | P=0.330487459897995
2024-10-22 17:01:02,710 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 4)) | P=0.3403501510620117
2024-10-22 17:01:02,710 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 17:01:02,710 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:02,710 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': 'W', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X1|RYGWB1
-----
B4 || B4|B4
R2 || R2|R2
R4 || RX|R12345
W2 || WX|W12345
W4 || WX|W12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4}
2024-10-22 17:01:02,710 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:02,710 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:02,711 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:02,711 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:01:02,711 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:01:02,712 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:02,895 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:02,895 - DEBUG - Network Policy Logits: [[-0.00638304 -0.0140127   0.04824536 -0.04154458 -0.01084565  0.02989295
   0.0518742   0.00952415  0.02360817  0.01125645 -0.00581174 -0.0065991
  -0.03264327 -0.00652748  0.0120215  -0.01784587  0.00905928 -0.05473783
   0.02224535 -0.01949368]]
2024-10-22 17:01:02,895 - DEBUG - Network Policy after Softmax: [[0.04966083 0.04928337 0.05244919 0.04794502 0.04943971 0.0514954
  0.05263986 0.05045711 0.05117278 0.05054459 0.04968921 0.0496501
  0.0483737  0.04965366 0.05058328 0.04909483 0.05043366 0.04731662
  0.05110309 0.04901399]]
2024-10-22 17:01:02,897 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3389737  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.33660913 0.         0.3244172
  0.         0.        ]]
2024-10-22 17:01:02,898 - DEBUG - Added Child Node: ((Discard 3), (Discard 4)) | P=0.3389737010002136
2024-10-22 17:01:02,898 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1)) | P=0.3366091251373291
2024-10-22 17:01:02,899 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3)) | P=0.32441720366477966
2024-10-22 17:01:02,899 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:01:02,899 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:02,899 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 15, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W1 || WX|W12345
G3 || XX|RYGWB12345
Deck size: 15
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W4}
2024-10-22 17:01:02,899 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:02,899 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:02,899 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:02,899 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:01:02,899 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:01:02,900 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:03,092 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:03,092 - DEBUG - Network Policy Logits: [[-0.00518402 -0.01554445  0.04943379 -0.01712954 -0.0069852   0.0113789
   0.01553352 -0.01203055  0.02763119 -0.01624885  0.00619296 -0.00808598
  -0.02759683  0.01343438  0.02843376 -0.02933535  0.00034658 -0.05559925
   0.03125163 -0.00414409]]
2024-10-22 17:01:03,092 - DEBUG - Network Policy after Softmax: [[0.04976275 0.04924985 0.05255628 0.04917185 0.0496732  0.05059383
  0.05080447 0.04942321 0.05142282 0.04921517 0.05033213 0.04961855
  0.04865984 0.05069793 0.0514641  0.04857531 0.05003873 0.04731614
  0.05160933 0.04981453]]
2024-10-22 17:01:03,094 - DEBUG - Normalized Policy: [[0.3346785  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.31822386
  0.3470976  0.        ]]
2024-10-22 17:01:03,095 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0)) | P=0.3346785008907318
2024-10-22 17:01:03,096 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3)) | P=0.31822386384010315
2024-10-22 17:01:03,096 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 4)) | P=0.34709760546684265
2024-10-22 17:01:03,096 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:01:03,096 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:03,096 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': 'W', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W4 || WX|W12345
W2 || WX|W12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4}
2024-10-22 17:01:03,097 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:03,097 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:03,097 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:03,097 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3902212381362915 | PUCT: 0.3902212381362915
2024-10-22 17:01:03,098 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.7826792597770691 | PUCT: 0.7826792597770691
2024-10-22 17:01:03,098 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4128948152065277 | PUCT: 0.4128948152065277
2024-10-22 17:01:03,099 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.7826792597770691
2024-10-22 17:01:03,099 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:03,099 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4))
2024-10-22 17:01:03,099 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))']
2024-10-22 17:01:03,100 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:03,100 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:03,299 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:03,299 - DEBUG - Network Policy Logits: [[ 0.05014079 -0.00776414  0.01681409 -0.04633297  0.02442014  0.02526709
   0.03267808  0.01300816 -0.02322765  0.00798236 -0.04056249  0.01831985
  -0.02376312 -0.02944711  0.03143044 -0.01405963  0.01702371 -0.02365959
  -0.02504354 -0.04218242]]
2024-10-22 17:01:03,299 - DEBUG - Network Policy after Softmax: [[0.05265258 0.04969033 0.05092676 0.04781032 0.05131559 0.05135907
  0.0517411  0.05073331 0.04892785 0.05047897 0.04808701 0.0510035
  0.04890166 0.04862449 0.05167659 0.04937849 0.05093744 0.04890672
  0.04883909 0.04800917]]
2024-10-22 17:01:03,300 - DEBUG - Normalized Policy: [[0.5187872  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.48121276 0.        ]]
2024-10-22 17:01:03,301 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Discard 0)) | P=0.5187872052192688
2024-10-22 17:01:03,302 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 rank 4)) | P=0.4812127649784088
2024-10-22 17:01:03,302 - DEBUG - Simulating Node: ((Discard 3), (Discard 4)) | Value: 0.0
2024-10-22 17:01:03,302 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:03,302 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || WX|W12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
R4 || XX|RYGWB12345
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B2}
2024-10-22 17:01:03,302 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:03,302 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:03,302 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:03,303 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4117310643196106 | PUCT: 0.4117310643196106
2024-10-22 17:01:03,303 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5505481362342834 | PUCT: 0.5505481362342834
2024-10-22 17:01:03,304 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.43565449118614197 | PUCT: 0.43565449118614197
2024-10-22 17:01:03,304 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.5505481362342834
2024-10-22 17:01:03,304 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:03,304 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 1))
2024-10-22 17:01:03,304 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 1))']
2024-10-22 17:01:03,305 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:03,305 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:01:03,305 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:03,305 - DEBUG - Rollout #6 completed with reward=4
2024-10-22 17:01:03,305 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:03,305 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4290769398212433 | PUCT: 0.4290769398212433
2024-10-22 17:01:03,306 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 1.3333333333333333 | U: 0.43030670285224915 | PUCT: 1.76364004611969
2024-10-22 17:01:03,306 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4540082514286041 | PUCT: 0.4540082514286041
2024-10-22 17:01:03,306 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 1.76364004611969
2024-10-22 17:01:03,307 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:03,307 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 3))
2024-10-22 17:01:03,307 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 3))']
2024-10-22 17:01:03,307 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:03,307 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:01:03,308 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:03,308 - DEBUG - Rollout #7 completed with reward=4
2024-10-22 17:01:03,308 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:03,308 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4435546398162842 | PUCT: 0.4435546398162842
2024-10-22 17:01:03,309 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 2.0 | U: 0.35586073994636536 | PUCT: 2.355860710144043
2024-10-22 17:01:03,309 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4693271517753601 | PUCT: 0.4693271517753601
2024-10-22 17:01:03,309 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 2.355860710144043
2024-10-22 17:01:03,309 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:03,310 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.5375429391860962 | PUCT: 0.5375429391860962
2024-10-22 17:01:03,310 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.5337931513786316 | PUCT: 4.533792972564697
2024-10-22 17:01:03,310 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3)) | Q: 4.0 | U: 0.5144592523574829 | PUCT: 4.514459133148193
2024-10-22 17:01:03,311 - DEBUG - Selected Child: ((Discard 3), (Reveal player +1 rank 1)) | PUCT: 4.533792972564697
2024-10-22 17:01:03,311 - DEBUG - Selected child for exploration: ((Discard 3), (Reveal player +1 rank 1))
2024-10-22 17:01:03,311 - DEBUG - Node ((Discard 3), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:01:03,311 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 1))']
2024-10-22 17:01:03,311 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:03,311 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:01:03,312 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:03,312 - DEBUG - Rollout #8 completed with reward=4
2024-10-22 17:01:03,312 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:03,312 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4559434950351715 | PUCT: 0.4559434950351715
2024-10-22 17:01:03,313 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 2.4 | U: 0.3048335015773773 | PUCT: 2.704833507537842
2024-10-22 17:01:03,313 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.48243585228919983 | PUCT: 0.48243585228919983
2024-10-22 17:01:03,313 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 2.704833507537842
2024-10-22 17:01:03,313 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:03,314 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.567173421382904 | PUCT: 0.567173421382904
2024-10-22 17:01:03,314 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.37547799944877625 | PUCT: 4.3754777908325195
2024-10-22 17:01:03,314 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3)) | Q: 4.0 | U: 0.5428173542022705 | PUCT: 4.542817115783691
2024-10-22 17:01:03,315 - DEBUG - Selected Child: ((Discard 3), (Reveal player +1 rank 3)) | PUCT: 4.542817115783691
2024-10-22 17:01:03,315 - DEBUG - Selected child for exploration: ((Discard 3), (Reveal player +1 rank 3))
2024-10-22 17:01:03,315 - DEBUG - Node ((Discard 3), (Reveal player +1 rank 3)) is a leaf node.
2024-10-22 17:01:03,315 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 3))']
2024-10-22 17:01:03,315 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:03,316 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:03,509 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:03,510 - DEBUG - Network Policy Logits: [[ 0.05565519 -0.01631819  0.03606986 -0.0156362   0.04931965  0.01856253
   0.01235521  0.01713385 -0.01199727 -0.00367295 -0.04989004 -0.00696968
  -0.00358803 -0.01089715  0.04052058 -0.01082273  0.00460146 -0.01961845
  -0.0294458  -0.00345844]]
2024-10-22 17:01:03,510 - DEBUG - Network Policy after Softmax: [[0.05270631 0.04904615 0.05168408 0.04907961 0.05237344 0.05078711
  0.05047283 0.0507146  0.04925854 0.04967029 0.04742692 0.04950681
  0.04967451 0.04931276 0.05191462 0.04931643 0.05008299 0.04888456
  0.0484065  0.04968095]]
2024-10-22 17:01:03,511 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32652116 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34538218 0.32809666 0.         0.
  0.         0.        ]]
2024-10-22 17:01:03,512 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Discard 3)) | P=0.3265211582183838
2024-10-22 17:01:03,513 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Reveal player +1 rank 1)) | P=0.3280966579914093
2024-10-22 17:01:03,514 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Reveal player +1 color B)) | P=0.3453821837902069
2024-10-22 17:01:03,514 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:01:03,514 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:03,514 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 15, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': 2}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R1245
XX || WX|W1245
XX || X3|RYGWB3
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 15
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2}
2024-10-22 17:01:03,514 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:03,514 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:03,514 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:03,515 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.46674707531929016 | PUCT: 0.46674707531929016
2024-10-22 17:01:03,515 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 2.0 | U: 0.26747703552246094 | PUCT: 2.267477035522461
2024-10-22 17:01:03,516 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4938671886920929 | PUCT: 0.4938671886920929
2024-10-22 17:01:03,516 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 2.267477035522461
2024-10-22 17:01:03,516 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:03,516 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.5910679697990417 | PUCT: 0.5910679697990417
2024-10-22 17:01:03,517 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.3912965953350067 | PUCT: 4.39129638671875
2024-10-22 17:01:03,518 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3)) | Q: 2.0 | U: 0.3771238625049591 | PUCT: 2.3771238327026367
2024-10-22 17:01:03,518 - DEBUG - Selected Child: ((Discard 3), (Reveal player +1 rank 1)) | PUCT: 4.39129638671875
2024-10-22 17:01:03,518 - DEBUG - Selected child for exploration: ((Discard 3), (Reveal player +1 rank 1))
2024-10-22 17:01:03,518 - DEBUG - Node ((Discard 3), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:01:03,518 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 1))']
2024-10-22 17:01:03,519 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:03,519 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:03,728 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:03,728 - DEBUG - Network Policy Logits: [[ 0.03856188  0.01268725  0.02182686 -0.04312385  0.02744066  0.03474014
   0.03570535  0.01534555 -0.0090428   0.00562597 -0.03143592  0.01293658
  -0.02220196 -0.00497873  0.01354527 -0.01325583  0.00054692 -0.0159036
  -0.01210196 -0.02071706]]
2024-10-22 17:01:03,729 - DEBUG - Network Policy after Softmax: [[0.05183248 0.05050854 0.05097228 0.04776682 0.05125923 0.05163477
  0.05168463 0.05064298 0.04942282 0.05015314 0.04832839 0.05052113
  0.04877672 0.04962409 0.05055189 0.04921504 0.04989905 0.0490849
  0.04927186 0.0488492 ]]
2024-10-22 17:01:03,731 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24103142 0.         0.
  0.         0.25554454 0.         0.         0.         0.
  0.         0.         0.2550849  0.24833913 0.         0.
  0.         0.        ]]
2024-10-22 17:01:03,732 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Discard 3)) | P=0.24103142321109772
2024-10-22 17:01:03,732 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.24833913147449493
2024-10-22 17:01:03,733 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.25508490204811096
2024-10-22 17:01:03,734 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Play 2)) | P=0.2555445432662964
2024-10-22 17:01:03,734 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:03,734 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:03,734 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 15, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R1|R1
XX || WX|W2345
XX || XX|RYGWB2345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 15
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W4}
2024-10-22 17:01:03,734 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:03,734 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:03,734 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:03,735 - DEBUG - Best node chosen by MCTS: ((Discard 3),) | Visit Count: 7
2024-10-22 17:01:03,735 - INFO - Actual Game Score: 4
2024-10-22 17:01:03,735 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:03,735 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:03,735 - DEBUG - Policy Targets: [0.         0.         0.         0.77777778 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.11111111 0.11111111 0.         0.
 0.         0.        ]
2024-10-22 17:01:03,735 - DEBUG - === End of Training Data ===
2024-10-22 17:01:03,735 - INFO - Chosen Action: (Discard 3) | Visit Count: 7
2024-10-22 17:01:05,636 - DEBUG - Not the current player's turn.
2024-10-22 17:01:05,637 - INFO - Agent state has been reset.
2024-10-22 17:01:05,637 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:05,638 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || WX|W12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || XX|RYGWB12345
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:05,638 - INFO - Max Rollouts: 10
2024-10-22 17:01:05,638 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:05,638 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:05,638 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:05,838 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:05,838 - DEBUG - Network Policy Logits: [[ 0.05514297 -0.00881157  0.01964936 -0.04831221  0.03615495  0.02247302
   0.03474378  0.02728926 -0.00788722 -0.00161232 -0.02629137  0.01937005
  -0.01109448 -0.03257217  0.04515067 -0.02303227  0.02456839 -0.0219636
  -0.01793429 -0.04051021]]
2024-10-22 17:01:05,838 - DEBUG - Network Policy after Softmax: [[0.05269412 0.04942959 0.05085661 0.04751515 0.051703   0.05100042
  0.05163009 0.05124664 0.0494753  0.04978673 0.04857308 0.05084241
  0.04931688 0.04826896 0.0521702  0.04873164 0.0511074  0.04878375
  0.04898071 0.04788731]]
2024-10-22 17:01:05,839 - DEBUG - Normalized Policy: [[0.        0.        0.        0.4980495 0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.5019505]]
2024-10-22 17:01:05,840 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.37353712 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.6264629 ]
2024-10-22 17:01:05,840 - DEBUG - Added Child Node: ((Discard 3),) | P=0.3735371232032776
2024-10-22 17:01:05,841 - DEBUG - Added Child Node: ((Reveal player +1 rank 5),) | P=0.6264628767967224
2024-10-22 17:01:05,841 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:05,841 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:05,841 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || WX|W12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || XX|RYGWB12345
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:05,841 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:05,841 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:05,841 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:05,842 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5),)
2024-10-22 17:01:05,842 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)']
2024-10-22 17:01:05,842 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:01:06,043 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:06,044 - DEBUG - Network Policy Logits: [[ 0.01220912 -0.01797107  0.03852769 -0.01708097  0.02032113  0.00040163
   0.03189019  0.0146261   0.01735334  0.00853476  0.00264716 -0.01819622
  -0.02319136  0.00916817  0.02122466 -0.02378947  0.01354235 -0.04772553
   0.02103721 -0.00140818]]
2024-10-22 17:01:06,044 - DEBUG - Network Policy after Softmax: [[0.05044598 0.04894625 0.05179127 0.04898984 0.05085686 0.04985384
  0.05144864 0.05056805 0.05070615 0.05026096 0.04996592 0.04893523
  0.04869141 0.05029281 0.05090283 0.04866229 0.05051328 0.04751134
  0.05089329 0.0497637 ]]
2024-10-22 17:01:06,046 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33811605 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.32352573 0.         0.
  0.33835825 0.        ]]
2024-10-22 17:01:06,047 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4)) | P=0.3381160497665405
2024-10-22 17:01:06,047 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1)) | P=0.32352572679519653
2024-10-22 17:01:06,048 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 4)) | P=0.3383582532405853
2024-10-22 17:01:06,048 - DEBUG - Simulating Node: ((Reveal player +1 rank 5),) | Value: 0.0
2024-10-22 17:01:06,048 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:06,048 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R1 || RX|R12345
W4 || WX|W12345
R4 || XX|RYGWB12345
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:06,048 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:06,048 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:06,049 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:06,049 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:01:06,049 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:01:06,050 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:06,262 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:06,263 - DEBUG - Network Policy Logits: [[-0.01174426 -0.00644231  0.03734983 -0.04213584 -0.0115361   0.02498019
   0.03315383  0.01563017  0.02461649  0.01190116  0.01266246 -0.01510546
  -0.04593987 -0.03326968  0.03671884 -0.0221122   0.02240392 -0.03362966
   0.01055374 -0.04203869]]
2024-10-22 17:01:06,263 - DEBUG - Network Policy after Softmax: [[0.04948162 0.04974466 0.05197149 0.04800041 0.04949192 0.05133258
  0.05175387 0.05085486 0.05131391 0.05066557 0.05070416 0.04931557
  0.04781817 0.04842788 0.05193871 0.04897124 0.0512005  0.04841045
  0.05059735 0.04800508]]
2024-10-22 17:01:06,264 - DEBUG - Normalized Policy: [[0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.5147035 0.4852965 0.        0.        0.        0.       ]]
2024-10-22 17:01:06,265 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1)) | P=0.48529648780822754
2024-10-22 17:01:06,265 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color B)) | P=0.5147035121917725
2024-10-22 17:01:06,265 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:01:06,266 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:06,266 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 8, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 2}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 8
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R1 || RX|R12345
B3 || XX|RYGWB12345
G3 || XX|RYGWB12345
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4}
2024-10-22 17:01:06,266 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:06,266 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:06,266 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:06,267 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.9220045804977417 | PUCT: 0.9220045804977417
2024-10-22 17:01:06,267 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5497578978538513 | PUCT: 0.5497578978538513
2024-10-22 17:01:06,268 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 0.9220045804977417
2024-10-22 17:01:06,268 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:01:06,268 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5), (Discard 4))
2024-10-22 17:01:06,268 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Discard 4))']
2024-10-22 17:01:06,268 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:01:06,269 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:06,467 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:06,468 - DEBUG - Network Policy Logits: [[ 0.05017649 -0.00132126  0.0190736  -0.04416427  0.03000292  0.03028523
   0.03819218  0.02221601 -0.01980705 -0.00180621 -0.03774951  0.0115404
  -0.037517   -0.03872448  0.04952019 -0.00845439  0.02085179 -0.02530433
  -0.02949858 -0.05041869]]
2024-10-22 17:01:06,468 - DEBUG - Network Policy after Softmax: [[0.05260617 0.04996565 0.05099515 0.04787018 0.05155555 0.05157011
  0.05197949 0.05115565 0.04905048 0.04994142 0.04817824 0.05061244
  0.04818944 0.04813129 0.05257166 0.0496105  0.05108591 0.04878157
  0.0485774  0.04757171]]
2024-10-22 17:01:06,469 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33050114 0.         0.
  0.         0.         0.         0.         0.         0.
  0.33270538 0.         0.         0.         0.         0.3367935
  0.         0.        ]]
2024-10-22 17:01:06,470 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4), (Discard 3)) | P=0.33050113916397095
2024-10-22 17:01:06,471 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4), (Reveal player +1 rank 3)) | P=0.3367935121059418
2024-10-22 17:01:06,471 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4), (Reveal player +1 color G)) | P=0.33270537853240967
2024-10-22 17:01:06,471 - DEBUG - Simulating Node: ((Reveal player +1 rank 5), (Discard 4)) | Value: 0.0
2024-10-22 17:01:06,471 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:06,471 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || WX|W12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G3 || XX|RYGWB12345
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 G5}
2024-10-22 17:01:06,471 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:06,471 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:06,472 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:06,472 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.6622945666313171 | PUCT: 0.6622945666313171
2024-10-22 17:01:06,473 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5923534035682678 | PUCT: 0.5923534035682678
2024-10-22 17:01:06,473 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 0.6622945666313171
2024-10-22 17:01:06,473 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:01:06,473 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5), (Reveal player +1 rank 4))
2024-10-22 17:01:06,473 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Reveal player +1 rank 4))']
2024-10-22 17:01:06,473 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:01:06,474 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:06,671 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:06,672 - DEBUG - Network Policy Logits: [[ 0.07324572 -0.00386662  0.03505376 -0.02651762  0.04068751  0.00403764
   0.01031428 -0.00786127 -0.00351764 -0.00222451 -0.02332358  0.03816431
  -0.02561968 -0.00797753  0.04265852 -0.00804975  0.01456707 -0.02161313
  -0.01806912 -0.03145262]]
2024-10-22 17:01:06,672 - DEBUG - Network Policy after Softmax: [[0.05356776 0.04959228 0.05156048 0.04848159 0.05185178 0.04998582
  0.05030055 0.04939457 0.04960959 0.04967378 0.04863669 0.05172111
  0.04852514 0.04938883 0.05195408 0.04938526 0.05051492 0.04871995
  0.04889292 0.04824292]]
2024-10-22 17:01:06,674 - DEBUG - Normalized Policy: [[0.         0.         0.         0.4953651  0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.50463486 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:06,675 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 4), (Reveal player +1 color W)) | P=0.5046348571777344
2024-10-22 17:01:06,675 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 4), (Discard 3)) | P=0.49536511301994324
2024-10-22 17:01:06,676 - DEBUG - Simulating Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:06,676 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:06,676 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R1235
XX || W4|W4
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:06,676 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:06,676 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:06,676 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:06,677 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.5241012573242188 | PUCT: 0.5241012573242188
2024-10-22 17:01:06,677 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.6250051856040955 | PUCT: 0.6250051856040955
2024-10-22 17:01:06,677 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.6250051856040955
2024-10-22 17:01:06,677 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:06,677 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 color B))
2024-10-22 17:01:06,677 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 color B))']
2024-10-22 17:01:06,678 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:06,679 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:06,875 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:06,876 - DEBUG - Network Policy Logits: [[ 0.03948642 -0.03123972  0.02617391 -0.05096518  0.0227611   0.03061881
   0.03729697  0.03699094 -0.01132991  0.00202081 -0.03606267  0.00697748
  -0.03219049 -0.03353867  0.02045543  0.00047314  0.01223035 -0.01202869
  -0.04390862 -0.0287624 ]]
2024-10-22 17:01:06,876 - DEBUG - Network Policy after Softmax: [[0.0521076  0.04854953 0.05141851 0.04760126 0.05124333 0.05164757
  0.05199363 0.05197773 0.04952584 0.05019147 0.04831595 0.05044087
  0.0485034  0.04843805 0.05112532 0.05011385 0.05070653 0.04949124
  0.04793835 0.04866996]]
2024-10-22 17:01:06,878 - DEBUG - Normalized Policy: [[0.         0.         0.         0.49444953 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.50555044]]
2024-10-22 17:01:06,878 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color B), (Discard 3)) | P=0.49444952607154846
2024-10-22 17:01:06,879 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color B), (Reveal player +1 rank 5)) | P=0.5055504441261292
2024-10-22 17:01:06,879 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:06,879 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:06,879 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|RYGW12345
XX || XX|RYGW12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || XX|RYGWB12345
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4}
2024-10-22 17:01:06,879 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:06,879 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:06,879 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:06,880 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.5461812019348145 | PUCT: 0.5461812019348145
2024-10-22 17:01:06,880 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.43422409892082214 | PUCT: 0.43422409892082214
2024-10-22 17:01:06,881 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 0.5461812019348145
2024-10-22 17:01:06,881 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:01:06,881 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5), (Reveal player +1 rank 1))
2024-10-22 17:01:06,881 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Reveal player +1 rank 1))']
2024-10-22 17:01:06,882 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:01:06,882 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:07,076 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:07,077 - DEBUG - Network Policy Logits: [[ 0.05717787  0.01673888  0.01453453 -0.02230921  0.03166668  0.00164989
   0.02015784  0.00152119 -0.00624394  0.00869372 -0.00690193  0.0347181
  -0.03385409 -0.00654774  0.03455205 -0.00657878  0.00784892 -0.01874685
  -0.02279173 -0.04148219]]
2024-10-22 17:01:07,077 - DEBUG - Network Policy after Softmax: [[0.05275783 0.05066692 0.05055536 0.0487266  0.05142894 0.04990815
  0.05084045 0.04990173 0.04951574 0.05026093 0.04948316 0.05158611
  0.0481673  0.04950069 0.05157755 0.04949916 0.05021849 0.0489005
  0.0487031  0.04780127]]
2024-10-22 17:01:07,078 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32894707 0.         0.
  0.         0.33688018 0.         0.         0.         0.
  0.         0.33417284 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:07,079 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1), (Reveal player +1 color W)) | P=0.3341728448867798
2024-10-22 17:01:07,079 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1), (Discard 3)) | P=0.3289470672607422
2024-10-22 17:01:07,080 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1), (Play 2)) | P=0.3368801772594452
2024-10-22 17:01:07,080 - DEBUG - Simulating Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:07,080 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:07,080 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R1|R1
XX || WX|W2345
XX || XX|RYGWB2345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:07,080 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:07,080 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:07,080 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:07,081 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.45168814063072205 | PUCT: 0.45168814063072205
2024-10-22 17:01:07,082 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.44887545704841614 | PUCT: 0.44887545704841614
2024-10-22 17:01:07,082 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 0.45168814063072205
2024-10-22 17:01:07,082 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:01:07,082 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Discard 4)) | Q: 0.0 | U: 0.5361828207969666 | PUCT: 0.5361828207969666
2024-10-22 17:01:07,082 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.5365669131278992 | PUCT: 0.5365669131278992
2024-10-22 17:01:07,083 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5130455493927002 | PUCT: 0.5130455493927002
2024-10-22 17:01:07,083 - DEBUG - Selected Child: ((Reveal player +1 rank 5), (Reveal player +1 rank 4)) | PUCT: 0.5365669131278992
2024-10-22 17:01:07,083 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5), (Reveal player +1 rank 4))
2024-10-22 17:01:07,083 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5), (Reveal player +1 rank 4), (Reveal player +1 color W))
2024-10-22 17:01:07,083 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Reveal player +1 rank 4))', '((Reveal player +1 rank 5), (Reveal player +1 rank 4), (Reveal player +1 color W))']
2024-10-22 17:01:07,084 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:01:07,084 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:07,085 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 3
2024-10-22 17:01:07,286 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:07,287 - DEBUG - Network Policy Logits: [[ 0.00862897 -0.01645837  0.03087469  0.01483629  0.00589895 -0.01972401
   0.01707517  0.00364647  0.00411777 -0.00033711 -0.00059655 -0.0071811
  -0.03116234  0.02088605  0.03336873 -0.01746776 -0.00043191 -0.02037433
   0.00261022  0.01054495]]
2024-10-22 17:01:07,287 - DEBUG - Network Policy after Softmax: [[0.05032864 0.04908174 0.05146078 0.05064201 0.05019143 0.04892171
  0.05075552 0.0500785  0.05010211 0.04987941 0.04986647 0.0495392
  0.04836532 0.05094932 0.05158929 0.04903222 0.04987468 0.04888991
  0.05002663 0.05042516]]
2024-10-22 17:01:07,288 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33697328 0.
  0.         0.         0.         0.         0.33479157 0.
  0.         0.         0.         0.         0.         0.32823518
  0.         0.        ]]
2024-10-22 17:01:07,289 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 4), (Reveal player +1 color W), (Reveal player +1 color R)) | P=0.3347915709018707
2024-10-22 17:01:07,290 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 4), (Reveal player +1 color W), (Discard 4)) | P=0.33697327971458435
2024-10-22 17:01:07,291 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 4), (Reveal player +1 color W), (Reveal player +1 rank 3)) | P=0.3282351791858673
2024-10-22 17:01:07,291 - DEBUG - Simulating Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 4), (Reveal player +1 color W)) | Value: 0.0
2024-10-22 17:01:07,291 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:07,291 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': 3}, {'color': None, 'rank': 3}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R1235
W4 || W4|W4
R4 || X4|RYGWB4
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:07,291 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:07,291 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:07,291 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:07,292 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.38692012429237366 | PUCT: 0.38692012429237366
2024-10-22 17:01:07,292 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4614129066467285 | PUCT: 0.4614129066467285
2024-10-22 17:01:07,292 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.4614129066467285
2024-10-22 17:01:07,292 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:07,292 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 1))
2024-10-22 17:01:07,292 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 1))']
2024-10-22 17:01:07,293 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:07,294 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:07,488 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:07,489 - DEBUG - Network Policy Logits: [[ 0.04174495 -0.02382103  0.02877593 -0.03147329  0.04114344  0.04420994
   0.03316332  0.03770532 -0.00520705  0.00170894 -0.04564879 -0.00079231
  -0.03586552 -0.01902248  0.03741033  0.00090179  0.00602961 -0.01451308
  -0.03969486 -0.01317533]]
2024-10-22 17:01:07,489 - DEBUG - Network Policy after Softmax: [[0.05199537 0.04869561 0.0513254  0.04832439 0.05196411 0.0521237
  0.05155108 0.05178576 0.04961051 0.04995481 0.04764421 0.04983002
  0.04811261 0.04892984 0.05177048 0.0499145  0.05017111 0.04915097
  0.04792872 0.04921677]]
2024-10-22 17:01:07,491 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32763198 0.         0.
  0.         0.         0.         0.3386859  0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.33368212]]
2024-10-22 17:01:07,491 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Discard 3)) | P=0.32763198018074036
2024-10-22 17:01:07,492 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Reveal player +1 rank 5)) | P=0.333682119846344
2024-10-22 17:01:07,493 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Play 4)) | P=0.33868589997291565
2024-10-22 17:01:07,493 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:07,493 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:07,493 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || XX|RYGWB12345
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4}
2024-10-22 17:01:07,493 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:07,493 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:07,493 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:07,494 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.39608824253082275 | PUCT: 0.39608824253082275
2024-10-22 17:01:07,495 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.35425958037376404 | PUCT: 0.35425958037376404
2024-10-22 17:01:07,495 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 0.39608824253082275
2024-10-22 17:01:07,495 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:01:07,496 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Discard 4)) | Q: 0.0 | U: 0.5657383799552917 | PUCT: 0.5657383799552917
2024-10-22 17:01:07,496 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.3774290978908539 | PUCT: 0.3774290978908539
2024-10-22 17:01:07,496 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5413257479667664 | PUCT: 0.5413257479667664
2024-10-22 17:01:07,497 - DEBUG - Selected Child: ((Reveal player +1 rank 5), (Discard 4)) | PUCT: 0.5657383799552917
2024-10-22 17:01:07,497 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5), (Discard 4))
2024-10-22 17:01:07,497 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5), (Discard 4), (Discard 3))
2024-10-22 17:01:07,497 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Discard 4))', '((Reveal player +1 rank 5), (Discard 4), (Discard 3))']
2024-10-22 17:01:07,497 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:01:07,498 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:07,499 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 3
2024-10-22 17:01:07,716 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:07,716 - DEBUG - Network Policy Logits: [[-0.01252371 -0.01236163  0.03787568 -0.03128836 -0.00255221  0.02660027
   0.02845982  0.00864208  0.01673517  0.01525871  0.01564708 -0.0124748
  -0.04939508 -0.02745431  0.03536166 -0.03070228  0.02877063 -0.03402228
   0.01733487 -0.04546465]]
2024-10-22 17:01:07,717 - DEBUG - Network Policy after Softmax: [[0.04942738 0.04943539 0.05198233 0.04850854 0.04992271 0.0513995
  0.05149516 0.0504847  0.05089493 0.05081984 0.05083958 0.04942979
  0.04763811 0.04869488 0.05185181 0.04853697 0.05151118 0.0483761
  0.05092546 0.04782572]]
2024-10-22 17:01:07,718 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.48799303 0.         0.
  0.512007   0.        ]]
2024-10-22 17:01:07,718 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4), (Discard 3), (Reveal player +1 rank 1)) | P=0.4879930317401886
2024-10-22 17:01:07,719 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4), (Discard 3), (Reveal player +1 rank 4)) | P=0.5120069980621338
2024-10-22 17:01:07,719 - DEBUG - Simulating Node: ((Reveal player +1 rank 5), (Discard 4), (Discard 3)) | Value: 0.0
2024-10-22 17:01:07,719 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:07,719 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 8, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'Y', 'rank': 4}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 8
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R1 || RX|R12345
B4 || XX|RYGWB12345
R4 || XX|RYGWB12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 Y5 W2}
2024-10-22 17:01:07,719 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:07,719 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:07,719 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:07,719 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 5),) | Visit Count: 6
2024-10-22 17:01:07,719 - INFO - Actual Game Score: 4
2024-10-22 17:01:07,720 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:07,720 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:07,720 - DEBUG - Policy Targets: [0.         0.         0.         0.33333333 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.66666667]
2024-10-22 17:01:07,720 - DEBUG - === End of Training Data ===
2024-10-22 17:01:07,720 - INFO - Chosen Action: (Reveal player +1 rank 5) | Visit Count: 6
2024-10-22 17:01:09,276 - DEBUG - Not the current player's turn.
2024-10-22 17:01:09,278 - INFO - Agent state has been reset.
2024-10-22 17:01:09,278 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:09,278 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || WX|W1245
XX || XX|RYGWB1245
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:09,278 - INFO - Max Rollouts: 10
2024-10-22 17:01:09,278 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:09,279 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:09,279 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:09,490 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:09,490 - DEBUG - Network Policy Logits: [[ 0.07819218  0.00119024  0.02090984 -0.01326337  0.02724208 -0.00444762
   0.03131309 -0.00795632 -0.00583041 -0.00257259 -0.0085644   0.03929489
  -0.02862825 -0.01385238  0.06942998 -0.01502317  0.02638085 -0.04379497
  -0.01039683 -0.03554228]]
2024-10-22 17:01:09,490 - DEBUG - Network Policy after Softmax: [[0.0537592  0.049775   0.05076629 0.04906074 0.05108877 0.04949516
  0.05129717 0.04932181 0.04942677 0.04958806 0.04929182 0.05170826
  0.04831269 0.04903186 0.05329021 0.04897448 0.05104479 0.04758548
  0.04920158 0.04797981]]
2024-10-22 17:01:09,491 - DEBUG - Normalized Policy: [[0.         0.         0.         0.5001472  0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.49985278 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:09,492 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.37511072 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.62488925 0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:09,492 - DEBUG - Added Child Node: ((Reveal player +1 color W),) | P=0.6248892545700073
2024-10-22 17:01:09,493 - DEBUG - Added Child Node: ((Discard 3),) | P=0.3751107156276703
2024-10-22 17:01:09,493 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:09,493 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:09,493 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || WX|W1245
XX || XX|RYGWB1245
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:09,493 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:09,493 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:09,493 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:09,494 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W),)
2024-10-22 17:01:09,494 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)']
2024-10-22 17:01:09,494 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:09,719 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:09,719 - DEBUG - Network Policy Logits: [[ 0.00848877 -0.01918865  0.05195971 -0.00203296  0.01707127  0.0094141
  -0.00887253  0.01173065  0.01656451  0.01337953 -0.0040679   0.00011901
  -0.02510725  0.0180259   0.00923024 -0.01511706  0.01982009 -0.0330237
   0.031725   -0.01294181]]
2024-10-22 17:01:09,719 - DEBUG - Network Policy after Softmax: [[0.05019717 0.04882689 0.05242741 0.04967178 0.05062984 0.05024364
  0.04933321 0.05036017 0.05060419 0.05044328 0.04957081 0.04977879
  0.04853876 0.0506782  0.0502344  0.0490261  0.05076921 0.04815602
  0.05137722 0.04913286]]
2024-10-22 17:01:09,721 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.49633664 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.50366336 0.        ]]
2024-10-22 17:01:09,721 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 4)) | P=0.4963366389274597
2024-10-22 17:01:09,722 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 4)) | P=0.5036633610725403
2024-10-22 17:01:09,722 - DEBUG - Simulating Node: ((Reveal player +1 color W),) | Value: 0.0
2024-10-22 17:01:09,722 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:09,722 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
W4 || WX|W1245
G5 || XX|RYGWB1245
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:09,722 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:09,722 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:09,722 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:09,723 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:01:09,723 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:01:09,723 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:10,011 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:10,011 - DEBUG - Network Policy Logits: [[-0.01241599 -0.0109663   0.03958129 -0.00809624  0.01031569  0.0188271
   0.0169163   0.00803101  0.03253443  0.02178193 -0.00354295 -0.00457834
  -0.03048203  0.01362165  0.01692857 -0.02614608  0.01228084 -0.03448569
   0.02278216 -0.01076237]]
2024-10-22 17:01:10,011 - DEBUG - Network Policy after Softmax: [[0.04919534 0.04926671 0.05182104 0.04940832 0.05032644 0.05075662
  0.05065973 0.0502116  0.05145715 0.05090682 0.0496338  0.04958243
  0.04831456 0.0504931  0.05066035 0.0485245  0.05042544 0.04812151
  0.05095777 0.04927676]]
2024-10-22 17:01:10,013 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33893344 0.
  0.         0.         0.         0.         0.3342687  0.
  0.         0.         0.         0.3267979  0.         0.
  0.         0.        ]]
2024-10-22 17:01:10,014 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R)) | P=0.3342686891555786
2024-10-22 17:01:10,014 - DEBUG - Added Child Node: ((Discard 3), (Discard 4)) | P=0.33893343806266785
2024-10-22 17:01:10,015 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1)) | P=0.3267979025840759
2024-10-22 17:01:10,015 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:01:10,015 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:10,015 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R1 || XX|RYGWB1245
W4 || XX|RYGWB12345
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W2}
2024-10-22 17:01:10,016 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:10,016 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:10,016 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:10,016 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.9196885824203491 | PUCT: 0.9196885824203491
2024-10-22 17:01:10,017 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5520738959312439 | PUCT: 0.5520738959312439
2024-10-22 17:01:10,017 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.9196885824203491
2024-10-22 17:01:10,017 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:01:10,017 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Reveal player +1 rank 4))
2024-10-22 17:01:10,017 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Reveal player +1 rank 4))']
2024-10-22 17:01:10,018 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:10,019 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:10,249 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:10,249 - DEBUG - Network Policy Logits: [[ 0.06141181  0.00165166  0.01732454 -0.00212171  0.03061997 -0.00448085
   0.03172316 -0.00438903  0.00156588  0.0071866  -0.026019    0.04559092
  -0.02491179 -0.00922582  0.05113131 -0.02193176  0.01540183 -0.02600372
   0.00471593 -0.03197855]]
2024-10-22 17:01:10,250 - DEBUG - Network Policy after Softmax: [[0.05283752 0.04977244 0.05055866 0.04958498 0.05123535 0.04946814
  0.0512919  0.04947269 0.04976817 0.05004869 0.04841408 0.05200816
  0.04846771 0.04923397 0.05229711 0.04861237 0.05046155 0.04841482
  0.04992519 0.04812641]]
2024-10-22 17:01:10,251 - DEBUG - Normalized Policy: [[0.        0.        0.        0.        0.5138794 0.        0.
  0.        0.        0.        0.        0.        0.4861206 0.
  0.        0.        0.        0.        0.        0.       ]]
2024-10-22 17:01:10,252 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 4), (Discard 4)) | P=0.5138794183731079
2024-10-22 17:01:10,253 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 4), (Reveal player +1 color G)) | P=0.4861206114292145
2024-10-22 17:01:10,253 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:10,253 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:10,253 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || WX|W125
XX || XX|RYGWB125
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || W5|W5
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:10,253 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:10,253 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:10,253 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:10,254 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.660631000995636 | PUCT: 0.660631000995636
2024-10-22 17:01:10,254 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5948488116264343 | PUCT: 0.5948488116264343
2024-10-22 17:01:10,254 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.660631000995636
2024-10-22 17:01:10,254 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:01:10,254 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Discard 4))
2024-10-22 17:01:10,254 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Discard 4))']
2024-10-22 17:01:10,255 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:10,256 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:10,463 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:10,464 - DEBUG - Network Policy Logits: [[ 0.05469413  0.00275555  0.01348769 -0.02028692  0.02882415  0.00247554
   0.04300805  0.01241921 -0.02323543  0.01482252 -0.02792068  0.0238306
  -0.02845246 -0.01930063  0.04771703 -0.01146378  0.02357145 -0.03176748
  -0.00165284 -0.04234324]]
2024-10-22 17:01:10,464 - DEBUG - Network Policy after Softmax: [[0.05262939 0.04996567 0.0505048  0.0488275  0.05128533 0.04995168
  0.05201794 0.05045086 0.04868374 0.05057225 0.04845618 0.05102988
  0.04843042 0.04887568 0.05226347 0.04926022 0.05101665 0.04827014
  0.04974589 0.04776233]]
2024-10-22 17:01:10,466 - DEBUG - Normalized Policy: [[0.         0.         0.         0.48903716 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.5109628  0.
  0.         0.        ]]
2024-10-22 17:01:10,466 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 4), (Discard 3)) | P=0.4890371561050415
2024-10-22 17:01:10,467 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 4), (Reveal player +1 rank 2)) | P=0.5109627842903137
2024-10-22 17:01:10,467 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Discard 4)) | Value: 0.0
2024-10-22 17:01:10,467 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:10,467 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || WX|W1245
XX || XX|RYGWB1245
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y2 || XX|RYGWB12345
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W5}
2024-10-22 17:01:10,468 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:10,468 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:10,468 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:10,469 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.5227847695350647 | PUCT: 0.5227847695350647
2024-10-22 17:01:10,469 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.6276381611824036 | PUCT: 0.6276381611824036
2024-10-22 17:01:10,469 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.6276381611824036
2024-10-22 17:01:10,469 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:10,469 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4))
2024-10-22 17:01:10,470 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))']
2024-10-22 17:01:10,470 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:10,471 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:10,696 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:10,697 - DEBUG - Network Policy Logits: [[ 0.04362745 -0.00973345  0.02266793 -0.0596193   0.0201016   0.05281205
   0.04001431  0.04509993 -0.02289088  0.00785869 -0.00774649  0.00772735
  -0.04247627 -0.02849983  0.04320902 -0.00381376  0.0177144  -0.03674244
  -0.01916699 -0.04095466]]
2024-10-22 17:01:10,697 - DEBUG - Network Policy after Softmax: [[0.05212514 0.04941661 0.05104399 0.04701189 0.05091317 0.05260609
  0.05193715 0.05220195 0.04877067 0.05029364 0.04951489 0.05028703
  0.04782477 0.04849788 0.05210333 0.04971    0.05079177 0.04809977
  0.04895262 0.0478976 ]]
2024-10-22 17:01:10,698 - DEBUG - Normalized Policy: [[0.         0.         0.         0.3289007  0.         0.
  0.         0.         0.         0.         0.         0.
  0.33458763 0.         0.         0.         0.         0.3365116
  0.         0.        ]]
2024-10-22 17:01:10,700 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Discard 3)) | P=0.32890069484710693
2024-10-22 17:01:10,701 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 rank 3)) | P=0.33651161193847656
2024-10-22 17:01:10,701 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 color G)) | P=0.33458763360977173
2024-10-22 17:01:10,701 - DEBUG - Simulating Node: ((Discard 3), (Discard 4)) | Value: 0.0
2024-10-22 17:01:10,701 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:10,701 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || XX|RYGWB1245
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G3 || XX|RYGWB12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W1 G5}
2024-10-22 17:01:10,702 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:10,702 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:10,702 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:10,703 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.5448092818260193 | PUCT: 0.5448092818260193
2024-10-22 17:01:10,703 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4360533654689789 | PUCT: 0.4360533654689789
2024-10-22 17:01:10,703 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.5448092818260193
2024-10-22 17:01:10,703 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:01:10,704 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.7412728071212769 | PUCT: 0.7412728071212769
2024-10-22 17:01:10,704 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Discard 4)) | Q: 0.0 | U: 0.7304896712303162 | PUCT: 0.7304896712303162
2024-10-22 17:01:10,704 - DEBUG - Selected Child: ((Reveal player +1 color W), (Reveal player +1 rank 4)) | PUCT: 0.7412728071212769
2024-10-22 17:01:10,704 - DEBUG - Selected child for exploration: ((Reveal player +1 color W), (Reveal player +1 rank 4))
2024-10-22 17:01:10,704 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Reveal player +1 rank 4), (Reveal player +1 color G))
2024-10-22 17:01:10,705 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Reveal player +1 rank 4))', '((Reveal player +1 color W), (Reveal player +1 rank 4), (Reveal player +1 color G))']
2024-10-22 17:01:10,705 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:10,706 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:10,707 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 3
2024-10-22 17:01:10,915 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:10,916 - DEBUG - Network Policy Logits: [[ 1.2825173e-02 -1.5916489e-02  4.0734909e-02  3.4381698e-03
   2.5441067e-02 -2.1027094e-03 -6.9996798e-03  2.3351071e-02
   2.5590129e-02  8.1753358e-05  1.6411925e-02  1.0133654e-02
  -3.1932786e-02  1.5105929e-02  6.8747364e-03 -1.8918695e-02
   3.7153393e-02 -3.6971696e-02  2.1988053e-02 -1.7997280e-02]]
2024-10-22 17:01:10,917 - DEBUG - Network Policy after Softmax: [[0.05036062 0.04893378 0.05178597 0.0498901  0.05099999 0.04961443
  0.04937206 0.05089351 0.05100759 0.04972293 0.05054158 0.05022526
  0.04815628 0.05047561 0.05006184 0.04878709 0.05160083 0.04791424
  0.05082419 0.04883206]]
2024-10-22 17:01:10,918 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50258374 0.
  0.         0.         0.         0.         0.         0.
  0.         0.49741623 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:10,919 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 4), (Reveal player +1 color G), (Reveal player +1 color W)) | P=0.497416228055954
2024-10-22 17:01:10,919 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 4), (Reveal player +1 color G), (Discard 4)) | P=0.5025837421417236
2024-10-22 17:01:10,919 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Reveal player +1 rank 4), (Reveal player +1 color G)) | Value: 0.0
2024-10-22 17:01:10,919 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:10,920 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
W4 || W4|W4
W2 || XX|RYGWB125
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:10,920 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:10,920 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:10,920 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:10,921 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.4505535662174225 | PUCT: 0.4505535662174225
2024-10-22 17:01:10,921 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4507664442062378 | PUCT: 0.4507664442062378
2024-10-22 17:01:10,922 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.4507664442062378
2024-10-22 17:01:10,922 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:10,922 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 1))
2024-10-22 17:01:10,922 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 1))']
2024-10-22 17:01:10,923 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:10,923 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:01:10,923 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:10,923 - DEBUG - Rollout #8 completed with reward=4
2024-10-22 17:01:10,923 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:10,924 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.4631379246711731 | PUCT: 0.4631379246711731
2024-10-22 17:01:10,924 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 1.3333333333333333 | U: 0.34751754999160767 | PUCT: 1.6808509826660156
2024-10-22 17:01:10,924 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 1.6808509826660156
2024-10-22 17:01:10,924 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:10,924 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 color R))
2024-10-22 17:01:10,925 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 color R))']
2024-10-22 17:01:10,926 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:10,926 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:01:11,196 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:11,197 - DEBUG - Network Policy Logits: [[ 0.04947396 -0.00033697  0.02156158 -0.02132577  0.03494556  0.02428542
   0.04833112  0.02108834 -0.01428234  0.00112558 -0.01723401  0.01853212
  -0.04312756 -0.00180044  0.05551747 -0.01222039  0.02201859 -0.03509291
  -0.03413698 -0.05034245]]
2024-10-22 17:01:11,197 - DEBUG - Network Policy after Softmax: [[0.05233528 0.04979227 0.05089468 0.04875809 0.05158043 0.0510335
  0.0522755  0.0508706  0.04910272 0.04986516 0.048958   0.05074073
  0.04770658 0.04971946 0.05265253 0.04920407 0.05091795 0.04809143
  0.04813742 0.04736362]]
2024-10-22 17:01:11,199 - DEBUG - Normalized Policy: [[0.         0.         0.         0.49511883 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.50488114 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:11,200 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R), (Reveal player +1 color W)) | P=0.5048811435699463
2024-10-22 17:01:11,201 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R), (Discard 3)) | P=0.4951188266277313
2024-10-22 17:01:11,201 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:01:11,201 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:11,202 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || XX|YGWB1245
XX || XX|YGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4}
2024-10-22 17:01:11,202 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:11,202 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:11,202 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:11,203 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.474111944437027 | PUCT: 0.474111944437027
2024-10-22 17:01:11,204 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 1.0 | U: 0.2846015989780426 | PUCT: 1.2846015691757202
2024-10-22 17:01:11,204 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 1.2846015691757202
2024-10-22 17:01:11,204 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:11,205 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.537479043006897 | PUCT: 0.537479043006897
2024-10-22 17:01:11,206 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.5182346105575562 | PUCT: 4.518234729766846
2024-10-22 17:01:11,207 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 color R)) | Q: 0.0 | U: 0.5300816893577576 | PUCT: 0.5300816893577576
2024-10-22 17:01:11,207 - DEBUG - Selected Child: ((Discard 3), (Reveal player +1 rank 1)) | PUCT: 4.518234729766846
2024-10-22 17:01:11,207 - DEBUG - Selected child for exploration: ((Discard 3), (Reveal player +1 rank 1))
2024-10-22 17:01:11,207 - DEBUG - Node ((Discard 3), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:01:11,207 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 1))']
2024-10-22 17:01:11,208 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:11,209 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:11,519 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:11,522 - DEBUG - Network Policy Logits: [[ 0.04054841 -0.01119174  0.02269353 -0.00310766  0.0413607  -0.01748661
   0.02062423  0.01223954 -0.00864783 -0.00037643 -0.0031176  -0.01153881
  -0.01344228 -0.01507501  0.04714914 -0.0143001   0.00395451 -0.03757575
  -0.03525125 -0.02759814]]
2024-10-22 17:01:11,522 - DEBUG - Network Policy after Softmax: [[0.05208063 0.04945449 0.05115898 0.04985591 0.05212295 0.04914416
  0.05105323 0.05062696 0.04958046 0.04999226 0.04985541 0.04943733
  0.04934332 0.04926282 0.05242553 0.04930101 0.05020924 0.04816674
  0.04827884 0.04864974]]
2024-10-22 17:01:11,526 - DEBUG - Normalized Policy: [[0.3450787  0.         0.         0.         0.         0.
  0.         0.         0.32851297 0.         0.         0.
  0.         0.32640833 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:11,527 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Reveal player +1 color W)) | P=0.326408326625824
2024-10-22 17:01:11,528 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Discard 0)) | P=0.345078706741333
2024-10-22 17:01:11,529 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Play 3)) | P=0.328512966632843
2024-10-22 17:01:11,529 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:11,529 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:11,529 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || X1|RYGWB1
XX || X1|RYGWB1
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4}
2024-10-22 17:01:11,530 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:11,530 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:11,530 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:11,530 - DEBUG - Best node chosen by MCTS: ((Discard 3),) | Visit Count: 5
2024-10-22 17:01:11,530 - INFO - Actual Game Score: 4
2024-10-22 17:01:11,531 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:11,531 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:11,531 - DEBUG - Policy Targets: [0.         0.         0.         0.55555556 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.44444444 0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:11,532 - DEBUG - === End of Training Data ===
2024-10-22 17:01:11,532 - INFO - Chosen Action: (Discard 3) | Visit Count: 5
2024-10-22 17:01:13,031 - DEBUG - Not the current player's turn.
2024-10-22 17:01:13,032 - INFO - Agent state has been reset.
2024-10-22 17:01:13,032 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:13,032 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || X2|RYGWB2
XX || X2|RYGWB2
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4}
2024-10-22 17:01:13,032 - INFO - Max Rollouts: 10
2024-10-22 17:01:13,032 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:13,033 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:13,033 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:13,223 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:13,223 - DEBUG - Network Policy Logits: [[ 0.05661741 -0.01116258  0.03412415 -0.02167956  0.0425114  -0.00431073
   0.02028072 -0.00888351  0.00907026 -0.01556252 -0.01704639  0.01934191
  -0.02360727  0.02121658  0.0367222  -0.00096666  0.02528948  0.00485523
  -0.03337226 -0.04764419]]
2024-10-22 17:01:13,224 - DEBUG - Network Policy after Softmax: [[0.0526672  0.04921571 0.05149577 0.04870082 0.05192949 0.04955409
  0.05078781 0.04932801 0.05022163 0.04899964 0.04892699 0.05074015
  0.04860704 0.05083536 0.05162973 0.04972008 0.05104282 0.05001039
  0.0481347  0.0474526 ]]
2024-10-22 17:01:13,225 - DEBUG - Normalized Policy: [[0.         0.         0.         0.4892776  0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.51072246 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:13,225 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.61695814 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.38304183 0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:13,226 - DEBUG - Added Child Node: ((Reveal player +1 color W),) | P=0.3830418288707733
2024-10-22 17:01:13,227 - DEBUG - Added Child Node: ((Discard 3),) | P=0.6169581413269043
2024-10-22 17:01:13,227 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:13,227 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:13,227 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || X2|RYGWB2
XX || X2|RYGWB2
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4}
2024-10-22 17:01:13,227 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:13,227 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:13,227 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:13,227 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W),)
2024-10-22 17:01:13,227 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)']
2024-10-22 17:01:13,228 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:13,414 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:13,415 - DEBUG - Network Policy Logits: [[ 0.01872473 -0.00355295  0.06071847  0.0110204   0.00838939 -0.00677147
  -0.00644067  0.01620527  0.02992163 -0.00083613  0.0209738   0.01169618
  -0.02384388  0.02118216 -0.00416329 -0.00176426  0.02034206 -0.02652107
   0.01517434 -0.01862668]]
2024-10-22 17:01:13,415 - DEBUG - Network Policy after Softmax: [[0.05057518 0.04946094 0.05274424 0.05018703 0.05005516 0.049302
  0.04931832 0.05044791 0.05114464 0.0495955  0.05068905 0.05022095
  0.04846744 0.05069961 0.04943076 0.04954949 0.05065704 0.04833786
  0.05039593 0.04872097]]
2024-10-22 17:01:13,416 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33154443 0.
  0.         0.         0.         0.         0.         0.33264259
  0.         0.33581305 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:13,417 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color W)) | P=0.335813045501709
2024-10-22 17:01:13,417 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 4)) | P=0.331544429063797
2024-10-22 17:01:13,418 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color Y)) | P=0.3326425850391388
2024-10-22 17:01:13,418 - DEBUG - Simulating Node: ((Reveal player +1 color W),) | Value: 0.0
2024-10-22 17:01:13,418 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:13,418 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
W2 || X2|RYGWB2
Y2 || X2|RYGWB2
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4}
2024-10-22 17:01:13,418 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:13,418 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:13,419 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:13,419 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:01:13,419 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:01:13,419 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:13,614 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:13,614 - DEBUG - Network Policy Logits: [[ 1.3571866e-02 -1.1892656e-02  5.5185556e-02 -1.4630158e-02
   1.5984943e-02  2.5707494e-02  1.7801868e-02  2.0478327e-02
   1.8945178e-02  4.9856938e-03 -7.8032957e-05 -2.0054961e-03
  -4.7088508e-02  1.0779072e-02  1.7727673e-02 -2.3022793e-02
   1.2242354e-02 -2.9572852e-02  2.5504306e-02 -5.6763939e-03]]
2024-10-22 17:01:13,614 - DEBUG - Network Policy after Softmax: [[0.05040544 0.0491381  0.05254725 0.04900376 0.05052722 0.05102087
  0.05061911 0.05075477 0.05067701 0.0499745  0.04972209 0.04962634
  0.04743872 0.05026487 0.05061535 0.04859421 0.05033847 0.04827696
  0.0510105  0.0494445 ]]
2024-10-22 17:01:13,616 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3404099  0.
  0.         0.         0.         0.         0.         0.33434054
  0.         0.         0.         0.         0.         0.32524952
  0.         0.        ]]
2024-10-22 17:01:13,617 - DEBUG - Added Child Node: ((Discard 3), (Discard 4)) | P=0.34040990471839905
2024-10-22 17:01:13,618 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color Y)) | P=0.33434054255485535
2024-10-22 17:01:13,618 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3)) | P=0.3252495229244232
2024-10-22 17:01:13,618 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:01:13,618 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:13,618 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
Y2 || X2|RYGWB2
G3 || XX|RYGWB12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:13,619 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:13,619 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:13,619 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:13,620 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.5637466311454773 | PUCT: 0.5637466311454773
2024-10-22 17:01:13,620 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.9080158472061157 | PUCT: 0.9080158472061157
2024-10-22 17:01:13,620 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.9080158472061157
2024-10-22 17:01:13,620 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:13,620 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4))
2024-10-22 17:01:13,620 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))']
2024-10-22 17:01:13,621 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:13,622 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:13,831 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:13,832 - DEBUG - Network Policy Logits: [[ 0.02801744  0.00442861  0.02469511 -0.04694063  0.04029145  0.04404409
   0.05725881  0.0144984  -0.00274706  0.00087224 -0.0160503   0.02121633
  -0.04636029 -0.01649822  0.02833822 -0.00661422  0.01708978 -0.01363268
  -0.01676446 -0.06061184]]
2024-10-22 17:01:13,832 - DEBUG - Network Policy after Softmax: [[0.05125648 0.05006155 0.05108647 0.04755486 0.05188948 0.05208457
  0.05277742 0.0505682  0.04970361 0.04988382 0.04904677 0.05090906
  0.04758247 0.0490248  0.05127292 0.04951176 0.05069941 0.04916549
  0.04901175 0.04690915]]
2024-10-22 17:01:13,834 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32058117 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.3456457  0.3337732  0.         0.
  0.         0.        ]]
2024-10-22 17:01:13,835 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Discard 3)) | P=0.3205811679363251
2024-10-22 17:01:13,836 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 rank 1)) | P=0.3337731957435608
2024-10-22 17:01:13,837 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 color B)) | P=0.3456456959247589
2024-10-22 17:01:13,837 - DEBUG - Simulating Node: ((Discard 3), (Discard 4)) | Value: 0.0
2024-10-22 17:01:13,837 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:13,837 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || X2|RYGWB2
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 G5}
2024-10-22 17:01:13,837 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:13,837 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:13,837 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:13,838 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.6074259281158447 | PUCT: 0.6074259281158447
2024-10-22 17:01:13,838 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.6522461771965027 | PUCT: 0.6522461771965027
2024-10-22 17:01:13,838 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.6522461771965027
2024-10-22 17:01:13,838 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:13,838 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 color Y))
2024-10-22 17:01:13,839 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 color Y))']
2024-10-22 17:01:13,840 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:13,840 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 2
2024-10-22 17:01:14,041 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:14,041 - DEBUG - Network Policy Logits: [[ 0.03726817  0.00552414  0.00614449 -0.02100704  0.04735009  0.02649225
   0.03310651 -0.01257277 -0.02124215  0.0047498   0.0028157   0.02297697
  -0.03232677 -0.01683547  0.03862288 -0.01079578  0.01264806 -0.02405768
  -0.01973098 -0.04256701]]
2024-10-22 17:01:14,042 - DEBUG - Network Policy after Softmax: [[0.05178702 0.05016892 0.05020005 0.04885538 0.05231178 0.05123197
  0.05157195 0.04926918 0.04884389 0.05013008 0.05003322 0.05105219
  0.04830547 0.04905961 0.05185723 0.04935681 0.05052759 0.04870656
  0.04891776 0.04781333]]
2024-10-22 17:01:14,043 - DEBUG - Normalized Policy: [[0.         0.         0.         0.49895713 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.5010429  0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:14,043 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color Y), (Reveal player +1 color W)) | P=0.501042902469635
2024-10-22 17:01:14,044 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color Y), (Discard 3)) | P=0.4989571273326874
2024-10-22 17:01:14,044 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 17:01:14,044 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:14,044 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || Y2|Y2
XX || XX|RGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:14,044 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:14,045 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:14,045 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:14,045 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.6409085392951965 | PUCT: 0.6409085392951965
2024-10-22 17:01:14,046 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5161495804786682 | PUCT: 0.5161495804786682
2024-10-22 17:01:14,046 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.6409085392951965
2024-10-22 17:01:14,046 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:01:14,046 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Reveal player +1 color W))
2024-10-22 17:01:14,046 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Reveal player +1 color W))']
2024-10-22 17:01:14,047 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:14,047 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 2
2024-10-22 17:01:14,250 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:14,251 - DEBUG - Network Policy Logits: [[ 0.05482254 -0.00460487  0.02432806 -0.00615698  0.02424865 -0.01695801
   0.02871003 -0.00807279  0.013796   -0.00678875 -0.02913313  0.0228507
  -0.02203956 -0.00155483  0.03143478 -0.01176768  0.01431736  0.00513177
  -0.01666285 -0.02632592]]
2024-10-22 17:01:14,251 - DEBUG - Network Policy after Softmax: [[0.05262156 0.04958551 0.05104112 0.04950861 0.05103706 0.04897673
  0.05126527 0.04941384 0.05050637 0.04947734 0.04838406 0.05096576
  0.04872849 0.04973697 0.05140514 0.0492316  0.05053271 0.05007066
  0.0489912  0.04852007]]
2024-10-22 17:01:14,253 - DEBUG - Normalized Policy: [[0.      0.      0.      0.      0.51157 0.      0.      0.      0.
  0.      0.      0.      0.48843 0.      0.      0.      0.      0.
  0.      0.     ]]
2024-10-22 17:01:14,253 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color W), (Discard 4)) | P=0.5115699768066406
2024-10-22 17:01:14,254 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color W), (Reveal player +1 color G)) | P=0.488429993391037
2024-10-22 17:01:14,254 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Reveal player +1 color W)) | Value: 0.0
2024-10-22 17:01:14,254 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:14,254 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': None, 'rank': 1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || W2|W2
XX || X2|RYGB2
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || W5|W5
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4}
2024-10-22 17:01:14,254 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:14,254 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:14,254 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:14,255 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.4452730119228363 | PUCT: 0.4452730119228363
2024-10-22 17:01:14,255 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5378944873809814 | PUCT: 0.5378944873809814
2024-10-22 17:01:14,255 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.5378944873809814
2024-10-22 17:01:14,255 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:14,255 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 3))
2024-10-22 17:01:14,255 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 3))']
2024-10-22 17:01:14,256 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:14,257 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:14,453 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:14,453 - DEBUG - Network Policy Logits: [[ 0.05201333 -0.01415938  0.01913627 -0.01065268  0.05902152  0.00393955
   0.01750087  0.00193502 -0.00142326  0.01110126 -0.00999749  0.01253931
  -0.03050292  0.01318233  0.03670603  0.00181039  0.01426516 -0.00968628
  -0.04348409 -0.03320945]]
2024-10-22 17:01:14,454 - DEBUG - Network Policy after Softmax: [[0.05241594 0.04905971 0.05072068 0.04923205 0.05278458 0.04995572
  0.0506378  0.04985569 0.04968854 0.05031478 0.04926432 0.05038719
  0.04826442 0.05041959 0.05161971 0.04984947 0.05047422 0.04927965
  0.04764194 0.04813397]]
2024-10-22 17:01:14,455 - DEBUG - Normalized Policy: [[0.50970656 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.49029347 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:14,456 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Reveal player +1 color W)) | P=0.4902934730052948
2024-10-22 17:01:14,457 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Discard 0)) | P=0.5097065567970276
2024-10-22 17:01:14,457 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:01:14,457 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:14,457 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': None, 'rank': 2}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || X2|RYGWB2
XX || X3|RYGWB3
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 Y2}
2024-10-22 17:01:14,458 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:14,458 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:14,458 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:14,458 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.46029719710350037 | PUCT: 0.46029719710350037
2024-10-22 17:01:14,459 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4448350965976715 | PUCT: 0.4448350965976715
2024-10-22 17:01:14,459 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.46029719710350037
2024-10-22 17:01:14,459 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:01:14,459 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Reveal player +1 color Y))
2024-10-22 17:01:14,459 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Reveal player +1 color Y))']
2024-10-22 17:01:14,460 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:14,460 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 2
2024-10-22 17:01:14,659 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:14,659 - DEBUG - Network Policy Logits: [[ 0.041145   -0.00114662  0.01259814 -0.00624324  0.02844603 -0.01995236
   0.02528522 -0.01855527  0.01035156 -0.01076993 -0.03396985  0.01366488
  -0.03016997  0.02375114  0.02183832 -0.00572367  0.01182243 -0.0041726
  -0.0249344  -0.02578809]]
2024-10-22 17:01:14,660 - DEBUG - Network Policy after Softmax: [[0.05206887 0.04991271 0.05060348 0.04965897 0.05141183 0.04898283
  0.05124958 0.04905132 0.05048992 0.04943468 0.04830101 0.05065749
  0.0484849  0.05117102 0.05107324 0.04968477 0.05056424 0.0497619
  0.04873941 0.04869782]]
2024-10-22 17:01:14,661 - DEBUG - Normalized Policy: [[0.        0.        0.        0.        0.5146498 0.        0.
  0.        0.        0.        0.        0.        0.4853502 0.
  0.        0.        0.        0.        0.        0.       ]]
2024-10-22 17:01:14,661 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color Y), (Discard 4)) | P=0.5146498084068298
2024-10-22 17:01:14,662 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color Y), (Reveal player +1 color G)) | P=0.48535019159317017
2024-10-22 17:01:14,662 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 17:01:14,662 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:14,662 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': 'Y', 'rank': 1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || X2|RGWB2
XX || Y2|Y2
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || W5|W5
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4}
2024-10-22 17:01:14,662 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:14,662 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:14,662 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:14,663 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.35486525297164917 | PUCT: 0.35486525297164917
2024-10-22 17:01:14,663 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4572597146034241 | PUCT: 0.4572597146034241
2024-10-22 17:01:14,664 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.4572597146034241
2024-10-22 17:01:14,664 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:14,664 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.5398204326629639 | PUCT: 0.5398204326629639
2024-10-22 17:01:14,664 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 color Y)) | Q: 0.0 | U: 0.5301956534385681 | PUCT: 0.5301956534385681
2024-10-22 17:01:14,665 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3)) | Q: 0.0 | U: 0.5157791972160339 | PUCT: 0.5157791972160339
2024-10-22 17:01:14,665 - DEBUG - Selected Child: ((Discard 3), (Discard 4)) | PUCT: 0.5398204326629639
2024-10-22 17:01:14,665 - DEBUG - Selected child for exploration: ((Discard 3), (Discard 4))
2024-10-22 17:01:14,665 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4), (Reveal player +1 color B))
2024-10-22 17:01:14,665 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))', '((Discard 3), (Discard 4), (Reveal player +1 color B))']
2024-10-22 17:01:14,666 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:14,667 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:14,667 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 3
2024-10-22 17:01:14,856 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:14,857 - DEBUG - Network Policy Logits: [[ 0.01018352 -0.00875881  0.06651946 -0.01950987  0.01351666  0.03001079
   0.03575974  0.02192623  0.03442595  0.01260482 -0.00694623  0.00690519
  -0.05358287 -0.01056886  0.02037798 -0.00933208  0.02114374 -0.01658559
   0.02020112 -0.03445785]]
2024-10-22 17:01:14,857 - DEBUG - Network Policy after Softmax: [[0.05015714 0.04921599 0.0530639  0.0486897  0.0503246  0.05116154
  0.05145651 0.05074959 0.05138793 0.05027873 0.04930528 0.04999298
  0.04705864 0.04912699 0.05067108 0.04918778 0.0507099  0.04883229
  0.05066212 0.0479673 ]]
2024-10-22 17:01:14,858 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33588257 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.3381951  0.         0.         0.32592243
  0.         0.        ]]
2024-10-22 17:01:14,859 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 color B), (Discard 4)) | P=0.3358825743198395
2024-10-22 17:01:14,859 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 color B), (Reveal player +1 color B)) | P=0.3381950855255127
2024-10-22 17:01:14,860 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 3)) | P=0.325922429561615
2024-10-22 17:01:14,860 - DEBUG - Simulating Node: ((Discard 3), (Discard 4), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:14,860 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:14,860 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGW12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
B2 || X2|RYGWB2
G3 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y5}
2024-10-22 17:01:14,860 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:14,860 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:14,860 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:14,861 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.3632737994194031 | PUCT: 0.3632737994194031
2024-10-22 17:01:14,862 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.39007875323295593 | PUCT: 0.39007875323295593
2024-10-22 17:01:14,862 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.39007875323295593
2024-10-22 17:01:14,862 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:14,862 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.3797176778316498 | PUCT: 0.3797176778316498
2024-10-22 17:01:14,862 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 color Y)) | Q: 0.0 | U: 0.559421181678772 | PUCT: 0.559421181678772
2024-10-22 17:01:14,863 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3)) | Q: 0.0 | U: 0.5442100167274475 | PUCT: 0.5442100167274475
2024-10-22 17:01:14,863 - DEBUG - Selected Child: ((Discard 3), (Reveal player +1 color Y)) | PUCT: 0.559421181678772
2024-10-22 17:01:14,863 - DEBUG - Selected child for exploration: ((Discard 3), (Reveal player +1 color Y))
2024-10-22 17:01:14,863 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 color Y), (Reveal player +1 color W))
2024-10-22 17:01:14,863 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 color Y))', '((Discard 3), (Reveal player +1 color Y), (Reveal player +1 color W))']
2024-10-22 17:01:14,864 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:14,864 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 2
2024-10-22 17:01:14,865 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 3
2024-10-22 17:01:15,078 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:15,079 - DEBUG - Network Policy Logits: [[ 0.01830992 -0.00434813  0.05902676  0.00685882  0.02481214  0.00017953
  -0.00024242  0.00441327  0.02638377 -0.00571826  0.00220836  0.00269007
  -0.0393979   0.01318869  0.00911974 -0.00013997  0.01511955 -0.01710288
   0.02610901  0.00464366]]
2024-10-22 17:01:15,079 - DEBUG - Network Policy after Softmax: [[0.0505441  0.04941175 0.05264457 0.04996862 0.05087382 0.04963597
  0.04961503 0.04984657 0.05095384 0.0493441  0.04973678 0.04976074
  0.04770987 0.05028591 0.05008172 0.04962012 0.0503831  0.04878552
  0.05093984 0.04985805]]
2024-10-22 17:01:15,080 - DEBUG - Normalized Policy: [[0.         0.         0.5135924  0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.48640758]]
2024-10-22 17:01:15,081 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color Y), (Reveal player +1 color W), (Discard 2)) | P=0.5135924220085144
2024-10-22 17:01:15,082 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color Y), (Reveal player +1 color W), (Reveal player +1 rank 5)) | P=0.4864075779914856
2024-10-22 17:01:15,082 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 color Y), (Reveal player +1 color W)) | Value: 0.0
2024-10-22 17:01:15,082 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:15,082 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'Y', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
Y2 || Y2|Y2
Y5 || YX|Y12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 B2}
2024-10-22 17:01:15,082 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:15,082 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:15,082 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:15,082 - DEBUG - Best node chosen by MCTS: ((Discard 3),) | Visit Count: 6
2024-10-22 17:01:15,082 - INFO - Actual Game Score: 4
2024-10-22 17:01:15,083 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:15,083 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:15,083 - DEBUG - Policy Targets: [0.         0.         0.         0.66666667 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.33333333 0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:15,083 - DEBUG - === End of Training Data ===
2024-10-22 17:01:15,083 - INFO - Chosen Action: (Discard 3) | Visit Count: 6
2024-10-22 17:01:16,483 - DEBUG - Not the current player's turn.
2024-10-22 17:01:16,484 - INFO - Agent state has been reset.
2024-10-22 17:01:16,484 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:16,484 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || Y2|Y2
XX || XX|RGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:16,484 - INFO - Max Rollouts: 10
2024-10-22 17:01:16,484 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:16,484 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:16,484 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:16,691 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:16,692 - DEBUG - Network Policy Logits: [[ 0.0369539   0.00551795  0.01678933 -0.01159716  0.0431999   0.02389355
   0.03282807 -0.00467781 -0.0223803  -0.01474614  0.0025124   0.01970571
  -0.0150135  -0.01075132  0.04627684 -0.00374041  0.01625202 -0.03042566
  -0.01268045 -0.05069375]]
2024-10-22 17:01:16,692 - DEBUG - Network Policy after Softmax: [[0.05169182 0.05009211 0.05065991 0.04924208 0.0520157  0.0510211
  0.05147899 0.04958398 0.04871394 0.04908726 0.04994179 0.05080787
  0.04907414 0.04928374 0.05217599 0.04963048 0.0506327  0.04832359
  0.04918876 0.04735403]]
2024-10-22 17:01:16,693 - DEBUG - Normalized Policy: [[0.         0.         0.         0.49978852 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.5002114  0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:16,694 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.37484142 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.6251586  0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:16,694 - DEBUG - Added Child Node: ((Reveal player +1 color W),) | P=0.6251586079597473
2024-10-22 17:01:16,695 - DEBUG - Added Child Node: ((Discard 3),) | P=0.3748414218425751
2024-10-22 17:01:16,695 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:16,695 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:16,695 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || Y2|Y2
XX || XX|RGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:16,695 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:16,695 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:16,695 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:16,695 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W),)
2024-10-22 17:01:16,696 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)']
2024-10-22 17:01:16,696 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:16,964 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:16,966 - DEBUG - Network Policy Logits: [[ 1.39541570e-02 -5.67980437e-03  6.05596080e-02  1.62506364e-02
   4.24860679e-02  1.72212273e-02  9.22158826e-03  1.49214007e-02
  -1.83375319e-03  4.04281635e-03  1.48657085e-02  9.50137619e-03
  -3.55810449e-02 -2.20973068e-03  2.85820290e-02 -1.07776728e-02
   1.63796823e-02 -2.27709822e-02  1.55493235e-02 -7.93533400e-05]]
2024-10-22 17:01:16,966 - DEBUG - Network Policy after Softmax: [[0.05022615 0.04924963 0.05262237 0.05034163 0.05167984 0.05039052
  0.04998901 0.05027476 0.04943942 0.04973081 0.05027196 0.050003
  0.04779881 0.04942083 0.05096625 0.0489992  0.05034813 0.04841505
  0.05030634 0.04952623]]
2024-10-22 17:01:16,967 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3407942  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.33608857 0.32311717 0.         0.
  0.         0.        ]]
2024-10-22 17:01:16,968 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 4)) | P=0.3407942056655884
2024-10-22 17:01:16,969 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 1)) | P=0.3231171667575836
2024-10-22 17:01:16,970 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color B)) | P=0.3360885679721832
2024-10-22 17:01:16,970 - DEBUG - Simulating Node: ((Reveal player +1 color W),) | Value: 0.0
2024-10-22 17:01:16,970 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:16,970 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
Y2 || Y2|Y2
B1 || XX|RGWB12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:16,971 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:16,971 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:16,971 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:16,971 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:01:16,971 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:01:16,972 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:17,215 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:17,216 - DEBUG - Network Policy Logits: [[ 0.00383727 -0.01503078  0.04056124 -0.01977443  0.02486483  0.01751464
   0.01530116  0.011995    0.01840133  0.00447504  0.00180609 -0.01277519
  -0.04495904 -0.00082491  0.03164858 -0.02975545 -0.00530946 -0.02064189
   0.01839904 -0.00839664]]
2024-10-22 17:01:17,216 - DEBUG - Network Policy after Softmax: [[0.05010261 0.04916613 0.05197678 0.04893346 0.0511673  0.05079259
  0.05068028 0.050513   0.05083764 0.05013457 0.05000094 0.04927716
  0.04771648 0.04986957 0.05151558 0.04844748 0.04964642 0.04889103
  0.05083753 0.04949339]]
2024-10-22 17:01:17,218 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.49830407 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.50169593 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:17,219 - DEBUG - Added Child Node: ((Discard 3), (Discard 4)) | P=0.4983040690422058
2024-10-22 17:01:17,220 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color B)) | P=0.5016959309577942
2024-10-22 17:01:17,220 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:01:17,220 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:17,220 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
B3 || XX|RGWB12345
B2 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2}
2024-10-22 17:01:17,220 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:17,220 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:17,220 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:17,221 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.9200850129127502 | PUCT: 0.9200850129127502
2024-10-22 17:01:17,221 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5516775846481323 | PUCT: 0.5516775846481323
2024-10-22 17:01:17,222 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.9200850129127502
2024-10-22 17:01:17,222 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:01:17,222 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Reveal player +1 rank 1))
2024-10-22 17:01:17,222 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Reveal player +1 rank 1))']
2024-10-22 17:01:17,223 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:17,223 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:17,445 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:17,445 - DEBUG - Network Policy Logits: [[ 0.0355584  -0.00407284  0.01884281  0.00326244  0.04496414  0.00150954
   0.02843661  0.00393798  0.00134769 -0.00165083 -0.00419943  0.005077
  -0.02745401 -0.00862019  0.04085286 -0.02532858 -0.00327783 -0.02034482
  -0.02033366 -0.02780032]]
2024-10-22 17:01:17,446 - DEBUG - Network Policy after Softmax: [[0.05169262 0.04968404 0.05083572 0.05004982 0.05218112 0.04996217
  0.05132578 0.05008364 0.04995408 0.04980452 0.04967775 0.05014072
  0.04853584 0.04945862 0.05196703 0.04863911 0.04972355 0.04888212
  0.04888267 0.04851904]]
2024-10-22 17:01:17,447 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33728525 0.         0.
  0.         0.         0.         0.33563218 0.         0.
  0.32708254 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:17,447 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 1), (Discard 3)) | P=0.33728525042533875
2024-10-22 17:01:17,448 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 1), (Play 4)) | P=0.33563217520713806
2024-10-22 17:01:17,449 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 1), (Reveal player +1 color G)) | P=0.3270825445652008
2024-10-22 17:01:17,449 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:17,449 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:17,449 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || Y2|Y2
XX || X1|RGWB1
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || W5|W5
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:17,449 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:17,449 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:17,449 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:17,450 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.6609156727790833 | PUCT: 0.6609156727790833
2024-10-22 17:01:17,450 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5944217443466187 | PUCT: 0.5944217443466187
2024-10-22 17:01:17,450 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.6609156727790833
2024-10-22 17:01:17,450 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:01:17,450 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Reveal player +1 color B))
2024-10-22 17:01:17,450 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Reveal player +1 color B))']
2024-10-22 17:01:17,451 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:17,452 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:17,666 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:17,667 - DEBUG - Network Policy Logits: [[ 0.03830886  0.00143187  0.01102392 -0.00838366  0.04425953  0.01147823
   0.03346382 -0.00873593 -0.0026839   0.00679138 -0.0106581   0.02085455
  -0.03097921 -0.01216192  0.0317725  -0.00519167  0.00822161 -0.01376315
  -0.01241725 -0.02914912]]
2024-10-22 17:01:17,667 - DEBUG - Network Policy after Softmax: [[0.05175081 0.04987716 0.05035788 0.04938998 0.05205968 0.05038077
  0.05150068 0.04937259 0.04967229 0.05014519 0.04927777 0.05085538
  0.0482865  0.04920372 0.05141365 0.04954789 0.05021696 0.049125
  0.04919116 0.04837495]]
2024-10-22 17:01:17,668 - DEBUG - Normalized Policy: [[0.         0.         0.         0.5056486  0.         0.
  0.         0.         0.         0.         0.         0.
  0.49435133 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:17,669 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color B), (Discard 3)) | P=0.5056486129760742
2024-10-22 17:01:17,669 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color B), (Reveal player +1 color G)) | P=0.494351327419281
2024-10-22 17:01:17,669 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:17,669 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:17,670 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || Y2|Y2
XX || XX|RGW12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || W5|W5
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:17,670 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:17,670 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:17,670 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:17,670 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.5230100750923157 | PUCT: 0.5230100750923157
2024-10-22 17:01:17,671 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.6271875500679016 | PUCT: 0.6271875500679016
2024-10-22 17:01:17,671 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.6271875500679016
2024-10-22 17:01:17,671 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:17,671 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4))
2024-10-22 17:01:17,671 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))']
2024-10-22 17:01:17,672 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:17,672 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:17,918 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:17,918 - DEBUG - Network Policy Logits: [[ 0.03058903  0.00541816  0.03293829 -0.04167246  0.00796009  0.04423115
   0.05221111  0.0407453  -0.02451898  0.01336213 -0.0107805   0.0233365
  -0.04365999 -0.03456181  0.04537892 -0.00435634  0.01767446 -0.04891863
  -0.02485185 -0.04149602]]
2024-10-22 17:01:17,919 - DEBUG - Network Policy after Softmax: [[0.05142461 0.05014636 0.05154556 0.04783968 0.05027399 0.05213095
  0.05254862 0.05194955 0.04866737 0.0505463  0.0493406  0.051053
  0.04774468 0.04818106 0.05219083 0.04965859 0.05076475 0.04749427
  0.04865117 0.04784812]]
2024-10-22 17:01:17,920 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.345495   0.
  0.         0.         0.         0.         0.         0.
  0.328113   0.         0.         0.         0.         0.32639208
  0.         0.        ]]
2024-10-22 17:01:17,921 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Discard 4)) | P=0.34549498558044434
2024-10-22 17:01:17,922 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 rank 3)) | P=0.3263920843601227
2024-10-22 17:01:17,923 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 color G)) | P=0.32811298966407776
2024-10-22 17:01:17,923 - DEBUG - Simulating Node: ((Discard 3), (Discard 4)) | Value: 0.0
2024-10-22 17:01:17,923 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:17,923 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G3 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:17,923 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:17,923 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:17,923 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:17,924 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.5450440645217896 | PUCT: 0.5450440645217896
2024-10-22 17:01:17,925 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.43574032187461853 | PUCT: 0.43574032187461853
2024-10-22 17:01:17,925 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.5450440645217896
2024-10-22 17:01:17,925 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:01:17,925 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Discard 4))
2024-10-22 17:01:17,925 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Discard 4))']
2024-10-22 17:01:17,926 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:17,926 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:18,171 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:18,171 - DEBUG - Network Policy Logits: [[ 0.02778325  0.00771855  0.01874483 -0.02994046  0.0449721   0.03965152
   0.05415061 -0.00026978 -0.02689359  0.00035577 -0.01148891  0.01134481
  -0.02435961 -0.02848813  0.02839726 -0.01381256  0.01018578 -0.01823639
  -0.00308281 -0.03665751]]
2024-10-22 17:01:18,171 - DEBUG - Network Policy after Softmax: [[0.05126254 0.05024422 0.0508013  0.04838726 0.0521513  0.05187456
  0.05263217 0.04984445 0.04853491 0.04987564 0.04928837 0.05042675
  0.04865805 0.04845758 0.05129402 0.04917397 0.05036834 0.04895691
  0.04970443 0.04806333]]
2024-10-22 17:01:18,173 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32506248 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34458995 0.3303476  0.         0.
  0.         0.        ]]
2024-10-22 17:01:18,174 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 4), (Discard 3)) | P=0.32506248354911804
2024-10-22 17:01:18,174 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 4), (Reveal player +1 rank 1)) | P=0.33034759759902954
2024-10-22 17:01:18,175 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 4), (Reveal player +1 color B)) | P=0.3445899486541748
2024-10-22 17:01:18,175 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Discard 4)) | Value: 0.0
2024-10-22 17:01:18,175 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:18,175 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || Y2|Y2
XX || XX|RGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 W5}
2024-10-22 17:01:18,175 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:18,175 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:18,175 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:18,176 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.4507477283477783 | PUCT: 0.4507477283477783
2024-10-22 17:01:18,177 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4504428207874298 | PUCT: 0.4504428207874298
2024-10-22 17:01:18,177 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.4507477283477783
2024-10-22 17:01:18,177 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:01:18,177 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5123976469039917 | PUCT: 0.5123976469039917
2024-10-22 17:01:18,178 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Reveal player +1 color B)) | Q: 0.0 | U: 0.5329676270484924 | PUCT: 0.5329676270484924
2024-10-22 17:01:18,178 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Discard 4)) | Q: 0.0 | U: 0.5404298305511475 | PUCT: 0.5404298305511475
2024-10-22 17:01:18,178 - DEBUG - Selected Child: ((Reveal player +1 color W), (Discard 4)) | PUCT: 0.5404298305511475
2024-10-22 17:01:18,178 - DEBUG - Selected child for exploration: ((Reveal player +1 color W), (Discard 4))
2024-10-22 17:01:18,178 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Discard 4), (Discard 3))
2024-10-22 17:01:18,178 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Discard 4))', '((Reveal player +1 color W), (Discard 4), (Discard 3))']
2024-10-22 17:01:18,179 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:18,180 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:18,180 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 3
2024-10-22 17:01:18,418 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:18,418 - DEBUG - Network Policy Logits: [[-0.00501403 -0.00464521  0.05247143 -0.0309571   0.00355575  0.03641426
   0.03474667  0.00921277  0.00862895  0.01602825  0.00813558  0.01352182
  -0.06343304 -0.02579313  0.03218284 -0.04198696  0.01001396 -0.02746318
   0.01504955 -0.04563829]]
2024-10-22 17:01:18,418 - DEBUG - Network Policy after Softmax: [[0.04974046 0.04975881 0.05268359 0.04846663 0.05016855 0.0518444
  0.05175801 0.05045316 0.05042371 0.0507982  0.05039884 0.05067103
  0.04691792 0.04871755 0.05162549 0.04793499 0.0504936  0.04863627
  0.0507485  0.04776028]]
2024-10-22 17:01:18,420 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.49885505 0.
  0.         0.         0.         0.         0.50114495 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:18,420 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 4), (Discard 3), (Reveal player +1 color R)) | P=0.5011449456214905
2024-10-22 17:01:18,421 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 4), (Discard 3), (Discard 4)) | P=0.4988550543785095
2024-10-22 17:01:18,422 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Discard 4), (Discard 3)) | Value: 0.0
2024-10-22 17:01:18,422 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:18,422 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'G', 'rank': 4}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
G5 || XX|RGWB12345
R4 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 W5 Y2}
2024-10-22 17:01:18,422 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:18,422 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:18,422 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:18,423 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.38611459732055664 | PUCT: 0.38611459732055664
2024-10-22 17:01:18,424 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4630240499973297 | PUCT: 0.4630240499973297
2024-10-22 17:01:18,424 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.4630240499973297
2024-10-22 17:01:18,424 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:18,424 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 color B))
2024-10-22 17:01:18,424 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 color B))']
2024-10-22 17:01:18,425 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:18,425 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:18,681 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:18,681 - DEBUG - Network Policy Logits: [[ 0.0342719   0.00222257  0.01433721 -0.00024788  0.02547001  0.0128661
   0.01721572  0.00933155 -0.01764229 -0.01357647 -0.00454369  0.01183155
  -0.02786706 -0.00891424  0.05177581 -0.01831238  0.00039691 -0.01899542
  -0.03507695 -0.0323861 ]]
2024-10-22 17:01:18,681 - DEBUG - Network Policy after Softmax: [[0.05172507 0.0500936  0.05070416 0.04997    0.05127179 0.05062962
  0.05085032 0.05045099 0.04910832 0.04930839 0.0497558  0.05057727
  0.04860875 0.04953881 0.05263843 0.04907542 0.05000223 0.04904191
  0.04825955 0.04838958]]
2024-10-22 17:01:18,683 - DEBUG - Normalized Policy: [[0.         0.         0.         0.50216657 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.49783343 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:18,683 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color B), (Reveal player +1 color W)) | P=0.4978334307670593
2024-10-22 17:01:18,684 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color B), (Discard 3)) | P=0.5021665692329407
2024-10-22 17:01:18,684 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:18,684 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:18,684 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': 'B', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || XX|RGW12345
XX || BX|B12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2}
2024-10-22 17:01:18,684 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:18,684 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:18,685 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:18,685 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.39526358246803284 | PUCT: 0.39526358246803284
2024-10-22 17:01:18,686 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3554965853691101 | PUCT: 0.3554965853691101
2024-10-22 17:01:18,686 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.39526358246803284
2024-10-22 17:01:18,686 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:01:18,686 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5406421422958374 | PUCT: 0.5406421422958374
2024-10-22 17:01:18,687 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Reveal player +1 color B)) | Q: 0.0 | U: 0.5623459815979004 | PUCT: 0.5623459815979004
2024-10-22 17:01:18,687 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Discard 4)) | Q: 0.0 | U: 0.3801463544368744 | PUCT: 0.3801463544368744
2024-10-22 17:01:18,687 - DEBUG - Selected Child: ((Reveal player +1 color W), (Reveal player +1 color B)) | PUCT: 0.5623459815979004
2024-10-22 17:01:18,687 - DEBUG - Selected child for exploration: ((Reveal player +1 color W), (Reveal player +1 color B))
2024-10-22 17:01:18,687 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Reveal player +1 color B), (Discard 3))
2024-10-22 17:01:18,688 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Reveal player +1 color B))', '((Reveal player +1 color W), (Reveal player +1 color B), (Discard 3))']
2024-10-22 17:01:18,688 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:18,689 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:18,690 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 3
2024-10-22 17:01:18,909 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:18,909 - DEBUG - Network Policy Logits: [[ 0.01462239 -0.01130414  0.04995902  0.00751913  0.04336466  0.01207031
   0.02017766  0.02448998  0.0100495  -0.00592873  0.00484396 -0.00427829
  -0.02048268  0.01597998  0.02314208 -0.0062971   0.02253005 -0.01129219
   0.0311409  -0.00843265]]
2024-10-22 17:01:18,909 - DEBUG - Network Policy after Softmax: [[0.05019331 0.0489087  0.05199868 0.04983804 0.05165691 0.05006538
  0.05047293 0.05069105 0.04996431 0.04917231 0.04970489 0.04925353
  0.04846184 0.0502615  0.05062276 0.0491542  0.05059179 0.04890928
  0.05102931 0.04904934]]
2024-10-22 17:01:18,910 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3431988  0.
  0.         0.         0.         0.         0.33022994 0.
  0.         0.         0.         0.32657126 0.         0.
  0.         0.        ]]
2024-10-22 17:01:18,911 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color B), (Discard 3), (Reveal player +1 color R)) | P=0.3302299380302429
2024-10-22 17:01:18,912 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color B), (Discard 3), (Discard 4)) | P=0.3431988060474396
2024-10-22 17:01:18,912 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color B), (Discard 3), (Reveal player +1 rank 1)) | P=0.3265712559223175
2024-10-22 17:01:18,912 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Reveal player +1 color B), (Discard 3)) | Value: 0.0
2024-10-22 17:01:18,912 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:18,913 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'B', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
B1 || BX|B12345
R1 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2}
2024-10-22 17:01:18,913 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:18,913 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:18,913 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:18,913 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color W),) | Visit Count: 6
2024-10-22 17:01:18,913 - INFO - Actual Game Score: 4
2024-10-22 17:01:18,913 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:18,914 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:18,914 - DEBUG - Policy Targets: [0.         0.         0.         0.33333333 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.66666667 0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:18,914 - DEBUG - === End of Training Data ===
2024-10-22 17:01:18,914 - INFO - Chosen Action: (Reveal player +1 color W) | Visit Count: 6
2024-10-22 17:01:21,176 - DEBUG - Not the current player's turn.
2024-10-22 17:01:21,177 - INFO - Agent state has been reset.
2024-10-22 17:01:21,177 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:21,177 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || Y2|Y2
XX || RX|R12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || W5|W5
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:21,177 - INFO - Max Rollouts: 10
2024-10-22 17:01:21,177 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:21,177 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:21,177 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:21,397 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:21,397 - DEBUG - Network Policy Logits: [[ 0.06021068 -0.00772938  0.03757607 -0.00418009  0.03409407 -0.00439867
   0.03779581 -0.01076041 -0.00591637 -0.00795616  0.0040765   0.00978624
  -0.01719677  0.0090177   0.0273808  -0.01154613 -0.00535633 -0.00885493
  -0.01845521 -0.01060842]]
2024-10-22 17:01:21,397 - DEBUG - Network Policy after Softmax: [[0.05280735 0.04933878 0.0516255  0.04951421 0.05144606 0.04950339
  0.05163685 0.04918946 0.04942831 0.04932759 0.04992472 0.05021059
  0.04887388 0.05017202 0.05110184 0.04915082 0.049456   0.04928328
  0.04881241 0.04919694]]
2024-10-22 17:01:21,398 - DEBUG - Normalized Policy: [[0.         0.         0.         0.5032541  0.         0.
  0.         0.         0.         0.         0.         0.
  0.49674588 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:21,399 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.6274406  0.         0.
 0.         0.         0.         0.         0.         0.
 0.37255943 0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:21,399 - DEBUG - Added Child Node: ((Discard 3),) | P=0.6274405717849731
2024-10-22 17:01:21,400 - DEBUG - Added Child Node: ((Reveal player +1 color G),) | P=0.37255942821502686
2024-10-22 17:01:21,400 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:21,400 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:21,400 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || Y2|Y2
XX || RX|R12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || W5|W5
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:21,400 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:21,400 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:21,400 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:21,401 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G),)
2024-10-22 17:01:21,401 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)']
2024-10-22 17:01:21,401 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:01:21,627 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:21,627 - DEBUG - Network Policy Logits: [[ 0.00543756 -0.01032542  0.04749563  0.02379287  0.04558886  0.00607976
  -0.00852077  0.00894768  0.00842501 -0.0184296   0.02048265  0.00181737
  -0.04006767  0.00836777  0.02022442 -0.01221831  0.0107998  -0.00376727
   0.00843666 -0.00378093]]
2024-10-22 17:01:21,627 - DEBUG - Network Policy after Softmax: [[0.04996517 0.04918374 0.05211142 0.05089076 0.05201215 0.04999726
  0.04927257 0.05014085 0.05011465 0.04878675 0.05072257 0.0497846
  0.04774244 0.05011179 0.05070948 0.04909072 0.05023381 0.04950735
  0.05011524 0.04950668]]
2024-10-22 17:01:21,629 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50928694 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.49071303 0.        ]]
2024-10-22 17:01:21,630 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4)) | P=0.5092869400978088
2024-10-22 17:01:21,630 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 4)) | P=0.4907130300998688
2024-10-22 17:01:21,630 - DEBUG - Simulating Node: ((Reveal player +1 color G),) | Value: 0.0
2024-10-22 17:01:21,630 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:21,631 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
Y2 || Y2|Y2
R4 || RX|R12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:21,631 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:21,631 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:21,631 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:21,631 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:01:21,631 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:01:21,632 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:21,862 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:21,862 - DEBUG - Network Policy Logits: [[-0.00238337 -0.00611389  0.0622648   0.00851749  0.036051    0.02221626
   0.02884473  0.00945887  0.00653769  0.00580163 -0.00069174 -0.00438994
  -0.03923688  0.00676871  0.02514032  0.00125912  0.00465976 -0.02738993
   0.00404555  0.00935378]]
2024-10-22 17:01:21,862 - DEBUG - Network Policy after Softmax: [[0.04949563 0.04931133 0.05280113 0.05003813 0.05143499 0.05072831
  0.05106567 0.05008525 0.04993916 0.04990241 0.04957943 0.04939641
  0.04770475 0.0499507  0.05087686 0.04967625 0.04984546 0.04827326
  0.04981486 0.05007999]]
2024-10-22 17:01:21,864 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3439936  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.32284817
  0.33315825 0.        ]]
2024-10-22 17:01:21,864 - DEBUG - Added Child Node: ((Discard 3), (Discard 4)) | P=0.343993604183197
2024-10-22 17:01:21,865 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3)) | P=0.3228481709957123
2024-10-22 17:01:21,865 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 4)) | P=0.3331582546234131
2024-10-22 17:01:21,866 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:01:21,866 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:21,866 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G3 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2}
2024-10-22 17:01:21,866 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:21,866 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:21,866 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:21,867 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.5483189821243286 | PUCT: 0.5483189821243286
2024-10-22 17:01:21,867 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.9234434962272644 | PUCT: 0.9234434962272644
2024-10-22 17:01:21,867 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.9234434962272644
2024-10-22 17:01:21,867 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:21,867 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4))
2024-10-22 17:01:21,867 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))']
2024-10-22 17:01:21,868 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:21,869 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:22,153 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:22,153 - DEBUG - Network Policy Logits: [[ 0.02213155 -0.0053856   0.02719519 -0.03865596  0.02210005  0.02930317
   0.05585897  0.01639155 -0.02352325  0.00303673 -0.0030342   0.01658957
  -0.04595561 -0.0245692   0.04521083 -0.01661203  0.0070373  -0.03182099
  -0.01437837 -0.03673095]]
2024-10-22 17:01:22,153 - DEBUG - Network Policy after Softmax: [[0.05108776 0.04970114 0.05134711 0.04807477 0.05108615 0.05145546
  0.0528402  0.05079536 0.0488078  0.0501215  0.04981814 0.05080541
  0.04772511 0.04875677 0.05228054 0.04914629 0.05032242 0.04840448
  0.04925619 0.0481674 ]]
2024-10-22 17:01:22,155 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.34701556 0.
  0.         0.         0.         0.         0.         0.
  0.32418483 0.         0.         0.         0.         0.32879964
  0.         0.        ]]
2024-10-22 17:01:22,155 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Discard 4)) | P=0.3470155596733093
2024-10-22 17:01:22,156 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 rank 3)) | P=0.32879963517189026
2024-10-22 17:01:22,156 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 color G)) | P=0.3241848349571228
2024-10-22 17:01:22,157 - DEBUG - Simulating Node: ((Discard 3), (Discard 4)) | Value: 0.0
2024-10-22 17:01:22,157 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:22,157 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G3 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:22,157 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:22,157 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:22,157 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:22,158 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.5908029675483704 | PUCT: 0.5908029675483704
2024-10-22 17:01:22,158 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.6633281707763672 | PUCT: 0.6633281707763672
2024-10-22 17:01:22,158 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.6633281707763672
2024-10-22 17:01:22,158 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:22,158 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 4))
2024-10-22 17:01:22,158 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 4))']
2024-10-22 17:01:22,159 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:22,160 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:22,382 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:22,382 - DEBUG - Network Policy Logits: [[ 0.03810401 -0.00661462  0.0318647  -0.01534457  0.03456014  0.01453087
   0.04075732 -0.00683911  0.00080251 -0.00968896 -0.00852414  0.03901234
  -0.04179221 -0.00700529  0.05102346 -0.01616121  0.00823284 -0.01525299
  -0.01501248 -0.03318262]]
2024-10-22 17:01:22,382 - DEBUG - Network Policy after Softmax: [[0.05170816 0.04944678 0.05138654 0.04901699 0.05152524 0.05050349
  0.05184554 0.04943568 0.04981489 0.049295   0.04935245 0.05175515
  0.0477376  0.04942747 0.05238054 0.04897698 0.05018642 0.04902148
  0.04903327 0.04815038]]
2024-10-22 17:01:22,383 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.51907885 0.
  0.         0.         0.         0.         0.         0.
  0.4809212  0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:22,384 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 4), (Discard 4)) | P=0.5190788507461548
2024-10-22 17:01:22,385 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 4), (Reveal player +1 color G)) | P=0.48092120885849
2024-10-22 17:01:22,385 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:22,385 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:22,385 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R1235
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || W5|W5
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2}
2024-10-22 17:01:22,385 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:22,385 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:22,385 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:22,386 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.6233693361282349 | PUCT: 0.6233693361282349
2024-10-22 17:01:22,386 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5249192118644714 | PUCT: 0.5249192118644714
2024-10-22 17:01:22,386 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.6233693361282349
2024-10-22 17:01:22,386 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:01:22,386 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Discard 4))
2024-10-22 17:01:22,387 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Discard 4))']
2024-10-22 17:01:22,387 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:01:22,388 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:22,624 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:22,624 - DEBUG - Network Policy Logits: [[ 0.03293592 -0.00439223  0.0137905  -0.02095228  0.05804599  0.00554524
   0.0364802  -0.00495852 -0.00907782  0.01034646 -0.01270466 -0.00669273
  -0.00957417 -0.0181732   0.00960301 -0.01914001 -0.00040861 -0.00415098
  -0.01151012 -0.01173328]]
2024-10-22 17:01:22,625 - DEBUG - Network Policy after Softmax: [[0.0515779  0.04968809 0.05059982 0.04887202 0.05288943 0.05018432
  0.05176103 0.04965996 0.04945581 0.05042585 0.04927677 0.04957391
  0.04943127 0.04900803 0.05038837 0.04896067 0.04988642 0.04970008
  0.04933567 0.04932466]]
2024-10-22 17:01:22,626 - DEBUG - Normalized Policy: [[0.         0.         0.         0.49763945 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.5023605  0.        ]]
2024-10-22 17:01:22,626 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Discard 3)) | P=0.4976394474506378
2024-10-22 17:01:22,627 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Reveal player +1 rank 4)) | P=0.5023605227470398
2024-10-22 17:01:22,627 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Discard 4)) | Value: 0.0
2024-10-22 17:01:22,627 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:22,627 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || Y2|Y2
XX || RX|R12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W4 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 W5}
2024-10-22 17:01:22,627 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:22,627 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:22,628 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:22,628 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.433087557554245 | PUCT: 0.433087557554245
2024-10-22 17:01:22,629 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5470336079597473 | PUCT: 0.5470336079597473
2024-10-22 17:01:22,629 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.5470336079597473
2024-10-22 17:01:22,629 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:22,629 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 3))
2024-10-22 17:01:22,629 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 3))']
2024-10-22 17:01:22,630 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:22,631 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:22,963 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:22,963 - DEBUG - Network Policy Logits: [[ 0.02691947  0.00150617  0.01214366  0.00091741  0.02328123  0.00363577
   0.0385807  -0.0054611  -0.00391901 -0.01209081  0.00780747  0.02916362
  -0.05292735 -0.00068584  0.05321432 -0.02431487  0.00382697 -0.01489046
  -0.00443452 -0.03609838]]
2024-10-22 17:01:22,964 - DEBUG - Network Policy after Softmax: [[0.05123083 0.04994529 0.05047942 0.04991589 0.05104478 0.05005176
  0.05183174 0.04959852 0.04967506 0.04927078 0.050261   0.05134593
  0.04729926 0.04983593 0.0525958  0.04867215 0.05006133 0.04913303
  0.04964945 0.04810199]]
2024-10-22 17:01:22,965 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.5190429  0.
  0.         0.         0.         0.         0.         0.
  0.48095706 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:22,966 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Discard 4)) | P=0.5190429091453552
2024-10-22 17:01:22,966 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Reveal player +1 color G)) | P=0.4809570610523224
2024-10-22 17:01:22,966 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:01:22,966 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:22,966 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R1245
XX || XX|RYGWB1245
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || W5|W5
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2}
2024-10-22 17:01:22,966 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:22,966 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:22,967 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:22,967 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.4477005898952484 | PUCT: 0.4477005898952484
2024-10-22 17:01:22,968 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4523930549621582 | PUCT: 0.4523930549621582
2024-10-22 17:01:22,968 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.4523930549621582
2024-10-22 17:01:22,968 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:22,968 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.5455034375190735 | PUCT: 0.5455034375190735
2024-10-22 17:01:22,969 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.5283207893371582 | PUCT: 0.5283207893371582
2024-10-22 17:01:22,969 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3)) | Q: 0.0 | U: 0.511971116065979 | PUCT: 0.511971116065979
2024-10-22 17:01:22,969 - DEBUG - Selected Child: ((Discard 3), (Discard 4)) | PUCT: 0.5455034375190735
2024-10-22 17:01:22,969 - DEBUG - Selected child for exploration: ((Discard 3), (Discard 4))
2024-10-22 17:01:22,970 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4), (Reveal player +1 rank 3))
2024-10-22 17:01:22,970 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))', '((Discard 3), (Discard 4), (Reveal player +1 rank 3))']
2024-10-22 17:01:22,970 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:22,971 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:22,972 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 3
2024-10-22 17:01:23,217 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:23,217 - DEBUG - Network Policy Logits: [[-0.0067476   0.00036348  0.08541448 -0.00047525  0.02939807  0.01969322
   0.0284335   0.00813006  0.02020296  0.0166741  -0.00235302  0.00189895
  -0.0316746  -0.00274166  0.01625794 -0.00735092  0.01655255 -0.01775941
   0.00234273 -0.00153099]]
2024-10-22 17:01:23,217 - DEBUG - Network Policy after Softmax: [[0.04921861 0.04956985 0.0539703  0.0495283  0.05103019 0.05053734
  0.05098099 0.04995634 0.05056311 0.05038499 0.04943538 0.04964602
  0.0480069  0.04941617 0.05036404 0.04918892 0.05037887 0.0486796
  0.04966806 0.04947603]]
2024-10-22 17:01:23,219 - DEBUG - Normalized Policy: [[0.49772742 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.50227255 0.        ]]
2024-10-22 17:01:23,220 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 rank 3), (Discard 0)) | P=0.4977274239063263
2024-10-22 17:01:23,220 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 rank 3), (Reveal player +1 rank 4)) | P=0.5022725462913513
2024-10-22 17:01:23,220 - DEBUG - Simulating Node: ((Discard 3), (Discard 4), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:01:23,220 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:23,220 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 2}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X3|RYGWB3
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
B4 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:23,220 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:23,221 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:23,221 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:23,221 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.46020522713661194 | PUCT: 0.46020522713661194
2024-10-22 17:01:23,222 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.38752397894859314 | PUCT: 0.38752397894859314
2024-10-22 17:01:23,222 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.46020522713661194
2024-10-22 17:01:23,222 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:01:23,222 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Reveal player +1 rank 4))
2024-10-22 17:01:23,222 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 rank 4))']
2024-10-22 17:01:23,223 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:01:23,224 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:23,443 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:23,443 - DEBUG - Network Policy Logits: [[ 0.04337132  0.00338787  0.01754278 -0.00295037  0.03912373  0.00141934
   0.02010178 -0.00493879 -0.00277999 -0.00188024 -0.00026832  0.01666581
  -0.02989695 -0.00995651  0.01513572 -0.02386387  0.00328527 -0.00072465
  -0.02695181 -0.00939412]]
2024-10-22 17:01:23,443 - DEBUG - Network Policy after Softmax: [[0.05208611 0.05004461 0.05075803 0.04972842 0.05186534 0.04994619
  0.05088808 0.04962964 0.04973689 0.04978167 0.04986198 0.05071354
  0.0484063  0.04938123 0.050636   0.04869923 0.05003948 0.04983922
  0.04854908 0.04940902]]
2024-10-22 17:01:23,444 - DEBUG - Normalized Policy: [[0.         0.         0.         0.5067363  0.         0.
  0.         0.         0.         0.         0.         0.
  0.49326375 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:23,445 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 4), (Discard 3)) | P=0.5067362785339355
2024-10-22 17:01:23,446 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 4), (Reveal player +1 color G)) | P=0.49326375126838684
2024-10-22 17:01:23,446 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:23,446 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:23,446 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || Y2|Y2
XX || RX|R1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || W5|W5
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:23,446 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:23,446 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:23,446 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:23,447 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.3533323407173157 | PUCT: 0.3533323407173157
2024-10-22 17:01:23,447 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.39670637249946594 | PUCT: 0.39670637249946594
2024-10-22 17:01:23,447 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.39670637249946594
2024-10-22 17:01:23,447 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:23,448 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.3837151825428009 | PUCT: 0.3837151825428009
2024-10-22 17:01:23,448 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.5574429631233215 | PUCT: 0.5574429631233215
2024-10-22 17:01:23,449 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3)) | Q: 0.0 | U: 0.5401920676231384 | PUCT: 0.5401920676231384
2024-10-22 17:01:23,449 - DEBUG - Selected Child: ((Discard 3), (Reveal player +1 rank 4)) | PUCT: 0.5574429631233215
2024-10-22 17:01:23,449 - DEBUG - Selected child for exploration: ((Discard 3), (Reveal player +1 rank 4))
2024-10-22 17:01:23,449 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 4), (Discard 4))
2024-10-22 17:01:23,449 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 4))', '((Discard 3), (Reveal player +1 rank 4), (Discard 4))']
2024-10-22 17:01:23,450 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:23,450 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:23,451 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:01:23,667 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:23,667 - DEBUG - Network Policy Logits: [[ 0.00434327 -0.01147311  0.06652364  0.00091226  0.0394794   0.02610273
   0.02208683  0.01895848  0.00492165 -0.00952816  0.00163451  0.00207559
  -0.04410727  0.00271715  0.01992543 -0.00354965  0.01301215 -0.03970763
   0.01766954  0.00952726]]
2024-10-22 17:01:23,668 - DEBUG - Network Policy after Softmax: [[0.04984945 0.04906722 0.05304751 0.04967871 0.0516321  0.05094604
  0.05074186 0.05058336 0.04987829 0.04916274 0.0497146  0.04973654
  0.0474918  0.04976846 0.0506323  0.04945754 0.05028347 0.0477012
  0.0505182  0.05010854]]
2024-10-22 17:01:23,669 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3470113  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.33239642 0.         0.32059234
  0.         0.        ]]
2024-10-22 17:01:23,670 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 4), (Discard 4), (Discard 4)) | P=0.3470112979412079
2024-10-22 17:01:23,670 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 4), (Discard 4), (Reveal player +1 rank 1)) | P=0.33239641785621643
2024-10-22 17:01:23,671 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 4), (Discard 4), (Reveal player +1 rank 3)) | P=0.32059234380722046
2024-10-22 17:01:23,671 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 4), (Discard 4)) | Value: 0.0
2024-10-22 17:01:23,671 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:23,671 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R1 || RX|R1235
G3 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W4}
2024-10-22 17:01:23,671 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:23,671 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:23,671 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:23,671 - DEBUG - Best node chosen by MCTS: ((Discard 3),) | Visit Count: 6
2024-10-22 17:01:23,671 - INFO - Actual Game Score: 4
2024-10-22 17:01:23,671 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:23,672 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:23,672 - DEBUG - Policy Targets: [0.         0.         0.         0.66666667 0.         0.
 0.         0.         0.         0.         0.         0.
 0.33333333 0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:23,672 - DEBUG - === End of Training Data ===
2024-10-22 17:01:23,672 - INFO - Chosen Action: (Discard 3) | Visit Count: 6
2024-10-22 17:01:25,288 - DEBUG - Not the current player's turn.
2024-10-22 17:01:25,289 - INFO - Agent state has been reset.
2024-10-22 17:01:25,289 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:25,289 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y5 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:25,289 - INFO - Max Rollouts: 10
2024-10-22 17:01:25,289 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:25,289 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:25,289 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:25,508 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:25,508 - DEBUG - Network Policy Logits: [[ 0.0189988  -0.01457479  0.02848928 -0.03683247  0.02696487  0.01486848
   0.05535597  0.01586732 -0.01218962  0.00470788 -0.00381674  0.01525134
  -0.02446191 -0.02302838  0.04697082 -0.02403012  0.01956904 -0.02910222
  -0.01000801 -0.03499844]]
2024-10-22 17:01:25,508 - DEBUG - Network Policy after Softmax: [[0.05085482 0.04917579 0.05133976 0.04809334 0.05126155 0.05064521
  0.05273778 0.05069582 0.04929322 0.05013323 0.04970768 0.05066461
  0.04869198 0.04876183 0.05229742 0.04871301 0.05088383 0.04846656
  0.04940088 0.04818163]]
2024-10-22 17:01:25,510 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.5154858  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.48451412]]
2024-10-22 17:01:25,510 - DEBUG - Dirichlet Noise Added: [0.        0.        0.        0.        0.3866494 0.        0.
 0.        0.        0.        0.        0.        0.        0.
 0.        0.        0.        0.        0.        0.6133506]
2024-10-22 17:01:25,511 - DEBUG - Added Child Node: ((Reveal player +1 rank 5),) | P=0.6133505702018738
2024-10-22 17:01:25,512 - DEBUG - Added Child Node: ((Discard 4),) | P=0.38664939999580383
2024-10-22 17:01:25,512 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:25,512 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:25,512 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y5 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:25,512 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:25,512 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:25,512 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:25,512 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:25,513 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:25,513 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:25,733 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:25,733 - DEBUG - Network Policy Logits: [[-0.00706286  0.00874112  0.07064945 -0.02551895  0.00525855  0.0421869
   0.05719012  0.00659436  0.01654397  0.00049362  0.01224675  0.02953387
  -0.06271049 -0.02123627  0.02615905 -0.00828535  0.01572373 -0.04166301
   0.00642353 -0.02258369]]
2024-10-22 17:01:25,733 - DEBUG - Network Policy after Softmax: [[0.04935526 0.05014146 0.05334374 0.04845271 0.04996715 0.05184685
  0.05263058 0.05003394 0.05053424 0.04972962 0.05031755 0.05119495
  0.04668378 0.04866066 0.05102248 0.04929496 0.05049281 0.04767676
  0.05002539 0.04859514]]
2024-10-22 17:01:25,735 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3383719  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.3228617
  0.33876634 0.        ]]
2024-10-22 17:01:25,736 - DEBUG - Added Child Node: ((Discard 4), (Discard 4)) | P=0.3383719027042389
2024-10-22 17:01:25,737 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3)) | P=0.3228617012500763
2024-10-22 17:01:25,737 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4)) | P=0.33876633644104004
2024-10-22 17:01:25,737 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:25,737 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:25,738 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G3 || XX|RYGWB12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 W4}
2024-10-22 17:01:25,738 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:25,738 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:25,738 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:25,738 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5),)
2024-10-22 17:01:25,738 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)']
2024-10-22 17:01:25,739 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:01:25,940 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:25,940 - DEBUG - Network Policy Logits: [[ 0.00262255 -0.00486193  0.05943375  0.00252122  0.0336267   0.01765809
   0.03092505 -0.00165654  0.0158419  -0.00102225  0.00301727  0.01185778
  -0.04533726  0.01176343  0.01497051 -0.01723706  0.01707462 -0.03708499
   0.02260926  0.00346654]]
2024-10-22 17:01:25,940 - DEBUG - Network Policy after Softmax: [[0.04976835 0.04939725 0.05267761 0.04976331 0.05133554 0.0505223
  0.05119704 0.04955584 0.05043062 0.04958728 0.049788   0.0502301
  0.0474378  0.05022536 0.05038669 0.04878972 0.05049283 0.04783089
  0.05077306 0.04981037]]
2024-10-22 17:01:25,941 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3410729  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.3347687  0.32415843 0.         0.
  0.         0.        ]]
2024-10-22 17:01:25,942 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4)) | P=0.3410728871822357
2024-10-22 17:01:25,942 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1)) | P=0.3241584300994873
2024-10-22 17:01:25,943 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 color B)) | P=0.33476871252059937
2024-10-22 17:01:25,943 - DEBUG - Simulating Node: ((Reveal player +1 rank 5),) | Value: 0.0
2024-10-22 17:01:25,943 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:25,943 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R1 || RX|R12345
B3 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:25,943 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:25,943 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:25,943 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:25,944 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5690560936927795 | PUCT: 0.5690560936927795
2024-10-22 17:01:25,944 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.9027063846588135 | PUCT: 0.9027063846588135
2024-10-22 17:01:25,944 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 0.9027063846588135
2024-10-22 17:01:25,944 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:01:25,944 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5), (Discard 4))
2024-10-22 17:01:25,944 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Discard 4))']
2024-10-22 17:01:25,945 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:01:25,945 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:26,169 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:26,169 - DEBUG - Network Policy Logits: [[ 0.01834687 -0.00223416  0.02810857 -0.03541716  0.0309638   0.03728388
   0.05603922  0.0093022  -0.01815405 -0.00406433  0.00280897  0.02504598
  -0.0566206  -0.02393838  0.04636229 -0.01645706  0.01186169 -0.02825399
  -0.01756085 -0.03629208]]
2024-10-22 17:01:26,169 - DEBUG - Network Policy after Softmax: [[0.05083431 0.04979878 0.05133297 0.04817342 0.05147975 0.05180613
  0.05278694 0.0503766  0.04901227 0.04970772 0.05005056 0.051176
  0.04716273 0.04872958 0.05227859 0.04909551 0.05050571 0.04851974
  0.04904135 0.04813129]]
2024-10-22 17:01:26,171 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33679065 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34201685 0.3211925  0.         0.
  0.         0.        ]]
2024-10-22 17:01:26,172 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4), (Discard 4)) | P=0.33679065108299255
2024-10-22 17:01:26,173 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4), (Reveal player +1 rank 1)) | P=0.32119250297546387
2024-10-22 17:01:26,174 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4), (Reveal player +1 color B)) | P=0.3420168459415436
2024-10-22 17:01:26,174 - DEBUG - Simulating Node: ((Reveal player +1 rank 5), (Discard 4)) | Value: 0.0
2024-10-22 17:01:26,174 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:26,174 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 G5}
2024-10-22 17:01:26,174 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:26,174 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:26,174 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:26,175 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6131467819213867 | PUCT: 0.6131467819213867
2024-10-22 17:01:26,175 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.6484323143959045 | PUCT: 0.6484323143959045
2024-10-22 17:01:26,176 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 0.6484323143959045
2024-10-22 17:01:26,176 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:01:26,176 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5), (Reveal player +1 rank 1))
2024-10-22 17:01:26,176 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Reveal player +1 rank 1))']
2024-10-22 17:01:26,176 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:01:26,178 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:26,401 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:26,401 - DEBUG - Network Policy Logits: [[ 0.02727225  0.00257367  0.0175019   0.00806419  0.04901108 -0.00530325
   0.01544375  0.00629085  0.00888664 -0.00402564 -0.00430931  0.01497606
  -0.03511883 -0.00967636  0.06293762 -0.02031995  0.00299169 -0.02440174
  -0.0217011  -0.02415464]]
2024-10-22 17:01:26,401 - DEBUG - Network Policy after Softmax: [[0.05119613 0.04994715 0.05069837 0.05022214 0.05232126 0.04955526
  0.05059413 0.05013316 0.05026346 0.04961862 0.04960454 0.05057047
  0.04809956 0.04933903 0.05305501 0.04881667 0.04996803 0.04861781
  0.04874929 0.04862983]]
2024-10-22 17:01:26,403 - DEBUG - Normalized Policy: [[0.33818448 0.         0.         0.         0.         0.
  0.         0.         0.         0.32776394 0.         0.33405158
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:26,404 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1), (Play 4)) | P=0.32776394486427307
2024-10-22 17:01:26,405 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1), (Reveal player +1 color Y)) | P=0.33405157923698425
2024-10-22 17:01:26,405 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1), (Discard 0)) | P=0.3381844758987427
2024-10-22 17:01:26,405 - DEBUG - Simulating Node: ((Reveal player +1 rank 5), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:26,405 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:26,406 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R2345
XX || X1|RYGWB1
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y5 || X5|RYGWB5
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:26,406 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:26,406 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:26,406 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:26,407 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6469447612762451 | PUCT: 0.6469447612762451
2024-10-22 17:01:26,408 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.5131314396858215 | PUCT: 0.5131314396858215
2024-10-22 17:01:26,408 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.6469447612762451
2024-10-22 17:01:26,408 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:26,408 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 4))
2024-10-22 17:01:26,408 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 4))']
2024-10-22 17:01:26,409 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:26,409 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:26,618 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:26,618 - DEBUG - Network Policy Logits: [[ 0.04541558  0.00327086  0.02306027 -0.0356258   0.05055918  0.02024299
   0.05778401  0.00620547 -0.01768798 -0.00350064 -0.02307434  0.02081089
  -0.02622732 -0.01626448  0.04279738 -0.02347855  0.01328257 -0.03483018
  -0.00598332 -0.01764284]]
2024-10-22 17:01:26,618 - DEBUG - Network Policy after Softmax: [[0.0520953  0.04994538 0.05094361 0.04803997 0.05236394 0.05080029
  0.05274364 0.05009216 0.04890947 0.04960832 0.04864674 0.05082915
  0.0484936  0.04897915 0.05195908 0.04862708 0.05044793 0.0480782
  0.0494853  0.04891168]]
2024-10-22 17:01:26,620 - DEBUG - Normalized Policy: [[0.5157594 0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.4842406]]
2024-10-22 17:01:26,621 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4), (Reveal player +1 rank 5)) | P=0.4842405915260315
2024-10-22 17:01:26,621 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4), (Discard 0)) | P=0.5157594084739685
2024-10-22 17:01:26,621 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:26,621 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:26,622 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y5 || XX|RYGWB12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 B1}
2024-10-22 17:01:26,622 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:26,622 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:26,622 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:26,623 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.44946667551994324 | PUCT: 0.44946667551994324
2024-10-22 17:01:26,623 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.5347492694854736 | PUCT: 0.5347492694854736
2024-10-22 17:01:26,623 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 0.5347492694854736
2024-10-22 17:01:26,623 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:01:26,623 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5), (Reveal player +1 color B))
2024-10-22 17:01:26,623 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Reveal player +1 color B))']
2024-10-22 17:01:26,625 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:01:26,625 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:26,830 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:26,830 - DEBUG - Network Policy Logits: [[ 0.02557995  0.00036698  0.01816284 -0.00614816  0.03831609 -0.00124818
   0.0280885   0.00421113  0.00375148  0.01103932 -0.00092565  0.03176266
  -0.04777654 -0.01384942  0.05230493 -0.01027466  0.01509177 -0.02556378
  -0.02363351 -0.04058423]]
2024-10-22 17:01:26,830 - DEBUG - Network Policy after Softmax: [[0.05112905 0.04985605 0.05075122 0.04953229 0.0517844  0.04977559
  0.05125747 0.05004808 0.05002507 0.05039098 0.04979165 0.05144615
  0.04751267 0.04915229 0.0525139  0.04932832 0.0505956  0.04857987
  0.04867373 0.04785563]]
2024-10-22 17:01:26,832 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50163835 0.
  0.         0.         0.         0.         0.         0.49836165
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:26,833 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 color B), (Discard 4)) | P=0.5016383528709412
2024-10-22 17:01:26,833 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Reveal player +1 color B), (Reveal player +1 color Y)) | P=0.49836164712905884
2024-10-22 17:01:26,833 - DEBUG - Simulating Node: ((Reveal player +1 rank 5), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:26,834 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:26,834 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGW12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y5 || X5|RYGWB5
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:26,834 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:26,834 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:26,834 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:26,834 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4646323621273041 | PUCT: 0.4646323621273041
2024-10-22 17:01:26,835 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.44223397970199585 | PUCT: 0.44223397970199585
2024-10-22 17:01:26,835 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.4646323621273041
2024-10-22 17:01:26,835 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:26,835 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 3))
2024-10-22 17:01:26,835 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 3))']
2024-10-22 17:01:26,836 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:26,837 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:27,040 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:27,042 - DEBUG - Network Policy Logits: [[ 0.02618084 -0.00414686  0.00992617 -0.02680396  0.03489436  0.01732861
   0.04998551  0.0061408  -0.02382637 -0.00300615 -0.00497726  0.01516873
  -0.04237258 -0.01481005  0.04705443 -0.0315029   0.01297146 -0.04140778
  -0.00605877 -0.02702568]]
2024-10-22 17:01:27,042 - DEBUG - Network Policy after Softmax: [[0.05132411 0.04979094 0.0504966  0.0486755  0.05177328 0.05087179
  0.05256053 0.05030582 0.04882066 0.04984777 0.04974961 0.05076203
  0.04792356 0.04926283 0.05240669 0.04844732 0.05065061 0.04796982
  0.04969583 0.04866471]]
2024-10-22 17:01:27,043 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.51547503 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.4845249 ]]
2024-10-22 17:01:27,044 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3), (Reveal player +1 rank 5)) | P=0.4845249056816101
2024-10-22 17:01:27,045 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3), (Discard 4)) | P=0.5154750347137451
2024-10-22 17:01:27,045 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:01:27,045 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:27,045 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R1245
XX || XX|RYGWB1245
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y5 || XX|RYGWB12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 B1}
2024-10-22 17:01:27,045 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:27,045 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:27,045 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:27,047 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.35820743441581726 | PUCT: 0.35820743441581726
2024-10-22 17:01:27,047 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.0 | U: 0.4545859694480896 | PUCT: 0.4545859694480896
2024-10-22 17:01:27,047 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 0.4545859694480896
2024-10-22 17:01:27,047 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:01:27,047 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Discard 4)) | Q: 0.0 | U: 0.540871798992157 | PUCT: 0.540871798992157
2024-10-22 17:01:27,048 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5140489339828491 | PUCT: 0.5140489339828491
2024-10-22 17:01:27,048 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Reveal player +1 color B)) | Q: 0.0 | U: 0.5308746695518494 | PUCT: 0.5308746695518494
2024-10-22 17:01:27,049 - DEBUG - Selected Child: ((Reveal player +1 rank 5), (Discard 4)) | PUCT: 0.540871798992157
2024-10-22 17:01:27,049 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5), (Discard 4))
2024-10-22 17:01:27,049 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5), (Discard 4), (Reveal player +1 rank 1))
2024-10-22 17:01:27,049 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Discard 4))', '((Reveal player +1 rank 5), (Discard 4), (Reveal player +1 rank 1))']
2024-10-22 17:01:27,050 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:01:27,051 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:27,051 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:01:27,051 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:27,051 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:01:27,051 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:27,052 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3666951656341553 | PUCT: 0.3666951656341553
2024-10-22 17:01:27,052 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5),) | Q: 0.8 | U: 0.38779783248901367 | PUCT: 1.1877977848052979
2024-10-22 17:01:27,052 - DEBUG - Selected Child: ((Reveal player +1 rank 5),) | PUCT: 1.1877977848052979
2024-10-22 17:01:27,052 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5),)
2024-10-22 17:01:27,053 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Discard 4)) | Q: 2.0 | U: 0.38045719265937805 | PUCT: 2.3804571628570557
2024-10-22 17:01:27,054 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5423843860626221 | PUCT: 0.5423843860626221
2024-10-22 17:01:27,055 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 5), (Reveal player +1 color B)) | Q: 0.0 | U: 0.5601376295089722 | PUCT: 0.5601376295089722
2024-10-22 17:01:27,055 - DEBUG - Selected Child: ((Reveal player +1 rank 5), (Discard 4)) | PUCT: 2.3804571628570557
2024-10-22 17:01:27,055 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 5), (Discard 4))
2024-10-22 17:01:27,055 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 5), (Discard 4), (Reveal player +1 color B))
2024-10-22 17:01:27,055 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 5),)', '((Reveal player +1 rank 5), (Discard 4))', '((Reveal player +1 rank 5), (Discard 4), (Reveal player +1 color B))']
2024-10-22 17:01:27,056 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 1
2024-10-22 17:01:27,057 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:27,058 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 3
2024-10-22 17:01:27,335 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:27,336 - DEBUG - Network Policy Logits: [[-0.00355352  0.00182968  0.07179052 -0.00835193  0.03070708  0.02781248
   0.04240008  0.00237939  0.02735496  0.01673505  0.00076357  0.03255418
  -0.06420393 -0.00976034  0.01727062 -0.00126639  0.02498923 -0.020392
   0.00320555 -0.01024239]]
2024-10-22 17:01:27,336 - DEBUG - Network Policy after Softmax: [[0.04935296 0.04961935 0.05321508 0.04911671 0.05107312 0.0509255
  0.05167382 0.04964663 0.0509022  0.05036448 0.04956648 0.05116754
  0.04644864 0.04904758 0.05039147 0.04946596 0.05078192 0.04852888
  0.04968766 0.04902394]]
2024-10-22 17:01:27,339 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33997354 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.32927534 0.         0.
  0.33075112 0.        ]]
2024-10-22 17:01:27,340 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4), (Reveal player +1 color B), (Discard 4)) | P=0.3399735391139984
2024-10-22 17:01:27,341 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 1)) | P=0.32927533984184265
2024-10-22 17:01:27,341 - DEBUG - Added Child Node: ((Reveal player +1 rank 5), (Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 4)) | P=0.33075112104415894
2024-10-22 17:01:27,341 - DEBUG - Simulating Node: ((Reveal player +1 rank 5), (Discard 4), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:27,341 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:27,342 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGW12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
B1 || XX|RYGWB12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5}
2024-10-22 17:01:27,342 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:27,342 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:27,342 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:27,342 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 5),) | Visit Count: 6
2024-10-22 17:01:27,342 - INFO - Actual Game Score: 4
2024-10-22 17:01:27,342 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:27,342 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:27,343 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.33333333 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.66666667]
2024-10-22 17:01:27,343 - DEBUG - === End of Training Data ===
2024-10-22 17:01:27,343 - INFO - Chosen Action: (Reveal player +1 rank 5) | Visit Count: 6
2024-10-22 17:01:29,596 - DEBUG - Not the current player's turn.
2024-10-22 17:01:29,597 - INFO - Agent state has been reset.
2024-10-22 17:01:29,597 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:29,597 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || XX|RYGWB12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5}
2024-10-22 17:01:29,598 - INFO - Max Rollouts: 10
2024-10-22 17:01:29,598 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:29,598 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:29,598 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:29,798 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:29,798 - DEBUG - Network Policy Logits: [[ 0.01747224 -0.01619666  0.02025102 -0.04632014  0.03404007  0.02258781
   0.05902047  0.01270547 -0.00811999 -0.0096774   0.00931966  0.01890228
  -0.03794672 -0.02503939  0.04281697 -0.02544245  0.01414973 -0.02285491
  -0.0154643  -0.02771958]]
2024-10-22 17:01:29,798 - DEBUG - Network Policy after Softmax: [[0.05081988 0.04913732 0.05096129 0.0476792  0.05166887 0.05108052
  0.05297583 0.05057821 0.04953578 0.0494587  0.05040725 0.0508926
  0.04808011 0.04870472 0.05212435 0.0486851  0.05065131 0.04881123
  0.04917331 0.04857436]]
2024-10-22 17:01:29,800 - DEBUG - Normalized Policy: [[0.        0.        0.        0.        0.4978058 0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.5021942 0.        0.        0.        0.        0.       ]]
2024-10-22 17:01:29,800 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.37335435 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.6266457  0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:29,801 - DEBUG - Added Child Node: ((Discard 4),) | P=0.37335434556007385
2024-10-22 17:01:29,801 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.6266456842422485
2024-10-22 17:01:29,801 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:29,801 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:29,802 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || XX|RYGWB12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5}
2024-10-22 17:01:29,802 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:29,802 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:29,802 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:29,802 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:29,802 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:29,803 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:29,985 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:29,986 - DEBUG - Network Policy Logits: [[-0.00756251  0.00019779  0.06560036 -0.01666208  0.0201573   0.03013006
   0.04375628  0.00149443  0.01350578  0.00701038  0.00038508  0.02719143
  -0.0708418  -0.00622255  0.01577516 -0.01210227  0.03231516 -0.02615814
   0.00701902 -0.02349802]]
2024-10-22 17:01:29,986 - DEBUG - Network Policy after Softmax: [[0.04935231 0.04973679 0.05309844 0.04890527 0.05073949 0.05124803
  0.05195113 0.04980133 0.05040311 0.05007679 0.04974611 0.05109765
  0.04632609 0.04941849 0.05051763 0.04912877 0.05136014 0.04844306
  0.05007722 0.04857209]]
2024-10-22 17:01:29,988 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50806415 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.4919358  0.         0.
  0.         0.        ]]
2024-10-22 17:01:29,989 - DEBUG - Added Child Node: ((Discard 4), (Discard 4)) | P=0.5080641508102417
2024-10-22 17:01:29,990 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1)) | P=0.4919357895851135
2024-10-22 17:01:29,990 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:29,990 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:29,990 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R1 || RX|R12345
W1 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G5}
2024-10-22 17:01:29,990 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:29,991 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:29,991 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:29,991 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:01:29,991 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:01:29,992 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:30,210 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:30,210 - DEBUG - Network Policy Logits: [[-0.00926286  0.00523018  0.07004026 -0.0002436   0.02797788  0.02838686
   0.03757598 -0.00617749  0.01378233 -0.00577981  0.0067221   0.00749085
  -0.05525121  0.00129438  0.01755376 -0.01685685  0.01472446 -0.01789286
   0.00932304  0.00388233]]
2024-10-22 17:01:30,210 - DEBUG - Network Policy after Softmax: [[0.04919732 0.04991553 0.05325769 0.04964305 0.05106401 0.05108489
  0.05155648 0.04934935 0.05034425 0.04936897 0.04999006 0.0500285
  0.04698605 0.04971946 0.05053448 0.04882513 0.0503917  0.04877457
  0.05012025 0.0498483 ]]
2024-10-22 17:01:30,212 - DEBUG - Normalized Policy: [[0.3320941  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.32958177 0.         0.
  0.3383241  0.        ]]
2024-10-22 17:01:30,213 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0)) | P=0.33209410309791565
2024-10-22 17:01:30,213 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | P=0.32958176732063293
2024-10-22 17:01:30,214 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 4)) | P=0.33832409977912903
2024-10-22 17:01:30,214 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:01:30,214 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:30,214 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
B1 || XX|RYGWB12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5}
2024-10-22 17:01:30,214 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:30,215 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:30,215 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:30,215 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.54948890209198 | PUCT: 0.54948890209198
2024-10-22 17:01:30,216 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.922273576259613 | PUCT: 0.922273576259613
2024-10-22 17:01:30,216 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.922273576259613
2024-10-22 17:01:30,216 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:30,216 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Discard 0))
2024-10-22 17:01:30,216 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Discard 0))']
2024-10-22 17:01:30,217 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:30,218 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:01:30,398 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:30,399 - DEBUG - Network Policy Logits: [[ 0.02015128 -0.00419328  0.02371334 -0.0326624   0.02072633  0.00973145
   0.04524884  0.03874967  0.00858516  0.02011354  0.00080024 -0.01220382
  -0.01503779 -0.00648356  0.06244027 -0.02596053  0.05049847 -0.00589595
   0.00031959 -0.02660404]]
2024-10-22 17:01:30,399 - DEBUG - Network Policy after Softmax: [[0.05056382 0.04934772 0.05074425 0.04796265 0.0505929  0.05003969
  0.05184891 0.05151302 0.04998236 0.05056191 0.04959476 0.04895401
  0.04881547 0.04923484 0.05274797 0.04828517 0.05212181 0.04926378
  0.04957093 0.04825411]]
2024-10-22 17:01:30,400 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3254344  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.33929667 0.         0.3352689  0.
  0.         0.        ]]
2024-10-22 17:01:30,401 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0), (Discard 4)) | P=0.3254343867301941
2024-10-22 17:01:30,401 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0), (Reveal player +1 color B)) | P=0.3392966687679291
2024-10-22 17:01:30,402 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0), (Reveal player +1 rank 2)) | P=0.33526891469955444
2024-10-22 17:01:30,402 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Discard 0)) | Value: 0.0
2024-10-22 17:01:30,402 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:30,402 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || BX|B12345
B4 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:30,402 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:30,402 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:30,402 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:30,403 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5920635461807251 | PUCT: 0.5920635461807251
2024-10-22 17:01:30,403 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.662487804889679 | PUCT: 0.662487804889679
2024-10-22 17:01:30,403 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.662487804889679
2024-10-22 17:01:30,403 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:30,403 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 rank 4))
2024-10-22 17:01:30,403 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 rank 4))']
2024-10-22 17:01:30,404 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:30,404 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:30,596 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:30,597 - DEBUG - Network Policy Logits: [[ 0.04340539 -0.0015141   0.0121006  -0.01717057  0.04262592 -0.00859009
   0.03747828 -0.01630242 -0.00411522 -0.02142076  0.00409818  0.0470886
  -0.0427877  -0.01542228  0.05289987 -0.02284892 -0.00197735 -0.00762396
  -0.00687054 -0.01322787]]
2024-10-22 17:01:30,597 - DEBUG - Network Policy after Softmax: [[0.05204366 0.04975761 0.05043968 0.04898465 0.05200311 0.04940677
  0.0517361  0.04902719 0.04962835 0.0487769  0.05003765 0.0522357
  0.04774574 0.04907036 0.05254014 0.04870728 0.04973457 0.04945453
  0.0494918  0.04917816]]
2024-10-22 17:01:30,598 - DEBUG - Normalized Policy: [[0.5113437  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.48865625 0.
  0.         0.        ]]
2024-10-22 17:01:30,599 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 4), (Discard 0)) | P=0.5113437175750732
2024-10-22 17:01:30,599 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 4), (Reveal player +1 rank 2)) | P=0.48865625262260437
2024-10-22 17:01:30,600 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:30,600 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:30,600 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || BX|B12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5}
2024-10-22 17:01:30,600 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:30,600 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:30,600 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:30,600 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6246993541717529 | PUCT: 0.6246993541717529
2024-10-22 17:01:30,601 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.5242542028427124 | PUCT: 0.5242542028427124
2024-10-22 17:01:30,601 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.6246993541717529
2024-10-22 17:01:30,601 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:30,601 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 1))
2024-10-22 17:01:30,601 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 1))']
2024-10-22 17:01:30,602 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:30,602 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:30,802 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:30,802 - DEBUG - Network Policy Logits: [[ 0.02404758 -0.01304921  0.0146266  -0.03738356  0.03559738  0.01014936
   0.0599913   0.00043211 -0.03034631 -0.00465233 -0.00542646  0.00685153
  -0.0349789  -0.01325402  0.03154384 -0.0242901   0.02503466 -0.0169195
  -0.02446618 -0.02399826]]
2024-10-22 17:01:30,802 - DEBUG - Network Policy after Softmax: [[0.0512522  0.04938574 0.05077162 0.04819848 0.05184758 0.05054481
  0.0531279  0.05005603 0.04853885 0.04980217 0.04976363 0.0503784
  0.04831451 0.04937563 0.05163784 0.04883371 0.05130281 0.04919497
  0.04882511 0.04884796]]
2024-10-22 17:01:30,804 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.34104806 0.
  0.         0.         0.31928357 0.         0.         0.
  0.         0.         0.33966842 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:30,805 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1), (Play 3)) | P=0.3192835748195648
2024-10-22 17:01:30,806 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.3396684229373932
2024-10-22 17:01:30,806 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1), (Discard 4)) | P=0.34104806184768677
2024-10-22 17:01:30,806 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:30,806 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:30,806 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || R1|R1
XX || XX|RYGWB2345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 R4}
2024-10-22 17:01:30,806 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:30,806 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:30,807 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:30,807 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4340116083621979 | PUCT: 0.4340116083621979
2024-10-22 17:01:30,808 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.5463405847549438 | PUCT: 0.5463405847549438
2024-10-22 17:01:30,808 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.5463405847549438
2024-10-22 17:01:30,808 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:30,808 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 rank 1))
2024-10-22 17:01:30,808 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 rank 1))']
2024-10-22 17:01:30,809 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:30,809 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:01:30,809 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:30,809 - DEBUG - Rollout #7 completed with reward=4
2024-10-22 17:01:30,809 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:30,810 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4486558139324188 | PUCT: 0.4486558139324188
2024-10-22 17:01:30,810 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 1.0 | U: 0.4518199563026428 | PUCT: 1.451819896697998
2024-10-22 17:01:30,811 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 1.451819896697998
2024-10-22 17:01:30,811 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:30,811 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Discard 0)) | Q: 0.0 | U: 0.5266332626342773 | PUCT: 0.5266332626342773
2024-10-22 17:01:30,812 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.5365127325057983 | PUCT: 0.5365127325057983
2024-10-22 17:01:30,812 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.5226492285728455 | PUCT: 4.52264928817749
2024-10-22 17:01:30,812 - DEBUG - Selected Child: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | PUCT: 4.52264928817749
2024-10-22 17:01:30,813 - DEBUG - Selected child for exploration: ((Reveal player +1 color B), (Reveal player +1 rank 1))
2024-10-22 17:01:30,813 - DEBUG - Node ((Reveal player +1 color B), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:01:30,813 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 rank 1))']
2024-10-22 17:01:30,813 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:30,813 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:01:30,813 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:30,814 - DEBUG - Rollout #8 completed with reward=4
2024-10-22 17:01:30,814 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:30,814 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4611871540546417 | PUCT: 0.4611871540546417
2024-10-22 17:01:30,815 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 1.6 | U: 0.38703301548957825 | PUCT: 1.9870330095291138
2024-10-22 17:01:30,815 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 1.9870330095291138
2024-10-22 17:01:30,815 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:30,815 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Discard 0)) | Q: 0.0 | U: 0.5556623935699463 | PUCT: 0.5556623935699463
2024-10-22 17:01:30,816 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.56608647108078 | PUCT: 0.56608647108078
2024-10-22 17:01:30,816 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.3676391839981079 | PUCT: 4.367639064788818
2024-10-22 17:01:30,817 - DEBUG - Selected Child: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | PUCT: 4.367639064788818
2024-10-22 17:01:30,817 - DEBUG - Selected child for exploration: ((Reveal player +1 color B), (Reveal player +1 rank 1))
2024-10-22 17:01:30,817 - DEBUG - Node ((Reveal player +1 color B), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:01:30,817 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 rank 1))']
2024-10-22 17:01:30,817 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:30,818 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:01:30,818 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:30,818 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:01:30,818 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:30,818 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.47211501002311707 | PUCT: 0.47211501002311707
2024-10-22 17:01:30,819 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 2.0 | U: 0.3396032452583313 | PUCT: 2.3396031856536865
2024-10-22 17:01:30,819 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 2.3396031856536865
2024-10-22 17:01:30,819 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:30,819 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Discard 0)) | Q: 0.0 | U: 0.5790719985961914 | PUCT: 0.5790719985961914
2024-10-22 17:01:30,820 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.5899352431297302 | PUCT: 0.5899352431297302
2024-10-22 17:01:30,820 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.28734561800956726 | PUCT: 4.2873454093933105
2024-10-22 17:01:30,821 - DEBUG - Selected Child: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | PUCT: 4.2873454093933105
2024-10-22 17:01:30,821 - DEBUG - Selected child for exploration: ((Reveal player +1 color B), (Reveal player +1 rank 1))
2024-10-22 17:01:30,821 - DEBUG - Node ((Reveal player +1 color B), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:01:30,821 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 rank 1))']
2024-10-22 17:01:30,822 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:30,822 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:31,013 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:31,014 - DEBUG - Network Policy Logits: [[ 0.02885417 -0.01267098  0.01057467  0.00059122  0.04253823 -0.01819127
   0.01699702 -0.00540414  0.00754332 -0.02227517  0.00723867  0.02569808
  -0.04064487 -0.01320649  0.06428241 -0.02482651 -0.01490366 -0.00819644
  -0.01977124 -0.0044427 ]]
2024-10-22 17:01:31,014 - DEBUG - Network Policy after Softmax: [[0.05139721 0.04930664 0.05046623 0.04996491 0.05210537 0.0490352
  0.05079139 0.04966625 0.05031348 0.04883536 0.05029816 0.05123525
  0.04794645 0.04928024 0.05325076 0.04871092 0.04919668 0.04952776
  0.04895779 0.04971402]]
2024-10-22 17:01:31,015 - DEBUG - Normalized Policy: [[0.34395683 0.         0.         0.         0.         0.
  0.         0.         0.         0.32681257 0.         0.
  0.         0.         0.         0.         0.32923058 0.
  0.         0.        ]]
2024-10-22 17:01:31,016 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 1), (Play 4)) | P=0.3268125653266907
2024-10-22 17:01:31,016 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 1), (Discard 0)) | P=0.3439568281173706
2024-10-22 17:01:31,017 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 1), (Reveal player +1 rank 2)) | P=0.32923057675361633
2024-10-22 17:01:31,017 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:31,017 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:31,017 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R2345
XX || X1|RYGWB1
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || BX|B12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5}
2024-10-22 17:01:31,017 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:31,017 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:31,017 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:31,017 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color B),) | Visit Count: 7
2024-10-22 17:01:31,018 - INFO - Actual Game Score: 4
2024-10-22 17:01:31,018 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:31,018 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:31,018 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.22222222 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.77777778 0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:31,018 - DEBUG - === End of Training Data ===
2024-10-22 17:01:31,018 - INFO - Chosen Action: (Reveal player +1 color B) | Visit Count: 7
2024-10-22 17:01:33,305 - DEBUG - Not the current player's turn.
2024-10-22 17:01:33,306 - INFO - Agent state has been reset.
2024-10-22 17:01:33,306 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:33,307 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || BX|B12345
B3 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:33,307 - INFO - Max Rollouts: 10
2024-10-22 17:01:33,307 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:33,307 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:33,307 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:33,520 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:33,520 - DEBUG - Network Policy Logits: [[ 0.03569674 -0.01627437  0.02378463 -0.03043596  0.02753115  0.00297529
   0.05038843  0.04856456  0.01360573  0.01341056  0.01229407 -0.01963898
  -0.00875287 -0.00231396  0.07398182 -0.02871193  0.05193938 -0.01026949
   0.00034817 -0.03826509]]
2024-10-22 17:01:33,521 - DEBUG - Network Policy after Softmax: [[0.05127838 0.04868145 0.05067117 0.0479969  0.05086136 0.04962763
  0.05203731 0.05194248 0.05015801 0.05014822 0.05009226 0.04851793
  0.04904899 0.04936583 0.05327964 0.04807972 0.05211807 0.04897466
  0.04949742 0.04762259]]
2024-10-22 17:01:33,522 - DEBUG - Normalized Policy: [[0.        0.        0.        0.        0.3254938 0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.3409699 0.        0.3335363 0.        0.        0.       ]]
2024-10-22 17:01:33,523 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.24412037 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.2557274  0.         0.50015223 0.
 0.         0.        ]
2024-10-22 17:01:33,524 - DEBUG - Added Child Node: ((Discard 4),) | P=0.24412037432193756
2024-10-22 17:01:33,524 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.2557274103164673
2024-10-22 17:01:33,525 - DEBUG - Added Child Node: ((Reveal player +1 rank 2),) | P=0.5001522302627563
2024-10-22 17:01:33,525 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:33,525 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:33,526 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || BX|B12345
B3 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:33,526 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:33,526 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:33,526 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:33,526 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2),)
2024-10-22 17:01:33,526 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)']
2024-10-22 17:01:33,527 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:01:33,744 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:33,744 - DEBUG - Network Policy Logits: [[ 0.00095613  0.02083663  0.06152982  0.00032497  0.01757246  0.04656774
   0.04538353  0.02429944  0.01417883  0.03882106 -0.01660858  0.01096751
  -0.03611204 -0.00939332  0.01771892 -0.00582758  0.02287655 -0.03392737
  -0.02043776 -0.01782189]]
2024-10-22 17:01:33,745 - DEBUG - Network Policy after Softmax: [[0.04957739 0.05057288 0.0526733  0.04954611 0.05040807 0.05189106
  0.05182964 0.0507483  0.05023729 0.05149063 0.04871418 0.05007622
  0.04777329 0.04906694 0.05041545 0.04924221 0.05067615 0.04787777
  0.048528   0.04865511]]
2024-10-22 17:01:33,746 - DEBUG - Normalized Policy: [[0.        0.        0.        0.        0.5095014 0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.4904986 0.       ]]
2024-10-22 17:01:33,748 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 4)) | P=0.5095013976097107
2024-10-22 17:01:33,749 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 4)) | P=0.4904986023902893
2024-10-22 17:01:33,749 - DEBUG - Simulating Node: ((Reveal player +1 rank 2),) | Value: 0.0
2024-10-22 17:01:33,749 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:33,749 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB1345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:33,749 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:33,749 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:33,749 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:33,750 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:33,750 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:33,751 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:33,970 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:33,971 - DEBUG - Network Policy Logits: [[ 0.00533967  0.01982114  0.08860778 -0.0034874   0.00754229  0.05931096
   0.06189764  0.02660752  0.01042147  0.04683298 -0.00894961  0.024691
  -0.06022053 -0.00967657  0.02056195 -0.00042385  0.0237737  -0.04104899
  -0.01643238 -0.03298785]]
2024-10-22 17:01:33,971 - DEBUG - Network Policy after Softmax: [[0.04968166 0.05040635 0.05399567 0.04924504 0.04979121 0.05243671
  0.05257253 0.05074959 0.04993477 0.05178648 0.04897679 0.05065242
  0.04652899 0.0489412  0.05044371 0.04939613 0.05060598 0.04742962
  0.04861167 0.04781351]]
2024-10-22 17:01:33,973 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33688456 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.33421153 0.         0.
  0.32890388 0.        ]]
2024-10-22 17:01:33,973 - DEBUG - Added Child Node: ((Discard 4), (Discard 4)) | P=0.3368845582008362
2024-10-22 17:01:33,974 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1)) | P=0.334211528301239
2024-10-22 17:01:33,975 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4)) | P=0.3289038836956024
2024-10-22 17:01:33,975 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:33,975 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:33,975 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B12345
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
B1 || XX|RYGWB12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 G3}
2024-10-22 17:01:33,975 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:33,975 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:33,975 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:33,975 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:01:33,976 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:01:33,976 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:34,202 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:34,202 - DEBUG - Network Policy Logits: [[ 0.00807113  0.00652069  0.0744049   0.01349554  0.02383478  0.03452307
   0.03455741  0.01251726  0.00985211  0.02095063 -0.01876625 -0.01434314
  -0.03831372  0.01275719  0.01867077 -0.01645952  0.02421337 -0.03703213
  -0.00234665 -0.00462266]]
2024-10-22 17:01:34,202 - DEBUG - Network Policy after Softmax: [[0.04998112 0.04990369 0.053409   0.05025298 0.05077525 0.05132086
  0.05132262 0.05020384 0.05007022 0.05062902 0.0486576  0.0488733
  0.0477157  0.05021589 0.05051372 0.04876997 0.05079448 0.04777689
  0.04946313 0.04935068]]
2024-10-22 17:01:34,204 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33843562 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.3284481  0.         0.
  0.33311632 0.        ]]
2024-10-22 17:01:34,205 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 3)) | P=0.3384356200695038
2024-10-22 17:01:34,205 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | P=0.328448086977005
2024-10-22 17:01:34,206 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 4)) | P=0.3331163227558136
2024-10-22 17:01:34,206 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:01:34,206 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:34,206 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B12345
XX || BX|B12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R1 || RX|R12345
W4 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:34,206 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:34,207 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:34,207 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:34,207 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.7931389808654785 | PUCT: 0.7931389808654785
2024-10-22 17:01:34,208 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3871249556541443 | PUCT: 0.3871249556541443
2024-10-22 17:01:34,208 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4055313169956207 | PUCT: 0.4055313169956207
2024-10-22 17:01:34,208 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.7931389808654785
2024-10-22 17:01:34,208 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:01:34,209 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Reveal player +1 rank 4))
2024-10-22 17:01:34,209 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 rank 4))']
2024-10-22 17:01:34,209 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:01:34,210 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:34,424 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:34,424 - DEBUG - Network Policy Logits: [[ 0.01126301 -0.02461536  0.01917762  0.01047826  0.03205802  0.00892858
   0.03742281  0.01218428  0.00314358 -0.00749215  0.00352664 -0.03586955
  -0.01708268  0.00053706  0.07913657 -0.02826802  0.03264314  0.0018614
  -0.01906556 -0.00506897]]
2024-10-22 17:01:34,424 - DEBUG - Network Policy after Softmax: [[0.05025972 0.04848845 0.05065909 0.0502203  0.05131581 0.05014253
  0.05159185 0.05030604 0.04985329 0.04932587 0.04987239 0.04794581
  0.04885508 0.04972352 0.05378946 0.04831166 0.05134585 0.04978941
  0.0487583  0.04944555]]
2024-10-22 17:01:34,426 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.48823252 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.51176745 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:34,426 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 4), (Discard 4)) | P=0.4882325232028961
2024-10-22 17:01:34,427 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 4), (Reveal player +1 color B)) | P=0.5117674469947815
2024-10-22 17:01:34,427 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:34,427 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:34,427 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': 3}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R1235
XX || X4|RYGWB4
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B3 || XX|RYGWB1345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:34,428 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:34,428 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:34,428 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:34,428 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.5579056739807129 | PUCT: 0.5579056739807129
2024-10-22 17:01:34,429 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.40846410393714905 | PUCT: 0.40846410393714905
2024-10-22 17:01:34,429 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4278850853443146 | PUCT: 0.4278850853443146
2024-10-22 17:01:34,429 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.5579056739807129
2024-10-22 17:01:34,429 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:01:34,429 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Discard 4))
2024-10-22 17:01:34,429 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Discard 4))']
2024-10-22 17:01:34,431 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:01:34,432 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:34,649 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:34,650 - DEBUG - Network Policy Logits: [[ 0.01320968  0.00153169  0.03565405 -0.03850294  0.03539841  0.03022831
   0.0464429   0.03859559 -0.00042137  0.01508895  0.00970986 -0.0040764
  -0.01836871 -0.00786647  0.06040005 -0.02106501  0.04866352 -0.01848802
  -0.01178629 -0.03195777]]
2024-10-22 17:01:34,650 - DEBUG - Network Policy after Softmax: [[0.0501851  0.04960245 0.05132421 0.04765586 0.05131109 0.05104649
  0.05188094 0.05147541 0.04950567 0.0502795  0.05000977 0.04932505
  0.0486251  0.04913846 0.05261013 0.04849417 0.05199628 0.0486193
  0.04894622 0.0479688 ]]
2024-10-22 17:01:34,651 - DEBUG - Normalized Policy: [[0.500875   0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.49912506 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:34,652 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 4), (Reveal player +1 color R)) | P=0.49912506341934204
2024-10-22 17:01:34,652 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 4), (Discard 0)) | P=0.5008749961853027
2024-10-22 17:01:34,652 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Discard 4)) | Value: 0.0
2024-10-22 17:01:34,653 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:34,653 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
R4 || XX|RYGWB12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 W4}
2024-10-22 17:01:34,653 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:34,653 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:34,653 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:34,653 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.43605732917785645 | PUCT: 0.43605732917785645
2024-10-22 17:01:34,654 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.42567235231399536 | PUCT: 0.42567235231399536
2024-10-22 17:01:34,654 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4459115266799927 | PUCT: 0.4459115266799927
2024-10-22 17:01:34,654 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.4459115266799927
2024-10-22 17:01:34,654 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:34,655 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 rank 1))
2024-10-22 17:01:34,655 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 rank 1))']
2024-10-22 17:01:34,655 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:34,656 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:34,872 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:34,873 - DEBUG - Network Policy Logits: [[ 0.03059476 -0.0166934  -0.00439749 -0.00689538  0.02105438 -0.02414874
   0.03258863  0.01043408  0.00936671 -0.00466193  0.02154657 -0.00527801
  -0.01841623  0.00639216  0.07279864 -0.03459544  0.03666968  0.00565865
   0.00069259 -0.02193897]]
2024-10-22 17:01:34,873 - DEBUG - Network Policy after Softmax: [[0.0512529  0.04888566 0.04949046 0.04936699 0.05076625 0.04852255
  0.05135519 0.05022995 0.05017637 0.04947737 0.05079124 0.0494469
  0.0488015  0.05002734 0.05346226 0.04801829 0.0515652  0.04999065
  0.04974301 0.04862989]]
2024-10-22 17:01:34,874 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33287638 0.
  0.         0.         0.32900846 0.         0.         0.
  0.         0.         0.         0.         0.33811513 0.
  0.         0.        ]]
2024-10-22 17:01:34,875 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 1), (Play 3)) | P=0.32900846004486084
2024-10-22 17:01:34,876 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 1), (Reveal player +1 rank 2)) | P=0.3381151258945465
2024-10-22 17:01:34,876 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 1), (Discard 4)) | P=0.33287638425827026
2024-10-22 17:01:34,876 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:34,876 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:34,877 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || R1|R1
XX || XX|RYGWB2345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || BX|B12345
B3 || BX|B12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:34,877 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:34,877 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:34,877 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:34,877 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.4507705569267273 | PUCT: 0.4507705569267273
2024-10-22 17:01:34,878 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4400351941585541 | PUCT: 0.4400351941585541
2024-10-22 17:01:34,879 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.30730482935905457 | PUCT: 0.30730482935905457
2024-10-22 17:01:34,879 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.4507705569267273
2024-10-22 17:01:34,879 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:01:34,879 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.7218974232673645 | PUCT: 0.7218974232673645
2024-10-22 17:01:34,880 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Discard 4)) | Q: 0.0 | U: 0.7498650550842285 | PUCT: 0.7498650550842285
2024-10-22 17:01:34,880 - DEBUG - Selected Child: ((Reveal player +1 rank 2), (Discard 4)) | PUCT: 0.7498650550842285
2024-10-22 17:01:34,880 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2), (Discard 4))
2024-10-22 17:01:34,880 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Discard 4), (Reveal player +1 color R))
2024-10-22 17:01:34,880 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Discard 4))', '((Reveal player +1 rank 2), (Discard 4), (Reveal player +1 color R))']
2024-10-22 17:01:34,881 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:01:34,881 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:34,882 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 3
2024-10-22 17:01:35,127 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:35,127 - DEBUG - Network Policy Logits: [[-0.00412183  0.01336224  0.07199246  0.00545183  0.01944404  0.04551916
   0.05201741  0.02867843  0.01251848  0.02620685 -0.01915693  0.0141153
  -0.05518117  0.00129325  0.02560062 -0.03081474  0.03932336 -0.02729132
  -0.02018364 -0.03598386]]
2024-10-22 17:01:35,129 - DEBUG - Network Policy after Softmax: [[0.04936587 0.05023657 0.05327001 0.04984075 0.05054303 0.05187828
  0.05221649 0.05101192 0.0501942  0.050886   0.04862919 0.05027442
  0.04690854 0.04963391 0.05085516 0.04806558 0.05155785 0.04823523
  0.04857929 0.04781776]]
2024-10-22 17:01:35,130 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.51256204 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.48743796 0.         0.
  0.         0.        ]]
2024-10-22 17:01:35,131 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 4), (Reveal player +1 color R), (Discard 4)) | P=0.5125620365142822
2024-10-22 17:01:35,132 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 4), (Reveal player +1 color R), (Reveal player +1 rank 1)) | P=0.4874379634857178
2024-10-22 17:01:35,132 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Discard 4), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:01:35,132 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:35,132 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|YGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R1 || RX|R12345
B1 || XX|RYGWB12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 R4}
2024-10-22 17:01:35,132 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:35,132 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:35,132 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:35,133 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.3706887662410736 | PUCT: 0.3706887662410736
2024-10-22 17:01:35,133 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4523257315158844 | PUCT: 0.4523257315158844
2024-10-22 17:01:35,134 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.31588810682296753 | PUCT: 0.31588810682296753
2024-10-22 17:01:35,134 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.4523257315158844
2024-10-22 17:01:35,134 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:35,134 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 4))
2024-10-22 17:01:35,134 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 4))']
2024-10-22 17:01:35,135 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:35,135 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:35,396 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:35,398 - DEBUG - Network Policy Logits: [[ 0.02450316 -0.01517017  0.03470683 -0.03294426  0.03928217  0.01839768
   0.04273055  0.03020847  0.00708693  0.01366473 -0.00213482 -0.00930502
  -0.00970263 -0.00575663  0.06350184 -0.02851355  0.04944384 -0.0101878
  -0.00010417 -0.02579309]]
2024-10-22 17:01:35,399 - DEBUG - Network Policy after Softmax: [[0.05075274 0.04877862 0.05127325 0.04791928 0.05150838 0.05044381
  0.05168631 0.05104312 0.04987647 0.05020562 0.04941863 0.04906556
  0.04904605 0.04923997 0.05277112 0.04813208 0.05203446 0.04902226
  0.04951908 0.0482632 ]]
2024-10-22 17:01:35,402 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.32951874 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.337597   0.         0.33288428 0.
  0.         0.        ]]
2024-10-22 17:01:35,404 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4), (Discard 4)) | P=0.32951873540878296
2024-10-22 17:01:35,405 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4), (Reveal player +1 color B)) | P=0.3375970125198364
2024-10-22 17:01:35,406 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4), (Reveal player +1 rank 2)) | P=0.332884281873703
2024-10-22 17:01:35,406 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:35,406 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:35,406 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R1235
XX || XX|RYGWB1235
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || BX|B12345
B3 || XX|RYGWB12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:35,406 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:35,406 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:35,407 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:35,408 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.3794722557067871 | PUCT: 0.3794722557067871
2024-10-22 17:01:35,408 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3086957335472107 | PUCT: 0.3086957335472107
2024-10-22 17:01:35,409 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.32337307929992676 | PUCT: 0.32337307929992676
2024-10-22 17:01:35,409 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.3794722557067871
2024-10-22 17:01:35,409 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:01:35,410 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.7778303623199463 | PUCT: 0.7778303623199463
2024-10-22 17:01:35,410 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Discard 4)) | Q: 0.0 | U: 0.5386433005332947 | PUCT: 0.5386433005332947
2024-10-22 17:01:35,410 - DEBUG - Selected Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 4)) | PUCT: 0.7778303623199463
2024-10-22 17:01:35,411 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2), (Reveal player +1 rank 4))
2024-10-22 17:01:35,411 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Reveal player +1 rank 4), (Reveal player +1 color B))
2024-10-22 17:01:35,411 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 rank 4))', '((Reveal player +1 rank 2), (Reveal player +1 rank 4), (Reveal player +1 color B))']
2024-10-22 17:01:35,411 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:01:35,412 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:35,413 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 3
2024-10-22 17:01:35,617 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:35,618 - DEBUG - Network Policy Logits: [[ 0.00759896  0.0189235   0.06250175  0.02455534  0.0163986   0.0246064
   0.02381771  0.03444846  0.02762324  0.02067028  0.00102154 -0.00123891
  -0.03632133 -0.0026935   0.00160911 -0.01719578  0.03883564 -0.03791236
  -0.01112719 -0.01267562]]
2024-10-22 17:01:35,618 - DEBUG - Network Policy after Softmax: [[0.04990653 0.05047492 0.05272315 0.05075999 0.05034763 0.05076258
  0.05072255 0.05126465 0.05091595 0.05056316 0.04957935 0.04946741
  0.04776206 0.04939551 0.0496085  0.04868433 0.05149005 0.04768613
  0.04898067 0.04890489]]
2024-10-22 17:01:35,619 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33920696 0.
  0.         0.         0.         0.         0.         0.
  0.         0.33279222 0.         0.32800078 0.         0.
  0.         0.        ]]
2024-10-22 17:01:35,620 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 4), (Reveal player +1 color B), (Reveal player +1 color W)) | P=0.3327922224998474
2024-10-22 17:01:35,621 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 4), (Reveal player +1 color B), (Discard 4)) | P=0.3392069637775421
2024-10-22 17:01:35,621 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 4), (Reveal player +1 color B), (Reveal player +1 rank 1)) | P=0.3280007839202881
2024-10-22 17:01:35,621 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 4), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:35,622 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:35,622 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B1345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
W1 || XX|RYGWB1235
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:35,622 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:35,622 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:35,622 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:35,622 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 2),) | Visit Count: 5
2024-10-22 17:01:35,622 - INFO - Actual Game Score: 4
2024-10-22 17:01:35,622 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:35,622 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:35,622 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.22222222 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.22222222 0.         0.55555556 0.
 0.         0.        ]
2024-10-22 17:01:35,622 - DEBUG - === End of Training Data ===
2024-10-22 17:01:35,622 - INFO - Chosen Action: (Reveal player +1 rank 2) | Visit Count: 5
2024-10-22 17:01:37,362 - DEBUG - Not the current player's turn.
2024-10-22 17:01:37,362 - INFO - Agent state has been reset.
2024-10-22 17:01:37,362 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:37,363 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB1235
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B3 || XX|RYGWB1345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:37,363 - INFO - Max Rollouts: 10
2024-10-22 17:01:37,363 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:37,363 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:37,363 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:37,555 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:37,555 - DEBUG - Network Policy Logits: [[ 0.05147199 -0.00885475  0.03998227 -0.01213699  0.0564892   0.02778373
   0.04813177  0.02089925  0.02003688 -0.01514892  0.00288148 -0.01023419
  -0.0053561  -0.01477604  0.08212407 -0.01796691  0.05755657 -0.00777527
  -0.00226644 -0.01003879]]
2024-10-22 17:01:37,556 - DEBUG - Network Policy after Softmax: [[0.05182633 0.04879225 0.05123427 0.04863237 0.05208701 0.05061308
  0.05165351 0.05026583 0.0502225  0.04848611 0.04936827 0.048725
  0.04896326 0.0485042  0.05343951 0.04834967 0.05214263 0.04884495
  0.04911477 0.04873452]]
2024-10-22 17:01:37,557 - DEBUG - Normalized Policy: [[0.4923376 0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.5076624 0.        0.        0.        0.        0.       ]]
2024-10-22 17:01:37,558 - DEBUG - Dirichlet Noise Added: [0.61925286 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.38074714 0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:37,558 - DEBUG - Added Child Node: ((Discard 0),) | P=0.6192528605461121
2024-10-22 17:01:37,559 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.38074713945388794
2024-10-22 17:01:37,559 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:37,559 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:37,559 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB1235
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B3 || XX|RYGWB1345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:37,559 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:37,559 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:37,559 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:37,560 - DEBUG - Expanding unexplored child: ((Discard 0),)
2024-10-22 17:01:37,560 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 17:01:37,560 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:01:37,763 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:37,763 - DEBUG - Network Policy Logits: [[-0.01317928  0.0114941   0.02242115 -0.01496551 -0.00085115  0.02461376
   0.04705977  0.01458848  0.0080895   0.05673555 -0.01504708 -0.00378808
  -0.05222259 -0.0320206   0.03848737 -0.02913648  0.00172795 -0.04547082
  -0.00499087 -0.02182133]]
2024-10-22 17:01:37,763 - DEBUG - Network Policy after Softmax: [[0.04934571 0.05057838 0.05113408 0.04925765 0.04995782 0.05124633
  0.05240961 0.05073513 0.05040647 0.05291917 0.04925363 0.04981131
  0.04745622 0.04842468 0.05196225 0.04856454 0.05008683 0.04777772
  0.04975143 0.0489211 ]]
2024-10-22 17:01:37,765 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33806455 0.
  0.         0.         0.         0.         0.33329928 0.
  0.         0.         0.         0.32863623 0.         0.
  0.         0.        ]]
2024-10-22 17:01:37,766 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color R)) | P=0.33329927921295166
2024-10-22 17:01:37,767 - DEBUG - Added Child Node: ((Discard 0), (Discard 4)) | P=0.3380645513534546
2024-10-22 17:01:37,767 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1)) | P=0.3286362290382385
2024-10-22 17:01:37,767 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 17:01:37,767 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:37,768 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB1345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || XX|RYGWB1235
G3 || XX|RYGWB12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:37,768 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:37,768 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:37,768 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:37,768 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:01:37,768 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:01:37,769 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:37,969 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:37,970 - DEBUG - Network Policy Logits: [[ 0.00926172  0.01931993  0.06336823  0.02111348  0.01751217  0.02370049
   0.0286708   0.03295374  0.02933961  0.01412538  0.00420986 -0.00172577
  -0.0320665  -0.00616361  0.00529614 -0.02172072  0.03906301 -0.03831639
  -0.01192611 -0.01341708]]
2024-10-22 17:01:37,970 - DEBUG - Network Policy after Softmax: [[0.0499916  0.05049697 0.05277099 0.05058762 0.05040576 0.05071866
  0.05097137 0.05119015 0.05100547 0.05023533 0.04973969 0.04944533
  0.04796765 0.04922638 0.04979375 0.04846649 0.05150384 0.04766879
  0.04894353 0.04887061]]
2024-10-22 17:01:37,971 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.51239216 0.
  0.         0.         0.         0.         0.         0.
  0.48760787 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:37,972 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 4)) | P=0.5123921632766724
2024-10-22 17:01:37,972 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color G)) | P=0.48760786652565
2024-10-22 17:01:37,973 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:01:37,973 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:37,973 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B1345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || XX|RYGWB1235
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:37,973 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:37,973 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:37,973 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:37,974 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.9113931655883789 | PUCT: 0.9113931655883789
2024-10-22 17:01:37,974 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.5603693723678589 | PUCT: 0.5603693723678589
2024-10-22 17:01:37,974 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.9113931655883789
2024-10-22 17:01:37,974 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:01:37,974 - DEBUG - Expanding unexplored child: ((Discard 0), (Discard 4))
2024-10-22 17:01:37,974 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Discard 4))']
2024-10-22 17:01:37,975 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:01:37,976 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:38,159 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:38,159 - DEBUG - Network Policy Logits: [[ 0.05158306  0.01892635  0.03009932 -0.0208273   0.02522106  0.04775411
   0.04718259  0.06036722 -0.00974429  0.04727738 -0.00765758 -0.02130217
  -0.02692851 -0.02182977  0.03869993 -0.00939931  0.07078297 -0.01871347
  -0.01968684 -0.01868618]]
2024-10-22 17:01:38,160 - DEBUG - Network Policy after Softmax: [[0.05193087 0.05026237 0.0508271  0.04830345 0.05057975 0.05173241
  0.05170285 0.05238905 0.04884178 0.05170776 0.0489438  0.04828052
  0.04800964 0.04825505 0.05126613 0.04885863 0.05293757 0.04840567
  0.04835857 0.04840699]]
2024-10-22 17:01:38,161 - DEBUG - Normalized Policy: [[0.        0.        0.        0.        0.4966303 0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.5033697 0.        0.        0.        0.        0.       ]]
2024-10-22 17:01:38,162 - DEBUG - Added Child Node: ((Discard 0), (Discard 4), (Discard 4)) | P=0.49663031101226807
2024-10-22 17:01:38,162 - DEBUG - Added Child Node: ((Discard 0), (Discard 4), (Reveal player +1 color B)) | P=0.5033696889877319
2024-10-22 17:01:38,162 - DEBUG - Simulating Node: ((Discard 0), (Discard 4)) | Value: 0.0
2024-10-22 17:01:38,162 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:38,162 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 6, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB1235
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B3 || XX|RYGWB12345
Deck size: 6
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 B1}
2024-10-22 17:01:38,162 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:38,162 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:38,163 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:38,163 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.6546722054481506 | PUCT: 0.6546722054481506
2024-10-22 17:01:38,164 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.6037870049476624 | PUCT: 0.6037870049476624
2024-10-22 17:01:38,164 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.6546722054481506
2024-10-22 17:01:38,164 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:01:38,164 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 rank 1))
2024-10-22 17:01:38,164 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 rank 1))']
2024-10-22 17:01:38,165 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:01:38,165 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:38,350 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:38,351 - DEBUG - Network Policy Logits: [[ 0.03515023  0.00249028  0.02846293 -0.01343417  0.03234722  0.01203686
   0.04753293  0.0244785  -0.00430065  0.01152137  0.00533628 -0.03850953
  -0.02585302 -0.0167942   0.06621821 -0.02344147  0.04676523  0.00824624
  -0.00745056 -0.00118183]]
2024-10-22 17:01:38,351 - DEBUG - Network Policy after Softmax: [[0.05128164 0.04963384 0.05093985 0.04884971 0.0511381  0.05010994
  0.05192059 0.05073728 0.04929792 0.05008411 0.0497753  0.04764001
  0.0482468  0.04868585 0.05289986 0.04836329 0.05188075 0.04992035
  0.04914288 0.04945191]]
2024-10-22 17:01:38,352 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33350378 0.
  0.         0.         0.32150283 0.         0.         0.
  0.         0.         0.34499338 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:38,353 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Play 3)) | P=0.32150283455848694
2024-10-22 17:01:38,354 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.34499338269233704
2024-10-22 17:01:38,354 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Discard 4)) | P=0.333503782749176
2024-10-22 17:01:38,354 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:38,354 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:38,355 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B3 || XX|RYGWB1345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:38,355 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:38,355 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:38,355 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:38,355 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.518069326877594 | PUCT: 0.518069326877594
2024-10-22 17:01:38,356 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.637069046497345 | PUCT: 0.637069046497345
2024-10-22 17:01:38,356 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.637069046497345
2024-10-22 17:01:38,356 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:38,356 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 color G))
2024-10-22 17:01:38,356 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 color G))']
2024-10-22 17:01:38,357 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:38,357 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 2
2024-10-22 17:01:38,588 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:38,589 - DEBUG - Network Policy Logits: [[ 0.03322949 -0.00633627 -0.0010615   0.01944726  0.05097466 -0.01883126
   0.01608741  0.01861044  0.018897   -0.00971862  0.00224693  0.00026913
  -0.00305096  0.00833623  0.07216784 -0.02646732  0.03320448  0.01060345
  -0.00395575  0.00635849]]
2024-10-22 17:01:38,589 - DEBUG - Network Policy after Softmax: [[0.05110801 0.04912537 0.04938518 0.05040846 0.05202303 0.04851536
  0.05023938 0.0503663  0.05038074 0.04895949 0.04954883 0.04945093
  0.04928702 0.04985147 0.05313733 0.04814631 0.05110674 0.04996463
  0.04924245 0.04975298]]
2024-10-22 17:01:38,590 - DEBUG - Normalized Policy: [[0.50565624 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.49434373
  0.         0.        ]]
2024-10-22 17:01:38,591 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color G), (Discard 0)) | P=0.5056562423706055
2024-10-22 17:01:38,591 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color G), (Reveal player +1 rank 3)) | P=0.49434372782707214
2024-10-22 17:01:38,591 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Reveal player +1 color G)) | Value: 0.0
2024-10-22 17:01:38,591 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:38,592 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G1235
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B3 || BX|B1345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:38,592 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:38,592 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:38,592 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:38,592 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.5398951768875122 | PUCT: 0.5398951768875122
2024-10-22 17:01:38,593 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.44260549545288086 | PUCT: 0.44260549545288086
2024-10-22 17:01:38,593 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.5398951768875122
2024-10-22 17:01:38,593 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:01:38,593 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 color R))
2024-10-22 17:01:38,593 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 color R))']
2024-10-22 17:01:38,594 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:01:38,594 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:01:38,788 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:38,788 - DEBUG - Network Policy Logits: [[ 0.0589847   0.00713937  0.02289344  0.01236117  0.04272702  0.02538263
   0.03509712  0.03409245  0.00179627  0.0397671  -0.00888365 -0.03471646
  -0.02059107 -0.01999047  0.0304823  -0.00769548  0.04466608  0.01327276
  -0.01563105  0.02539599]]
2024-10-22 17:01:38,789 - DEBUG - Network Policy after Softmax: [[0.05226689 0.04962615 0.05041415 0.04988596 0.05142402 0.0505398
  0.05103316 0.05098191 0.04936169 0.05127203 0.04883732 0.04759187
  0.0482689  0.04829789 0.05079819 0.04889538 0.05152383 0.04993146
  0.0485089  0.05054047]]
2024-10-22 17:01:38,790 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33247146 0.         0.
  0.         0.         0.3289774  0.         0.         0.
  0.         0.         0.33855116 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:38,791 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color R), (Discard 3)) | P=0.33247146010398865
2024-10-22 17:01:38,791 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color R), (Play 3)) | P=0.32897740602493286
2024-10-22 17:01:38,792 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color R), (Reveal player +1 color B)) | P=0.3385511636734009
2024-10-22 17:01:38,792 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:01:38,792 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:38,792 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': 'R', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|YGWB1235
XX || RX|R12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B3 || XX|RYGWB1345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:38,792 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:38,792 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:38,792 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:38,793 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4464896321296692 | PUCT: 0.4464896321296692
2024-10-22 17:01:38,793 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4575396478176117 | PUCT: 0.4575396478176117
2024-10-22 17:01:38,794 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.4575396478176117
2024-10-22 17:01:38,794 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:38,794 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Discard 4))
2024-10-22 17:01:38,794 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Discard 4))']
2024-10-22 17:01:38,794 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:38,795 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:39,004 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:39,005 - DEBUG - Network Policy Logits: [[ 0.04357267  0.00977804  0.02839225 -0.02836641  0.06033943  0.01440112
   0.04167085  0.03641999  0.00492453  0.01521252 -0.01324428 -0.00545874
   0.00264129 -0.00323768  0.05539581 -0.02651754  0.05146816 -0.00159403
  -0.00072211 -0.01494792]]
2024-10-22 17:01:39,005 - DEBUG - Network Policy after Softmax: [[0.05150808 0.04979647 0.05073207 0.04793278 0.05237898 0.05002721
  0.05141021 0.05114097 0.04955536 0.05006782 0.04866313 0.04904348
  0.04944235 0.04915253 0.05212068 0.04802148 0.05191637 0.04923338
  0.04927633 0.0485803 ]]
2024-10-22 17:01:39,006 - DEBUG - Normalized Policy: [[0.51023144 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.48976862 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:39,007 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 4), (Discard 0)) | P=0.5102314352989197
2024-10-22 17:01:39,008 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 4), (Reveal player +1 color G)) | P=0.4897686243057251
2024-10-22 17:01:39,008 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Discard 4)) | Value: 0.0
2024-10-22 17:01:39,008 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:39,008 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB1235
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
G5 || XX|RYGWB12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B1}
2024-10-22 17:01:39,008 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:39,008 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:39,008 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:39,009 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4589604437351227 | PUCT: 0.4589604437351227
2024-10-22 17:01:39,009 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.3527393341064453 | PUCT: 0.3527393341064453
2024-10-22 17:01:39,010 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.4589604437351227
2024-10-22 17:01:39,010 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:01:39,010 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Discard 4)) | Q: 0.0 | U: 0.5361011624336243 | PUCT: 0.5361011624336243
2024-10-22 17:01:39,010 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.521149754524231 | PUCT: 0.521149754524231
2024-10-22 17:01:39,011 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 color R)) | Q: 0.0 | U: 0.5285444259643555 | PUCT: 0.5285444259643555
2024-10-22 17:01:39,011 - DEBUG - Selected Child: ((Discard 0), (Discard 4)) | PUCT: 0.5361011624336243
2024-10-22 17:01:39,011 - DEBUG - Selected child for exploration: ((Discard 0), (Discard 4))
2024-10-22 17:01:39,011 - DEBUG - Expanding unexplored child: ((Discard 0), (Discard 4), (Discard 4))
2024-10-22 17:01:39,011 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Discard 4))', '((Discard 0), (Discard 4), (Discard 4))']
2024-10-22 17:01:39,012 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:01:39,013 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:39,014 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:01:39,223 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:39,224 - DEBUG - Network Policy Logits: [[-0.00767111  0.00655116  0.03165279 -0.0324496  -0.01038819  0.02258344
   0.05461132  0.01396987  0.01297012  0.0464753  -0.0181001  -0.00415963
  -0.06724089 -0.03935293  0.03630456 -0.02701341  0.01363774 -0.04475024
  -0.00205679 -0.03000987]]
2024-10-22 17:01:39,224 - DEBUG - Network Policy after Softmax: [[0.04970376 0.05041571 0.05169725 0.04848731 0.0495689  0.05123051
  0.05289787 0.05079113 0.05074037 0.05246924 0.0491881  0.0498786
  0.04682938 0.04815374 0.05193829 0.04875161 0.05077426 0.04789454
  0.0499836  0.04860575]]
2024-10-22 17:01:39,226 - DEBUG - Normalized Policy: [[0.33664718 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.33315456 0.
  0.         0.         0.         0.33019823 0.         0.
  0.         0.        ]]
2024-10-22 17:01:39,227 - DEBUG - Added Child Node: ((Discard 0), (Discard 4), (Discard 4), (Reveal player +1 color R)) | P=0.333154559135437
2024-10-22 17:01:39,228 - DEBUG - Added Child Node: ((Discard 0), (Discard 4), (Discard 4), (Discard 0)) | P=0.3366471827030182
2024-10-22 17:01:39,228 - DEBUG - Added Child Node: ((Discard 0), (Discard 4), (Discard 4), (Reveal player +1 rank 1)) | P=0.3301982283592224
2024-10-22 17:01:39,228 - DEBUG - Simulating Node: ((Discard 0), (Discard 4), (Discard 4)) | Value: 0.0
2024-10-22 17:01:39,229 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:39,229 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || XX|RYGWB1235
G3 || XX|RYGWB12345
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 W4 B1}
2024-10-22 17:01:39,229 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:39,229 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:39,229 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:39,230 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.3915295898914337 | PUCT: 0.3915295898914337
2024-10-22 17:01:39,231 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.361097514629364 | PUCT: 0.361097514629364
2024-10-22 17:01:39,231 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.3915295898914337
2024-10-22 17:01:39,231 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:01:39,231 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Discard 4)) | Q: 0.0 | U: 0.37710145115852356 | PUCT: 0.37710145115852356
2024-10-22 17:01:39,232 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5498766303062439 | PUCT: 0.5498766303062439
2024-10-22 17:01:39,232 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 color R)) | Q: 0.0 | U: 0.5576789379119873 | PUCT: 0.5576789379119873
2024-10-22 17:01:39,232 - DEBUG - Selected Child: ((Discard 0), (Reveal player +1 color R)) | PUCT: 0.5576789379119873
2024-10-22 17:01:39,232 - DEBUG - Selected child for exploration: ((Discard 0), (Reveal player +1 color R))
2024-10-22 17:01:39,232 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 color R), (Discard 3))
2024-10-22 17:01:39,232 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 color R))', '((Discard 0), (Reveal player +1 color R), (Discard 3))']
2024-10-22 17:01:39,233 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:01:39,234 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:01:39,235 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 3
2024-10-22 17:01:39,430 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:39,430 - DEBUG - Network Policy Logits: [[ 0.00026098  0.02406126  0.01315796 -0.01626691 -0.00283733  0.02497852
   0.04383545  0.01844595  0.00385566  0.0572849  -0.01310392  0.00372408
  -0.03980586 -0.04953769  0.03478461 -0.03454396  0.01309406 -0.03149348
   0.00124854 -0.02529544]]
2024-10-22 17:01:39,430 - DEBUG - Network Policy after Softmax: [[0.04992897 0.05113155 0.05057707 0.04911053 0.04977451 0.05117847
  0.05215269 0.05084523 0.05010877 0.05285886 0.04926611 0.05010218
  0.04796802 0.04750347 0.0516828  0.04822109 0.05057384 0.04836841
  0.0499783  0.04866913]]
2024-10-22 17:01:39,432 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33254305 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.3452923  0.32216465 0.         0.
  0.         0.        ]]
2024-10-22 17:01:39,432 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color R), (Discard 3), (Discard 4)) | P=0.3325430452823639
2024-10-22 17:01:39,433 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color R), (Discard 3), (Reveal player +1 rank 1)) | P=0.3221646547317505
2024-10-22 17:01:39,433 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color R), (Discard 3), (Reveal player +1 color B)) | P=0.3452922999858856
2024-10-22 17:01:39,434 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 color R), (Discard 3)) | Value: 0.0
2024-10-22 17:01:39,434 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:39,434 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 6, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 0}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB1345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
B1 || XX|YGWB12345
G5 || XX|RYGWB12345
Deck size: 6
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 W1}
2024-10-22 17:01:39,434 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:39,434 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:39,434 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:39,434 - DEBUG - Best node chosen by MCTS: ((Discard 0),) | Visit Count: 6
2024-10-22 17:01:39,434 - INFO - Actual Game Score: 4
2024-10-22 17:01:39,434 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:39,434 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:39,434 - DEBUG - Policy Targets: [0.66666667 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.33333333 0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:39,434 - DEBUG - === End of Training Data ===
2024-10-22 17:01:39,435 - INFO - Chosen Action: (Discard 0) | Visit Count: 6
2024-10-22 17:01:41,631 - DEBUG - Not the current player's turn.
2024-10-22 17:01:41,633 - INFO - Agent state has been reset.
2024-10-22 17:01:41,633 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:41,633 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G1235
XX || GX|G12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B3 || XX|RYGWB1345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:41,633 - INFO - Max Rollouts: 10
2024-10-22 17:01:41,633 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:41,634 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:41,634 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:41,843 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:41,843 - DEBUG - Network Policy Logits: [[ 4.0490098e-02 -1.4924649e-03  2.0287786e-02  2.0787043e-02
   3.6279436e-02  1.8762577e-02  3.5441726e-02  2.7828958e-02
   1.0206361e-02 -7.7556819e-05 -4.3916233e-02 -3.4668945e-02
   1.5577335e-02 -9.5365020e-03  6.2208679e-02 -1.4213724e-02
   3.0141950e-02  2.4237625e-02  5.2662548e-03  7.6338635e-03]]
2024-10-22 17:01:41,843 - DEBUG - Network Policy after Softmax: [[0.05140039 0.04928714 0.0503724  0.05039756 0.05118442 0.05029563
  0.05114156 0.05075371 0.04986713 0.04935693 0.04723993 0.04767879
  0.05013569 0.04889227 0.05252895 0.04866412 0.05087124 0.05057176
  0.04962139 0.04973901]]
2024-10-22 17:01:41,845 - DEBUG - Normalized Policy: [[0.         0.         0.         0.48964608 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.5103539  0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:41,846 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.6172346  0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.38276544 0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:41,847 - DEBUG - Added Child Node: ((Discard 3),) | P=0.6172345876693726
2024-10-22 17:01:41,847 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.38276544213294983
2024-10-22 17:01:41,847 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:41,847 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:41,847 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G1235
XX || GX|G12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B3 || XX|RYGWB1345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:41,848 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:41,848 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:41,848 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:41,848 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:01:41,848 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:01:41,849 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:42,080 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:42,080 - DEBUG - Network Policy Logits: [[ 0.00766594  0.02508928  0.0295319  -0.02428237  0.02690371  0.01868355
   0.05044242  0.00973537 -0.00027975  0.05102551 -0.04233624 -0.00130051
  -0.03161614 -0.0454909   0.03944576 -0.01894199  0.01593778 -0.0271815
  -0.02907551 -0.01883865]]
2024-10-22 17:01:42,081 - DEBUG - Network Policy after Softmax: [[0.05027452 0.05115815 0.05138593 0.04869373 0.05125106 0.05083149
  0.05247175 0.05037867 0.04987665 0.05250236 0.0478225  0.04982576
  0.04833792 0.04767188 0.0518979  0.04895446 0.05069211 0.04855276
  0.04846089 0.04895952]]
2024-10-22 17:01:42,083 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3471675  0.
  0.         0.         0.         0.         0.32394293 0.
  0.         0.         0.         0.         0.         0.3288896
  0.         0.        ]]
2024-10-22 17:01:42,084 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R)) | P=0.3239429295063019
2024-10-22 17:01:42,085 - DEBUG - Added Child Node: ((Discard 3), (Discard 4)) | P=0.3471674919128418
2024-10-22 17:01:42,086 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3)) | P=0.3288896083831787
2024-10-22 17:01:42,086 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:01:42,086 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:42,087 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 6, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB1345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
R1 || XX|RYGWB12345
Deck size: 6
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5}
2024-10-22 17:01:42,087 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:42,087 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:42,087 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:42,087 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:01:42,087 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:01:42,088 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:42,318 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:42,319 - DEBUG - Network Policy Logits: [[ 0.01231899  0.02854508  0.03366017  0.01322741 -0.00194726 -0.01502026
   0.02908715  0.00728571  0.00945996  0.02030902 -0.02536841 -0.01039858
  -0.04372887 -0.02762556  0.04227732 -0.04633142 -0.02040282 -0.00551986
  -0.03554869  0.00161956]]
2024-10-22 17:01:42,319 - DEBUG - Network Policy after Softmax: [[0.05068979 0.051519   0.05178319 0.05073585 0.04997177 0.04932274
  0.05154693 0.05043529 0.05054507 0.05109642 0.04881497 0.04955122
  0.04792689 0.04870491 0.05223135 0.04780231 0.04905797 0.04979356
  0.04832054 0.05015033]]
2024-10-22 17:01:42,321 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33333257 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.3321438
  0.         0.33452362]]
2024-10-22 17:01:42,322 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 5)) | P=0.33452361822128296
2024-10-22 17:01:42,322 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 4)) | P=0.3333325684070587
2024-10-22 17:01:42,323 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3)) | P=0.3321438133716583
2024-10-22 17:01:42,323 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:01:42,323 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:42,324 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B1345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || GX|G1235
G3 || GX|G12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:42,324 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:42,324 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:42,324 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:42,324 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.9084227681159973 | PUCT: 0.9084227681159973
2024-10-22 17:01:42,325 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.5633398294448853 | PUCT: 0.5633398294448853
2024-10-22 17:01:42,325 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.9084227681159973
2024-10-22 17:01:42,325 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:42,325 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4))
2024-10-22 17:01:42,325 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))']
2024-10-22 17:01:42,326 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:42,327 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:42,535 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:42,535 - DEBUG - Network Policy Logits: [[ 0.04954652  0.00991089  0.00962054 -0.03319874  0.00361458  0.03509067
   0.05396166  0.03549809 -0.01156661  0.02447892 -0.00900406 -0.02137037
  -0.01663288 -0.03146279  0.04312181 -0.01032919  0.03467731  0.01343456
  -0.00976806 -0.02097517]]
2024-10-22 17:01:42,536 - DEBUG - Network Policy after Softmax: [[0.05213176 0.05010591 0.05009136 0.04799176 0.04979141 0.05138358
  0.05236245 0.05140452 0.04904123 0.05084119 0.04916706 0.04856279
  0.0487934  0.04807514 0.05179791 0.04910195 0.05136234 0.05028278
  0.04912952 0.04858199]]
2024-10-22 17:01:42,538 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3344678  0.
  0.         0.         0.         0.         0.         0.
  0.32776377 0.         0.         0.         0.         0.33776847
  0.         0.        ]]
2024-10-22 17:01:42,538 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Discard 4)) | P=0.3344677984714508
2024-10-22 17:01:42,539 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 rank 3)) | P=0.33776846528053284
2024-10-22 17:01:42,540 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 color G)) | P=0.32776376605033875
2024-10-22 17:01:42,540 - DEBUG - Simulating Node: ((Discard 3), (Discard 4)) | Value: 0.0
2024-10-22 17:01:42,540 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:42,540 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
G3 || XX|RYGWB12345
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G3 W1}
2024-10-22 17:01:42,540 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:42,540 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:42,540 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:42,541 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.6525384783744812 | PUCT: 0.6525384783744812
2024-10-22 17:01:42,541 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.6069875955581665 | PUCT: 0.6069875955581665
2024-10-22 17:01:42,542 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.6525384783744812
2024-10-22 17:01:42,542 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:42,542 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 3))
2024-10-22 17:01:42,542 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 3))']
2024-10-22 17:01:42,543 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:42,543 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:42,753 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:42,753 - DEBUG - Network Policy Logits: [[ 0.04785975 -0.00900648  0.00953493  0.00085202  0.029881    0.02594279
   0.04797586  0.01000508 -0.00902756  0.02023307 -0.00773549 -0.01183158
  -0.03764338 -0.0309645   0.06990482 -0.02988975  0.03176554  0.01207648
   0.00562026 -0.01308497]]
2024-10-22 17:01:42,754 - DEBUG - Network Policy after Softmax: [[0.05200684 0.04913192 0.05005139 0.04961868 0.05108018 0.05087941
  0.05201288 0.05007493 0.04913089 0.05058973 0.04919441 0.04899332
  0.04774489 0.04806484 0.05316607 0.04811653 0.05117653 0.05017877
  0.04985585 0.04893195]]
2024-10-22 17:01:42,755 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33303648 0.
  0.         0.         0.32032734 0.         0.         0.
  0.         0.         0.3466362  0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:42,756 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Play 3)) | P=0.3203273415565491
2024-10-22 17:01:42,757 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Reveal player +1 color B)) | P=0.34663620591163635
2024-10-22 17:01:42,758 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Discard 4)) | P=0.33303648233413696
2024-10-22 17:01:42,758 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:01:42,758 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:42,758 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 6, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || G3|G3
XX || XX|RYGWB1245
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B3 || XX|RYGWB1345
Deck size: 6
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G3}
2024-10-22 17:01:42,759 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:42,759 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:42,759 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:42,759 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5163808465003967 | PUCT: 0.5163808465003967
2024-10-22 17:01:42,760 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.6404460668563843 | PUCT: 0.6404460668563843
2024-10-22 17:01:42,760 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.6404460668563843
2024-10-22 17:01:42,760 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:42,760 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 rank 3))
2024-10-22 17:01:42,760 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 rank 3))']
2024-10-22 17:01:42,761 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:42,762 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:42,986 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:42,986 - DEBUG - Network Policy Logits: [[ 0.04476673  0.00515187 -0.00665101  0.01871179  0.03814581 -0.00496037
   0.00552123  0.02386836  0.01131082  0.00986074 -0.00416043 -0.02331608
   0.00677498 -0.00013463  0.05721044 -0.02859768  0.02338206  0.03310467
  -0.00750758  0.01707028]]
2024-10-22 17:01:42,987 - DEBUG - Network Policy after Softmax: [[0.05170666 0.04969835 0.04911521 0.05037684 0.05136544 0.04919832
  0.04971671 0.05063729 0.05000538 0.04993292 0.04923769 0.04830348
  0.04977908 0.04943631 0.0523541  0.04804904 0.05061267 0.05110716
  0.04907316 0.05029422]]
2024-10-22 17:01:42,989 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3370314  0.
  0.         0.         0.         0.327632   0.         0.
  0.         0.         0.         0.         0.         0.33533666
  0.         0.        ]]
2024-10-22 17:01:42,990 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3), (Play 4)) | P=0.32763200998306274
2024-10-22 17:01:42,990 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3), (Discard 4)) | P=0.33703139424324036
2024-10-22 17:01:42,991 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3), (Reveal player +1 rank 3)) | P=0.3353366553783417
2024-10-22 17:01:42,991 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:01:42,991 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:42,991 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': 2}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G125
XX || G3|G3
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B3 || BX|B1345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:42,991 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:42,991 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:42,991 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:42,992 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5381355285644531 | PUCT: 0.5381355285644531
2024-10-22 17:01:42,993 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4449516832828522 | PUCT: 0.4449516832828522
2024-10-22 17:01:42,993 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.5381355285644531
2024-10-22 17:01:42,993 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:42,993 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 color R))
2024-10-22 17:01:42,993 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 color R))']
2024-10-22 17:01:42,994 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:42,995 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:01:43,211 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:43,211 - DEBUG - Network Policy Logits: [[ 0.0404198   0.00050668  0.00740948 -0.00541552  0.01806547  0.03558134
   0.05859233  0.02527965 -0.00606508  0.00744013 -0.01830061 -0.02286983
  -0.02036271 -0.02656992  0.07804663 -0.03351269  0.03797901  0.01706982
  -0.01404515 -0.02333498]]
2024-10-22 17:01:43,211 - DEBUG - Network Policy after Softmax: [[0.05163481 0.0496145  0.04995815 0.04932154 0.05049336 0.05138559
  0.05258173 0.05085894 0.04928951 0.04995969 0.0486901  0.04846813
  0.0485898  0.04828913 0.05361468 0.04795503 0.05150894 0.05044311
  0.04889774 0.04844559]]
2024-10-22 17:01:43,213 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.48500922 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.5149908  0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:43,214 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R), (Discard 4)) | P=0.48500922322273254
2024-10-22 17:01:43,214 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R), (Reveal player +1 color B)) | P=0.5149908065795898
2024-10-22 17:01:43,214 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:01:43,214 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:43,215 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 6, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|YGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B3 || XX|RYGWB1345
Deck size: 6
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G3}
2024-10-22 17:01:43,215 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:43,215 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:43,215 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:43,216 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4450344443321228 | PUCT: 0.4450344443321228
2024-10-22 17:01:43,216 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4599650204181671 | PUCT: 0.4599650204181671
2024-10-22 17:01:43,216 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.4599650204181671
2024-10-22 17:01:43,216 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:43,216 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 rank 5))
2024-10-22 17:01:43,216 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 rank 5))']
2024-10-22 17:01:43,217 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:43,218 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 2
2024-10-22 17:01:43,430 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:43,430 - DEBUG - Network Policy Logits: [[ 0.04473776  0.00104198 -0.00270261  0.01837302  0.03489174 -0.01346885
   0.01557944  0.01651138  0.00559918 -0.00786265 -0.00095653 -0.02253987
  -0.00649993  0.00201894  0.05290955 -0.02401309  0.01993497  0.03430573
  -0.00311162  0.01618069]]
2024-10-22 17:01:43,430 - DEBUG - Network Policy after Softmax: [[0.05180576 0.04959081 0.04940546 0.05045776 0.05129818 0.0488764
  0.050317   0.05036391 0.04981732 0.04915118 0.0494918  0.04843505
  0.04921821 0.04963928 0.05223084 0.04836375 0.05053664 0.05126813
  0.04938526 0.05034726]]
2024-10-22 17:01:43,432 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33295956 0.         0.
  0.         0.         0.3287334  0.         0.         0.
  0.         0.         0.         0.         0.         0.33830696
  0.         0.        ]]
2024-10-22 17:01:43,434 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 5), (Discard 3)) | P=0.3329595625400543
2024-10-22 17:01:43,434 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 5), (Play 3)) | P=0.3287334144115448
2024-10-22 17:01:43,435 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 5), (Reveal player +1 rank 3)) | P=0.3383069634437561
2024-10-22 17:01:43,435 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Reveal player +1 rank 5)) | Value: 0.0
2024-10-22 17:01:43,435 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:43,436 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': 4}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G123
XX || G5|G5
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B3 || BX|B1345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:43,436 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:43,436 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:43,436 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:43,436 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4574646055698395 | PUCT: 0.4574646055698395
2024-10-22 17:01:43,437 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.3546091914176941 | PUCT: 0.3546091914176941
2024-10-22 17:01:43,437 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.4574646055698395
2024-10-22 17:01:43,437 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:43,439 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 0.0 | U: 0.550536572933197 | PUCT: 0.550536572933197
2024-10-22 17:01:43,439 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3)) | Q: 0.0 | U: 0.5215516090393066 | PUCT: 0.5215516090393066
2024-10-22 17:01:43,439 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 color R)) | Q: 0.0 | U: 0.513707160949707 | PUCT: 0.513707160949707
2024-10-22 17:01:43,440 - DEBUG - Selected Child: ((Discard 3), (Discard 4)) | PUCT: 0.550536572933197
2024-10-22 17:01:43,440 - DEBUG - Selected child for exploration: ((Discard 3), (Discard 4))
2024-10-22 17:01:43,440 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4), (Reveal player +1 rank 3))
2024-10-22 17:01:43,440 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))', '((Discard 3), (Discard 4), (Reveal player +1 rank 3))']
2024-10-22 17:01:43,441 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:43,441 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:43,442 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:01:43,442 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:43,442 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:01:43,442 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:43,443 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.8 | U: 0.39025354385375977 | PUCT: 1.190253496170044
2024-10-22 17:01:43,443 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.3630116581916809 | PUCT: 0.3630116581916809
2024-10-22 17:01:43,444 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 1.190253496170044
2024-10-22 17:01:43,444 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:43,444 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Discard 4)) | Q: 2.0 | U: 0.38725554943084717 | PUCT: 2.3872556686401367
2024-10-22 17:01:43,445 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 rank 3)) | Q: 0.0 | U: 0.550300657749176 | PUCT: 0.550300657749176
2024-10-22 17:01:43,445 - DEBUG - PUCT Calculation | Child: ((Discard 3), (Reveal player +1 color R)) | Q: 0.0 | U: 0.542023777961731 | PUCT: 0.542023777961731
2024-10-22 17:01:43,445 - DEBUG - Selected Child: ((Discard 3), (Discard 4)) | PUCT: 2.3872556686401367
2024-10-22 17:01:43,445 - DEBUG - Selected child for exploration: ((Discard 3), (Discard 4))
2024-10-22 17:01:43,445 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 4), (Reveal player +1 color G))
2024-10-22 17:01:43,446 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 4))', '((Discard 3), (Discard 4), (Reveal player +1 color G))']
2024-10-22 17:01:43,447 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:43,448 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:43,449 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 3
2024-10-22 17:01:43,666 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:43,666 - DEBUG - Network Policy Logits: [[ 0.01606193  0.01354162  0.04909697 -0.04100904  0.01361848  0.01920995
   0.05236971  0.00464746 -0.00528699  0.03983739 -0.02365401 -0.00215188
  -0.04883623 -0.03785092  0.0359657  -0.0290797   0.01705948 -0.01584893
  -0.02950255 -0.0207575 ]]
2024-10-22 17:01:43,667 - DEBUG - Network Policy after Softmax: [[0.05076806 0.05064026 0.05247319 0.0479518  0.05064416 0.05092813
  0.0526452  0.05019186 0.0496957  0.05198955 0.04879127 0.04985175
  0.04757794 0.04810347 0.05178865 0.04852726 0.05081872 0.04917357
  0.04850674 0.04893279]]
2024-10-22 17:01:43,668 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50736636 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.49263367
  0.         0.        ]]
2024-10-22 17:01:43,669 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 color G), (Discard 4)) | P=0.5073663592338562
2024-10-22 17:01:43,670 - DEBUG - Added Child Node: ((Discard 3), (Discard 4), (Reveal player +1 color G), (Reveal player +1 rank 3)) | P=0.4926336705684662
2024-10-22 17:01:43,670 - DEBUG - Simulating Node: ((Discard 3), (Discard 4), (Reveal player +1 color G)) | Value: 0.0
2024-10-22 17:01:43,670 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:43,670 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
B1 || XX|RYGWB12345
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G3 G5}
2024-10-22 17:01:43,670 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:43,670 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:43,670 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:43,670 - DEBUG - Best node chosen by MCTS: ((Discard 3),) | Visit Count: 6
2024-10-22 17:01:43,670 - INFO - Actual Game Score: 4
2024-10-22 17:01:43,671 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:43,671 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:43,671 - DEBUG - Policy Targets: [0.         0.         0.         0.66666667 0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.33333333 0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:43,671 - DEBUG - === End of Training Data ===
2024-10-22 17:01:43,671 - INFO - Chosen Action: (Discard 3) | Visit Count: 6
2024-10-22 17:01:45,865 - DEBUG - Not the current player's turn.
2024-10-22 17:01:45,866 - INFO - Agent state has been reset.
2024-10-22 17:01:45,866 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:45,866 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B4 || XX|RYGWB12345
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:45,866 - INFO - Max Rollouts: 10
2024-10-22 17:01:45,866 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:45,867 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:45,867 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:46,075 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:46,076 - DEBUG - Network Policy Logits: [[ 0.03453676  0.01104491  0.01697753 -0.0310801   0.01040349  0.02648172
   0.05029977  0.03884463  0.01339397  0.02350724 -0.00808341 -0.03253852
  -0.00917842 -0.02842769  0.04544466 -0.01328136  0.04650764  0.01277852
  -0.00335425 -0.02323032]]
2024-10-22 17:01:46,076 - DEBUG - Network Policy after Softmax: [[0.05127312 0.05008265 0.05038066 0.04801674 0.05005054 0.05086176
  0.05208774 0.05149448 0.05020044 0.0507107  0.04913376 0.04794676
  0.04907999 0.04814427 0.05183546 0.04887903 0.05189059 0.05016955
  0.04936668 0.04839515]]
2024-10-22 17:01:46,078 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3290927  0.
  0.         0.         0.33007833 0.         0.         0.
  0.         0.         0.34082893 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:46,078 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.24681953 0.
 0.         0.         0.2523292  0.         0.         0.
 0.         0.         0.5008513  0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:46,079 - DEBUG - Added Child Node: ((Play 3),) | P=0.2523292005062103
2024-10-22 17:01:46,080 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.5008512735366821
2024-10-22 17:01:46,080 - DEBUG - Added Child Node: ((Discard 4),) | P=0.24681952595710754
2024-10-22 17:01:46,081 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:46,081 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:46,081 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B4 || XX|RYGWB12345
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:46,081 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:46,081 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:46,081 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:46,081 - DEBUG - Expanding unexplored child: ((Play 3),)
2024-10-22 17:01:46,081 - DEBUG - Traversing Path: ['()', '((Play 3),)']
2024-10-22 17:01:46,082 - DEBUG - Move: (Play 3) | Reward: 5 | Depth: 1
2024-10-22 17:01:46,285 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:46,286 - DEBUG - Network Policy Logits: [[-0.02620771  0.02258978  0.02183163 -0.0150483  -0.01072179  0.02904219
   0.04184118 -0.00025963  0.0138018   0.07324931 -0.00666649  0.00724994
  -0.07569329 -0.04041418  0.03633723 -0.02741056  0.01010237 -0.01890178
  -0.01389961 -0.02879975]]
2024-10-22 17:01:46,286 - DEBUG - Network Policy after Softmax: [[0.04870028 0.05113566 0.05109691 0.04924678 0.04946031 0.05146668
  0.05212963 0.0499805  0.05068826 0.05379291 0.0496613  0.05035723
  0.04634897 0.04801331 0.0518435  0.04864173 0.05050108 0.04905738
  0.04930339 0.04857421]]
2024-10-22 17:01:46,288 - DEBUG - Normalized Policy: [[0.         0.2517912  0.         0.         0.         0.25342113
  0.         0.         0.         0.         0.         0.
  0.         0.         0.2552766  0.23951113 0.         0.
  0.         0.        ]]
2024-10-22 17:01:46,289 - DEBUG - Added Child Node: ((Play 3), (Play 0)) | P=0.2534211277961731
2024-10-22 17:01:46,290 - DEBUG - Added Child Node: ((Play 3), (Discard 1)) | P=0.25179120898246765
2024-10-22 17:01:46,290 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 rank 1)) | P=0.2395111322402954
2024-10-22 17:01:46,291 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 color B)) | P=0.2552765905857086
2024-10-22 17:01:46,291 - DEBUG - Simulating Node: ((Play 3),) | Value: 0.0
2024-10-22 17:01:46,291 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:46,292 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
B1 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:46,292 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:46,292 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:46,292 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:46,292 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:46,292 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:46,293 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:46,495 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:46,496 - DEBUG - Network Policy Logits: [[-0.00715835  0.01450287  0.03442645 -0.04543166  0.00940047  0.01316956
   0.05604963  0.00123272  0.00684596  0.06278184 -0.04518876 -0.00248995
  -0.05145094 -0.04167512  0.03420005 -0.01884626  0.01963147 -0.02380829
  -0.02942419 -0.02898413]]
2024-10-22 17:01:46,496 - DEBUG - Network Policy after Softmax: [[0.04972154 0.05081032 0.05183279 0.04785449 0.05055172 0.05074262
  0.05296579 0.05014051 0.05042276 0.05332357 0.04786612 0.04995421
  0.0475673  0.0480346  0.05182106 0.04914378 0.05107158 0.04890053
  0.04862668 0.04864809]]
2024-10-22 17:01:46,497 - DEBUG - Normalized Policy: [[0.         0.33201888 0.         0.         0.         0.
  0.         0.         0.         0.3484417  0.         0.
  0.         0.         0.         0.         0.         0.31953946
  0.         0.        ]]
2024-10-22 17:01:46,498 - DEBUG - Added Child Node: ((Discard 4), (Play 4)) | P=0.3484416902065277
2024-10-22 17:01:46,498 - DEBUG - Added Child Node: ((Discard 4), (Discard 1)) | P=0.3320188820362091
2024-10-22 17:01:46,499 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3)) | P=0.31953945755958557
2024-10-22 17:01:46,499 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:46,499 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:46,499 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
W4 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 R1}
2024-10-22 17:01:46,499 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:46,499 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:46,499 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:46,500 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:01:46,500 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:01:46,500 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:46,708 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:46,709 - DEBUG - Network Policy Logits: [[-0.00239098  0.00678012  0.03712024 -0.02867751  0.02217805  0.00630707
   0.03962902 -0.00121356  0.00060125  0.04261197 -0.04792711 -0.03046713
  -0.03357471 -0.02521681  0.03990707 -0.0298466   0.01356077 -0.01970816
  -0.02074052 -0.00231763]]
2024-10-22 17:01:46,709 - DEBUG - Network Policy after Softmax: [[0.04994567 0.05040583 0.05195859 0.04864987 0.05118798 0.05038199
  0.0520891  0.05000451 0.05009534 0.05224471 0.04772234 0.04856288
  0.04841221 0.04881853 0.05210358 0.04859303 0.05074878 0.04908819
  0.04903754 0.04994933]]
2024-10-22 17:01:46,710 - DEBUG - Normalized Policy: [[0.         0.33218828 0.         0.         0.         0.
  0.         0.         0.         0.34430704 0.         0.
  0.         0.         0.         0.         0.         0.32350472
  0.         0.        ]]
2024-10-22 17:01:46,712 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 4)) | P=0.3443070352077484
2024-10-22 17:01:46,712 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1)) | P=0.33218827843666077
2024-10-22 17:01:46,713 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3)) | P=0.3235047161579132
2024-10-22 17:01:46,713 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:01:46,713 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:46,713 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
W4 || XX|RYGWB12345
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:46,713 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:46,713 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:46,713 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:46,714 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.40014246106147766 | PUCT: 0.40014246106147766
2024-10-22 17:01:46,714 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.39140522480010986 | PUCT: 0.39140522480010986
2024-10-22 17:01:46,715 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.794247567653656 | PUCT: 0.794247567653656
2024-10-22 17:01:46,715 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.794247567653656
2024-10-22 17:01:46,715 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:46,715 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 rank 3))
2024-10-22 17:01:46,715 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 rank 3))']
2024-10-22 17:01:46,716 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:46,717 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:46,925 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:46,925 - DEBUG - Network Policy Logits: [[ 0.03398614  0.00779389  0.0053813   0.00395009  0.0110333  -0.00788234
   0.01997591  0.00896623  0.00878081  0.02228664  0.00189801 -0.00405098
  -0.04681503 -0.01424924  0.06582112 -0.01804932  0.02679306  0.01807348
   0.00802097 -0.01099051]]
2024-10-22 17:01:46,926 - DEBUG - Network Policy after Softmax: [[0.0513532  0.05002561 0.04990507 0.04983369 0.05018793 0.04924751
  0.05063875 0.05008429 0.05007501 0.0507559  0.04973153 0.04943656
  0.04736702 0.04893495 0.05301433 0.04874935 0.05098514 0.0505425
  0.05003697 0.04909468]]
2024-10-22 17:01:46,927 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33391854 0.
  0.         0.         0.33316725 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.33291417 0.        ]]
2024-10-22 17:01:46,928 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3), (Play 3)) | P=0.33316725492477417
2024-10-22 17:01:46,929 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3), (Discard 4)) | P=0.3339185416698456
2024-10-22 17:01:46,930 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3), (Reveal player +1 rank 4)) | P=0.33291417360305786
2024-10-22 17:01:46,930 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:01:46,930 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:46,930 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || G3|G3
XX || XX|RYGWB1245
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B4 || BX|B12345
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:46,930 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:46,930 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:46,930 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:46,931 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.42219918966293335 | PUCT: 0.42219918966293335
2024-10-22 17:01:46,931 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.412980318069458 | PUCT: 0.412980318069458
2024-10-22 17:01:46,932 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.5586854815483093 | PUCT: 0.5586854815483093
2024-10-22 17:01:46,932 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.5586854815483093
2024-10-22 17:01:46,932 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:46,932 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Play 4))
2024-10-22 17:01:46,932 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Play 4))']
2024-10-22 17:01:46,933 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:46,934 - DEBUG - Move: (Play 4) | Reward: 5 | Depth: 2
2024-10-22 17:01:47,151 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:47,151 - DEBUG - Network Policy Logits: [[ 0.03205218  0.01645662  0.00994555 -0.02534506  0.0140476   0.02610056
   0.02910355  0.03476409 -0.00619052  0.0378282  -0.01685751 -0.02421852
  -0.02221792 -0.03086939  0.04313198 -0.00143758  0.04978165  0.02156359
  -0.01054429 -0.01467005]]
2024-10-22 17:01:47,152 - DEBUG - Network Policy after Softmax: [[0.05119489 0.05040267 0.05007556 0.04833918 0.05028139 0.0508911
  0.05104415 0.05133391 0.04927402 0.05149144 0.04875121 0.04839367
  0.04849058 0.04807287 0.05176527 0.04950877 0.05211064 0.05066073
  0.04905996 0.04885796]]
2024-10-22 17:01:47,155 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.25505802 0.
  0.         0.         0.24994804 0.         0.         0.
  0.         0.24385509 0.         0.25113884 0.         0.
  0.         0.        ]]
2024-10-22 17:01:47,155 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 4), (Reveal player +1 color W)) | P=0.2438550889492035
2024-10-22 17:01:47,156 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 4), (Play 3)) | P=0.24994803965091705
2024-10-22 17:01:47,157 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 4), (Reveal player +1 rank 1)) | P=0.251138836145401
2024-10-22 17:01:47,158 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 4), (Discard 4)) | P=0.25505802035331726
2024-10-22 17:01:47,158 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Play 4)) | Value: 0.0
2024-10-22 17:01:47,158 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:47,158 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B1 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
W1 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:47,158 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:47,158 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:47,158 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:47,159 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.43998607993125916 | PUCT: 0.43998607993125916
2024-10-22 17:01:47,160 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.43037885427474976 | PUCT: 0.43037885427474976
2024-10-22 17:01:47,160 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.4366668164730072 | PUCT: 0.4366668164730072
2024-10-22 17:01:47,160 - DEBUG - Selected Child: ((Play 3),) | PUCT: 0.43998607993125916
2024-10-22 17:01:47,160 - DEBUG - Selected child for exploration: ((Play 3),)
2024-10-22 17:01:47,160 - DEBUG - Expanding unexplored child: ((Play 3), (Play 0))
2024-10-22 17:01:47,160 - DEBUG - Traversing Path: ['()', '((Play 3),)', '((Play 3), (Play 0))']
2024-10-22 17:01:47,161 - DEBUG - Move: (Play 3) | Reward: 5 | Depth: 1
2024-10-22 17:01:47,162 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 2
2024-10-22 17:01:47,383 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:47,383 - DEBUG - Network Policy Logits: [[-0.01192213  0.00209989  0.01088042 -0.01899778  0.00510705  0.0796342
   0.00699326  0.04511031 -0.00998158  0.06868087 -0.01140521 -0.01407253
  -0.0900086  -0.03559006  0.03159392 -0.03347044  0.04607352 -0.00340618
  -0.0162974  -0.00917753]]
2024-10-22 17:01:47,383 - DEBUG - Network Policy after Softmax: [[0.04926952 0.04996525 0.0504059  0.04892214 0.05011573 0.05399341
  0.05021035 0.05216116 0.04936523 0.05340523 0.049295   0.04916369
  0.04556862 0.04811711 0.05146087 0.04821921 0.05221143 0.04969089
  0.04905443 0.04940493]]
2024-10-22 17:01:47,385 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32921538 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34629947 0.32448512 0.         0.
  0.         0.        ]]
2024-10-22 17:01:47,387 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Discard 3)) | P=0.3292153775691986
2024-10-22 17:01:47,387 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Reveal player +1 rank 1)) | P=0.3244851231575012
2024-10-22 17:01:47,388 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Reveal player +1 color B)) | P=0.3462994694709778
2024-10-22 17:01:47,388 - DEBUG - Simulating Node: ((Play 3), (Play 0)) | Value: 0.0
2024-10-22 17:01:47,388 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:47,388 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 3, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B4 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 3
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:47,388 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:47,389 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:47,389 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:47,389 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.3032212555408478 | PUCT: 0.3032212555408478
2024-10-22 17:01:47,390 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4449004828929901 | PUCT: 0.4449004828929901
2024-10-22 17:01:47,390 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.45140060782432556 | PUCT: 0.45140060782432556
2024-10-22 17:01:47,391 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.45140060782432556
2024-10-22 17:01:47,391 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:47,391 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Discard 1))
2024-10-22 17:01:47,391 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Discard 1))']
2024-10-22 17:01:47,392 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:47,393 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:47,660 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:47,662 - DEBUG - Network Policy Logits: [[ 0.02060578 -0.00158134 -0.00255041 -0.01406457  0.01492495  0.03554217
   0.03496679  0.04125606 -0.00729531  0.03421161 -0.0257896  -0.01844621
  -0.00687178 -0.01927525  0.01593812 -0.02358307  0.05332219  0.0312465
   0.00715246 -0.02748464]]
2024-10-22 17:01:47,662 - DEBUG - Network Policy after Softmax: [[0.05066393 0.04955222 0.04950422 0.0489375  0.05037693 0.05142635
  0.05139676 0.05172103 0.04926989 0.05135797 0.04836705 0.04872354
  0.04929077 0.04868316 0.050428   0.04847389 0.05234889 0.05120591
  0.0499869  0.04828514]]
2024-10-22 17:01:47,664 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.25429076 0.
  0.         0.         0.24870265 0.         0.         0.
  0.         0.         0.         0.24468467 0.         0.
  0.25232196 0.        ]]
2024-10-22 17:01:47,666 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1), (Play 3)) | P=0.24870264530181885
2024-10-22 17:01:47,667 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1), (Reveal player +1 rank 1)) | P=0.24468466639518738
2024-10-22 17:01:47,668 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1), (Discard 4)) | P=0.25429075956344604
2024-10-22 17:01:47,669 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1), (Reveal player +1 rank 4)) | P=0.2523219585418701
2024-10-22 17:01:47,669 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Discard 1)) | Value: 0.0
2024-10-22 17:01:47,669 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:47,669 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B4 || BX|B12345
R1 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B5}
2024-10-22 17:01:47,670 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:47,670 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:47,670 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:47,671 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.31169047951698303 | PUCT: 0.31169047951698303
2024-10-22 17:01:47,671 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4573269188404083 | PUCT: 0.4573269188404083
2024-10-22 17:01:47,672 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.3712068796157837 | PUCT: 0.3712068796157837
2024-10-22 17:01:47,672 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.4573269188404083
2024-10-22 17:01:47,672 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:47,672 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 3))
2024-10-22 17:01:47,673 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 3))']
2024-10-22 17:01:47,674 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:47,675 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:47,877 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:47,877 - DEBUG - Network Policy Logits: [[ 0.02456037  0.0135367   0.01739139 -0.01548308  0.0178061   0.01590308
   0.03662463  0.02288862 -0.00259632  0.04203254 -0.0160342  -0.02635445
  -0.04163975 -0.01914837  0.04566414 -0.00904749  0.04084223  0.00877943
   0.00274757 -0.01631054]]
2024-10-22 17:01:47,878 - DEBUG - Network Policy after Softmax: [[0.05086533 0.05030768 0.05050198 0.04886875 0.05052293 0.05042687
  0.05148269 0.05078036 0.04950258 0.05176186 0.04884182 0.04834035
  0.04760708 0.04868995 0.05195018 0.04918426 0.05170029 0.05006892
  0.04976782 0.04882833]]
2024-10-22 17:01:47,879 - DEBUG - Normalized Policy: [[0.33394146 0.         0.         0.         0.         0.
  0.         0.         0.32499474 0.         0.         0.
  0.         0.         0.34106377 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:47,880 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3), (Discard 0)) | P=0.3339414596557617
2024-10-22 17:01:47,881 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3), (Play 3)) | P=0.3249947428703308
2024-10-22 17:01:47,881 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3), (Reveal player +1 color B)) | P=0.3410637676715851
2024-10-22 17:01:47,881 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:01:47,881 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:47,882 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || G3|G3
XX || XX|RYGWB1245
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B4 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 R1}
2024-10-22 17:01:47,882 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:47,882 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:47,882 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:47,882 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.31907597184181213 | PUCT: 0.31907597184181213
2024-10-22 17:01:47,883 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3121088445186615 | PUCT: 0.3121088445186615
2024-10-22 17:01:47,883 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.38000261783599854 | PUCT: 0.38000261783599854
2024-10-22 17:01:47,883 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.38000261783599854
2024-10-22 17:01:47,884 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:47,884 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Reveal player +1 rank 3)) | Q: 0.0 | U: 0.5130122303962708 | PUCT: 0.5130122303962708
2024-10-22 17:01:47,884 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Play 4)) | Q: 0.0 | U: 0.5460004806518555 | PUCT: 0.5460004806518555
2024-10-22 17:01:47,885 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Discard 1)) | Q: 0.0 | U: 0.5267825722694397 | PUCT: 0.5267825722694397
2024-10-22 17:01:47,885 - DEBUG - Selected Child: ((Reveal player +1 color B), (Play 4)) | PUCT: 0.5460004806518555
2024-10-22 17:01:47,885 - DEBUG - Selected child for exploration: ((Reveal player +1 color B), (Play 4))
2024-10-22 17:01:47,885 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Play 4), (Reveal player +1 rank 1))
2024-10-22 17:01:47,886 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Play 4))', '((Reveal player +1 color B), (Play 4), (Reveal player +1 rank 1))']
2024-10-22 17:01:47,886 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:01:47,887 - DEBUG - Move: (Play 4) | Reward: 5 | Depth: 2
2024-10-22 17:01:47,888 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 3
2024-10-22 17:01:48,093 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:48,094 - DEBUG - Network Policy Logits: [[ 0.00363713  0.00442913  0.035533   -0.01967061  0.02304008 -0.01090479
   0.02258332  0.01931224  0.01180997  0.05379064 -0.04633585 -0.02786375
  -0.04197073 -0.04147858  0.05279912 -0.0276458   0.00709851 -0.02486457
  -0.02961178  0.00021096]]
2024-10-22 17:01:48,094 - DEBUG - Network Policy after Softmax: [[0.05025057 0.05029039 0.05187919 0.04909289 0.0512351  0.04952512
  0.0512117  0.05104446 0.05066294 0.05283508 0.04780111 0.04869231
  0.04801023 0.04803386 0.05278272 0.04870292 0.05042481 0.04883856
  0.04860726 0.0500787 ]]
2024-10-22 17:01:48,096 - DEBUG - Normalized Policy: [[0.         0.33573502 0.         0.         0.         0.
  0.         0.         0.33822218 0.         0.         0.
  0.         0.         0.         0.         0.         0.32604277
  0.         0.        ]]
2024-10-22 17:01:48,097 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 4), (Reveal player +1 rank 1), (Play 3)) | P=0.3382221758365631
2024-10-22 17:01:48,097 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 4), (Reveal player +1 rank 1), (Discard 1)) | P=0.335735023021698
2024-10-22 17:01:48,098 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 4), (Reveal player +1 rank 1), (Reveal player +1 rank 3)) | P=0.3260427713394165
2024-10-22 17:01:48,098 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Play 4), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:48,098 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:48,098 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B1 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
G3 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:48,099 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:48,099 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:48,099 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:48,099 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color B),) | Visit Count: 5
2024-10-22 17:01:48,099 - INFO - Actual Game Score: 5
2024-10-22 17:01:48,099 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:48,099 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:48,100 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.22222222 0.
 0.         0.         0.22222222 0.         0.         0.
 0.         0.         0.55555556 0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:48,100 - DEBUG - === End of Training Data ===
2024-10-22 17:01:48,100 - INFO - Chosen Action: (Reveal player +1 color B) | Visit Count: 5
2024-10-22 17:01:50,169 - DEBUG - Not the current player's turn.
2024-10-22 17:01:50,170 - INFO - Agent state has been reset.
2024-10-22 17:01:50,170 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:50,170 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
G3 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4}
2024-10-22 17:01:50,170 - INFO - Max Rollouts: 10
2024-10-22 17:01:50,170 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:50,171 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:50,171 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:50,366 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:50,366 - DEBUG - Network Policy Logits: [[ 0.02530055  0.02048701  0.00607566 -0.01822577  0.01222684  0.03660647
   0.04453045  0.03400103  0.00062025  0.03171881 -0.00514819 -0.03223246
  -0.01468011 -0.03902815  0.04090726 -0.00029596  0.04458935  0.0087787
  -0.00702545 -0.01524455]]
2024-10-22 17:01:50,366 - DEBUG - Network Policy after Softmax: [[0.05082135 0.05057731 0.04985365 0.04865673 0.05016125 0.05139919
  0.0518081  0.05126545 0.04958241 0.05114858 0.04929722 0.04797996
  0.04882956 0.04765501 0.05162073 0.04953701 0.05181115 0.04998858
  0.04920477 0.04880201]]
2024-10-22 17:01:50,368 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.25262284 0.
  0.         0.         0.24970771 0.         0.         0.
  0.24591616 0.         0.         0.         0.         0.25175327
  0.         0.        ]]
2024-10-22 17:01:50,369 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.3874232  0.
 0.         0.         0.23932475 0.         0.         0.
 0.18443713 0.         0.         0.         0.         0.18881495
 0.         0.        ]
2024-10-22 17:01:50,369 - DEBUG - Added Child Node: ((Play 3),) | P=0.23932474851608276
2024-10-22 17:01:50,370 - DEBUG - Added Child Node: ((Discard 4),) | P=0.38742318749427795
2024-10-22 17:01:50,370 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.1888149529695511
2024-10-22 17:01:50,371 - DEBUG - Added Child Node: ((Reveal player +1 color G),) | P=0.1844371259212494
2024-10-22 17:01:50,371 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:50,371 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:50,371 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
G3 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4}
2024-10-22 17:01:50,371 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:50,371 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:50,371 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:50,372 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G),)
2024-10-22 17:01:50,372 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)']
2024-10-22 17:01:50,372 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:01:50,554 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:50,554 - DEBUG - Network Policy Logits: [[-0.0113487   0.01307181  0.03101917  0.00203464  0.03492649 -0.0159817
   0.03439472  0.00470206  0.00880509  0.060607   -0.06368789 -0.01535042
  -0.03472503 -0.02552479  0.02571366 -0.01322314  0.0242349  -0.01146605
  -0.01718188  0.00100369]]
2024-10-22 17:01:50,554 - DEBUG - Network Policy after Softmax: [[0.04933739 0.05055707 0.05147263 0.05000213 0.05167414 0.04910934
  0.05164667 0.05013569 0.05034181 0.05301834 0.04682153 0.04914035
  0.04819744 0.04864291 0.05120026 0.049245   0.0511246  0.0493316
  0.04905044 0.04995061]]
2024-10-22 17:01:50,556 - DEBUG - Normalized Policy: [[0.         0.25312892 0.         0.         0.         0.
  0.         0.         0.         0.265452   0.23442581 0.
  0.         0.         0.         0.         0.         0.24699324
  0.         0.        ]]
2024-10-22 17:01:50,556 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color R)) | P=0.23442581295967102
2024-10-22 17:01:50,557 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Play 4)) | P=0.26545199751853943
2024-10-22 17:01:50,558 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 1)) | P=0.25312891602516174
2024-10-22 17:01:50,558 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 3)) | P=0.24699324369430542
2024-10-22 17:01:50,558 - DEBUG - Simulating Node: ((Reveal player +1 color G),) | Value: 0.0
2024-10-22 17:01:50,558 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:50,558 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || GX|G12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
R1 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4}
2024-10-22 17:01:50,558 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:50,558 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:50,559 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:50,559 - DEBUG - Expanding unexplored child: ((Play 3),)
2024-10-22 17:01:50,559 - DEBUG - Traversing Path: ['()', '((Play 3),)']
2024-10-22 17:01:50,560 - DEBUG - Move: (Play 3) | Reward: 5 | Depth: 1
2024-10-22 17:01:50,753 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:50,754 - DEBUG - Network Policy Logits: [[-0.03400936  0.02338113  0.01212689 -0.01977277 -0.00406769  0.02058552
   0.04463643 -0.01602781  0.0129055   0.07663359 -0.01185968  0.00527775
  -0.07312724 -0.0383257   0.03651111 -0.02519607  0.02359507 -0.01224609
  -0.00666065 -0.02372447]]
2024-10-22 17:01:50,754 - DEBUG - Network Policy after Softmax: [[0.04832505 0.05117958 0.05060681 0.04901795 0.04979386 0.05103669
  0.05227906 0.04920187 0.05064623 0.05397889 0.04940737 0.05026139
  0.04647117 0.04811691 0.05185599 0.04875283 0.05119053 0.04938829
  0.04966491 0.04882463]]
2024-10-22 17:01:50,755 - DEBUG - Normalized Policy: [[0.         0.25508922 0.         0.         0.         0.25437707
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.24299385 0.         0.
  0.24753985 0.        ]]
2024-10-22 17:01:50,756 - DEBUG - Added Child Node: ((Play 3), (Play 0)) | P=0.2543770670890808
2024-10-22 17:01:50,757 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 rank 1)) | P=0.24299384653568268
2024-10-22 17:01:50,757 - DEBUG - Added Child Node: ((Play 3), (Discard 1)) | P=0.2550892233848572
2024-10-22 17:01:50,758 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 rank 4)) | P=0.24753984808921814
2024-10-22 17:01:50,758 - DEBUG - Simulating Node: ((Play 3),) | Value: 0.0
2024-10-22 17:01:50,758 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:50,758 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 3, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
B1 || XX|RYGWB12345
W4 || XX|RYGWB12345
Deck size: 3
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4}
2024-10-22 17:01:50,758 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:50,758 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:50,758 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:50,759 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:50,759 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:50,759 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:50,955 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:50,955 - DEBUG - Network Policy Logits: [[-0.00563154  0.02243825  0.04899929 -0.0271097   0.01254869  0.01470038
   0.05535936  0.0053851   0.00161323  0.05096401 -0.03293127  0.0098101
  -0.07053843 -0.04536363  0.03858607 -0.01398303  0.03374141 -0.02375615
  -0.01868618 -0.02165465]]
2024-10-22 17:01:50,956 - DEBUG - Network Policy after Softmax: [[0.04960618 0.05101834 0.0523916  0.04855209 0.05051628 0.05062509
  0.05272587 0.05015569 0.04996687 0.05249463 0.04827026 0.05037813
  0.04648867 0.04767387 0.05184886 0.04919362 0.05159828 0.04871519
  0.0489628  0.04881767]]
2024-10-22 17:01:50,957 - DEBUG - Normalized Policy: [[0.         0.33514392 0.         0.         0.         0.
  0.         0.         0.         0.3448418  0.         0.
  0.         0.         0.         0.         0.         0.32001427
  0.         0.        ]]
2024-10-22 17:01:50,958 - DEBUG - Added Child Node: ((Discard 4), (Play 4)) | P=0.3448418080806732
2024-10-22 17:01:50,958 - DEBUG - Added Child Node: ((Discard 4), (Discard 1)) | P=0.33514392375946045
2024-10-22 17:01:50,959 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3)) | P=0.32001426815986633
2024-10-22 17:01:50,959 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:50,959 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:50,959 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 3, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
B1 || XX|RYGWB12345
Deck size: 3
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:50,959 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:50,959 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:50,959 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:50,960 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:01:50,960 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:01:50,960 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:51,164 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:51,165 - DEBUG - Network Policy Logits: [[-5.4332567e-03  6.2835999e-03  4.6113368e-02 -6.8793753e-03
   3.3475768e-02 -5.9335013e-03  2.3358721e-02  1.4560353e-02
   6.0159713e-05  6.6385522e-02 -4.8328716e-02 -2.0964352e-02
  -3.7370071e-02 -2.1893345e-02  2.9816382e-02 -9.2008878e-03
   2.1795666e-02 -1.2567427e-02 -2.9847186e-02 -6.7793997e-04]]
2024-10-22 17:01:51,165 - DEBUG - Network Policy after Softmax: [[0.04960344 0.05018806 0.05222738 0.04953176 0.0515715  0.04957863
  0.05105238 0.05060517 0.04987668 0.05329694 0.04752067 0.04883899
  0.04804429 0.04879364 0.05138313 0.0494169  0.05097264 0.04925082
  0.04840709 0.04983988]]
2024-10-22 17:01:51,167 - DEBUG - Normalized Policy: [[0.         0.32859388 0.         0.         0.         0.
  0.         0.         0.         0.34894854 0.         0.
  0.         0.         0.         0.         0.         0.32245752
  0.         0.        ]]
2024-10-22 17:01:51,168 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Play 4)) | P=0.34894853830337524
2024-10-22 17:01:51,170 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 1)) | P=0.3285938799381256
2024-10-22 17:01:51,170 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 3)) | P=0.32245752215385437
2024-10-22 17:01:51,170 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:01:51,170 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:51,171 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 2}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || X3|RYGWB3
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
W1 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4}
2024-10-22 17:01:51,171 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:51,171 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:51,171 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:51,172 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.30860164761543274 | PUCT: 0.30860164761543274
2024-10-22 17:01:51,172 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.4004400372505188 | PUCT: 0.4004400372505188
2024-10-22 17:01:51,173 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6482394337654114 | PUCT: 0.6482394337654114
2024-10-22 17:01:51,174 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.3159266412258148 | PUCT: 0.3159266412258148
2024-10-22 17:01:51,174 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.6482394337654114
2024-10-22 17:01:51,174 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:51,174 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 3))
2024-10-22 17:01:51,174 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 3))']
2024-10-22 17:01:51,175 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:51,176 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:51,390 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:51,390 - DEBUG - Network Policy Logits: [[ 0.02352467  0.01534927  0.00871673 -0.00786006  0.02408534  0.01859709
   0.0429383   0.01626111 -0.01467292  0.04147666 -0.01428488 -0.02344285
  -0.05545021 -0.02336913  0.05190799 -0.00291425  0.0491778   0.01208357
   0.00117264 -0.01001493]]
2024-10-22 17:01:51,390 - DEBUG - Network Policy after Softmax: [[0.05078102 0.05036756 0.0500346  0.04921203 0.0508095  0.05053141
  0.0517765  0.05041351 0.04887789 0.05170088 0.04889686 0.04845111
  0.04692487 0.04845468 0.05224301 0.04945602 0.05210057 0.05020335
  0.04965856 0.04910609]]
2024-10-22 17:01:51,392 - DEBUG - Normalized Policy: [[0.25805053 0.         0.         0.         0.         0.
  0.         0.         0.24837953 0.         0.         0.
  0.23845498 0.         0.         0.         0.         0.255115
  0.         0.        ]]
2024-10-22 17:01:51,393 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3), (Discard 0)) | P=0.2580505311489105
2024-10-22 17:01:51,393 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3), (Play 3)) | P=0.24837952852249146
2024-10-22 17:01:51,394 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3), (Reveal player +1 rank 3)) | P=0.25511500239372253
2024-10-22 17:01:51,395 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3), (Reveal player +1 color G)) | P=0.23845498263835907
2024-10-22 17:01:51,395 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:01:51,395 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:51,395 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 3, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || G3|G3
XX || XX|RYGWB1245
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
G3 || XX|RYGWB12345
Deck size: 3
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 R1}
2024-10-22 17:01:51,395 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:51,395 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:51,395 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:51,396 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.3216027617454529 | PUCT: 0.3216027617454529
2024-10-22 17:01:51,397 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.4173102378845215 | PUCT: 0.4173102378845215
2024-10-22 17:01:51,398 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.45036616921424866 | PUCT: 0.45036616921424866
2024-10-22 17:01:51,398 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.32923635840415955 | PUCT: 0.32923635840415955
2024-10-22 17:01:51,398 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.45036616921424866
2024-10-22 17:01:51,398 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:51,398 - DEBUG - Expanding unexplored child: ((Discard 4), (Play 4))
2024-10-22 17:01:51,398 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Play 4))']
2024-10-22 17:01:51,399 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:51,400 - DEBUG - Move: (Play 4) | Reward: 5 | Depth: 2
2024-10-22 17:01:51,595 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:51,596 - DEBUG - Network Policy Logits: [[ 0.02075176  0.02298975  0.01079444 -0.02740982  0.02113419  0.01854999
   0.04475941  0.01591898 -0.00991276  0.03594855 -0.01494064 -0.03089737
  -0.02954684 -0.02385715  0.04184511 -0.00849314  0.05664046  0.0189937
  -0.00666656 -0.02371173]]
2024-10-22 17:01:51,596 - DEBUG - Network Policy after Softmax: [[0.0506926  0.05080617 0.05019034 0.04830902 0.05071199 0.05058111
  0.05192433 0.0504482  0.04916172 0.05146885 0.04891517 0.04814083
  0.04820589 0.04848095 0.05177323 0.04923157 0.05254493 0.05060355
  0.04932157 0.048488  ]]
2024-10-22 17:01:51,597 - DEBUG - Normalized Policy: [[0.3398176  0.         0.         0.         0.         0.
  0.         0.         0.32955542 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.33062696 0.        ]]
2024-10-22 17:01:51,598 - DEBUG - Added Child Node: ((Discard 4), (Play 4), (Discard 0)) | P=0.339817613363266
2024-10-22 17:01:51,599 - DEBUG - Added Child Node: ((Discard 4), (Play 4), (Play 3)) | P=0.3295554220676422
2024-10-22 17:01:51,599 - DEBUG - Added Child Node: ((Discard 4), (Play 4), (Reveal player +1 rank 4)) | P=0.3306269645690918
2024-10-22 17:01:51,599 - DEBUG - Simulating Node: ((Discard 4), (Play 4)) | Value: 0.0
2024-10-22 17:01:51,600 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:51,600 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 2, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B1 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
W4 || XX|RYGWB12345
Deck size: 2
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 R1}
2024-10-22 17:01:51,600 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:51,600 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:51,600 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:51,601 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.332454115152359 | PUCT: 0.332454115152359
2024-10-22 17:01:51,601 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.4313909113407135 | PUCT: 0.4313909113407135
2024-10-22 17:01:51,601 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.34917163848876953 | PUCT: 0.34917163848876953
2024-10-22 17:01:51,602 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.3403452932834625 | PUCT: 0.3403452932834625
2024-10-22 17:01:51,602 - DEBUG - Selected Child: ((Play 3),) | PUCT: 0.4313909113407135
2024-10-22 17:01:51,602 - DEBUG - Selected child for exploration: ((Play 3),)
2024-10-22 17:01:51,602 - DEBUG - Expanding unexplored child: ((Play 3), (Play 0))
2024-10-22 17:01:51,602 - DEBUG - Traversing Path: ['()', '((Play 3),)', '((Play 3), (Play 0))']
2024-10-22 17:01:51,603 - DEBUG - Move: (Play 3) | Reward: 5 | Depth: 1
2024-10-22 17:01:51,604 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 2
2024-10-22 17:01:51,807 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:51,807 - DEBUG - Network Policy Logits: [[-0.01968394  0.01353622  0.01026899 -0.02631957  0.01752981  0.07864287
  -0.0080237   0.0396735  -0.01594466  0.07444718 -0.00870554 -0.00459071
  -0.09247924 -0.03017035  0.03293344 -0.03124167  0.06053485  0.00276788
  -0.01665218 -0.00926092]]
2024-10-22 17:01:51,808 - DEBUG - Network Policy after Softmax: [[0.0488233  0.05047246 0.05030782 0.04850039 0.05067442 0.05386788
  0.04939592 0.05180906 0.0490062  0.05364234 0.04936225 0.04956578
  0.04539547 0.04831399 0.05146104 0.04826226 0.05290122 0.04993187
  0.04897154 0.04933484]]
2024-10-22 17:01:51,809 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24590792 0.         0.
  0.         0.         0.24847248 0.         0.         0.
  0.         0.         0.26091906 0.24470052 0.         0.
  0.         0.        ]]
2024-10-22 17:01:51,810 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Discard 3)) | P=0.24590791761875153
2024-10-22 17:01:51,811 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Play 3)) | P=0.24847248196601868
2024-10-22 17:01:51,812 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Reveal player +1 rank 1)) | P=0.24470052123069763
2024-10-22 17:01:51,812 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Reveal player +1 color B)) | P=0.26091906428337097
2024-10-22 17:01:51,812 - DEBUG - Simulating Node: ((Play 3), (Play 0)) | Value: 0.0
2024-10-22 17:01:51,813 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:51,813 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 2, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
G3 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 2
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4}
2024-10-22 17:01:51,813 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:51,813 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:51,813 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:51,814 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.34173983335494995 | PUCT: 0.34173983335494995
2024-10-22 17:01:51,814 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.2956266701221466 | PUCT: 0.2956266701221466
2024-10-22 17:01:51,814 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3589242994785309 | PUCT: 0.3589242994785309
2024-10-22 17:01:51,815 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.3498513996601105 | PUCT: 0.3498513996601105
2024-10-22 17:01:51,815 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.3589242994785309
2024-10-22 17:01:51,815 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:51,816 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 1))
2024-10-22 17:01:51,816 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 1))']
2024-10-22 17:01:51,816 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:51,817 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:52,006 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:52,007 - DEBUG - Network Policy Logits: [[-0.02230117  0.00931403 -0.0066622  -0.02275476 -0.00491599  0.04711005
   0.0163679   0.03377893  0.00075712  0.04378665 -0.02064922 -0.01403204
  -0.03633591 -0.03914661  0.03356872 -0.02185964  0.0563421   0.03031696
   0.00414597 -0.0300933 ]]
2024-10-22 17:01:52,007 - DEBUG - Network Policy after Softmax: [[0.04873841 0.0503039  0.04950661 0.0487163  0.04959314 0.05224157
  0.05065999 0.05154976 0.04987529 0.05206824 0.04881899 0.0491431
  0.04805915 0.04792426 0.05153892 0.04875993 0.0527261  0.0513716
  0.05004459 0.04836011]]
2024-10-22 17:01:52,009 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.2493381  0.
  0.         0.         0.25075662 0.         0.         0.
  0.24162568 0.         0.         0.         0.         0.2582796
  0.         0.        ]]
2024-10-22 17:01:52,009 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Play 3)) | P=0.2507566213607788
2024-10-22 17:01:52,010 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Discard 4)) | P=0.24933810532093048
2024-10-22 17:01:52,010 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Reveal player +1 rank 3)) | P=0.25827959179878235
2024-10-22 17:01:52,011 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Reveal player +1 color G)) | P=0.24162568151950836
2024-10-22 17:01:52,011 - DEBUG - Simulating Node: ((Discard 4), (Discard 1)) | Value: 0.0
2024-10-22 17:01:52,011 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:52,011 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 6, 'num_players': 2, 'deck_size': 2, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
G3 || XX|RYGWB12345
R1 || XX|RYGWB12345
Deck size: 2
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 B5}
2024-10-22 17:01:52,011 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:52,011 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:52,011 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:52,012 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.34983736276626587 | PUCT: 0.34983736276626587
2024-10-22 17:01:52,012 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.30263155698776245 | PUCT: 0.30263155698776245
2024-10-22 17:01:52,013 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.29394322633743286 | PUCT: 0.29394322633743286
2024-10-22 17:01:52,013 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.358141154050827 | PUCT: 0.358141154050827
2024-10-22 17:01:52,013 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.358141154050827
2024-10-22 17:01:52,013 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:01:52,014 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Reveal player +1 rank 3))
2024-10-22 17:01:52,014 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 rank 3))']
2024-10-22 17:01:52,014 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:52,015 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:52,198 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:52,198 - DEBUG - Network Policy Logits: [[ 0.02786688  0.01256518  0.01377263  0.00931054  0.014882    0.00596544
   0.0344187   0.0227347   0.00416456  0.01572427  0.00979214 -0.00946226
  -0.056885   -0.02128368  0.05248055 -0.01188204  0.02788581  0.02352021
  -0.00825977 -0.00318706]]
2024-10-22 17:01:52,199 - DEBUG - Network Policy after Softmax: [[0.05097976 0.05020561 0.05026627 0.05004248 0.05032207 0.04987536
  0.05131486 0.05071879 0.04978563 0.05036447 0.05006659 0.04911181
  0.04683715 0.04853465 0.05225012 0.04899311 0.05098072 0.05075864
  0.0491709  0.04942096]]
2024-10-22 17:01:52,200 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.34245548 0.
  0.         0.         0.33880484 0.         0.         0.
  0.31873965 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:52,201 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 3), (Play 3)) | P=0.33880484104156494
2024-10-22 17:01:52,202 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 3), (Discard 4)) | P=0.3424554765224457
2024-10-22 17:01:52,203 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 3), (Reveal player +1 color G)) | P=0.318739652633667
2024-10-22 17:01:52,203 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:01:52,203 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:52,203 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 2}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || G3|G3
XX || XX|RYGWB1245
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
G3 || X3|RYGWB3
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4}
2024-10-22 17:01:52,203 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:52,203 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:52,203 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:52,203 - DEBUG - Best node chosen by MCTS: ((Discard 4),) | Visit Count: 4
2024-10-22 17:01:52,203 - INFO - Actual Game Score: 4
2024-10-22 17:01:52,203 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:52,204 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:52,204 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.44444444 0.
 0.         0.         0.22222222 0.         0.         0.
 0.11111111 0.         0.         0.         0.         0.22222222
 0.         0.        ]
2024-10-22 17:01:52,204 - DEBUG - === End of Training Data ===
2024-10-22 17:01:52,204 - INFO - Chosen Action: (Discard 4) | Visit Count: 4
2024-10-22 17:01:53,935 - DEBUG - Not the current player's turn.
2024-10-22 17:01:53,937 - INFO - Agent state has been reset.
2024-10-22 17:01:53,937 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:53,938 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 2, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
Deck size: 2
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:53,938 - INFO - Max Rollouts: 10
2024-10-22 17:01:53,938 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:53,938 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:53,938 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:54,162 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:54,163 - DEBUG - Network Policy Logits: [[ 0.02033189  0.03104718  0.01041513 -0.01790814  0.02307697  0.03027702
   0.04066427  0.02711105  0.00204014  0.03291291  0.00944666 -0.01710341
  -0.01529833 -0.02770651  0.04023417 -0.01425142  0.05028883  0.00892659
   0.00199521 -0.01732541]]
2024-10-22 17:01:54,163 - DEBUG - Network Policy after Softmax: [[0.05045769 0.05100127 0.04995978 0.04856461 0.05059639 0.050962
  0.05149412 0.05080091 0.04954312 0.05109651 0.04991142 0.04860371
  0.04869152 0.04809108 0.05147197 0.04874253 0.05199211 0.04988547
  0.04954089 0.04859292]]
2024-10-22 17:01:54,165 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24297416 0.         0.
  0.         0.         0.         0.25564152 0.         0.
  0.         0.         0.25752    0.24386428 0.         0.
  0.         0.        ]]
2024-10-22 17:01:54,165 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.3530098  0.         0.
 0.         0.         0.         0.19173114 0.         0.
 0.         0.         0.2723605  0.18289857 0.         0.
 0.         0.        ]
2024-10-22 17:01:54,166 - DEBUG - Added Child Node: ((Discard 3),) | P=0.35300979018211365
2024-10-22 17:01:54,167 - DEBUG - Added Child Node: ((Play 4),) | P=0.19173114001750946
2024-10-22 17:01:54,168 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.18289856612682343
2024-10-22 17:01:54,168 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.27236050367355347
2024-10-22 17:01:54,168 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:54,168 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:54,169 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 2, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
Deck size: 2
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:54,169 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:54,169 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:54,169 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:54,169 - DEBUG - Expanding unexplored child: ((Play 4),)
2024-10-22 17:01:54,169 - DEBUG - Traversing Path: ['()', '((Play 4),)']
2024-10-22 17:01:54,170 - DEBUG - Move: (Play 4) | Reward: 6 | Depth: 1
2024-10-22 17:01:54,385 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:54,386 - DEBUG - Network Policy Logits: [[-0.01360029  0.03461025  0.04457525 -0.02901471  0.01417755  0.01640637
   0.03930477 -0.00303706 -0.01556856  0.05999513 -0.02397365  0.01798893
  -0.07086207 -0.03161674  0.02789443 -0.02126476  0.02117183 -0.03105124
  -0.01845916 -0.02143046]]
2024-10-22 17:01:54,386 - DEBUG - Network Policy after Softmax: [[0.04930866 0.05174409 0.0522623  0.04855442 0.05069755 0.05081067
  0.05198757 0.04983228 0.0492117  0.05307442 0.04879981 0.05089115
  0.04656447 0.04842825 0.05139775 0.04893218 0.05105339 0.04845564
  0.04906966 0.04892407]]
2024-10-22 17:01:54,388 - DEBUG - Normalized Policy: [[0.         0.25879475 0.         0.         0.         0.2541263
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.24473117 0.         0.24234779
  0.         0.        ]]
2024-10-22 17:01:54,389 - DEBUG - Added Child Node: ((Play 4), (Play 0)) | P=0.25412631034851074
2024-10-22 17:01:54,389 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 rank 1)) | P=0.24473117291927338
2024-10-22 17:01:54,390 - DEBUG - Added Child Node: ((Play 4), (Discard 1)) | P=0.25879475474357605
2024-10-22 17:01:54,391 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 rank 3)) | P=0.24234779179096222
2024-10-22 17:01:54,391 - DEBUG - Simulating Node: ((Play 4),) | Value: 0.0
2024-10-22 17:01:54,391 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:54,391 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 1, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R1 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
B1 || XX|RYGWB12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:54,391 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:54,392 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:54,392 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:54,392 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 17:01:54,392 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 17:01:54,393 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 1
2024-10-22 17:01:54,600 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:54,600 - DEBUG - Network Policy Logits: [[-0.0109495   0.01982185  0.0377453  -0.00795546  0.03071766 -0.00583886
   0.01508607  0.00441709 -0.00181078  0.06251925 -0.0373293  -0.01180709
  -0.04561275 -0.02929478  0.03322032 -0.02310665  0.01557073 -0.02399146
  -0.02001115  0.00031084]]
2024-10-22 17:01:54,600 - DEBUG - Network Policy after Softmax: [[0.04943335 0.05097813 0.05190007 0.04958158 0.05153662 0.04968664
  0.05073728 0.05019885 0.04988718 0.0532019  0.04814636 0.04939098
  0.04774919 0.04853475 0.05166576 0.04883603 0.05076188 0.04879283
  0.04898743 0.04999314]]
2024-10-22 17:01:54,602 - DEBUG - Normalized Policy: [[0.         0.25708407 0.         0.         0.         0.250571
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.24628137 0.         0.24606355
  0.         0.        ]]
2024-10-22 17:01:54,603 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0)) | P=0.25057101249694824
2024-10-22 17:01:54,604 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.24628137052059174
2024-10-22 17:01:54,604 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1)) | P=0.25708407163619995
2024-10-22 17:01:54,605 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 3)) | P=0.24606354534626007
2024-10-22 17:01:54,605 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 17:01:54,605 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:54,605 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 2, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
W1 || XX|RYGWB12345
Deck size: 2
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:54,605 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:54,605 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:54,605 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:54,605 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:01:54,606 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:01:54,606 - DEBUG - Move: (Discard 3) | Reward: 5 | Depth: 1
2024-10-22 17:01:54,821 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:54,822 - DEBUG - Network Policy Logits: [[-0.04280825  0.03160007  0.03065045 -0.01476763 -0.01269266  0.02533402
   0.0476872  -0.00703684  0.00556206  0.06308958  0.00420314  0.01138467
  -0.07737151 -0.04557187  0.02178578 -0.02831812  0.01702425 -0.02938391
  -0.00242169 -0.02854118]]
2024-10-22 17:01:54,822 - DEBUG - Network Policy after Softmax: [[0.04795112 0.05165518 0.05160615 0.04931473 0.04941716 0.05133252
  0.05249288 0.04969745 0.05032754 0.05330766 0.0502592  0.05062144
  0.04632208 0.04781879 0.0511507  0.04865099 0.05090772 0.04859917
  0.04992734 0.04864015]]
2024-10-22 17:01:54,824 - DEBUG - Normalized Policy: [[0.         0.25584802 0.         0.         0.         0.2542499
  0.         0.         0.         0.         0.24893375 0.
  0.         0.         0.         0.24096832 0.         0.
  0.         0.        ]]
2024-10-22 17:01:54,824 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R)) | P=0.24893374741077423
2024-10-22 17:01:54,825 - DEBUG - Added Child Node: ((Discard 3), (Discard 1)) | P=0.2558480203151703
2024-10-22 17:01:54,826 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1)) | P=0.24096831679344177
2024-10-22 17:01:54,826 - DEBUG - Added Child Node: ((Discard 3), (Play 0)) | P=0.2542499005794525
2024-10-22 17:01:54,826 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:01:54,826 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:54,826 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 6, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 6
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:54,826 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:54,827 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:54,827 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:54,827 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:01:54,827 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:01:54,828 - DEBUG - Move: (Reveal player +1 color B) | Reward: 5 | Depth: 1
2024-10-22 17:01:55,040 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:55,041 - DEBUG - Network Policy Logits: [[-0.01191971  0.02793955  0.03689658 -0.01327505  0.02327578 -0.00132081
   0.02976367 -0.01288868 -0.01023395  0.04510746 -0.03323813 -0.01770154
  -0.04424458 -0.02283667  0.02484546 -0.02220681  0.01689478 -0.01423125
  -0.01335312 -0.00166295]]
2024-10-22 17:01:55,041 - DEBUG - Network Policy after Softmax: [[0.04942842 0.05143839 0.0519012  0.04936147 0.05119905 0.04995509
  0.05153231 0.04938055 0.04951181 0.0523291  0.04838584 0.04914346
  0.0478562  0.04889175 0.05127948 0.04892255 0.05087339 0.04931429
  0.04935762 0.049938  ]]
2024-10-22 17:01:55,043 - DEBUG - Normalized Policy: [[0.         0.20739935 0.         0.         0.         0.20141871
  0.         0.         0.         0.         0.19509147 0.
  0.         0.         0.         0.1972555  0.         0.19883502
  0.         0.        ]]
2024-10-22 17:01:55,043 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 1)) | P=0.19725550711154938
2024-10-22 17:01:55,044 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 0)) | P=0.2014187127351761
2024-10-22 17:01:55,045 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 rank 3)) | P=0.19883501529693604
2024-10-22 17:01:55,045 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color R)) | P=0.19509147107601166
2024-10-22 17:01:55,046 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1)) | P=0.20739935338497162
2024-10-22 17:01:55,046 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:01:55,046 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:55,046 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 2, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
R1 || XX|RYGWB12345
Deck size: 2
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:55,046 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:55,046 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:55,046 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:55,047 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 0.0 | U: 0.32080602645874023 | PUCT: 0.32080602645874023
2024-10-22 17:01:55,048 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.30602729320526123 | PUCT: 0.30602729320526123
2024-10-22 17:01:55,048 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5906587243080139 | PUCT: 0.5906587243080139
2024-10-22 17:01:55,048 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.45571571588516235 | PUCT: 0.45571571588516235
2024-10-22 17:01:55,049 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.5906587243080139
2024-10-22 17:01:55,049 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:55,049 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 1))
2024-10-22 17:01:55,049 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 1))']
2024-10-22 17:01:55,049 - DEBUG - Move: (Discard 3) | Reward: 5 | Depth: 1
2024-10-22 17:01:55,050 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 2
2024-10-22 17:01:55,269 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:55,269 - DEBUG - Network Policy Logits: [[-0.03086026  0.02449957  0.00833702 -0.02375286 -0.00747724  0.07863986
   0.01091599  0.06206248 -0.01537095  0.06568223  0.00674317 -0.01402572
  -0.06127864 -0.0352287   0.03624244 -0.01283966  0.06316793  0.00378406
  -0.00385268 -0.01842964]]
2024-10-22 17:01:55,270 - DEBUG - Network Policy after Softmax: [[0.04811693 0.05085579 0.05004044 0.04846014 0.04925531 0.05368504
  0.05016966 0.05280242 0.04886803 0.05299389 0.04996075 0.04893382
  0.04667533 0.0479072  0.0514565  0.04899189 0.05286082 0.04981312
  0.04943416 0.04871879]]
2024-10-22 17:01:55,271 - DEBUG - Normalized Policy: [[0.24371229 0.         0.         0.         0.         0.
  0.         0.         0.2475166  0.         0.         0.
  0.         0.         0.2606272  0.24814394 0.         0.
  0.         0.        ]]
2024-10-22 17:01:55,272 - DEBUG - Added Child Node: ((Discard 3), (Discard 1), (Discard 0)) | P=0.24371229112148285
2024-10-22 17:01:55,273 - DEBUG - Added Child Node: ((Discard 3), (Discard 1), (Play 3)) | P=0.24751660227775574
2024-10-22 17:01:55,274 - DEBUG - Added Child Node: ((Discard 3), (Discard 1), (Reveal player +1 rank 1)) | P=0.24814394116401672
2024-10-22 17:01:55,275 - DEBUG - Added Child Node: ((Discard 3), (Discard 1), (Reveal player +1 color B)) | P=0.26062721014022827
2024-10-22 17:01:55,275 - DEBUG - Simulating Node: ((Discard 3), (Discard 1)) | Value: 0.0
2024-10-22 17:01:55,275 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:55,275 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 7, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 7
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
R1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 B5}
2024-10-22 17:01:55,275 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:55,275 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:55,275 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:55,276 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 0.0 | U: 0.3343213200569153 | PUCT: 0.3343213200569153
2024-10-22 17:01:55,276 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.31891998648643494 | PUCT: 0.31891998648643494
2024-10-22 17:01:55,277 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.41036176681518555 | PUCT: 0.41036176681518555
2024-10-22 17:01:55,277 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.47491464018821716 | PUCT: 0.47491464018821716
2024-10-22 17:01:55,278 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.47491464018821716
2024-10-22 17:01:55,278 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:55,278 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 color R))
2024-10-22 17:01:55,279 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 color R))']
2024-10-22 17:01:55,279 - DEBUG - Move: (Reveal player +1 color B) | Reward: 5 | Depth: 1
2024-10-22 17:01:55,280 - DEBUG - Move: (Reveal player +1 color R) | Reward: 5 | Depth: 2
2024-10-22 17:01:55,504 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:55,504 - DEBUG - Network Policy Logits: [[ 0.01538961  0.0341977  -0.00192404  0.01236639  0.01035812  0.0047243
   0.02365784  0.01229701 -0.00014421  0.01144288  0.01246638 -0.00072235
  -0.0459287  -0.00387583  0.06607206 -0.02334661  0.03528374  0.02845421
  -0.00906162 -0.02076428]]
2024-10-22 17:01:55,504 - DEBUG - Network Policy after Softmax: [[0.05035461 0.05131065 0.0494903  0.05020261 0.05010189 0.04982042
  0.05077268 0.05019912 0.04957846 0.05015627 0.05020763 0.0495498
  0.04735971 0.0493938  0.05297249 0.04844136 0.05136641 0.05101679
  0.04913831 0.04856661]]
2024-10-22 17:01:55,506 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33738258 0.         0.
  0.         0.         0.         0.33707115 0.         0.
  0.         0.         0.         0.32554626 0.         0.
  0.         0.        ]]
2024-10-22 17:01:55,507 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color R), (Discard 3)) | P=0.33738258481025696
2024-10-22 17:01:55,508 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color R), (Play 4)) | P=0.33707115054130554
2024-10-22 17:01:55,509 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color R), (Reveal player +1 rank 1)) | P=0.3255462646484375
2024-10-22 17:01:55,509 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:01:55,509 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:55,509 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 2, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|YGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || BX|B12345
Deck size: 2
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:55,509 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:55,509 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:55,509 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:55,510 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 0.0 | U: 0.3456018269062042 | PUCT: 0.3456018269062042
2024-10-22 17:01:55,510 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.32968080043792725 | PUCT: 0.32968080043792725
2024-10-22 17:01:55,511 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.42420801520347595 | PUCT: 0.42420801520347595
2024-10-22 17:01:55,512 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.32729265093803406 | PUCT: 0.32729265093803406
2024-10-22 17:01:55,512 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.42420801520347595
2024-10-22 17:01:55,512 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:01:55,512 - DEBUG - Expanding unexplored child: ((Discard 3), (Play 0))
2024-10-22 17:01:55,512 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Play 0))']
2024-10-22 17:01:55,513 - DEBUG - Move: (Discard 3) | Reward: 5 | Depth: 1
2024-10-22 17:01:55,514 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 2
2024-10-22 17:01:55,723 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:55,724 - DEBUG - Network Policy Logits: [[-0.02870215  0.02755059  0.01572468 -0.02756574  0.00327374  0.08986505
   0.00244833  0.04725573 -0.02155172  0.0636366   0.00424632 -0.0074161
  -0.100823   -0.04627937  0.03592817 -0.02447515  0.05334321 -0.01137354
  -0.01298187 -0.01428807]]
2024-10-22 17:01:55,724 - DEBUG - Network Policy after Softmax: [[0.04842702 0.05122925 0.05062699 0.04848208 0.05000054 0.05452313
  0.04995928 0.05224874 0.04877453 0.05311167 0.05004919 0.04946889
  0.04505739 0.04758324 0.05166022 0.04863215 0.05256777 0.0492735
  0.04919432 0.0491301 ]]
2024-10-22 17:01:55,726 - DEBUG - Normalized Policy: [[0.24520764 0.         0.         0.         0.         0.
  0.         0.         0.24696727 0.         0.         0.
  0.         0.         0.26157883 0.24624634 0.         0.
  0.         0.        ]]
2024-10-22 17:01:55,726 - DEBUG - Added Child Node: ((Discard 3), (Play 0), (Discard 0)) | P=0.24520763754844666
2024-10-22 17:01:55,727 - DEBUG - Added Child Node: ((Discard 3), (Play 0), (Play 3)) | P=0.24696727097034454
2024-10-22 17:01:55,728 - DEBUG - Added Child Node: ((Discard 3), (Play 0), (Reveal player +1 rank 1)) | P=0.246246337890625
2024-10-22 17:01:55,728 - DEBUG - Added Child Node: ((Discard 3), (Play 0), (Reveal player +1 color B)) | P=0.26157882809638977
2024-10-22 17:01:55,728 - DEBUG - Simulating Node: ((Discard 3), (Play 0)) | Value: 0.0
2024-10-22 17:01:55,728 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:55,729 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 6, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 6
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:55,729 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:55,729 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:55,729 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:55,729 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 0.0 | U: 0.35525476932525635 | PUCT: 0.35525476932525635
2024-10-22 17:01:55,730 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.33888906240463257 | PUCT: 0.33888906240463257
2024-10-22 17:01:55,730 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3270423710346222 | PUCT: 0.3270423710346222
2024-10-22 17:01:55,731 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.3364342153072357 | PUCT: 0.3364342153072357
2024-10-22 17:01:55,731 - DEBUG - Selected Child: ((Play 4),) | PUCT: 0.35525476932525635
2024-10-22 17:01:55,731 - DEBUG - Selected child for exploration: ((Play 4),)
2024-10-22 17:01:55,731 - DEBUG - Expanding unexplored child: ((Play 4), (Discard 1))
2024-10-22 17:01:55,731 - DEBUG - Traversing Path: ['()', '((Play 4),)', '((Play 4), (Discard 1))']
2024-10-22 17:01:55,732 - DEBUG - Move: (Play 4) | Reward: 6 | Depth: 1
2024-10-22 17:01:55,733 - DEBUG - Move: (Discard 1) | Reward: 6 | Depth: 2
2024-10-22 17:01:55,948 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:55,948 - DEBUG - Network Policy Logits: [[-2.8378103e-02  3.4254722e-02 -1.2951831e-02 -1.7972510e-02
  -5.0684260e-03  5.9470367e-02  7.7496669e-03  2.7273178e-02
  -1.7516440e-02  4.7661323e-02  3.8153259e-05 -3.2062978e-03
  -5.8080453e-02 -3.5458587e-02  3.3699751e-02 -2.7154801e-02
   4.5224760e-02  2.1009199e-02  1.9272259e-03 -2.5247727e-02]]
2024-10-22 17:01:55,949 - DEBUG - Network Policy after Softmax: [[0.04846331 0.05159578 0.04921672 0.04897023 0.04960625 0.05291334
  0.0502462  0.05123682 0.04899257 0.05229216 0.04986021 0.0496987
  0.047045   0.04812138 0.05156716 0.04852264 0.0521649  0.05091687
  0.04995449 0.04861526]]
2024-10-22 17:01:55,951 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24245887 0.         0.2619818
  0.         0.         0.         0.         0.         0.
  0.         0.         0.25531662 0.24024275 0.         0.
  0.         0.        ]]
2024-10-22 17:01:55,951 - DEBUG - Added Child Node: ((Play 4), (Discard 1), (Play 0)) | P=0.2619817852973938
2024-10-22 17:01:55,952 - DEBUG - Added Child Node: ((Play 4), (Discard 1), (Reveal player +1 rank 1)) | P=0.24024274945259094
2024-10-22 17:01:55,953 - DEBUG - Added Child Node: ((Play 4), (Discard 1), (Reveal player +1 color B)) | P=0.2553166151046753
2024-10-22 17:01:55,953 - DEBUG - Added Child Node: ((Play 4), (Discard 1), (Discard 3)) | P=0.24245886504650116
2024-10-22 17:01:55,953 - DEBUG - Simulating Node: ((Play 4), (Discard 1)) | Value: 0.0
2024-10-22 17:01:55,953 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:55,953 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 6, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 1, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 6
Fireworks: R1 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 B5}
2024-10-22 17:01:55,953 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:55,954 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:55,954 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:55,955 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 0.0 | U: 0.2424483448266983 | PUCT: 0.2424483448266983
2024-10-22 17:01:55,955 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.34691905975341797 | PUCT: 0.34691905975341797
2024-10-22 17:01:55,955 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3347916305065155 | PUCT: 0.3347916305065155
2024-10-22 17:01:55,956 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.34440600872039795 | PUCT: 0.34440600872039795
2024-10-22 17:01:55,956 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.34691905975341797
2024-10-22 17:01:55,956 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:01:55,956 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 rank 3))
2024-10-22 17:01:55,956 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 rank 3))']
2024-10-22 17:01:55,957 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 1
2024-10-22 17:01:55,958 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 5 | Depth: 2
2024-10-22 17:01:56,164 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:56,165 - DEBUG - Network Policy Logits: [[ 0.02329224  0.01807829  0.0159488   0.00962669  0.01196382  0.01929808
   0.02111131 -0.00470864  0.00150023  0.01623426  0.02106278 -0.01196266
  -0.06920876 -0.01695957  0.04852482 -0.0243279   0.04426071  0.02595403
   0.0154069  -0.00342759]]
2024-10-22 17:01:56,165 - DEBUG - Network Policy after Softmax: [[0.05075037 0.05048645 0.05037905 0.05006155 0.05017869 0.05054807
  0.05063981 0.04934902 0.04965638 0.05039343 0.05063735 0.04899234
  0.04626649 0.04874814 0.05204722 0.04839027 0.05182576 0.05088564
  0.05035176 0.04941228]]
2024-10-22 17:01:56,166 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32826772 0.         0.
  0.         0.         0.         0.33044395 0.         0.
  0.         0.         0.34128833 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:56,167 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 3), (Discard 3)) | P=0.3282677233219147
2024-10-22 17:01:56,167 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 3), (Play 4)) | P=0.33044394850730896
2024-10-22 17:01:56,168 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 3), (Reveal player +1 color B)) | P=0.34128832817077637
2024-10-22 17:01:56,168 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:01:56,168 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:56,168 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 2, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || G3|G3
XX || XX|RYGWB1245
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || X1|RYGWB1
Deck size: 2
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:56,168 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:56,168 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:56,168 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:56,169 - DEBUG - Best node chosen by MCTS: ((Discard 3),) | Visit Count: 3
2024-10-22 17:01:56,169 - INFO - Actual Game Score: 5
2024-10-22 17:01:56,169 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:56,169 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:56,169 - DEBUG - Policy Targets: [0.         0.         0.         0.33333333 0.         0.
 0.         0.         0.         0.22222222 0.         0.
 0.         0.         0.22222222 0.22222222 0.         0.
 0.         0.        ]
2024-10-22 17:01:56,169 - DEBUG - === End of Training Data ===
2024-10-22 17:01:56,169 - INFO - Chosen Action: (Discard 3) | Visit Count: 3
2024-10-22 17:01:58,416 - DEBUG - Not the current player's turn.
2024-10-22 17:01:58,417 - INFO - Agent state has been reset.
2024-10-22 17:01:58,418 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:58,418 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || X1|RYGWB1
XX || X1|RYGWB1
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:58,418 - INFO - Max Rollouts: 10
2024-10-22 17:01:58,418 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:58,418 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:58,418 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:58,621 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:58,621 - DEBUG - Network Policy Logits: [[ 0.02414739  0.02349459  0.04981949  0.00658285  0.04120761  0.00853697
   0.01413652  0.05468233 -0.00884432  0.0107548   0.02103195 -0.04713097
  -0.00176586 -0.01213888  0.05781854 -0.01417179  0.05637677 -0.00806978
  -0.00426382  0.00801054]]
2024-10-22 17:01:58,622 - DEBUG - Network Policy after Softmax: [[0.05049102 0.05045807 0.051804   0.04961191 0.05135979 0.04970895
  0.04998808 0.05205653 0.04885241 0.04981932 0.05033395 0.04701736
  0.04919944 0.04869172 0.05222005 0.04859284 0.05214481 0.04889026
  0.04907669 0.04968279]]
2024-10-22 17:01:58,624 - DEBUG - Normalized Policy: [[0.2522579  0.         0.         0.         0.         0.
  0.         0.         0.24407129 0.         0.         0.
  0.         0.         0.26089633 0.24277444 0.         0.
  0.         0.        ]]
2024-10-22 17:01:58,625 - DEBUG - Dirichlet Noise Added: [0.18919343 0.         0.         0.         0.         0.
 0.         0.         0.2435871  0.         0.         0.
 0.         0.         0.3851386  0.18208084 0.         0.
 0.         0.        ]
2024-10-22 17:01:58,625 - DEBUG - Added Child Node: ((Discard 0),) | P=0.18919342756271362
2024-10-22 17:01:58,626 - DEBUG - Added Child Node: ((Play 3),) | P=0.24358710646629333
2024-10-22 17:01:58,626 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.18208083510398865
2024-10-22 17:01:58,627 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.385138601064682
2024-10-22 17:01:58,627 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:58,627 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:58,627 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || X1|RYGWB1
XX || X1|RYGWB1
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:58,627 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:58,627 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:58,627 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:58,628 - DEBUG - Expanding unexplored child: ((Discard 0),)
2024-10-22 17:01:58,628 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 17:01:58,629 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 1
2024-10-22 17:01:58,830 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:58,830 - DEBUG - Network Policy Logits: [[-0.00070638  0.01864159  0.02952781 -0.01050675  0.00614865  0.04566729
   0.02011051 -0.025884   -0.04303375  0.05080189 -0.00095084  0.01189039
  -0.05572904 -0.01536722 -0.00237063  0.0136271   0.00972207 -0.03028643
  -0.02633971 -0.01182929]]
2024-10-22 17:01:58,830 - DEBUG - Network Policy after Softmax: [[0.04998877 0.05096537 0.05152322 0.04950126 0.05033262 0.05236153
  0.05104029 0.04874589 0.04791703 0.05263107 0.04997655 0.05062245
  0.04731256 0.04926124 0.04990565 0.05071044 0.0505128  0.04853176
  0.04872368 0.04943583]]
2024-10-22 17:01:58,832 - DEBUG - Normalized Policy: [[0.         0.2508026  0.         0.         0.         0.25767314
  0.         0.         0.         0.         0.24593659 0.
  0.         0.         0.24558765 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:58,833 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color R)) | P=0.2459365874528885
2024-10-22 17:01:58,833 - DEBUG - Added Child Node: ((Discard 0), (Discard 1)) | P=0.250802606344223
2024-10-22 17:01:58,834 - DEBUG - Added Child Node: ((Discard 0), (Play 0)) | P=0.25767314434051514
2024-10-22 17:01:58,835 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B)) | P=0.24558764696121216
2024-10-22 17:01:58,835 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 17:01:58,835 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:58,835 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 6, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 6
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R3 || R3|R3
R4 || R4|R4
B1 || X1|RYGWB1
W1 || X1|RYGWB1
R1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:01:58,835 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:58,835 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:58,835 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:58,835 - DEBUG - Expanding unexplored child: ((Play 3),)
2024-10-22 17:01:58,835 - DEBUG - Traversing Path: ['()', '((Play 3),)']
2024-10-22 17:01:58,836 - DEBUG - Move: (Play 3) | Reward: 6 | Depth: 1
2024-10-22 17:01:59,032 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:59,033 - DEBUG - Network Policy Logits: [[-0.02162226  0.03513627  0.03000542 -0.019248    0.00346977  0.00558191
   0.04676972 -0.00666184 -0.02061785  0.06151184 -0.00125056  0.01391222
  -0.05819159 -0.02667149  0.01546732 -0.01824647  0.02226825 -0.05051509
  -0.00143396 -0.02994994]]
2024-10-22 17:01:59,033 - DEBUG - Network Policy after Softmax: [[0.04895778 0.05181692 0.05155174 0.04907415 0.05020177 0.05030791
  0.05242325 0.04969571 0.04900698 0.05320181 0.04996536 0.05072875
  0.04719977 0.0487112  0.0508077  0.04912333 0.05115441 0.04756349
  0.0499562  0.04855177]]
2024-10-22 17:01:59,035 - DEBUG - Normalized Policy: [[0.         0.34069863 0.         0.         0.         0.33077684
  0.         0.         0.         0.         0.32852453 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:59,036 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 color R)) | P=0.32852452993392944
2024-10-22 17:01:59,036 - DEBUG - Added Child Node: ((Play 3), (Play 0)) | P=0.3307768404483795
2024-10-22 17:01:59,037 - DEBUG - Added Child Node: ((Play 3), (Discard 1)) | P=0.34069862961769104
2024-10-22 17:01:59,037 - DEBUG - Simulating Node: ((Play 3),) | Value: 0.0
2024-10-22 17:01:59,037 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:59,038 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G3 W0 B1 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || X1|RYGWB1
W1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:59,038 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:59,038 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:59,038 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:59,038 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 17:01:59,038 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 17:01:59,039 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 1
2024-10-22 17:01:59,243 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:59,243 - DEBUG - Network Policy Logits: [[-0.01904389  0.014577    0.03806553  0.01697904 -0.00407317 -0.00137208
   0.01868124 -0.01734419  0.00591085  0.04257456  0.00448616 -0.00248988
  -0.05229332 -0.02620207  0.01998397 -0.03251114  0.005509   -0.03663673
  -0.00994964  0.00433428]]
2024-10-22 17:01:59,243 - DEBUG - Network Policy after Softmax: [[0.04911875 0.05079824 0.05200554 0.05092041 0.04985962 0.04999448
  0.05100716 0.04920231 0.05035992 0.05224057 0.05028823 0.04993863
  0.04751243 0.04876841 0.05107365 0.04846169 0.05033969 0.04826217
  0.04956749 0.05028059]]
2024-10-22 17:01:59,245 - DEBUG - Normalized Policy: [[0.         0.33623198 0.         0.         0.         0.3309119
  0.         0.         0.         0.         0.33285618 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:59,246 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color R)) | P=0.3328561782836914
2024-10-22 17:01:59,247 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0)) | P=0.33091190457344055
2024-10-22 17:01:59,247 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1)) | P=0.3362319767475128
2024-10-22 17:01:59,247 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 17:01:59,248 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:59,248 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || X1|RYGWB1
W1 || X1|RYGWB1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:59,248 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:59,248 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:59,248 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:59,248 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:01:59,248 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:01:59,249 - DEBUG - Move: (Reveal player +1 color B) | Reward: 5 | Depth: 1
2024-10-22 17:01:59,457 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:59,458 - DEBUG - Network Policy Logits: [[-0.02201627  0.02030746  0.04090234  0.01289988 -0.01204637  0.00897937
   0.03438864 -0.03120112 -0.00524416  0.03465666  0.00901571 -0.00647167
  -0.06150478 -0.02384931  0.01154733 -0.0312864   0.00362792 -0.02072411
  -0.00710854  0.00354781]]
2024-10-22 17:01:59,458 - DEBUG - Network Policy after Softmax: [[0.04899791 0.05111619 0.05217984 0.05073895 0.04948885 0.05054041
  0.05184106 0.04854993 0.04982664 0.05185496 0.05054225 0.04976551
  0.04710076 0.04890818 0.05067036 0.04854579 0.05027067 0.04906126
  0.04973383 0.05026664]]
2024-10-22 17:01:59,459 - DEBUG - Normalized Policy: [[0.         0.3394963  0.         0.         0.         0.33567217
  0.         0.         0.         0.         0.         0.
  0.         0.32483146 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:59,460 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color W)) | P=0.32483145594596863
2024-10-22 17:01:59,461 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 0)) | P=0.33567216992378235
2024-10-22 17:01:59,461 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1)) | P=0.33949631452560425
2024-10-22 17:01:59,461 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:01:59,461 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:59,461 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
W1 || X1|RYGWB1
B1 || X1|RYGWB1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:59,461 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:59,462 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:59,462 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:59,462 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.31655991077423096 | PUCT: 0.31655991077423096
2024-10-22 17:01:59,463 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.40757185220718384 | PUCT: 0.40757185220718384
2024-10-22 17:01:59,463 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.30465906858444214 | PUCT: 0.30465906858444214
2024-10-22 17:01:59,463 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.644416868686676 | PUCT: 0.644416868686676
2024-10-22 17:01:59,464 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.644416868686676
2024-10-22 17:01:59,464 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:59,464 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 color W))
2024-10-22 17:01:59,464 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 color W))']
2024-10-22 17:01:59,464 - DEBUG - Move: (Reveal player +1 color B) | Reward: 5 | Depth: 1
2024-10-22 17:01:59,465 - DEBUG - Move: (Reveal player +1 color W) | Reward: 5 | Depth: 2
2024-10-22 17:01:59,689 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:59,689 - DEBUG - Network Policy Logits: [[ 0.00830063  0.01937106  0.01591236  0.02305306  0.0347916  -0.03078746
  -0.00312298  0.02329306  0.0031579   0.01642227  0.03887764 -0.03435459
  -0.03151244 -0.00271782  0.05265214 -0.01469208  0.02061155  0.01565448
  -0.01148565  0.01954338]]
2024-10-22 17:01:59,689 - DEBUG - Network Policy after Softmax: [[0.0499942  0.05055073 0.0503762  0.0507372  0.05133629 0.04807772
  0.04942634 0.05074938 0.04973775 0.05040189 0.05154648 0.04790653
  0.04804288 0.04944636 0.05226142 0.04885782 0.05061348 0.0503632
  0.04901472 0.05055944]]
2024-10-22 17:01:59,692 - DEBUG - Normalized Policy: [[0.3364579  0.         0.         0.         0.         0.
  0.         0.         0.33473203 0.         0.         0.
  0.         0.         0.         0.32881013 0.         0.
  0.         0.        ]]
2024-10-22 17:01:59,693 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color W), (Discard 0)) | P=0.33645790815353394
2024-10-22 17:01:59,694 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color W), (Play 3)) | P=0.3347320258617401
2024-10-22 17:01:59,695 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color W), (Reveal player +1 rank 1)) | P=0.3288101255893707
2024-10-22 17:01:59,695 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Reveal player +1 color W)) | Value: 0.0
2024-10-22 17:01:59,695 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:59,695 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': 'W', 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || X1|RYGB1
XX || W1|W1
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || BX|B12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:59,695 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:59,696 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:59,696 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:59,697 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.32989630103111267 | PUCT: 0.32989630103111267
2024-10-22 17:01:59,697 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.4247424900531769 | PUCT: 0.4247424900531769
2024-10-22 17:01:59,698 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.31749409437179565 | PUCT: 0.31749409437179565
2024-10-22 17:01:59,698 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.44771042466163635 | PUCT: 0.44771042466163635
2024-10-22 17:01:59,698 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.44771042466163635
2024-10-22 17:01:59,699 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:01:59,699 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Discard 1))
2024-10-22 17:01:59,699 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Discard 1))']
2024-10-22 17:01:59,700 - DEBUG - Move: (Reveal player +1 color B) | Reward: 5 | Depth: 1
2024-10-22 17:01:59,701 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 2
2024-10-22 17:01:59,922 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:59,922 - DEBUG - Network Policy Logits: [[-0.00070608  0.01739871  0.01466979  0.00732363  0.04292577  0.01403575
   0.004618    0.05511413 -0.01758615  0.03491943  0.01383693 -0.04560048
  -0.01811115 -0.0135987   0.03971545 -0.03367666  0.05636164  0.00488268
   0.00387271  0.00172106]]
2024-10-22 17:01:59,923 - DEBUG - Network Policy after Softmax: [[0.04949417 0.05039841 0.05026107 0.04989319 0.0517015  0.0502292
  0.04975838 0.0523355  0.04866571 0.0512892  0.05021922 0.0473213
  0.04864017 0.04886015 0.05153578 0.04788892 0.05240083 0.04977155
  0.04972131 0.04961444]]
2024-10-22 17:01:59,926 - DEBUG - Normalized Policy: [[0.2504961  0.         0.         0.         0.         0.
  0.         0.         0.24630319 0.         0.         0.
  0.         0.         0.26082897 0.24237175 0.         0.
  0.         0.        ]]
2024-10-22 17:01:59,926 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1), (Discard 0)) | P=0.2504960894584656
2024-10-22 17:01:59,927 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1), (Play 3)) | P=0.24630318582057953
2024-10-22 17:01:59,928 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1), (Reveal player +1 rank 1)) | P=0.24237175285816193
2024-10-22 17:01:59,928 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 1), (Reveal player +1 color B)) | P=0.26082897186279297
2024-10-22 17:01:59,929 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Discard 1)) | Value: 0.0
2024-10-22 17:01:59,929 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:59,929 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || X1|RYGWB1
XX || X1|RYGWB1
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B1 || BX|B12345
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 B5}
2024-10-22 17:01:59,929 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:59,929 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:59,929 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:59,930 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.34102749824523926 | PUCT: 0.34102749824523926
2024-10-22 17:01:59,931 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.43907395005226135 | PUCT: 0.43907395005226135
2024-10-22 17:01:59,931 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3282068371772766 | PUCT: 0.3282068371772766
2024-10-22 17:01:59,932 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.34711262583732605 | PUCT: 0.34711262583732605
2024-10-22 17:01:59,932 - DEBUG - Selected Child: ((Play 3),) | PUCT: 0.43907395005226135
2024-10-22 17:01:59,933 - DEBUG - Selected child for exploration: ((Play 3),)
2024-10-22 17:01:59,933 - DEBUG - Expanding unexplored child: ((Play 3), (Play 0))
2024-10-22 17:01:59,933 - DEBUG - Traversing Path: ['()', '((Play 3),)', '((Play 3), (Play 0))']
2024-10-22 17:01:59,934 - DEBUG - Move: (Play 3) | Reward: 6 | Depth: 1
2024-10-22 17:01:59,934 - DEBUG - Move: (Play 0) | Reward: 7 | Depth: 2
2024-10-22 17:02:00,146 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:00,148 - DEBUG - Network Policy Logits: [[-0.02415765  0.0312797   0.00427287 -0.00919228 -0.00483616  0.03829508
  -0.0141196   0.00885059 -0.01686629  0.02986976  0.02983803 -0.01430497
  -0.08640683 -0.03657115  0.05278534 -0.04327377  0.02960584 -0.01003161
  -0.0155856  -0.01497205]]
2024-10-22 17:02:00,148 - DEBUG - Network Policy after Softmax: [[0.0489419  0.05173173 0.05035331 0.04967984 0.04989673 0.05209592
  0.04943566 0.05058435 0.04930006 0.05165884 0.0516572  0.0494265
  0.04598819 0.04833812 0.0528563  0.04801521 0.05164521 0.04963816
  0.04936324 0.04939353]]
2024-10-22 17:02:00,150 - DEBUG - Normalized Policy: [[0.24239545 0.         0.         0.         0.         0.2580164
  0.         0.         0.         0.         0.         0.
  0.         0.         0.26178235 0.2378058  0.         0.
  0.         0.        ]]
2024-10-22 17:02:00,151 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Play 0)) | P=0.2580164074897766
2024-10-22 17:02:00,152 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Discard 0)) | P=0.24239544570446014
2024-10-22 17:02:00,152 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Reveal player +1 rank 1)) | P=0.2378057986497879
2024-10-22 17:02:00,153 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Reveal player +1 color B)) | P=0.26178234815597534
2024-10-22 17:02:00,153 - DEBUG - Simulating Node: ((Play 3), (Play 0)) | Value: 0.0
2024-10-22 17:02:00,153 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:00,153 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 1, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R1 Y2 G4 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || X1|RYGWB1
XX || XX|RYGWB12345
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:00,153 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:00,153 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:02:00,153 - DEBUG - --- Rollout #9 ---
2024-10-22 17:02:00,155 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.35055267810821533 | PUCT: 0.35055267810821533
2024-10-22 17:02:00,155 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.3008917570114136 | PUCT: 0.3008917570114136
2024-10-22 17:02:00,156 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.33737391233444214 | PUCT: 0.33737391233444214
2024-10-22 17:02:00,156 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.35680776834487915 | PUCT: 0.35680776834487915
2024-10-22 17:02:00,156 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.35680776834487915
2024-10-22 17:02:00,156 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:02:00,156 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Play 0))
2024-10-22 17:02:00,157 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Play 0))']
2024-10-22 17:02:00,157 - DEBUG - Move: (Reveal player +1 color B) | Reward: 5 | Depth: 1
2024-10-22 17:02:00,158 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 2
2024-10-22 17:02:00,468 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:00,468 - DEBUG - Network Policy Logits: [[-0.00141938  0.01973085  0.01807198 -0.00288336  0.05515093  0.02636824
  -0.00744862  0.03847605 -0.02021805  0.03043297  0.00462258 -0.03989544
  -0.04167295 -0.02637316  0.03641158 -0.03970725  0.04991487 -0.00608394
  -0.00216018  0.00687021]]
2024-10-22 17:02:00,469 - DEBUG - Network Policy after Softmax: [[0.04966422 0.05072582 0.05064174 0.04959157 0.05255473 0.05106362
  0.04936568 0.05168565 0.04873932 0.05127161 0.0499652  0.04778963
  0.04770476 0.04844025 0.05157906 0.04779863 0.05228027 0.0494331
  0.04962745 0.05007763]]
2024-10-22 17:02:00,471 - DEBUG - Normalized Policy: [[0.25110686 0.         0.         0.         0.         0.
  0.         0.         0.24643044 0.         0.         0.
  0.         0.         0.26078844 0.24167423 0.         0.
  0.         0.        ]]
2024-10-22 17:02:00,472 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 0), (Discard 0)) | P=0.251106858253479
2024-10-22 17:02:00,472 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 0), (Play 3)) | P=0.246430441737175
2024-10-22 17:02:00,473 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 0), (Reveal player +1 rank 1)) | P=0.24167422950267792
2024-10-22 17:02:00,474 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Play 0), (Reveal player +1 color B)) | P=0.2607884407043457
2024-10-22 17:02:00,474 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Play 0)) | Value: 0.0
2024-10-22 17:02:00,474 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:00,474 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || X1|RYGWB1
XX || X1|RYGWB1
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || BX|B12345
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:00,474 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:00,474 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:02:00,474 - DEBUG - --- Rollout #10 ---
2024-10-22 17:02:00,475 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.35885903239250183 | PUCT: 0.35885903239250183
2024-10-22 17:02:00,476 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.3080213963985443 | PUCT: 0.3080213963985443
2024-10-22 17:02:00,476 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.34536799788475037 | PUCT: 0.34536799788475037
2024-10-22 17:02:00,477 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.2922098934650421 | PUCT: 0.2922098934650421
2024-10-22 17:02:00,477 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.35885903239250183
2024-10-22 17:02:00,477 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:02:00,477 - DEBUG - Expanding unexplored child: ((Discard 0), (Discard 1))
2024-10-22 17:02:00,477 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Discard 1))']
2024-10-22 17:02:00,478 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 1
2024-10-22 17:02:00,478 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 2
2024-10-22 17:02:00,674 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:00,674 - DEBUG - Network Policy Logits: [[-0.04608252  0.02642573  0.01833309 -0.0182451  -0.03253403  0.00788566
  -0.00802398  0.02743444 -0.01355347  0.01822843  0.05207474 -0.00400656
  -0.05265682 -0.03248644  0.05075184 -0.03030002  0.02096541  0.0055464
   0.00875205 -0.01005449]]
2024-10-22 17:02:00,674 - DEBUG - Network Policy after Softmax: [[0.04775586 0.05134718 0.05093332 0.04910394 0.04840729 0.05040397
  0.04960841 0.051399   0.04933486 0.05092799 0.05268122 0.04980811
  0.04744293 0.04840959 0.05261157 0.04851555 0.05106758 0.0502862
  0.05044766 0.04950778]]
2024-10-22 17:02:00,676 - DEBUG - Normalized Policy: [[0.23844312 0.         0.         0.         0.         0.
  0.         0.2566332  0.         0.         0.         0.
  0.         0.         0.2626875  0.24223621 0.         0.
  0.         0.        ]]
2024-10-22 17:02:00,677 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Discard 0)) | P=0.23844312131404877
2024-10-22 17:02:00,678 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Reveal player +1 rank 1)) | P=0.2422362118959427
2024-10-22 17:02:00,678 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Reveal player +1 color B)) | P=0.2626875042915344
2024-10-22 17:02:00,679 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Play 2)) | P=0.2566331923007965
2024-10-22 17:02:00,679 - DEBUG - Simulating Node: ((Discard 0), (Discard 1)) | Value: 0.0
2024-10-22 17:02:00,679 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:00,680 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 7, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 7
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R3|R3
XX || R4|R4
XX || X1|RYGWB1
XX || X1|RYGWB1
XX || XX|RYGWB12345
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2 B5}
2024-10-22 17:02:00,680 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:00,680 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:02:00,680 - INFO - === MCTS Search Completed ===
2024-10-22 17:02:00,680 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color B),) | Visit Count: 4
2024-10-22 17:02:00,680 - INFO - Actual Game Score: 5
2024-10-22 17:02:00,680 - DEBUG - === Recording Training Data ===
2024-10-22 17:02:00,680 - DEBUG - State Vector Shape: 658
2024-10-22 17:02:00,680 - DEBUG - Policy Targets: [0.22222222 0.         0.         0.         0.         0.
 0.         0.         0.22222222 0.         0.         0.
 0.         0.         0.44444444 0.11111111 0.         0.
 0.         0.        ]
2024-10-22 17:02:00,680 - DEBUG - === End of Training Data ===
2024-10-22 17:02:00,681 - INFO - Chosen Action: (Reveal player +1 color B) | Visit Count: 4
2024-10-22 17:02:02,823 - DEBUG - Not the current player's turn.
2024-10-22 17:02:02,824 - INFO - Agent state has been reset.
2024-10-22 17:02:02,824 - INFO - === Starting MCTS Search ===
2024-10-22 17:02:02,824 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || X1|YGWB1
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || BX|B12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:02,824 - INFO - Max Rollouts: 10
2024-10-22 17:02:02,824 - DEBUG - --- Rollout #1 ---
2024-10-22 17:02:02,824 - DEBUG - Node () is a leaf node.
2024-10-22 17:02:02,824 - DEBUG - Traversing Path: ['()']
2024-10-22 17:02:03,028 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:03,028 - DEBUG - Network Policy Logits: [[ 0.02705725  0.0135242   0.03675027  0.03046801  0.03037686 -0.01363259
   0.00787372  0.0249064  -0.00140289  0.00083059  0.03688316 -0.03084528
  -0.0170072   0.00373054  0.08283392 -0.02059243  0.02901096  0.01506454
  -0.02266733  0.01355084]]
2024-10-22 17:02:03,029 - DEBUG - Network Policy after Softmax: [[0.05072418 0.05004235 0.05121824 0.05089748 0.05089284 0.04870164
  0.04976038 0.0506152  0.04930091 0.04941114 0.05122504 0.04787054
  0.04853757 0.04955464 0.05363379 0.04836387 0.05082338 0.05011949
  0.04826362 0.05004368]]
2024-10-22 17:02:03,031 - DEBUG - Normalized Policy: [[0.34183258 0.         0.         0.         0.         0.
  0.         0.         0.3322411  0.         0.         0.
  0.         0.         0.         0.32592633 0.         0.
  0.         0.        ]]
2024-10-22 17:02:03,032 - DEBUG - Dirichlet Noise Added: [0.25637445 0.         0.         0.         0.         0.
 0.         0.         0.24918082 0.         0.         0.
 0.         0.         0.         0.49444473 0.         0.
 0.         0.        ]
2024-10-22 17:02:03,032 - DEBUG - Added Child Node: ((Discard 0),) | P=0.25637444853782654
2024-10-22 17:02:03,033 - DEBUG - Added Child Node: ((Play 3),) | P=0.24918082356452942
2024-10-22 17:02:03,034 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.49444472789764404
2024-10-22 17:02:03,034 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:02:03,034 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:03,034 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || X1|YGWB1
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || BX|B12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:03,034 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:03,034 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:02:03,034 - DEBUG - --- Rollout #2 ---
2024-10-22 17:02:03,035 - DEBUG - Expanding unexplored child: ((Discard 0),)
2024-10-22 17:02:03,035 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 17:02:03,036 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 1
2024-10-22 17:02:03,257 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:03,258 - DEBUG - Network Policy Logits: [[ 0.00621475  0.02955722  0.03325312  0.00701121  0.01520691  0.02684548
   0.02188643 -0.01461219 -0.04515487  0.04377348  0.0101296  -0.02313784
  -0.05367766 -0.00446724 -0.00298842 -0.00089916  0.0122269  -0.01825822
  -0.02883609  0.00809441]]
2024-10-22 17:02:03,258 - DEBUG - Network Policy after Softmax: [[0.05024024 0.05142677 0.05161719 0.05028027 0.05069405 0.0512875
  0.05103379 0.04920471 0.04772459 0.05216309 0.05043731 0.04878699
  0.04731957 0.04970644 0.04978    0.04988411 0.0505432  0.04902564
  0.04850978 0.05033477]]
2024-10-22 17:02:03,259 - DEBUG - Normalized Policy: [[0.         0.25420436 0.         0.         0.         0.25351596
  0.         0.         0.         0.         0.         0.
  0.         0.24570072 0.         0.24657895 0.         0.
  0.         0.        ]]
2024-10-22 17:02:03,260 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color W)) | P=0.24570071697235107
2024-10-22 17:02:03,261 - DEBUG - Added Child Node: ((Discard 0), (Discard 1)) | P=0.2542043626308441
2024-10-22 17:02:03,261 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1)) | P=0.24657894670963287
2024-10-22 17:02:03,262 - DEBUG - Added Child Node: ((Discard 0), (Play 0)) | P=0.25351595878601074
2024-10-22 17:02:03,262 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 17:02:03,262 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:03,262 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || X1|YGWB1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:03,262 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:03,262 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:02:03,263 - DEBUG - --- Rollout #3 ---
2024-10-22 17:02:03,263 - DEBUG - Expanding unexplored child: ((Play 3),)
2024-10-22 17:02:03,263 - DEBUG - Traversing Path: ['()', '((Play 3),)']
2024-10-22 17:02:03,264 - DEBUG - Move: (Play 3) | Reward: 6 | Depth: 1
2024-10-22 17:02:03,462 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:03,463 - DEBUG - Network Policy Logits: [[-0.02704415  0.04319601  0.02381002 -0.00043476  0.00884409  0.00025999
   0.02786844 -0.00648732 -0.02471655  0.0625983  -0.00595438 -0.0030493
  -0.05003659 -0.0084964   0.01376428 -0.02562955  0.00639874 -0.03923711
  -0.0039519  -0.01655489]]
2024-10-22 17:02:03,463 - DEBUG - Network Policy after Softmax: [[0.04870943 0.05225382 0.05125058 0.05002296 0.05048927 0.05005773
  0.051459   0.04972111 0.04882294 0.05327756 0.04974761 0.04989234
  0.04760226 0.04962131 0.0507383  0.04877838 0.05036596 0.04811913
  0.04984733 0.04922305]]
2024-10-22 17:02:03,465 - DEBUG - Normalized Policy: [[0.         0.2589024  0.         0.         0.         0.24802142
  0.         0.         0.         0.         0.         0.
  0.         0.         0.2513935  0.24168265 0.         0.
  0.         0.        ]]
2024-10-22 17:02:03,466 - DEBUG - Added Child Node: ((Play 3), (Play 0)) | P=0.2480214238166809
2024-10-22 17:02:03,466 - DEBUG - Added Child Node: ((Play 3), (Discard 1)) | P=0.2589024007320404
2024-10-22 17:02:03,467 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 rank 1)) | P=0.24168264865875244
2024-10-22 17:02:03,468 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 color B)) | P=0.25139349699020386
2024-10-22 17:02:03,468 - DEBUG - Simulating Node: ((Play 3),) | Value: 0.0
2024-10-22 17:02:03,468 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:03,468 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 1, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R1 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
B1 || X1|YGWB1
W1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:03,468 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:03,468 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:02:03,468 - DEBUG - --- Rollout #4 ---
2024-10-22 17:02:03,469 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 17:02:03,469 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 17:02:03,470 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 1
2024-10-22 17:02:03,665 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:03,665 - DEBUG - Network Policy Logits: [[-0.00982851  0.01128832  0.03511564  0.0202876  -0.00386219 -0.0201287
   0.01774572 -0.01624108  0.0122433   0.03651126 -0.00304034 -0.00048571
  -0.06283076 -0.01791054  0.0119353  -0.03582444  0.00645822 -0.02422626
  -0.01160967  0.0104697 ]]
2024-10-22 17:02:03,665 - DEBUG - Network Policy after Softmax: [[0.04960648 0.05066516 0.05188686 0.05112316 0.04990334 0.04909815
  0.05099338 0.0492894  0.05071356 0.05195933 0.04994437 0.05007212
  0.04704569 0.04920718 0.05069795 0.04833354 0.05042103 0.04889738
  0.04951821 0.0506237 ]]
2024-10-22 17:02:03,667 - DEBUG - Normalized Policy: [[0.         0.34010196 0.         0.         0.         0.32958308
  0.         0.         0.         0.         0.         0.
  0.         0.33031496 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:03,668 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color W)) | P=0.330314964056015
2024-10-22 17:02:03,668 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0)) | P=0.329583078622818
2024-10-22 17:02:03,669 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1)) | P=0.340101957321167
2024-10-22 17:02:03,669 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 17:02:03,669 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:03,669 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || X1|YGWB1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:03,669 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:03,669 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:02:03,669 - DEBUG - --- Rollout #5 ---
2024-10-22 17:02:03,670 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4065574109554291 | PUCT: 0.4065574109554291
2024-10-22 17:02:03,671 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.39514976739883423 | PUCT: 0.39514976739883423
2024-10-22 17:02:03,671 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.784088134765625 | PUCT: 0.784088134765625
2024-10-22 17:02:03,671 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.784088134765625
2024-10-22 17:02:03,671 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:02:03,671 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 color W))
2024-10-22 17:02:03,671 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 color W))']
2024-10-22 17:02:03,672 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 1
2024-10-22 17:02:03,673 - DEBUG - Move: (Reveal player +1 color W) | Reward: 5 | Depth: 2
2024-10-22 17:02:03,894 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:03,894 - DEBUG - Network Policy Logits: [[ 9.0034753e-03  1.8238012e-02  1.5029185e-02  1.7001731e-02
   2.9552244e-02 -7.4809119e-03 -4.3664668e-03  2.0628834e-02
  -3.6275983e-03  1.8669507e-03  3.8763274e-02 -2.9681219e-02
  -3.4631643e-02 -1.2199394e-05  5.4927967e-02 -2.8237278e-02
   3.1136289e-02  3.9653555e-02 -2.1070316e-02  2.1384344e-02]]
2024-10-22 17:02:03,894 - DEBUG - Network Policy after Softmax: [[0.05001531 0.05047932 0.0503176  0.05041695 0.0510537  0.0491976
  0.04935106 0.05060015 0.04938754 0.04965965 0.05152613 0.04811743
  0.04787982 0.04956642 0.0523658  0.04818696 0.05113463 0.05157202
  0.04853355 0.05063839]]
2024-10-22 17:02:03,896 - DEBUG - Normalized Policy: [[0.33958724 0.         0.         0.         0.         0.
  0.         0.         0.33532485 0.         0.         0.
  0.32508796 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:03,897 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color W), (Discard 0)) | P=0.3395872414112091
2024-10-22 17:02:03,897 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color W), (Play 3)) | P=0.33532485365867615
2024-10-22 17:02:03,898 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color W), (Reveal player +1 color G)) | P=0.3250879645347595
2024-10-22 17:02:03,898 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Reveal player +1 color W)) | Value: 0.0
2024-10-22 17:02:03,898 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:03,898 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:03,898 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:03,898 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:02:03,898 - DEBUG - --- Rollout #6 ---
2024-10-22 17:02:03,899 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4289677143096924 | PUCT: 0.4289677143096924
2024-10-22 17:02:03,899 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.41693127155303955 | PUCT: 0.41693127155303955
2024-10-22 17:02:03,899 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.5515391826629639 | PUCT: 0.5515391826629639
2024-10-22 17:02:03,900 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.5515391826629639
2024-10-22 17:02:03,900 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:02:03,900 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Discard 1))
2024-10-22 17:02:03,900 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Discard 1))']
2024-10-22 17:02:03,900 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 1
2024-10-22 17:02:03,901 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 2
2024-10-22 17:02:04,106 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:04,106 - DEBUG - Network Policy Logits: [[-0.00894628  0.01661296  0.00540936  0.0083024   0.04967886  0.02398022
   0.00977183  0.04128604 -0.02309496  0.02853665  0.00916574 -0.03057482
  -0.02670704 -0.00124048  0.0467703  -0.04094557  0.0552816   0.0245695
  -0.0091434   0.0135452 ]]
2024-10-22 17:02:04,107 - DEBUG - Network Policy after Softmax: [[0.04906304 0.05033322 0.04977245 0.04991665 0.05202536 0.05070541
  0.04999006 0.05159054 0.04837376 0.05093697 0.04995977 0.04801327
  0.04819934 0.04944257 0.05187425 0.04751791 0.05231766 0.05073529
  0.04905337 0.05017905]]
2024-10-22 17:02:04,108 - DEBUG - Normalized Policy: [[0.24926738 0.         0.         0.         0.         0.
  0.         0.         0.24576543 0.         0.         0.
  0.         0.         0.2635499  0.24141729 0.         0.
  0.         0.        ]]
2024-10-22 17:02:04,109 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1), (Discard 0)) | P=0.24926738440990448
2024-10-22 17:02:04,111 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1), (Play 3)) | P=0.24576543271541595
2024-10-22 17:02:04,112 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1), (Reveal player +1 rank 1)) | P=0.2414172887802124
2024-10-22 17:02:04,113 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1), (Reveal player +1 color B)) | P=0.26354989409446716
2024-10-22 17:02:04,113 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Discard 1)) | Value: 0.0
2024-10-22 17:02:04,113 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:04,113 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || X1|YGWB1
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 B5}
2024-10-22 17:02:04,113 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:04,113 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:02:04,113 - DEBUG - --- Rollout #7 ---
2024-10-22 17:02:04,114 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.44703978300094604 | PUCT: 0.44703978300094604
2024-10-22 17:02:04,114 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.4344962239265442 | PUCT: 0.4344962239265442
2024-10-22 17:02:04,115 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.43108129501342773 | PUCT: 0.43108129501342773
2024-10-22 17:02:04,115 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.44703978300094604
2024-10-22 17:02:04,115 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:02:04,115 - DEBUG - Expanding unexplored child: ((Discard 0), (Discard 1))
2024-10-22 17:02:04,115 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Discard 1))']
2024-10-22 17:02:04,116 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 1
2024-10-22 17:02:04,117 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 2
2024-10-22 17:02:04,320 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:04,321 - DEBUG - Network Policy Logits: [[-0.00240666  0.02720676  0.02489712 -0.00229907  0.00463966 -0.01019842
   0.00644498  0.02749358 -0.01854953  0.00867845  0.05056185  0.00521353
  -0.0400033  -0.00664879  0.03896237 -0.02106511  0.03698556  0.01007659
   0.00736844 -0.02209312]]
2024-10-22 17:02:04,321 - DEBUG - Network Policy after Softmax: [[0.04955582 0.05104528 0.05092752 0.04956115 0.04990624 0.04917119
  0.04999642 0.05105993 0.04876227 0.05010821 0.05225148 0.04993489
  0.04772728 0.04934604 0.05164889 0.04863976 0.05154689 0.05017832
  0.05004261 0.04858978]]
2024-10-22 17:02:04,323 - DEBUG - Normalized Policy: [[0.33202004 0.         0.         0.         0.         0.
  0.         0.34209743 0.         0.         0.         0.
  0.         0.         0.         0.3258825  0.         0.
  0.         0.        ]]
2024-10-22 17:02:04,324 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Discard 0)) | P=0.3320200443267822
2024-10-22 17:02:04,324 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Reveal player +1 rank 1)) | P=0.3258824944496155
2024-10-22 17:02:04,325 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Play 2)) | P=0.3420974314212799
2024-10-22 17:02:04,325 - DEBUG - Simulating Node: ((Discard 0), (Discard 1)) | Value: 0.0
2024-10-22 17:02:04,325 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:04,325 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || X1|YGWB1
XX || XX|RYGWB12345
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B1 || BX|B12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2 B5}
2024-10-22 17:02:04,325 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:04,326 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:02:04,326 - DEBUG - --- Rollout #8 ---
2024-10-22 17:02:04,326 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.30808237195014954 | PUCT: 0.30808237195014954
2024-10-22 17:02:04,327 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.449156790971756 | PUCT: 0.449156790971756
2024-10-22 17:02:04,327 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4456266164779663 | PUCT: 0.4456266164779663
2024-10-22 17:02:04,328 - DEBUG - Selected Child: ((Play 3),) | PUCT: 0.449156790971756
2024-10-22 17:02:04,328 - DEBUG - Selected child for exploration: ((Play 3),)
2024-10-22 17:02:04,328 - DEBUG - Expanding unexplored child: ((Play 3), (Play 0))
2024-10-22 17:02:04,328 - DEBUG - Traversing Path: ['()', '((Play 3),)', '((Play 3), (Play 0))']
2024-10-22 17:02:04,329 - DEBUG - Move: (Play 3) | Reward: 6 | Depth: 1
2024-10-22 17:02:04,329 - DEBUG - Move: (Play 0) | Reward: 7 | Depth: 2
2024-10-22 17:02:04,530 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:04,530 - DEBUG - Network Policy Logits: [[ 0.00897618  0.03903876  0.0042709  -0.00731972  0.02527418  0.01979046
  -0.00302977  0.01314608 -0.01385643  0.01599017  0.02470299 -0.00200353
  -0.06799224 -0.01347565  0.03997367 -0.03603375  0.04547162  0.00543655
  -0.00483388 -0.0163646 ]]
2024-10-22 17:02:04,531 - DEBUG - Network Policy after Softmax: [[0.05023941 0.05177267 0.05000357 0.04942735 0.05106492 0.05078566
  0.04963984 0.05044934 0.04910531 0.05059303 0.05103576 0.04969081
  0.04651763 0.04912401 0.05182109 0.04802827 0.05210679 0.0500619
  0.04955037 0.0489823 ]]
2024-10-22 17:02:04,533 - DEBUG - Normalized Policy: [[0.33705658 0.         0.         0.         0.         0.3407214
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.32222205 0.         0.
  0.         0.        ]]
2024-10-22 17:02:04,534 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Play 0)) | P=0.34072139859199524
2024-10-22 17:02:04,534 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Discard 0)) | P=0.33705657720565796
2024-10-22 17:02:04,535 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Reveal player +1 rank 1)) | P=0.3222220540046692
2024-10-22 17:02:04,535 - DEBUG - Simulating Node: ((Play 3), (Play 0)) | Value: 0.0
2024-10-22 17:02:04,535 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:04,535 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 1, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R1 Y2 G4 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || X1|YGWB1
XX || XX|RYGWB12345
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || BX|B12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:04,536 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:04,536 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:02:04,536 - DEBUG - --- Rollout #9 ---
2024-10-22 17:02:04,536 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.31668737530708313 | PUCT: 0.31668737530708313
2024-10-22 17:02:04,537 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.30780139565467834 | PUCT: 0.30780139565467834
2024-10-22 17:02:04,537 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.45807334780693054 | PUCT: 0.45807334780693054
2024-10-22 17:02:04,537 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.45807334780693054
2024-10-22 17:02:04,538 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:02:04,538 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Play 0))
2024-10-22 17:02:04,538 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Play 0))']
2024-10-22 17:02:04,538 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 1
2024-10-22 17:02:04,539 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 2
2024-10-22 17:02:04,742 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:04,743 - DEBUG - Network Policy Logits: [[-0.00718587  0.01370533  0.00563576 -0.0009058   0.06047577  0.03207725
  -0.00359524  0.03251896 -0.02605642  0.01727466  0.00193378 -0.02482847
  -0.05014822 -0.01440919  0.04232199 -0.05059693  0.04550515  0.01253377
  -0.01959721  0.01303514]]
2024-10-22 17:02:04,743 - DEBUG - Network Policy after Softmax: [[0.04942338 0.05046676 0.05006115 0.04973474 0.05288318 0.0514025
  0.04960116 0.05142521 0.04849948 0.05064721 0.04987616 0.04855907
  0.047345   0.04906767 0.05193181 0.04732376 0.05209738 0.05040767
  0.04881376 0.05043295]]
2024-10-22 17:02:04,745 - DEBUG - Normalized Policy: [[0.2506531  0.         0.         0.         0.         0.
  0.         0.         0.24596746 0.         0.         0.
  0.         0.         0.2633747  0.24000476 0.         0.
  0.         0.        ]]
2024-10-22 17:02:04,745 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0), (Discard 0)) | P=0.25065308809280396
2024-10-22 17:02:04,746 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0), (Play 3)) | P=0.24596746265888214
2024-10-22 17:02:04,746 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0), (Reveal player +1 rank 1)) | P=0.240004763007164
2024-10-22 17:02:04,747 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0), (Reveal player +1 color B)) | P=0.2633746862411499
2024-10-22 17:02:04,747 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Play 0)) | Value: 0.0
2024-10-22 17:02:04,747 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:04,747 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || X1|YGWB1
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:04,747 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:04,747 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:02:04,747 - DEBUG - --- Rollout #10 ---
2024-10-22 17:02:04,748 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.32419130206108093 | PUCT: 0.32419130206108093
2024-10-22 17:02:04,749 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.3150947690010071 | PUCT: 0.3150947690010071
2024-10-22 17:02:04,749 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3751419186592102 | PUCT: 0.3751419186592102
2024-10-22 17:02:04,749 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.3751419186592102
2024-10-22 17:02:04,749 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:02:04,750 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1), (Reveal player +1 color W)) | Q: 0.0 | U: 0.523811936378479 | PUCT: 0.523811936378479
2024-10-22 17:02:04,750 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1), (Discard 1)) | Q: 0.0 | U: 0.5393320918083191 | PUCT: 0.5393320918083191
2024-10-22 17:02:04,750 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1), (Play 0)) | Q: 0.0 | U: 0.5226512551307678 | PUCT: 0.5226512551307678
2024-10-22 17:02:04,750 - DEBUG - Selected Child: ((Reveal player +1 rank 1), (Discard 1)) | PUCT: 0.5393320918083191
2024-10-22 17:02:04,751 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1), (Discard 1))
2024-10-22 17:02:04,751 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:02:04,751 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Discard 1))', '((Reveal player +1 rank 1), (Discard 1), (Reveal player +1 rank 1))']
2024-10-22 17:02:04,751 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 1
2024-10-22 17:02:04,752 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 2
2024-10-22 17:02:04,753 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 3
2024-10-22 17:02:04,954 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:04,954 - DEBUG - Network Policy Logits: [[-0.00482753  0.00601284  0.0277483   0.02499324  0.02815639 -0.00535982
   0.02650784 -0.01867176  0.00685771  0.00308702  0.00885779 -0.00878591
  -0.06088841 -0.04165769  0.00836882 -0.0371522   0.01861    -0.02923595
  -0.00214685  0.01167695]]
2024-10-22 17:02:04,954 - DEBUG - Network Policy after Softmax: [[0.04983898 0.05038219 0.05148925 0.05134759 0.05151027 0.04981245
  0.05142542 0.04915375 0.05042477 0.05023499 0.05052572 0.04964208
  0.04712183 0.04803679 0.05050103 0.04825371 0.05102087 0.04863721
  0.04997276 0.05066837]]
2024-10-22 17:02:04,957 - DEBUG - Normalized Policy: [[0.3319225  0.         0.         0.         0.         0.33174586
  0.         0.         0.         0.         0.         0.
  0.         0.         0.3363317  0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:04,957 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1), (Reveal player +1 rank 1), (Discard 0)) | P=0.3319225013256073
2024-10-22 17:02:04,958 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1), (Reveal player +1 rank 1), (Play 0)) | P=0.33174586296081543
2024-10-22 17:02:04,959 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 1), (Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.33633169531822205
2024-10-22 17:02:04,959 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Discard 1), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:02:04,959 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:04,959 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || R2|R2
XX || B2|B2
XX || B1|B1
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
B1 || X1|YGWB1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 B5}
2024-10-22 17:02:04,959 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:04,959 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:02:04,959 - INFO - === MCTS Search Completed ===
2024-10-22 17:02:04,959 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 1),) | Visit Count: 5
2024-10-22 17:02:04,959 - INFO - Actual Game Score: 5
2024-10-22 17:02:04,959 - DEBUG - === Recording Training Data ===
2024-10-22 17:02:04,959 - DEBUG - State Vector Shape: 658
2024-10-22 17:02:04,960 - DEBUG - Policy Targets: [0.22222222 0.         0.         0.         0.         0.
 0.         0.         0.22222222 0.         0.         0.
 0.         0.         0.         0.55555556 0.         0.
 0.         0.        ]
2024-10-22 17:02:04,960 - DEBUG - === End of Training Data ===
2024-10-22 17:02:04,960 - INFO - Chosen Action: (Reveal player +1 rank 1) | Visit Count: 5
2024-10-22 17:02:07,079 - DEBUG - Not the current player's turn.
2024-10-22 17:02:07,080 - INFO - Agent state has been reset.
2024-10-22 17:02:07,080 - INFO - === Starting MCTS Search ===
2024-10-22 17:02:07,080 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:07,081 - INFO - Max Rollouts: 10
2024-10-22 17:02:07,081 - DEBUG - --- Rollout #1 ---
2024-10-22 17:02:07,081 - DEBUG - Node () is a leaf node.
2024-10-22 17:02:07,081 - DEBUG - Traversing Path: ['()']
2024-10-22 17:02:07,266 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:07,267 - DEBUG - Network Policy Logits: [[ 0.0187503   0.02022607  0.02703543  0.01877256  0.02691974 -0.00775551
  -0.00246534  0.0248005  -0.0009193  -0.01426985  0.04231453 -0.02905528
  -0.01622469  0.01203993  0.06006269 -0.02306005  0.02777961  0.03984389
  -0.01360173  0.01939058]]
2024-10-22 17:02:07,267 - DEBUG - Network Policy after Softmax: [[0.05034864 0.050423   0.05076751 0.05034976 0.05076165 0.04903164
  0.04929171 0.05065418 0.04936798 0.04871327 0.05154916 0.04799832
  0.04861814 0.05001191 0.05247223 0.04828695 0.05080531 0.05142196
  0.04874583 0.05038089]]
2024-10-22 17:02:07,268 - DEBUG - Normalized Policy: [[0.33942577 0.         0.         0.         0.         0.
  0.         0.         0.33281463 0.         0.         0.
  0.3277596  0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:07,269 - DEBUG - Dirichlet Noise Added: [0.50456935 0.         0.         0.         0.         0.
 0.         0.         0.24961099 0.         0.         0.
 0.24581969 0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:02:07,270 - DEBUG - Added Child Node: ((Discard 0),) | P=0.5045693516731262
2024-10-22 17:02:07,270 - DEBUG - Added Child Node: ((Play 3),) | P=0.2496109902858734
2024-10-22 17:02:07,271 - DEBUG - Added Child Node: ((Reveal player +1 color G),) | P=0.24581968784332275
2024-10-22 17:02:07,271 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:02:07,271 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:07,271 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:07,271 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:07,271 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:02:07,271 - DEBUG - --- Rollout #2 ---
2024-10-22 17:02:07,271 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G),)
2024-10-22 17:02:07,271 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)']
2024-10-22 17:02:07,272 - DEBUG - Move: (Reveal player +1 color G) | Reward: 5 | Depth: 1
2024-10-22 17:02:07,454 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:07,454 - DEBUG - Network Policy Logits: [[-0.0152316   0.02512955  0.03004487  0.02080488 -0.00503523 -0.01315934
   0.01386864 -0.02307474  0.00047825  0.03501245 -0.0035491   0.00221659
  -0.05782572 -0.0157379   0.01903578 -0.02853256  0.00720949 -0.02367827
  -0.01155868  0.01176657]]
2024-10-22 17:02:07,454 - DEBUG - Network Policy after Softmax: [[0.04931034 0.05134127 0.05159425 0.05111971 0.0498157  0.04941263
  0.05076636 0.04892511 0.05009111 0.05185119 0.04988978 0.05017827
  0.04725411 0.04928538 0.05102936 0.04865881 0.05042943 0.04889558
  0.04949179 0.05065976]]
2024-10-22 17:02:07,455 - DEBUG - Normalized Policy: [[0.         0.5095711  0.         0.         0.         0.49042895
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:07,456 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Play 0)) | P=0.49042895436286926
2024-10-22 17:02:07,456 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 1)) | P=0.5095710754394531
2024-10-22 17:02:07,457 - DEBUG - Simulating Node: ((Reveal player +1 color G),) | Value: 0.0
2024-10-22 17:02:07,457 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:07,457 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 0, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 0
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:07,457 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:07,457 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:02:07,457 - DEBUG - --- Rollout #3 ---
2024-10-22 17:02:07,457 - DEBUG - Expanding unexplored child: ((Discard 0),)
2024-10-22 17:02:07,457 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 17:02:07,458 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 1
2024-10-22 17:02:07,641 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:07,641 - DEBUG - Network Policy Logits: [[ 0.01192025  0.01720461  0.03857924  0.0169951   0.02974245  0.00884158
   0.01142987 -0.0035108  -0.02340613  0.04676483  0.00100931 -0.02711889
  -0.05555656 -0.00278548 -0.00530318 -0.00233552  0.01062458 -0.01527754
  -0.03284118  0.01490067]]
2024-10-22 17:02:07,642 - DEBUG - Network Policy after Softmax: [[0.05048433 0.05075181 0.0518483  0.05074118 0.05139214 0.05032915
  0.05045958 0.04971128 0.04873204 0.05227444 0.04993649 0.04855144
  0.0471902  0.04974736 0.04962226 0.04976974 0.05041896 0.04912977
  0.04827441 0.05063502]]
2024-10-22 17:02:07,643 - DEBUG - Normalized Policy: [[0.         0.33643737 0.         0.         0.         0.33363548
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.32992718 0.         0.
  0.         0.        ]]
2024-10-22 17:02:07,644 - DEBUG - Added Child Node: ((Discard 0), (Play 0)) | P=0.33363547921180725
2024-10-22 17:02:07,644 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1)) | P=0.3299271762371063
2024-10-22 17:02:07,645 - DEBUG - Added Child Node: ((Discard 0), (Discard 1)) | P=0.3364373743534088
2024-10-22 17:02:07,645 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 17:02:07,645 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:07,645 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:07,645 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:07,645 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:02:07,645 - DEBUG - --- Rollout #4 ---
2024-10-22 17:02:07,645 - DEBUG - Expanding unexplored child: ((Play 3),)
2024-10-22 17:02:07,645 - DEBUG - Traversing Path: ['()', '((Play 3),)']
2024-10-22 17:02:07,646 - DEBUG - Move: (Play 3) | Reward: 6 | Depth: 1
2024-10-22 17:02:07,839 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:07,839 - DEBUG - Network Policy Logits: [[-0.02431921  0.03253987  0.03971983  0.00509703  0.02589221 -0.00296196
   0.02295854 -0.00191368 -0.00722536  0.05951241 -0.01290472 -0.00823282
  -0.04952262 -0.01511607  0.00565817 -0.02940878  0.00885551 -0.03358707
  -0.01366241  0.00259358]]
2024-10-22 17:02:07,839 - DEBUG - Network Policy after Softmax: [[0.04877279 0.05162632 0.05199833 0.05022881 0.05128426 0.04982564
  0.05113403 0.0498779  0.04961367 0.05303776 0.04933269 0.04956371
  0.04755891 0.04922372 0.050257   0.04852518 0.05041795 0.04832285
  0.04929533 0.05010322]]
2024-10-22 17:02:07,842 - DEBUG - Normalized Policy: [[0.         0.34422788 0.         0.         0.         0.33222157
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.3235505  0.         0.
  0.         0.        ]]
2024-10-22 17:02:07,843 - DEBUG - Added Child Node: ((Play 3), (Play 0)) | P=0.3322215676307678
2024-10-22 17:02:07,843 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 rank 1)) | P=0.3235504925251007
2024-10-22 17:02:07,844 - DEBUG - Added Child Node: ((Play 3), (Discard 1)) | P=0.3442278802394867
2024-10-22 17:02:07,844 - DEBUG - Simulating Node: ((Play 3),) | Value: 0.0
2024-10-22 17:02:07,844 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:07,844 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 1, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R1 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:07,845 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:07,845 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:02:07,845 - DEBUG - --- Rollout #5 ---
2024-10-22 17:02:07,846 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.3898197114467621 | PUCT: 0.3898197114467621
2024-10-22 17:02:07,846 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.8001436591148376 | PUCT: 0.8001436591148376
2024-10-22 17:02:07,847 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.3958319425582886 | PUCT: 0.3958319425582886
2024-10-22 17:02:07,847 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.8001436591148376
2024-10-22 17:02:07,847 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:02:07,847 - DEBUG - Expanding unexplored child: ((Discard 0), (Discard 1))
2024-10-22 17:02:07,847 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Discard 1))']
2024-10-22 17:02:07,848 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 1
2024-10-22 17:02:07,849 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 2
2024-10-22 17:02:08,055 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:08,056 - DEBUG - Network Policy Logits: [[-0.00839269  0.03004879  0.02050118  0.00441339  0.00523676  0.00307611
   0.00717233  0.01762168 -0.01897012  0.0093234   0.04452135  0.02730069
  -0.04294964 -0.00720615  0.04460997 -0.0217644   0.03421863  0.01851437
   0.00238541 -0.02019536]]
2024-10-22 17:02:08,056 - DEBUG - Network Policy after Softmax: [[0.04920049 0.05112865 0.05064282 0.0498346  0.04987565 0.049768
  0.04997228 0.0504972  0.04868282 0.05007989 0.05187399 0.05098834
  0.04752931 0.0492589  0.05187859 0.04854697 0.05134229 0.0505423
  0.04973364 0.0486232 ]]
2024-10-22 17:02:08,057 - DEBUG - Normalized Policy: [[0.33418113 0.         0.         0.         0.         0.
  0.         0.3429887  0.         0.         0.         0.
  0.3228301  0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:08,058 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Discard 0)) | P=0.33418112993240356
2024-10-22 17:02:08,058 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Play 2)) | P=0.3429886996746063
2024-10-22 17:02:08,059 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Reveal player +1 color G)) | P=0.32283011078834534
2024-10-22 17:02:08,059 - DEBUG - Simulating Node: ((Discard 0), (Discard 1)) | Value: 0.0
2024-10-22 17:02:08,059 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:08,059 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
XX || XX|RYGWB12345
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2 B5}
2024-10-22 17:02:08,059 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:08,059 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:02:08,059 - DEBUG - --- Rollout #6 ---
2024-10-22 17:02:08,060 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.4113073945045471 | PUCT: 0.4113073945045471
2024-10-22 17:02:08,060 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.5628328919410706 | PUCT: 0.5628328919410706
2024-10-22 17:02:08,060 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.41765105724334717 | PUCT: 0.41765105724334717
2024-10-22 17:02:08,061 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.5628328919410706
2024-10-22 17:02:08,061 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:02:08,061 - DEBUG - Expanding unexplored child: ((Discard 0), (Play 0))
2024-10-22 17:02:08,061 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Play 0))']
2024-10-22 17:02:08,061 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 1
2024-10-22 17:02:08,062 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 2
2024-10-22 17:02:08,298 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:08,298 - DEBUG - Network Policy Logits: [[-0.00663228  0.02714117  0.02072758 -0.0047948   0.01603367  0.01117314
  -0.00619474  0.0088546  -0.02193158 -0.00193858  0.03728938  0.03304704
  -0.06639083 -0.02037485  0.04016166 -0.03141577  0.02444218  0.00647865
  -0.0080684  -0.02070542]]
2024-10-22 17:02:08,299 - DEBUG - Network Policy after Softmax: [[0.04956167 0.05126413 0.05093639 0.04965282 0.05069786 0.05045204
  0.04958336 0.0503352  0.04880918 0.04979485 0.05178701 0.05156778
  0.04668669 0.04888522 0.05193597 0.04834845 0.05112595 0.05021575
  0.04949054 0.04886907]]
2024-10-22 17:02:08,300 - DEBUG - Normalized Policy: [[0.3264226  0.         0.         0.         0.         0.
  0.         0.33151722 0.         0.         0.         0.
  0.         0.         0.3420602  0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:08,301 - DEBUG - Added Child Node: ((Discard 0), (Play 0), (Discard 0)) | P=0.3264226019382477
2024-10-22 17:02:08,301 - DEBUG - Added Child Node: ((Discard 0), (Play 0), (Reveal player +1 color B)) | P=0.3420602083206177
2024-10-22 17:02:08,302 - DEBUG - Added Child Node: ((Discard 0), (Play 0), (Play 2)) | P=0.33151721954345703
2024-10-22 17:02:08,302 - DEBUG - Simulating Node: ((Discard 0), (Play 0)) | Value: 0.0
2024-10-22 17:02:08,302 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:08,302 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
XX || XX|RYGWB12345
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:08,302 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:08,302 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:02:08,302 - DEBUG - --- Rollout #7 ---
2024-10-22 17:02:08,303 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.42863544821739197 | PUCT: 0.42863544821739197
2024-10-22 17:02:08,303 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4399084150791168 | PUCT: 0.4399084150791168
2024-10-22 17:02:08,304 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.4352463483810425 | PUCT: 0.4352463483810425
2024-10-22 17:02:08,304 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.4399084150791168
2024-10-22 17:02:08,304 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:02:08,304 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 rank 1))
2024-10-22 17:02:08,304 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 rank 1))']
2024-10-22 17:02:08,305 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 1
2024-10-22 17:02:08,305 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 2
2024-10-22 17:02:08,494 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:08,494 - DEBUG - Network Policy Logits: [[ 0.01537186  0.02862642  0.04133942  0.01941833  0.02217687 -0.01859244
  -0.01829663  0.02293655 -0.00520372  0.00240263  0.0421799  -0.00388331
  -0.02943592 -0.01954347  0.05904893 -0.01709001  0.01661135  0.01526539
  -0.00602688  0.01306661]]
2024-10-22 17:02:08,495 - DEBUG - Network Policy after Softmax: [[0.05030508 0.0509763  0.05162849 0.05050906 0.05064858 0.0486252
  0.04863958 0.05068707 0.04928061 0.04965688 0.05167191 0.04934572
  0.04810078 0.04857897 0.05255095 0.04869831 0.05036748 0.05029973
  0.04924005 0.05018925]]
2024-10-22 17:02:08,496 - DEBUG - Normalized Policy: [[0.3374076  0.         0.         0.         0.         0.
  0.         0.33996966 0.         0.         0.         0.
  0.3226228  0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:08,496 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Discard 0)) | P=0.33740758895874023
2024-10-22 17:02:08,497 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Play 2)) | P=0.339969664812088
2024-10-22 17:02:08,498 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 color G)) | P=0.32262280583381653
2024-10-22 17:02:08,498 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:02:08,498 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:08,498 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
XX || X1|RYGWB1
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:08,498 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:08,498 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:02:08,498 - DEBUG - --- Rollout #8 ---
2024-10-22 17:02:08,498 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.443098247051239 | PUCT: 0.443098247051239
2024-10-22 17:02:08,499 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.3638012707233429 | PUCT: 0.3638012707233429
2024-10-22 17:02:08,499 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.44993218779563904 | PUCT: 0.44993218779563904
2024-10-22 17:02:08,499 - DEBUG - Selected Child: ((Play 3),) | PUCT: 0.44993218779563904
2024-10-22 17:02:08,499 - DEBUG - Selected child for exploration: ((Play 3),)
2024-10-22 17:02:08,499 - DEBUG - Expanding unexplored child: ((Play 3), (Play 0))
2024-10-22 17:02:08,499 - DEBUG - Traversing Path: ['()', '((Play 3),)', '((Play 3), (Play 0))']
2024-10-22 17:02:08,500 - DEBUG - Move: (Play 3) | Reward: 6 | Depth: 1
2024-10-22 17:02:08,501 - DEBUG - Move: (Play 0) | Reward: 7 | Depth: 2
2024-10-22 17:02:08,699 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:08,700 - DEBUG - Network Policy Logits: [[ 0.00371788  0.04101763  0.00214557 -0.00574993  0.01931925  0.04020063
  -0.00579049  0.0093537  -0.02083591  0.00814282  0.02103768  0.0221387
  -0.07000176 -0.02069534  0.04567047 -0.03974806  0.04538914  0.01175221
  -0.01917106 -0.01330601]]
2024-10-22 17:02:08,701 - DEBUG - Network Policy after Softmax: [[0.04997862 0.05187802 0.0499001  0.04950767 0.05076447 0.05183565
  0.04950566 0.05026109 0.0487664  0.05020026 0.05085178 0.0509078
  0.04642675 0.04877326 0.05211996 0.04785279 0.0521053  0.05038178
  0.04884766 0.04913499]]
2024-10-22 17:02:08,702 - DEBUG - Normalized Policy: [[0.32467514 0.         0.         0.         0.         0.3367389
  0.         0.         0.         0.         0.         0.
  0.         0.         0.33858588 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:08,703 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Discard 0)) | P=0.32467514276504517
2024-10-22 17:02:08,703 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Play 0)) | P=0.3367389142513275
2024-10-22 17:02:08,704 - DEBUG - Added Child Node: ((Play 3), (Play 0), (Reveal player +1 color B)) | P=0.33858588337898254
2024-10-22 17:02:08,704 - DEBUG - Simulating Node: ((Play 3), (Play 0)) | Value: 0.0
2024-10-22 17:02:08,704 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:08,704 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 1, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R1 Y2 G4 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || W1|W1
XX || XX|RYGWB12345
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:08,704 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:08,704 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:02:08,704 - DEBUG - --- Rollout #9 ---
2024-10-22 17:02:08,705 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.4554743468761444 | PUCT: 0.4554743468761444
2024-10-22 17:02:08,705 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.37396255135536194 | PUCT: 0.37396255135536194
2024-10-22 17:02:08,706 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.30833277106285095 | PUCT: 0.30833277106285095
2024-10-22 17:02:08,706 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.4554743468761444
2024-10-22 17:02:08,706 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:02:08,706 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Discard 1))
2024-10-22 17:02:08,706 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Discard 1))']
2024-10-22 17:02:08,706 - DEBUG - Move: (Reveal player +1 color G) | Reward: 5 | Depth: 1
2024-10-22 17:02:08,707 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 2
2024-10-22 17:02:08,965 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:08,966 - DEBUG - Network Policy Logits: [[-0.01817999  0.01731397 -0.00039601  0.00519103  0.05019441  0.0194956
   0.00384532  0.04196515 -0.02776552  0.01711109  0.02040042 -0.02636926
  -0.024813    0.00160352  0.03491439 -0.038101    0.0572738   0.03368802
  -0.0129414   0.01170923]]
2024-10-22 17:02:08,966 - DEBUG - Network Policy after Softmax: [[0.04867583 0.05043455 0.04954922 0.04982683 0.05212042 0.05054471
  0.04975982 0.05169328 0.04821147 0.05042433 0.05059046 0.04827883
  0.04835403 0.0496484  0.05133008 0.04771575 0.05249072 0.05126717
  0.04893149 0.05015267]]
2024-10-22 17:02:08,968 - DEBUG - Normalized Policy: [[0.24843083 0.         0.         0.         0.         0.
  0.         0.         0.24606085 0.         0.         0.
  0.         0.         0.26197755 0.24353081 0.         0.
  0.         0.        ]]
2024-10-22 17:02:08,968 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 1), (Discard 0)) | P=0.24843083322048187
2024-10-22 17:02:08,969 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 1), (Play 3)) | P=0.24606084823608398
2024-10-22 17:02:08,970 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 1), (Reveal player +1 rank 1)) | P=0.24353080987930298
2024-10-22 17:02:08,970 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 1), (Reveal player +1 color B)) | P=0.26197755336761475
2024-10-22 17:02:08,970 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Discard 1)) | Value: 0.0
2024-10-22 17:02:08,970 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:08,970 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 B5}
2024-10-22 17:02:08,970 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:08,970 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:02:08,971 - DEBUG - --- Rollout #10 ---
2024-10-22 17:02:08,971 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.3108445405960083 | PUCT: 0.3108445405960083
2024-10-22 17:02:08,972 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.3828235864639282 | PUCT: 0.3828235864639282
2024-10-22 17:02:08,972 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.3156387507915497 | PUCT: 0.3156387507915497
2024-10-22 17:02:08,972 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.3828235864639282
2024-10-22 17:02:08,972 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:02:08,973 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Discard 1)) | Q: 0.0 | U: 0.5335208177566528 | PUCT: 0.5335208177566528
2024-10-22 17:02:08,973 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Play 0)) | Q: 0.0 | U: 0.5290775895118713 | PUCT: 0.5290775895118713
2024-10-22 17:02:08,973 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5231969952583313 | PUCT: 0.5231969952583313
2024-10-22 17:02:08,973 - DEBUG - Selected Child: ((Discard 0), (Discard 1)) | PUCT: 0.5335208177566528
2024-10-22 17:02:08,974 - DEBUG - Selected child for exploration: ((Discard 0), (Discard 1))
2024-10-22 17:02:08,974 - DEBUG - Expanding unexplored child: ((Discard 0), (Discard 1), (Discard 0))
2024-10-22 17:02:08,974 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Discard 1))', '((Discard 0), (Discard 1), (Discard 0))']
2024-10-22 17:02:08,974 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 1
2024-10-22 17:02:08,975 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 2
2024-10-22 17:02:08,976 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 3
2024-10-22 17:02:09,172 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:09,173 - DEBUG - Network Policy Logits: [[-0.00837975  0.02070465  0.00763293  0.03906382 -0.00083501  0.01490807
  -0.01082769 -0.00513702  0.01390984  0.01237557  0.03460898 -0.02782479
  -0.07033124 -0.03211812  0.03016386 -0.01419235 -0.0001489  -0.00611276
  -0.01406026  0.01402036]]
2024-10-22 17:02:09,173 - DEBUG - Network Policy after Softmax: [[0.04957404 0.05103704 0.05037424 0.05198269 0.04994947 0.05074206
  0.04945283 0.04973505 0.05069143 0.05061371 0.05175163 0.04861937
  0.04659605 0.04841109 0.05152209 0.04928672 0.04998375 0.04968654
  0.04929323 0.05069703]]
2024-10-22 17:02:09,174 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:02:09,174 - DEBUG - Simulating Node: ((Discard 0), (Discard 1), (Discard 0)) | Value: 0.0
2024-10-22 17:02:09,174 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:09,175 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2 B5 R3}
2024-10-22 17:02:09,175 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:09,175 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:02:09,175 - INFO - === MCTS Search Completed ===
2024-10-22 17:02:09,175 - DEBUG - Best node chosen by MCTS: ((Discard 0),) | Visit Count: 5
2024-10-22 17:02:09,175 - INFO - Actual Game Score: 5
2024-10-22 17:02:09,175 - DEBUG - === Recording Training Data ===
2024-10-22 17:02:09,175 - DEBUG - State Vector Shape: 658
2024-10-22 17:02:09,175 - DEBUG - Policy Targets: [0.55555556 0.         0.         0.         0.         0.
 0.         0.         0.22222222 0.         0.         0.
 0.22222222 0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:02:09,176 - DEBUG - === End of Training Data ===
2024-10-22 17:02:09,176 - INFO - Chosen Action: (Discard 0) | Visit Count: 5
2024-10-22 17:02:11,201 - DEBUG - Not the current player's turn.
2024-10-22 17:02:11,203 - INFO - Agent state has been reset.
2024-10-22 17:02:11,203 - INFO - === Starting MCTS Search ===
2024-10-22 17:02:11,203 - INFO - Initial Observation: {'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
XX || XX|RYGWB12345
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:11,203 - INFO - Max Rollouts: 10
2024-10-22 17:02:11,203 - DEBUG - --- Rollout #1 ---
2024-10-22 17:02:11,203 - DEBUG - Node () is a leaf node.
2024-10-22 17:02:11,203 - DEBUG - Traversing Path: ['()']
2024-10-22 17:02:11,405 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:11,405 - DEBUG - Network Policy Logits: [[ 0.00674303  0.02530513  0.02507891 -0.00621024  0.02136414  0.0030166
  -0.00600446  0.01752641 -0.01453189  0.00306     0.03947411  0.01897483
  -0.05278423 -0.02589816  0.04531026 -0.03572074  0.0218659   0.00095461
  -0.00150165 -0.02118298]]
2024-10-22 17:02:11,406 - DEBUG - Network Policy after Softmax: [[0.0501606  0.05110038 0.05108882 0.04951505 0.05089939 0.04997403
  0.04952524 0.05070443 0.04910471 0.0499762  0.05182958 0.05077792
  0.04726182 0.04854973 0.05213295 0.04807518 0.05092494 0.04987109
  0.04974874 0.04877919]]
2024-10-22 17:02:11,408 - DEBUG - Normalized Policy: [[0.3278514  0.         0.         0.         0.         0.
  0.         0.33140588 0.         0.         0.         0.
  0.         0.         0.34074274 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:11,408 - DEBUG - Dirichlet Noise Added: [0.24654609 0.         0.         0.         0.         0.
 0.         0.24855441 0.         0.         0.         0.
 0.         0.         0.5048995  0.         0.         0.
 0.         0.        ]
2024-10-22 17:02:11,409 - DEBUG - Added Child Node: ((Discard 0),) | P=0.24654608964920044
2024-10-22 17:02:11,410 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.5048995018005371
2024-10-22 17:02:11,411 - DEBUG - Added Child Node: ((Play 2),) | P=0.24855440855026245
2024-10-22 17:02:11,411 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:02:11,411 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:11,411 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
XX || XX|RYGWB12345
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:11,411 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:11,411 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:02:11,411 - DEBUG - --- Rollout #2 ---
2024-10-22 17:02:11,411 - DEBUG - Expanding unexplored child: ((Play 2),)
2024-10-22 17:02:11,411 - DEBUG - Traversing Path: ['()', '((Play 2),)']
2024-10-22 17:02:11,412 - DEBUG - Move: (Play 2) | Reward: 7 | Depth: 1
2024-10-22 17:02:11,621 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:11,622 - DEBUG - Network Policy Logits: [[ 0.00512111  0.00550019 -0.01374334  0.03008979  0.02843868  0.01855065
  -0.02586636 -0.01212814 -0.01201044  0.00696976  0.03282196 -0.03271842
  -0.08332918 -0.02324731  0.02240307  0.00172161 -0.0041417   0.0030692
  -0.01720273  0.00077962]]
2024-10-22 17:02:11,622 - DEBUG - Network Policy after Softmax: [[0.05041331 0.05043242 0.0494712  0.05168791 0.05160264 0.0510949
  0.04887508 0.04955117 0.049557   0.05050659 0.05182932 0.04854133
  0.04614575 0.04900326 0.05129212 0.05024222 0.04994849 0.05030997
  0.04930036 0.05019492]]
2024-10-22 17:02:11,623 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:02:11,623 - DEBUG - Simulating Node: ((Play 2),) | Value: 0.0
2024-10-22 17:02:11,623 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:11,623 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 1, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R1 Y2 G4 W0 B0 
Hands:
Cur player
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:11,623 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:11,623 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:02:11,623 - DEBUG - --- Rollout #3 ---
2024-10-22 17:02:11,624 - DEBUG - Expanding unexplored child: ((Discard 0),)
2024-10-22 17:02:11,624 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 17:02:11,624 - DEBUG - Move: (Discard 0) | Reward: 6 | Depth: 1
2024-10-22 17:02:11,846 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:11,847 - DEBUG - Network Policy Logits: [[-0.00917662  0.01483453 -0.00258688  0.041292    0.00846778  0.01412085
  -0.01879883 -0.00117631  0.01830928  0.01413517  0.04348427 -0.03849933
  -0.07635925 -0.02540712  0.04266405 -0.00884427  0.00495001 -0.00908939
  -0.00358865 -0.00530949]]
2024-10-22 17:02:11,847 - DEBUG - Network Policy after Softmax: [[0.04951625 0.05071958 0.04984362 0.0520794  0.05039769 0.05068339
  0.04904208 0.04991398 0.05089612 0.05068412 0.0521937  0.04808538
  0.0462989  0.04871906 0.05215091 0.04953271 0.05022071 0.04952057
  0.04979372 0.04970811]]
2024-10-22 17:02:11,848 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:02:11,849 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 17:02:11,849 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:11,849 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2 R3}
2024-10-22 17:02:11,849 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:11,849 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:02:11,849 - DEBUG - --- Rollout #4 ---
2024-10-22 17:02:11,849 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:02:11,849 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:02:11,850 - DEBUG - Move: (Reveal player +1 color B) | Reward: 6 | Depth: 1
2024-10-22 17:02:12,072 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:12,073 - DEBUG - Network Policy Logits: [[ 0.01329716 -0.00121946  0.02406318  0.01799475  0.05908189  0.02419048
   0.00670465 -0.00381395 -0.03114557  0.01747898  0.01389863 -0.0533643
  -0.05069335 -0.0086404  -0.01156626  0.00667812  0.03345758 -0.01417444
  -0.01267635  0.00756452]]
2024-10-22 17:02:12,073 - DEBUG - Network Policy after Softmax: [[0.05055792 0.04982929 0.05110517 0.05079598 0.05292651 0.05111168
  0.05022572 0.04970018 0.04836018 0.05076979 0.05058834 0.04729753
  0.04742403 0.04946088 0.04931638 0.05022438 0.05158753 0.04918792
  0.04926166 0.05026892]]
2024-10-22 17:02:12,074 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:02:12,074 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:02:12,074 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:12,074 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:12,074 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:12,074 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:02:12,074 - DEBUG - --- Rollout #5 ---
2024-10-22 17:02:12,075 - DEBUG - PUCT Calculation | Child: ((Play 2),) | Q: 0.0 | U: 0.39415642619132996 | PUCT: 0.39415642619132996
2024-10-22 17:02:12,076 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.3909716010093689 | PUCT: 0.3909716010093689
2024-10-22 17:02:12,076 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.8006672263145447 | PUCT: 0.8006672263145447
2024-10-22 17:02:12,076 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.8006672263145447
2024-10-22 17:02:12,076 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:02:12,076 - DEBUG - Node ((Reveal player +1 color B),) is a leaf node.
2024-10-22 17:02:12,076 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:02:12,077 - DEBUG - Move: (Reveal player +1 color B) | Reward: 6 | Depth: 1
2024-10-22 17:02:12,077 - DEBUG - Node ((Reveal player +1 color B),) already expanded.
2024-10-22 17:02:12,077 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:02:12,077 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:12,078 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:12,078 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:12,078 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:02:12,078 - DEBUG - --- Rollout #6 ---
2024-10-22 17:02:12,079 - DEBUG - PUCT Calculation | Child: ((Play 2),) | Q: 0.0 | U: 0.4158831834793091 | PUCT: 0.4158831834793091
2024-10-22 17:02:12,079 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4125227928161621 | PUCT: 0.4125227928161621
2024-10-22 17:02:12,080 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.5632011294364929 | PUCT: 0.5632011294364929
2024-10-22 17:02:12,080 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.5632011294364929
2024-10-22 17:02:12,080 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:02:12,080 - DEBUG - Node ((Reveal player +1 color B),) is a leaf node.
2024-10-22 17:02:12,080 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:02:12,081 - DEBUG - Move: (Reveal player +1 color B) | Reward: 6 | Depth: 1
2024-10-22 17:02:12,081 - DEBUG - Node ((Reveal player +1 color B),) already expanded.
2024-10-22 17:02:12,081 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:02:12,081 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:12,081 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:12,081 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:12,081 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:02:12,081 - DEBUG - --- Rollout #7 ---
2024-10-22 17:02:12,082 - DEBUG - PUCT Calculation | Child: ((Play 2),) | Q: 0.0 | U: 0.43340399861335754 | PUCT: 0.43340399861335754
2024-10-22 17:02:12,083 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.429902046918869 | PUCT: 0.429902046918869
2024-10-22 17:02:12,083 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.44019627571105957 | PUCT: 0.44019627571105957
2024-10-22 17:02:12,083 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.44019627571105957
2024-10-22 17:02:12,083 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:02:12,084 - DEBUG - Node ((Reveal player +1 color B),) is a leaf node.
2024-10-22 17:02:12,084 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:02:12,085 - DEBUG - Move: (Reveal player +1 color B) | Reward: 6 | Depth: 1
2024-10-22 17:02:12,085 - DEBUG - Node ((Reveal player +1 color B),) already expanded.
2024-10-22 17:02:12,085 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:02:12,085 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:12,085 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:12,085 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:12,085 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:02:12,085 - DEBUG - --- Rollout #8 ---
2024-10-22 17:02:12,086 - DEBUG - PUCT Calculation | Child: ((Play 2),) | Q: 0.0 | U: 0.44802770018577576 | PUCT: 0.44802770018577576
2024-10-22 17:02:12,087 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.44440758228302 | PUCT: 0.44440758228302
2024-10-22 17:02:12,087 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.3640393316745758 | PUCT: 0.3640393316745758
2024-10-22 17:02:12,088 - DEBUG - Selected Child: ((Play 2),) | PUCT: 0.44802770018577576
2024-10-22 17:02:12,088 - DEBUG - Selected child for exploration: ((Play 2),)
2024-10-22 17:02:12,088 - DEBUG - Node ((Play 2),) is a leaf node.
2024-10-22 17:02:12,088 - DEBUG - Traversing Path: ['()', '((Play 2),)']
2024-10-22 17:02:12,089 - DEBUG - Move: (Play 2) | Reward: 7 | Depth: 1
2024-10-22 17:02:12,089 - DEBUG - Node ((Play 2),) already expanded.
2024-10-22 17:02:12,089 - DEBUG - Simulating Node: ((Play 2),) | Value: 0.0
2024-10-22 17:02:12,089 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:12,089 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 1, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R1 Y2 G4 W0 B0 
Hands:
Cur player
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:12,089 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:12,089 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:02:12,089 - DEBUG - --- Rollout #9 ---
2024-10-22 17:02:12,090 - DEBUG - PUCT Calculation | Child: ((Play 2),) | Q: 0.0 | U: 0.3070276379585266 | PUCT: 0.3070276379585266
2024-10-22 17:02:12,090 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4568202495574951 | PUCT: 0.4568202495574951
2024-10-22 17:02:12,090 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.3742072284221649 | PUCT: 0.3742072284221649
2024-10-22 17:02:12,091 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.4568202495574951
2024-10-22 17:02:12,091 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:02:12,091 - DEBUG - Node ((Discard 0),) is a leaf node.
2024-10-22 17:02:12,091 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 17:02:12,092 - DEBUG - Move: (Discard 0) | Reward: 6 | Depth: 1
2024-10-22 17:02:12,092 - DEBUG - Node ((Discard 0),) already expanded.
2024-10-22 17:02:12,092 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 17:02:12,092 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:12,092 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2 R3}
2024-10-22 17:02:12,092 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:12,092 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:02:12,092 - DEBUG - --- Rollout #10 ---
2024-10-22 17:02:12,093 - DEBUG - PUCT Calculation | Child: ((Play 2),) | Q: 0.0 | U: 0.3143026828765869 | PUCT: 0.3143026828765869
2024-10-22 17:02:12,093 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.31176307797431946 | PUCT: 0.31176307797431946
2024-10-22 17:02:12,094 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.3830741047859192 | PUCT: 0.3830741047859192
2024-10-22 17:02:12,094 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.3830741047859192
2024-10-22 17:02:12,094 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:02:12,094 - DEBUG - Node ((Reveal player +1 color B),) is a leaf node.
2024-10-22 17:02:12,094 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:02:12,095 - DEBUG - Move: (Reveal player +1 color B) | Reward: 6 | Depth: 1
2024-10-22 17:02:12,095 - DEBUG - Node ((Reveal player +1 color B),) already expanded.
2024-10-22 17:02:12,095 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:02:12,095 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:12,095 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:12,095 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:12,095 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:02:12,095 - INFO - === MCTS Search Completed ===
2024-10-22 17:02:12,095 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color B),) | Visit Count: 5
2024-10-22 17:02:12,096 - INFO - Actual Game Score: 6
2024-10-22 17:02:12,096 - DEBUG - === Recording Training Data ===
2024-10-22 17:02:12,096 - DEBUG - State Vector Shape: 658
2024-10-22 17:02:12,096 - DEBUG - Policy Targets: [0.22222222 0.         0.         0.         0.         0.
 0.         0.22222222 0.         0.         0.         0.
 0.         0.         0.55555556 0.         0.         0.
 0.         0.        ]
2024-10-22 17:02:12,096 - DEBUG - === End of Training Data ===
2024-10-22 17:02:12,096 - INFO - Chosen Action: (Reveal player +1 color B) | Visit Count: 5
