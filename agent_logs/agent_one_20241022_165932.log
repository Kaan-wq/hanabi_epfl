2024-10-22 16:59:32,673 - INFO - AlphaZero_Agent initialized.
2024-10-22 16:59:32,702 - DEBUG - Not the current player's turn.
2024-10-22 16:59:34,431 - INFO - Agent state has been reset.
2024-10-22 16:59:34,431 - INFO - === Starting MCTS Search ===
2024-10-22 16:59:34,431 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 40, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [], 'card_knowledge': [[{'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X3|RYGWB3
XX || XX|RYGWB1245
XX || XX|RYGWB1245
XX || X3|RYGWB3
XX || XX|RYGWB1245
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 40
Discards:}
2024-10-22 16:59:34,431 - INFO - Max Rollouts: 10
2024-10-22 16:59:34,431 - DEBUG - --- Rollout #1 ---
2024-10-22 16:59:34,432 - DEBUG - Node () is a leaf node.
2024-10-22 16:59:34,432 - DEBUG - Traversing Path: ['()']
2024-10-22 16:59:34,631 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:34,632 - DEBUG - Network Policy Logits: [[ 0.02639473 -0.02124447 -0.01057238 -0.03158404 -0.01740477  0.05340077
  -0.00858508 -0.02075807  0.03608513  0.05950752 -0.0240496  -0.02532065
  -0.07450926  0.00620164  0.05521658  0.01867787 -0.0549234  -0.03377304
   0.08118448 -0.03286496]]
2024-10-22 16:59:34,632 - DEBUG - Network Policy after Softmax: [[0.0513436  0.04895498 0.04948023 0.04845141 0.04914331 0.05274908
  0.04957866 0.04897879 0.05184355 0.05307219 0.04881785 0.04875584
  0.04641563 0.05031721 0.05284495 0.05094891 0.04733368 0.04834547
  0.05423519 0.04838939]]
2024-10-22 16:59:34,633 - DEBUG - Normalized Policy: [[0.339915   0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.322783
  0.         0.         0.         0.33730203 0.         0.
  0.         0.        ]]
2024-10-22 16:59:34,634 - DEBUG - Dirichlet Noise Added: [0.3901006  0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.24208724
 0.         0.         0.         0.36781216 0.         0.
 0.         0.        ]
2024-10-22 16:59:34,635 - DEBUG - Added Child Node: ((Discard 0),) | P=0.3901005983352661
2024-10-22 16:59:34,635 - DEBUG - Added Child Node: ((Reveal player +1 color Y),) | P=0.2420872449874878
2024-10-22 16:59:34,636 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.3678121566772461
2024-10-22 16:59:34,636 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 16:59:34,636 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:34,637 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 40, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [], 'card_knowledge': [[{'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X3|RYGWB3
XX || XX|RYGWB1245
XX || XX|RYGWB1245
XX || X3|RYGWB3
XX || XX|RYGWB1245
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 40
Discards:}
2024-10-22 16:59:34,637 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:34,637 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 16:59:34,637 - DEBUG - --- Rollout #2 ---
2024-10-22 16:59:34,637 - DEBUG - Expanding unexplored child: ((Discard 0),)
2024-10-22 16:59:34,637 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 16:59:34,638 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 1
2024-10-22 16:59:34,835 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:34,835 - DEBUG - Network Policy Logits: [[ 0.00570281  0.01204903  0.00380938 -0.03798704 -0.01374621  0.0952297
   0.0008036  -0.00125168  0.00453355  0.07949784 -0.05795541  0.0187027
  -0.06952036  0.00950415  0.02111271 -0.00621398 -0.04153033 -0.02852518
   0.05883322 -0.06826078]]
2024-10-22 16:59:34,835 - DEBUG - Network Policy after Softmax: [[0.05027741 0.0505975  0.05018231 0.04812809 0.04930901 0.05498623
  0.05003169 0.04992897 0.05021865 0.05412796 0.04717658 0.05093528
  0.04663413 0.05046889 0.05105818 0.04968182 0.04795786 0.04858563
  0.05302091 0.0466929 ]]
2024-10-22 16:59:34,836 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]]
2024-10-22 16:59:34,837 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B)) | P=1.0
2024-10-22 16:59:34,837 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 16:59:34,837 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:34,837 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
R2 || XX|RYGWB1245
R2 || XX|RYGWB1245
B3 || X3|RYGWB3
B4 || XX|RYGWB1245
B3 || XX|RYGWB12345
Deck size: 39
Discards: R3}
2024-10-22 16:59:34,837 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:34,837 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 16:59:34,837 - DEBUG - --- Rollout #3 ---
2024-10-22 16:59:34,838 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y),)
2024-10-22 16:59:34,838 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)']
2024-10-22 16:59:34,838 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 0 | Depth: 1
2024-10-22 16:59:35,054 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:35,054 - DEBUG - Network Policy Logits: [[ 0.039698    0.01797612  0.01217239  0.00962233 -0.03299782 -0.00938188
  -0.02156565  0.00571453 -0.00532716  0.05488151 -0.05263006 -0.01526609
  -0.01831584  0.08134672  0.05259696  0.00538551 -0.02693579 -0.03456961
   0.05085282 -0.0371217 ]]
2024-10-22 16:59:35,054 - DEBUG - Network Policy after Softmax: [[0.05179432 0.05068138 0.05038809 0.05025977 0.04816269 0.04931364
  0.04871646 0.05006374 0.049514   0.05258674 0.04722637 0.04902432
  0.04887503 0.05399704 0.05246674 0.05004727 0.04845554 0.04808705
  0.05237531 0.04796448]]
2024-10-22 16:59:35,056 - DEBUG - Normalized Policy: [[0.34365365 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.3242843  0.         0.         0.33206204 0.         0.
  0.         0.        ]]
2024-10-22 16:59:35,057 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 0)) | P=0.3436536490917206
2024-10-22 16:59:35,058 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 rank 1)) | P=0.3320620357990265
2024-10-22 16:59:35,059 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color G)) | P=0.32428428530693054
2024-10-22 16:59:35,059 - DEBUG - Simulating Node: ((Reveal player +1 color Y),) | Value: 0.0
2024-10-22 16:59:35,059 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:35,059 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 40, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'Y', 'rank': 4}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 0}]], 'discard_pile': [], 'card_knowledge': [[{'color': 'Y', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'Y', 'rank': None}], [{'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || YX|Y12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || YX|Y12345
-----
G3 || X3|RYGWB3
W4 || XX|RYGWB1245
Y5 || XX|RYGWB1245
W3 || X3|RYGWB3
G1 || XX|RYGWB1245
Deck size: 40
Discards:}
2024-10-22 16:59:35,059 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:35,059 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 16:59:35,059 - DEBUG - --- Rollout #4 ---
2024-10-22 16:59:35,059 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 16:59:35,060 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 16:59:35,060 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:35,279 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:35,279 - DEBUG - Network Policy Logits: [[ 0.00849017 -0.00057334  0.00090128  0.00550013  0.00119237 -0.00884138
  -0.01490314 -0.0276358  -0.00602927  0.04229556 -0.05056861 -0.05332398
  -0.04640653  0.06973632  0.04933737  0.00547636  0.00277844 -0.02592228
   0.06291916 -0.06363116]]
2024-10-22 16:59:35,279 - DEBUG - Network Policy after Softmax: [[0.05051701 0.05006122 0.05013509 0.05036619 0.05014969 0.04964902
  0.04934897 0.0487246  0.04978883 0.05225395 0.04761993 0.0474889
  0.04781854 0.05370769 0.05262321 0.05036499 0.05022929 0.04880816
  0.0533428  0.04700193]]
2024-10-22 16:59:35,281 - DEBUG - Normalized Policy: [[0.2546868  0.         0.         0.         0.         0.2503107
  0.         0.         0.         0.         0.         0.
  0.24108216 0.         0.         0.25392038 0.         0.
  0.         0.        ]]
2024-10-22 16:59:35,281 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0)) | P=0.2503106892108917
2024-10-22 16:59:35,282 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0)) | P=0.25468680262565613
2024-10-22 16:59:35,282 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.25392037630081177
2024-10-22 16:59:35,283 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color G)) | P=0.24108216166496277
2024-10-22 16:59:35,283 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 16:59:35,283 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:35,283 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 40, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 15, 17, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 2}, {'color': 'Y', 'rank': 4}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 2}, {'color': 'G', 'rank': 4}]], 'discard_pile': [], 'card_knowledge': [[{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
G3 || X3|RYGWB3
Y5 || XX|RYGWB1245
R1 || XX|RYGWB1245
R3 || X3|RYGWB3
G5 || XX|RYGWB1245
Deck size: 40
Discards:}
2024-10-22 16:59:35,283 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:35,283 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 16:59:35,283 - DEBUG - --- Rollout #5 ---
2024-10-22 16:59:35,284 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.6186196804046631 | PUCT: 0.6186196804046631
2024-10-22 16:59:35,285 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.38390082120895386 | PUCT: 0.38390082120895386
2024-10-22 16:59:35,285 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.583274781703949 | PUCT: 0.583274781703949
2024-10-22 16:59:35,285 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.6186196804046631
2024-10-22 16:59:35,285 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 16:59:35,285 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 color B))
2024-10-22 16:59:35,285 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 color B))']
2024-10-22 16:59:35,286 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 1
2024-10-22 16:59:35,286 - DEBUG - Move: (Reveal player +1 color B) | Reward: 0 | Depth: 2
2024-10-22 16:59:35,506 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:35,506 - DEBUG - Network Policy Logits: [[-0.0115463  -0.00112058  0.00178317 -0.02596609 -0.00392586  0.01486014
  -0.03207076  0.00140882  0.0634127   0.07351853 -0.03390199  0.00060866
  -0.06138509  0.00127013  0.03332119 -0.01032739 -0.05081289 -0.0190707
   0.02402385 -0.04481715]]
2024-10-22 16:59:35,506 - DEBUG - Network Policy after Softmax: [[0.04959742 0.05011721 0.05026295 0.04888736 0.04997682 0.05092455
  0.04858983 0.05024414 0.05345808 0.05400106 0.04850094 0.05020395
  0.04718613 0.05023717 0.0518734  0.04965791 0.04768763 0.04922563
  0.05139336 0.04797442]]
2024-10-22 16:59:35,508 - DEBUG - Normalized Policy: [[0.         0.         0.33480775 0.         0.         0.
  0.         0.         0.         0.         0.         0.33441475
  0.         0.         0.         0.33077753 0.         0.
  0.         0.        ]]
2024-10-22 16:59:35,508 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Discard 2)) | P=0.33480775356292725
2024-10-22 16:59:35,509 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 color Y)) | P=0.3344147503376007
2024-10-22 16:59:35,509 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 rank 1)) | P=0.33077752590179443
2024-10-22 16:59:35,510 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 16:59:35,510 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:35,510 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': 'B', 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGW1245
XX || BX|B1245
XX || X3|RYGW3
XX || XX|RYGW1245
XX || XX|RYGW12345
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 39
Discards: Y3}
2024-10-22 16:59:35,510 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:35,510 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 16:59:35,510 - DEBUG - --- Rollout #6 ---
2024-10-22 16:59:35,511 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4351462125778198 | PUCT: 0.4351462125778198
2024-10-22 16:59:35,511 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.4050622582435608 | PUCT: 0.4050622582435608
2024-10-22 16:59:35,512 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.6154261231422424 | PUCT: 0.6154261231422424
2024-10-22 16:59:35,512 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.6154261231422424
2024-10-22 16:59:35,512 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:35,513 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 color G))
2024-10-22 16:59:35,513 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 color G))']
2024-10-22 16:59:35,513 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:35,513 - DEBUG - Illegal move encountered: (Reveal player +1 color G)
2024-10-22 16:59:35,513 - DEBUG - Backpropagating reward: 0
2024-10-22 16:59:35,513 - DEBUG - Rollout #6 completed with reward=0
2024-10-22 16:59:35,513 - DEBUG - --- Rollout #7 ---
2024-10-22 16:59:35,514 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4534785747528076 | PUCT: 0.4534785747528076
2024-10-22 16:59:35,515 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.4221271872520447 | PUCT: 0.4221271872520447
2024-10-22 16:59:35,516 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.42756903171539307 | PUCT: 0.42756903171539307
2024-10-22 16:59:35,516 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.4534785747528076
2024-10-22 16:59:35,516 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 16:59:35,516 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 color B)) | Q: 0.0 | U: 1.3101838827133179 | PUCT: 1.3101838827133179
2024-10-22 16:59:35,516 - DEBUG - Selected Child: ((Discard 0), (Reveal player +1 color B)) | PUCT: 1.3101838827133179
2024-10-22 16:59:35,517 - DEBUG - Selected child for exploration: ((Discard 0), (Reveal player +1 color B))
2024-10-22 16:59:35,517 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 rank 1))
2024-10-22 16:59:35,517 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 color B))', '((Discard 0), (Reveal player +1 color B), (Reveal player +1 rank 1))']
2024-10-22 16:59:35,517 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 1
2024-10-22 16:59:35,518 - DEBUG - Move: (Reveal player +1 color B) | Reward: 0 | Depth: 2
2024-10-22 16:59:35,519 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 3
2024-10-22 16:59:35,728 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:35,728 - DEBUG - Network Policy Logits: [[ 0.00914505 -0.01015083  0.01584016 -0.00917817  0.0250052  -0.02088592
   0.02177241 -0.03884348  0.00197247  0.04664866 -0.03313675 -0.00106767
  -0.05613136  0.02896563  0.02718548 -0.01799767 -0.03267996  0.00816802
   0.05208233 -0.08928819]]
2024-10-22 16:59:35,728 - DEBUG - Network Policy after Softmax: [[0.0506133  0.04964603 0.0509533  0.04969434 0.05142243 0.04911593
  0.05125646 0.0482418  0.05025157 0.05254752 0.04851789 0.05009903
  0.04741497 0.05162649 0.05153467 0.04925799 0.04854006 0.05056387
  0.05283383 0.04586861]]
2024-10-22 16:59:35,730 - DEBUG - Normalized Policy: [[0.254228   0.         0.         0.         0.         0.24670677
  0.         0.         0.         0.         0.         0.25164485
  0.         0.         0.         0.24742036 0.         0.
  0.         0.        ]]
2024-10-22 16:59:35,731 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 rank 1), (Play 0)) | P=0.2467067688703537
2024-10-22 16:59:35,731 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 rank 1), (Discard 0)) | P=0.25422799587249756
2024-10-22 16:59:35,733 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 rank 1), (Reveal player +1 color Y)) | P=0.2516448497772217
2024-10-22 16:59:35,734 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.24742035567760468
2024-10-22 16:59:35,734 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:35,734 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:35,734 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': 'B', 'rank': None}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
W2 || XX|RYGW1245
Y1 || XX|RYGW1245
Y3 || X3|RYGW3
B4 || BX|B1245
B1 || BX|B12345
Deck size: 39
Discards: G3}
2024-10-22 16:59:35,734 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:35,734 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 16:59:35,734 - DEBUG - --- Rollout #8 ---
2024-10-22 16:59:35,735 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.35158470273017883 | PUCT: 0.35158470273017883
2024-10-22 16:59:35,735 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.4363703727722168 | PUCT: 0.4363703727722168
2024-10-22 16:59:35,736 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4419958293437958 | PUCT: 0.4419958293437958
2024-10-22 16:59:35,736 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.4419958293437958
2024-10-22 16:59:35,736 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:35,736 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Discard 0))
2024-10-22 16:59:35,736 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Discard 0))']
2024-10-22 16:59:35,737 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:35,737 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 2
2024-10-22 16:59:35,944 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:35,945 - DEBUG - Network Policy Logits: [[-0.00603465 -0.02492322 -0.00138695 -0.02438017 -0.04200262  0.07324269
   0.0231341  -0.02000386  0.03057504  0.05589562 -0.00836509 -0.02583198
  -0.06164462  0.00572498 -0.00379862 -0.00142318 -0.07274976 -0.02087288
   0.0759215  -0.04952547]]
2024-10-22 16:59:35,945 - DEBUG - Network Policy after Softmax: [[0.04990494 0.04897115 0.05013742 0.04899775 0.04814185 0.05402232
  0.05138204 0.04921265 0.0517658  0.05309327 0.04978877 0.04892667
  0.04720548 0.05049526 0.05001665 0.0501356  0.04668415 0.0491699
  0.05416723 0.04778105]]
2024-10-22 16:59:35,946 - DEBUG - Normalized Policy: [[0.5138989 0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.4861011 0.
  0.        0.        0.        0.        0.        0.       ]]
2024-10-22 16:59:35,947 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0), (Discard 0)) | P=0.5138989090919495
2024-10-22 16:59:35,948 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0), (Reveal player +1 color G)) | P=0.48610109090805054
2024-10-22 16:59:35,948 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Discard 0)) | Value: 0.0
2024-10-22 16:59:35,948 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:35,948 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X3|RYGWB3
XX || XX|RYGWB1245
XX || XX|RYGWB1245
XX || X3|RYGWB3
XX || XX|RYGWB1245
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
B5 || XX|RYGWB12345
Deck size: 39
Discards: W1}
2024-10-22 16:59:35,948 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:35,948 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 16:59:35,948 - DEBUG - --- Rollout #9 ---
2024-10-22 16:59:35,949 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.36140477657318115 | PUCT: 0.36140477657318115
2024-10-22 16:59:35,950 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.4485585689544678 | PUCT: 0.4485585689544678
2024-10-22 16:59:35,950 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3407558500766754 | PUCT: 0.3407558500766754
2024-10-22 16:59:35,950 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 0.4485585689544678
2024-10-22 16:59:35,950 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 16:59:35,950 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Reveal player +1 color G))
2024-10-22 16:59:35,950 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 color G))']
2024-10-22 16:59:35,951 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 0 | Depth: 1
2024-10-22 16:59:35,951 - DEBUG - Illegal move encountered: (Reveal player +1 color G)
2024-10-22 16:59:35,951 - DEBUG - Backpropagating reward: 0
2024-10-22 16:59:35,951 - DEBUG - Rollout #9 completed with reward=0
2024-10-22 16:59:35,951 - DEBUG - --- Rollout #10 ---
2024-10-22 16:59:35,952 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.3699682652950287 | PUCT: 0.3699682652950287
2024-10-22 16:59:35,952 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.3061247766017914 | PUCT: 0.3061247766017914
2024-10-22 16:59:35,953 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.34883007407188416 | PUCT: 0.34883007407188416
2024-10-22 16:59:35,953 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.3699682652950287
2024-10-22 16:59:35,953 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 16:59:35,953 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 color B)) | Q: 0.0 | U: 0.9811750054359436 | PUCT: 0.9811750054359436
2024-10-22 16:59:35,954 - DEBUG - Selected Child: ((Discard 0), (Reveal player +1 color B)) | PUCT: 0.9811750054359436
2024-10-22 16:59:35,954 - DEBUG - Selected child for exploration: ((Discard 0), (Reveal player +1 color B))
2024-10-22 16:59:35,954 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 color Y))
2024-10-22 16:59:35,954 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 color B))', '((Discard 0), (Reveal player +1 color B), (Reveal player +1 color Y))']
2024-10-22 16:59:35,954 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 1
2024-10-22 16:59:35,955 - DEBUG - Move: (Reveal player +1 color B) | Reward: 0 | Depth: 2
2024-10-22 16:59:35,955 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 0 | Depth: 3
2024-10-22 16:59:36,171 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:36,172 - DEBUG - Network Policy Logits: [[ 0.0403197  -0.01125465  0.01405854 -0.00422453 -0.01025029 -0.01133935
   0.01509668 -0.00560738  0.00717579  0.06063216 -0.01891866  0.01534501
  -0.04056829  0.04327715  0.04459307 -0.01817975 -0.05906332 -0.00867544
   0.02814826 -0.05296426]]
2024-10-22 16:59:36,172 - DEBUG - Network Policy after Softmax: [[0.05195975 0.04934789 0.05061299 0.04969603 0.04939748 0.04934371
  0.05066556 0.04962736 0.05026583 0.05302597 0.04897114 0.05067815
  0.04792232 0.05211364 0.05218227 0.04900733 0.04704414 0.04947533
  0.05133116 0.04733194]]
2024-10-22 16:59:36,174 - DEBUG - Normalized Policy: [[0.25500607 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.24871626
  0.         0.25576136 0.         0.24051632 0.         0.
  0.         0.        ]]
2024-10-22 16:59:36,175 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 color Y), (Reveal player +1 color W)) | P=0.25576135516166687
2024-10-22 16:59:36,175 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 color Y), (Discard 0)) | P=0.2550060749053955
2024-10-22 16:59:36,176 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 color Y), (Reveal player +1 rank 1)) | P=0.2405163198709488
2024-10-22 16:59:36,177 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 color Y), (Reveal player +1 color Y)) | P=0.24871626496315002
2024-10-22 16:59:36,177 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 16:59:36,177 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:36,177 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 2}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'Y', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'Y', 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': 'B', 'rank': None}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || YX|Y12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || YX|Y12345
-----
W4 || XX|RYGW1245
W1 || XX|RYGW1245
Y3 || X3|RYGW3
B1 || BX|B1245
B3 || BX|B12345
Deck size: 39
Discards: Y3}
2024-10-22 16:59:36,177 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:36,177 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 16:59:36,177 - INFO - === MCTS Search Completed ===
2024-10-22 16:59:36,177 - DEBUG - Best node chosen by MCTS: ((Discard 0),) | Visit Count: 4
2024-10-22 16:59:36,177 - INFO - Actual Game Score: 0
2024-10-22 16:59:36,178 - DEBUG - === Recording Training Data ===
2024-10-22 16:59:36,178 - DEBUG - State Vector Shape: 658
2024-10-22 16:59:36,178 - DEBUG - Policy Targets: [0.44444444 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.22222222
 0.         0.         0.         0.33333333 0.         0.
 0.         0.        ]
2024-10-22 16:59:36,178 - DEBUG - === End of Training Data ===
2024-10-22 16:59:36,178 - INFO - Chosen Action: (Discard 0) | Visit Count: 4
2024-10-22 16:59:36,178 - DEBUG - Not the current player's turn.
2024-10-22 16:59:38,617 - INFO - Agent state has been reset.
2024-10-22 16:59:38,617 - INFO - === Starting MCTS Search ===
2024-10-22 16:59:38,617 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || RX|R1245
XX || XX|YGWB1245
XX || R3|R3
XX || XX|YGWB1245
XX || XX|YGWB12345
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 39
Discards: B3}
2024-10-22 16:59:38,617 - INFO - Max Rollouts: 10
2024-10-22 16:59:38,617 - DEBUG - --- Rollout #1 ---
2024-10-22 16:59:38,618 - DEBUG - Node () is a leaf node.
2024-10-22 16:59:38,618 - DEBUG - Traversing Path: ['()']
2024-10-22 16:59:38,873 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:38,873 - DEBUG - Network Policy Logits: [[ 0.01637104 -0.01286188  0.04378174 -0.03694342 -0.00249073  0.05213276
   0.00891781  0.00826011  0.0478324   0.05121728 -0.04709316 -0.0283676
  -0.04384773  0.01424268  0.05544174 -0.00496283 -0.02828329 -0.05280701
   0.03683935 -0.04410331]]
2024-10-22 16:59:38,874 - DEBUG - Network Policy after Softmax: [[0.05070708 0.04924622 0.05211622 0.04807446 0.04975962 0.05255326
  0.05033055 0.05029746 0.05232775 0.05250517 0.04758898 0.04848851
  0.04774368 0.05059927 0.05272745 0.04963676 0.0484926  0.04731784
  0.05175566 0.04773148]]
2024-10-22 16:59:38,876 - DEBUG - Normalized Policy: [[0.         0.         0.34688303 0.         0.         0.
  0.         0.         0.         0.         0.         0.32273713
  0.         0.         0.         0.33037987 0.         0.
  0.         0.        ]]
2024-10-22 16:59:38,881 - DEBUG - Dirichlet Noise Added: [0.         0.         0.5099789  0.         0.         0.
 0.         0.         0.         0.         0.         0.24223618
 0.         0.         0.         0.24778491 0.         0.
 0.         0.        ]
2024-10-22 16:59:38,883 - DEBUG - Added Child Node: ((Discard 2),) | P=0.5099788904190063
2024-10-22 16:59:38,886 - DEBUG - Added Child Node: ((Reveal player +1 color Y),) | P=0.2422361820936203
2024-10-22 16:59:38,887 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.24778491258621216
2024-10-22 16:59:38,887 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 16:59:38,887 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:38,888 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || RX|R1245
XX || XX|YGWB1245
XX || R3|R3
XX || XX|YGWB1245
XX || XX|YGWB12345
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 39
Discards: B3}
2024-10-22 16:59:38,888 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:38,888 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 16:59:38,888 - DEBUG - --- Rollout #2 ---
2024-10-22 16:59:38,888 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y),)
2024-10-22 16:59:38,888 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)']
2024-10-22 16:59:38,889 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 0 | Depth: 1
2024-10-22 16:59:39,128 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:39,128 - DEBUG - Network Policy Logits: [[ 0.01958247 -0.01053512  0.04876832 -0.00093681 -0.06125165 -0.00412686
   0.01109173  0.0428361   0.01992041  0.07938179 -0.04746021 -0.00153738
  -0.03053486  0.01537371  0.04280031 -0.02363895 -0.04856845 -0.08124381
   0.05794002 -0.04930951]]
2024-10-22 16:59:39,129 - DEBUG - Network Policy after Softmax: [[0.0509978  0.04948477 0.05250815 0.04996202 0.04703765 0.0498029
  0.05056662 0.05219758 0.05101504 0.05414046 0.04769086 0.04993203
  0.04850492 0.05078361 0.05219571 0.04884056 0.04763804 0.0461066
  0.05299195 0.04760275]]
2024-10-22 16:59:39,131 - DEBUG - Normalized Policy: [[0.49041176 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.5095882  0.        ]]
2024-10-22 16:59:39,133 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 0)) | P=0.49041175842285156
2024-10-22 16:59:39,134 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 rank 4)) | P=0.5095881819725037
2024-10-22 16:59:39,134 - DEBUG - Simulating Node: ((Reveal player +1 color Y),) | Value: 0.0
2024-10-22 16:59:39,134 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:39,135 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 2}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'Y', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'Y', 'rank': None}], [{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || YX|Y12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || YX|Y12345
-----
R4 || RX|R1245
G4 || XX|YGWB1245
R3 || R3|R3
B2 || XX|YGWB1245
Y2 || XX|YGWB12345
Deck size: 39
Discards: B3}
2024-10-22 16:59:39,135 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:39,135 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 16:59:39,135 - DEBUG - --- Rollout #3 ---
2024-10-22 16:59:39,135 - DEBUG - Expanding unexplored child: ((Discard 2),)
2024-10-22 16:59:39,136 - DEBUG - Traversing Path: ['()', '((Discard 2),)']
2024-10-22 16:59:39,136 - DEBUG - Move: (Discard 2) | Reward: 0 | Depth: 1
2024-10-22 16:59:39,501 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:39,503 - DEBUG - Network Policy Logits: [[ 0.01354477  0.0113071   0.00355252 -0.0092992  -0.04060719  0.10223761
  -0.03990944  0.02456643  0.00577567  0.08402817 -0.05066812  0.00343292
  -0.05174526  0.02827194  0.05402528 -0.02187356 -0.0062541  -0.06645925
   0.08410297 -0.0578412 ]]
2024-10-22 16:59:39,504 - DEBUG - Network Policy after Softmax: [[0.05044595 0.05033319 0.04994439 0.04930662 0.04778685 0.05512455
  0.0478202  0.05100502 0.05005554 0.05412985 0.04730848 0.04993841
  0.04725755 0.05119437 0.05252992 0.04869051 0.049457   0.04656729
  0.0541339  0.04697035]]
2024-10-22 16:59:39,506 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]]
2024-10-22 16:59:39,507 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 1)) | P=1.0
2024-10-22 16:59:39,507 - DEBUG - Simulating Node: ((Discard 2),) | Value: 0.0
2024-10-22 16:59:39,507 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:39,508 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 0}, {'color': 'Y', 'rank': 4}, {'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
R1 || RX|R1245
Y5 || XX|YGWB1245
W2 || XX|YGWB1245
G4 || XX|YGWB12345
G1 || XX|RYGWB12345
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:39,508 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:39,508 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 16:59:39,508 - DEBUG - --- Rollout #4 ---
2024-10-22 16:59:39,508 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 16:59:39,509 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 16:59:39,510 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:39,901 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:39,902 - DEBUG - Network Policy Logits: [[-0.03311066 -0.01678044  0.05304817 -0.01691979 -0.04299564 -0.00836582
   0.01020957  0.00956501  0.02357839  0.05465312 -0.04577338 -0.0220532
  -0.06615459  0.016253    0.03688147 -0.02701925  0.00255088 -0.05837645
   0.08804537 -0.090651  ]]
2024-10-22 16:59:39,902 - DEBUG - Network Policy after Softmax: [[0.04864903 0.04945    0.05302644 0.04944311 0.0481705  0.04986786
  0.05080283 0.05077009 0.05148656 0.05311161 0.04803688 0.04918994
  0.04706774 0.05111078 0.05217607 0.04894627 0.05041523 0.04743527
  0.05491507 0.04592876]]
2024-10-22 16:59:39,906 - DEBUG - Normalized Policy: [[0.19502832 0.         0.         0.         0.         0.19991446
  0.         0.         0.         0.         0.         0.
  0.18868911 0.         0.         0.19621994 0.         0.
  0.22014815 0.        ]]
2024-10-22 16:59:39,908 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0)) | P=0.19991445541381836
2024-10-22 16:59:39,909 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.19621993601322174
2024-10-22 16:59:39,910 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 4)) | P=0.22014814615249634
2024-10-22 16:59:39,911 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color G)) | P=0.18868911266326904
2024-10-22 16:59:39,911 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0)) | P=0.19502831995487213
2024-10-22 16:59:39,912 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 16:59:39,912 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:39,912 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 39, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
R4 || RX|R1245
G2 || XX|YGWB1245
R3 || R3|R3
Y2 || XX|YGWB1245
G1 || XX|YGWB12345
Deck size: 39
Discards: B3}
2024-10-22 16:59:39,912 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:39,912 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 16:59:39,912 - DEBUG - --- Rollout #5 ---
2024-10-22 16:59:39,914 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.38413700461387634 | PUCT: 0.38413700461387634
2024-10-22 16:59:39,915 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.8087220788002014 | PUCT: 0.8087220788002014
2024-10-22 16:59:39,915 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3929361402988434 | PUCT: 0.3929361402988434
2024-10-22 16:59:39,916 - DEBUG - Selected Child: ((Discard 2),) | PUCT: 0.8087220788002014
2024-10-22 16:59:39,916 - DEBUG - Selected child for exploration: ((Discard 2),)
2024-10-22 16:59:39,916 - DEBUG - Expanding unexplored child: ((Discard 2), (Reveal player +1 rank 1))
2024-10-22 16:59:39,916 - DEBUG - Traversing Path: ['()', '((Discard 2),)', '((Discard 2), (Reveal player +1 rank 1))']
2024-10-22 16:59:39,917 - DEBUG - Move: (Discard 2) | Reward: 0 | Depth: 1
2024-10-22 16:59:39,918 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:40,276 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:40,277 - DEBUG - Network Policy Logits: [[-0.00981434 -0.01470983  0.00138043 -0.02374887  0.00321189  0.00540645
  -0.01301371 -0.01345059  0.04865246  0.07234845 -0.01384877 -0.07468235
  -0.03669443  0.01382132  0.05990604  0.01958228 -0.07503656 -0.03143329
   0.09030488 -0.01681314]]
2024-10-22 16:59:40,279 - DEBUG - Network Policy after Softmax: [[0.04948926 0.04924758 0.05004639 0.04880443 0.05013813 0.05024829
  0.04933118 0.04930963 0.052469   0.05372715 0.04929    0.0463809
  0.0481767  0.0506729  0.05306279 0.05096567 0.04636447 0.04843083
  0.05470061 0.0491441 ]]
2024-10-22 16:59:40,282 - DEBUG - Normalized Policy: [[0.25110728 0.         0.         0.         0.         0.2549586
  0.         0.         0.         0.         0.         0.23533554
  0.         0.         0.         0.25859857 0.         0.
  0.         0.        ]]
2024-10-22 16:59:40,284 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 1), (Play 0)) | P=0.2549585998058319
2024-10-22 16:59:40,285 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 1), (Discard 0)) | P=0.25110727548599243
2024-10-22 16:59:40,288 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 color Y)) | P=0.2353355437517166
2024-10-22 16:59:40,289 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.25859856605529785
2024-10-22 16:59:40,289 - DEBUG - Simulating Node: ((Discard 2), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:40,290 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:40,290 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || R1|R1
XX || X1|YGWB1
XX || XX|YGWB245
XX || X1|YGWB1
XX || X1|RYGWB1
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:40,290 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:40,290 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 16:59:40,290 - DEBUG - --- Rollout #6 ---
2024-10-22 16:59:40,291 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.4053114652633667 | PUCT: 0.4053114652633667
2024-10-22 16:59:40,292 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.568867027759552 | PUCT: 0.568867027759552
2024-10-22 16:59:40,293 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4145956039428711 | PUCT: 0.4145956039428711
2024-10-22 16:59:40,293 - DEBUG - Selected Child: ((Discard 2),) | PUCT: 0.568867027759552
2024-10-22 16:59:40,293 - DEBUG - Selected child for exploration: ((Discard 2),)
2024-10-22 16:59:40,294 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Reveal player +1 rank 1)) | Q: 0.0 | U: 1.3101838827133179 | PUCT: 1.3101838827133179
2024-10-22 16:59:40,294 - DEBUG - Selected Child: ((Discard 2), (Reveal player +1 rank 1)) | PUCT: 1.3101838827133179
2024-10-22 16:59:40,294 - DEBUG - Selected child for exploration: ((Discard 2), (Reveal player +1 rank 1))
2024-10-22 16:59:40,294 - DEBUG - Expanding unexplored child: ((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 rank 1))
2024-10-22 16:59:40,294 - DEBUG - Traversing Path: ['()', '((Discard 2),)', '((Discard 2), (Reveal player +1 rank 1))', '((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 rank 1))']
2024-10-22 16:59:40,295 - DEBUG - Move: (Discard 2) | Reward: 0 | Depth: 1
2024-10-22 16:59:40,296 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:40,297 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 3
2024-10-22 16:59:40,608 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:40,609 - DEBUG - Network Policy Logits: [[-0.02095419 -0.00716378  0.03284183  0.01587468 -0.0201765   0.00907643
   0.00488158 -0.00549267  0.01099073  0.05747358 -0.03779349 -0.02598156
  -0.01960726  0.03209766  0.02607517 -0.02638195 -0.01840771 -0.03316772
   0.07207683 -0.0760807 ]]
2024-10-22 16:59:40,609 - DEBUG - Network Policy after Softmax: [[0.04900792 0.04968844 0.05171655 0.05084647 0.04904605 0.05050198
  0.05029057 0.04977154 0.05059874 0.05300624 0.04818957 0.04876215
  0.04907397 0.05167808 0.05136778 0.04874264 0.04913288 0.048413
  0.05378598 0.0463794 ]]
2024-10-22 16:59:40,611 - DEBUG - Normalized Policy: [[0.23909338 0.         0.         0.         0.         0.24638239
  0.         0.         0.         0.         0.         0.
  0.         0.25212023 0.         0.         0.         0.
  0.26240396 0.        ]]
2024-10-22 16:59:40,612 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 rank 1), (Reveal player +1 color W)) | P=0.2521202266216278
2024-10-22 16:59:40,613 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 rank 1), (Discard 0)) | P=0.2390933781862259
2024-10-22 16:59:40,613 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 rank 1), (Play 0)) | P=0.24638238549232483
2024-10-22 16:59:40,615 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 rank 1), (Reveal player +1 rank 4)) | P=0.2624039649963379
2024-10-22 16:59:40,615 - DEBUG - Simulating Node: ((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:40,615 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:40,615 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
R4 || RX|R245
W4 || XX|YGWB245
W1 || X1|YGWB1
W2 || XX|YGWB2345
G5 || XX|RYGWB2345
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:40,615 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:40,616 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 16:59:40,616 - DEBUG - --- Rollout #7 ---
2024-10-22 16:59:40,617 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.42238688468933105 | PUCT: 0.42238688468933105
2024-10-22 16:59:40,617 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.44462472200393677 | PUCT: 0.44462472200393677
2024-10-22 16:59:40,618 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.43206217885017395 | PUCT: 0.43206217885017395
2024-10-22 16:59:40,618 - DEBUG - Selected Child: ((Discard 2),) | PUCT: 0.44462472200393677
2024-10-22 16:59:40,618 - DEBUG - Selected child for exploration: ((Discard 2),)
2024-10-22 16:59:40,618 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.9811750054359436 | PUCT: 0.9811750054359436
2024-10-22 16:59:40,619 - DEBUG - Selected Child: ((Discard 2), (Reveal player +1 rank 1)) | PUCT: 0.9811750054359436
2024-10-22 16:59:40,619 - DEBUG - Selected child for exploration: ((Discard 2), (Reveal player +1 rank 1))
2024-10-22 16:59:40,619 - DEBUG - Expanding unexplored child: ((Discard 2), (Reveal player +1 rank 1), (Discard 0))
2024-10-22 16:59:40,619 - DEBUG - Traversing Path: ['()', '((Discard 2),)', '((Discard 2), (Reveal player +1 rank 1))', '((Discard 2), (Reveal player +1 rank 1), (Discard 0))']
2024-10-22 16:59:40,620 - DEBUG - Move: (Discard 2) | Reward: 0 | Depth: 1
2024-10-22 16:59:40,620 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:40,621 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 3
2024-10-22 16:59:40,860 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:40,860 - DEBUG - Network Policy Logits: [[ 2.3397084e-02  5.2026715e-03  2.6680529e-05 -5.5179568e-03
  -2.1340095e-02  8.2587749e-02 -1.2836961e-02  1.9934925e-03
   2.3841072e-02  9.5711008e-02 -6.3317738e-02 -4.0545426e-03
  -5.8865298e-02  2.9358912e-02  5.4765224e-02 -3.0782780e-02
   6.5561226e-03 -2.7529918e-02  6.3836925e-02 -1.7546773e-02]]
2024-10-22 16:59:40,860 - DEBUG - Network Policy after Softmax: [[0.05076898 0.04985362 0.04959625 0.04932201 0.04854777 0.05386474
  0.04896234 0.04969389 0.05079152 0.05457629 0.04655203 0.04939425
  0.04675977 0.05107256 0.05238675 0.04809151 0.04992114 0.0482482
  0.05286415 0.04873228]]
2024-10-22 16:59:40,862 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 16:59:40,862 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 1), (Discard 0), (Reveal player +1 color Y)) | P=1.0
2024-10-22 16:59:40,863 - DEBUG - Simulating Node: ((Discard 2), (Reveal player +1 rank 1), (Discard 0)) | Value: 0.0
2024-10-22 16:59:40,863 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:40,863 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 11, 12, 13, 15, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
Y1 || X1|YGWB1
W5 || XX|YGWB245
Y3 || XX|YGWB2345
G4 || XX|RYGWB2345
W4 || XX|RYGWB12345
Deck size: 37
Discards: B3 R3 R5}
2024-10-22 16:59:40,863 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:40,863 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 16:59:40,863 - DEBUG - --- Rollout #8 ---
2024-10-22 16:59:40,864 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.43663886189460754 | PUCT: 0.43663886189460754
2024-10-22 16:59:40,865 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.36770159006118774 | PUCT: 0.36770159006118774
2024-10-22 16:59:40,865 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.44664061069488525 | PUCT: 0.44664061069488525
2024-10-22 16:59:40,865 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.44664061069488525
2024-10-22 16:59:40,865 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:40,865 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Discard 0))
2024-10-22 16:59:40,865 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Discard 0))']
2024-10-22 16:59:40,866 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:40,867 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 2
2024-10-22 16:59:41,099 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:41,099 - DEBUG - Network Policy Logits: [[-0.01502445 -0.01008708  0.03560154 -0.02360102 -0.01317524  0.07529049
   0.03205417  0.00050072  0.05263375  0.04007697 -0.03223785 -0.02848221
  -0.03293246 -0.00636694 -0.00901497 -0.02229781 -0.04880455 -0.04125479
   0.03869733 -0.05685211]]
2024-10-22 16:59:41,099 - DEBUG - Network Policy after Softmax: [[0.04938364 0.04962807 0.0519481  0.04896191 0.04947505 0.05405133
  0.05176415 0.05015631 0.05284047 0.05218111 0.04854085 0.0487235
  0.04850715 0.04981304 0.04968131 0.04902576 0.04774332 0.04810513
  0.05210917 0.04736064]]
2024-10-22 16:59:41,101 - DEBUG - Normalized Policy: [[0.        0.        0.5171268 0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.4828732 0.
  0.        0.        0.        0.        0.        0.       ]]
2024-10-22 16:59:41,102 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0), (Discard 2)) | P=0.5171267986297607
2024-10-22 16:59:41,102 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0), (Reveal player +1 color G)) | P=0.48287320137023926
2024-10-22 16:59:41,102 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Discard 0)) | Value: 0.0
2024-10-22 16:59:41,102 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:41,102 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || RX|R1245
XX || XX|YGWB1245
XX || R3|R3
XX || XX|YGWB1245
XX || XX|YGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
Y5 || XX|RYGWB12345
Deck size: 38
Discards: B3 Y1}
2024-10-22 16:59:41,102 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:41,103 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 16:59:41,103 - DEBUG - --- Rollout #9 ---
2024-10-22 16:59:41,103 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.44883453845977783 | PUCT: 0.44883453845977783
2024-10-22 16:59:41,104 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.3779718279838562 | PUCT: 0.3779718279838562
2024-10-22 16:59:41,104 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.30607709288597107 | PUCT: 0.30607709288597107
2024-10-22 16:59:41,104 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 0.44883453845977783
2024-10-22 16:59:41,104 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 16:59:41,104 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Discard 0))
2024-10-22 16:59:41,104 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Discard 0))']
2024-10-22 16:59:41,105 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 0 | Depth: 1
2024-10-22 16:59:41,105 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 2
2024-10-22 16:59:41,375 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:41,376 - DEBUG - Network Policy Logits: [[-0.02813454  0.01421901  0.03249921 -0.01662375 -0.00544111  0.05012786
   0.02629944  0.0013232   0.07524393  0.04256621 -0.07205983 -0.01761078
  -0.05424427  0.02586208  0.01686502  0.02179699 -0.02763638 -0.05430384
   0.04822122 -0.04941163]]
2024-10-22 16:59:41,376 - DEBUG - Network Policy after Softmax: [[0.04850314 0.05060154 0.05153506 0.04906467 0.04961643 0.0524516
  0.05121654 0.04995319 0.05378566 0.05205648 0.04641874 0.04901627
  0.04725312 0.05119414 0.05073561 0.05098645 0.04852731 0.04725031
  0.05235169 0.04748203]]
2024-10-22 16:59:41,378 - DEBUG - Normalized Policy: [[0.         0.         0.33275646 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.3292142  0.         0.
  0.33802938 0.        ]]
2024-10-22 16:59:41,379 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 0), (Discard 2)) | P=0.3327564597129822
2024-10-22 16:59:41,380 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 0), (Reveal player +1 rank 1)) | P=0.3292141854763031
2024-10-22 16:59:41,381 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 0), (Reveal player +1 rank 4)) | P=0.3380293846130371
2024-10-22 16:59:41,381 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Discard 0)) | Value: 0.0
2024-10-22 16:59:41,381 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:41,381 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'Y', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || RX|R1245
XX || XX|YGWB1245
XX || R3|R3
XX || XX|YGWB1245
XX || XX|YGWB12345
-----
G2 || XX|RGWB12345
B4 || XX|RGWB12345
G1 || XX|RGWB12345
Y4 || YX|Y12345
R4 || XX|RYGWB12345
Deck size: 38
Discards: B3 Y5}
2024-10-22 16:59:41,381 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:41,382 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 16:59:41,382 - DEBUG - --- Rollout #10 ---
2024-10-22 16:59:41,382 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.3063131272792816 | PUCT: 0.3063131272792816
2024-10-22 16:59:41,383 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.38692787289619446 | PUCT: 0.38692787289619446
2024-10-22 16:59:41,384 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3133296072483063 | PUCT: 0.3133296072483063
2024-10-22 16:59:41,384 - DEBUG - Selected Child: ((Discard 2),) | PUCT: 0.38692787289619446
2024-10-22 16:59:41,384 - DEBUG - Selected child for exploration: ((Discard 2),)
2024-10-22 16:59:41,385 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.792897641658783 | PUCT: 0.792897641658783
2024-10-22 16:59:41,385 - DEBUG - Selected Child: ((Discard 2), (Reveal player +1 rank 1)) | PUCT: 0.792897641658783
2024-10-22 16:59:41,385 - DEBUG - Selected child for exploration: ((Discard 2), (Reveal player +1 rank 1))
2024-10-22 16:59:41,385 - DEBUG - Expanding unexplored child: ((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 color Y))
2024-10-22 16:59:41,385 - DEBUG - Traversing Path: ['()', '((Discard 2),)', '((Discard 2), (Reveal player +1 rank 1))', '((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 color Y))']
2024-10-22 16:59:41,386 - DEBUG - Move: (Discard 2) | Reward: 0 | Depth: 1
2024-10-22 16:59:41,387 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:41,388 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 0 | Depth: 3
2024-10-22 16:59:41,587 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:41,587 - DEBUG - Network Policy Logits: [[ 0.0322741   0.0140333   0.01414552  0.00222091 -0.04078228  0.01566599
  -0.00015235  0.04353031  0.01670316  0.08503423 -0.04856042 -0.01301577
  -0.02492816  0.05072857  0.09913667 -0.0092839  -0.01529738 -0.04593141
   0.03907463 -0.03688626]]
2024-10-22 16:59:41,588 - DEBUG - Network Policy after Softmax: [[0.05114193 0.05021752 0.05022315 0.04962782 0.0475389  0.05029957
  0.04951018 0.05172085 0.05035177 0.05391264 0.04717057 0.04887739
  0.0482986  0.05209449 0.05467832 0.04906013 0.04876599 0.04729475
  0.05149091 0.04772447]]
2024-10-22 16:59:41,589 - DEBUG - Normalized Policy: [[0.34002364 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.31361955 0.
  0.         0.34635687 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:41,590 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 color Y), (Reveal player +1 color R)) | P=0.31361955404281616
2024-10-22 16:59:41,592 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 color Y), (Reveal player +1 color W)) | P=0.3463568687438965
2024-10-22 16:59:41,592 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 color Y), (Discard 0)) | P=0.34002363681793213
2024-10-22 16:59:41,592 - DEBUG - Simulating Node: ((Discard 2), (Reveal player +1 rank 1), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 16:59:41,592 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:41,592 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'Y', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'Y', 'rank': None}], [{'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || YX|Y12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || YX|Y12345
-----
R1 || R1|R1
W1 || X1|YGWB1
Y5 || XX|YGWB245
G4 || XX|YGWB2345
R2 || XX|RYGWB2345
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:41,593 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:41,593 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 16:59:41,593 - INFO - === MCTS Search Completed ===
2024-10-22 16:59:41,593 - DEBUG - Best node chosen by MCTS: ((Discard 2),) | Visit Count: 5
2024-10-22 16:59:41,593 - INFO - Actual Game Score: 0
2024-10-22 16:59:41,593 - DEBUG - === Recording Training Data ===
2024-10-22 16:59:41,593 - DEBUG - State Vector Shape: 658
2024-10-22 16:59:41,593 - DEBUG - Policy Targets: [0.         0.         0.55555556 0.         0.         0.
 0.         0.         0.         0.         0.         0.22222222
 0.         0.         0.         0.22222222 0.         0.
 0.         0.        ]
2024-10-22 16:59:41,593 - DEBUG - === End of Training Data ===
2024-10-22 16:59:41,593 - INFO - Chosen Action: (Discard 2) | Visit Count: 5
2024-10-22 16:59:41,594 - DEBUG - Not the current player's turn.
2024-10-22 16:59:44,115 - INFO - Agent state has been reset.
2024-10-22 16:59:44,115 - INFO - === Starting MCTS Search ===
2024-10-22 16:59:44,115 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || R4|R4
XX || XX|YGWB125
XX || XX|YGWB125
XX || XX|YGWB1235
XX || XX|RYGWB1235
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:44,116 - INFO - Max Rollouts: 10
2024-10-22 16:59:44,116 - DEBUG - --- Rollout #1 ---
2024-10-22 16:59:44,116 - DEBUG - Node () is a leaf node.
2024-10-22 16:59:44,116 - DEBUG - Traversing Path: ['()']
2024-10-22 16:59:44,357 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:44,357 - DEBUG - Network Policy Logits: [[ 0.02294403  0.0006372   0.00976337 -0.04563395 -0.00239179  0.07249825
  -0.0018291   0.00639224  0.05535929  0.0904898  -0.04306136 -0.04077102
  -0.03743826 -0.00279911  0.03917927  0.02676658 -0.04366196 -0.04601612
   0.07852524 -0.02115157]]
2024-10-22 16:59:44,358 - DEBUG - Network Policy after Softmax: [[0.05081347 0.04969253 0.05014811 0.04744558 0.04954224 0.05339492
  0.04957012 0.04997933 0.05248759 0.05436427 0.0475678  0.04767687
  0.04783603 0.04952206 0.05164517 0.05100808 0.04753924 0.04742745
  0.0537177  0.0486215 ]]
2024-10-22 16:59:44,359 - DEBUG - Normalized Policy: [[0.33989304 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.31891224
  0.         0.         0.         0.34119478 0.         0.
  0.         0.        ]]
2024-10-22 16:59:44,360 - DEBUG - Dirichlet Noise Added: [0.48918748 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.25491643
 0.         0.         0.         0.2558961  0.         0.
 0.         0.        ]
2024-10-22 16:59:44,360 - DEBUG - Added Child Node: ((Discard 0),) | P=0.48918747901916504
2024-10-22 16:59:44,361 - DEBUG - Added Child Node: ((Reveal player +1 color Y),) | P=0.2549164295196533
2024-10-22 16:59:44,361 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.25589609146118164
2024-10-22 16:59:44,362 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 16:59:44,362 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:44,362 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || R4|R4
XX || XX|YGWB125
XX || XX|YGWB125
XX || XX|YGWB1235
XX || XX|RYGWB1235
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:44,362 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:44,362 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 16:59:44,362 - DEBUG - --- Rollout #2 ---
2024-10-22 16:59:44,362 - DEBUG - Expanding unexplored child: ((Discard 0),)
2024-10-22 16:59:44,362 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 16:59:44,363 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 1
2024-10-22 16:59:44,590 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:44,591 - DEBUG - Network Policy Logits: [[ 0.02532319  0.00582242 -0.01340614 -0.02679622 -0.02163386  0.07243209
  -0.03841414  0.01284419 -0.0087477   0.10123184 -0.06114541  0.0236897
  -0.05936929  0.02467963  0.05305889 -0.01723622 -0.04542985 -0.05180139
   0.05832878 -0.03849154]]
2024-10-22 16:59:44,591 - DEBUG - Network Policy after Softmax: [[0.05124306 0.05025345 0.04929639 0.0486407  0.04889245 0.05371482
  0.04807887 0.05060757 0.04952657 0.05528429 0.0469983  0.05115942
  0.04708185 0.05121009 0.05268421 0.04910794 0.04774274 0.04743951
  0.05296258 0.04807515]]
2024-10-22 16:59:44,593 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]]
2024-10-22 16:59:44,594 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1)) | P=1.0
2024-10-22 16:59:44,594 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 16:59:44,595 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:44,595 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'B', 'rank': 0}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
Y1 || XX|YGWB125
G1 || XX|YGWB125
B1 || XX|YGWB1235
R3 || XX|RYGWB1235
Y2 || XX|RYGWB12345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:44,595 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:44,595 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 16:59:44,595 - DEBUG - --- Rollout #3 ---
2024-10-22 16:59:44,596 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y),)
2024-10-22 16:59:44,596 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)']
2024-10-22 16:59:44,596 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 0 | Depth: 1
2024-10-22 16:59:45,030 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:45,031 - DEBUG - Network Policy Logits: [[ 0.01575483  0.00115386  0.0311655   0.01850654 -0.0526108   0.01291465
  -0.00533661  0.04772364  0.00842303  0.09178011 -0.02967739 -0.00422037
  -0.01831964  0.02306537  0.06442983 -0.03114194 -0.02248259 -0.08583792
   0.07482024 -0.04301772]]
2024-10-22 16:59:45,032 - DEBUG - Network Policy after Softmax: [[0.05050115 0.04976914 0.05128543 0.0506403  0.04716397 0.05035792
  0.04944716 0.05214169 0.05013223 0.05449022 0.04825811 0.04950238
  0.04880933 0.05087169 0.05302009 0.04818748 0.04860656 0.0456226
  0.05357387 0.0476186 ]]
2024-10-22 16:59:45,036 - DEBUG - Normalized Policy: [[0.         0.5080733  0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.49192676 0.         0.
  0.         0.        ]]
2024-10-22 16:59:45,037 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 rank 1)) | P=0.49192675948143005
2024-10-22 16:59:45,038 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 1)) | P=0.5080732703208923
2024-10-22 16:59:45,039 - DEBUG - Simulating Node: ((Reveal player +1 color Y),) | Value: 0.0
2024-10-22 16:59:45,039 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:45,039 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 1}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'Y', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'Y', 'rank': None}], [{'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || YX|Y12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || YX|Y12345
-----
R4 || R4|R4
B5 || XX|YGWB125
G1 || XX|YGWB125
Y2 || XX|YGWB1235
Y1 || XX|RYGWB1235
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:45,039 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:45,039 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 16:59:45,039 - DEBUG - --- Rollout #4 ---
2024-10-22 16:59:45,040 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 16:59:45,040 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 16:59:45,041 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:45,329 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:45,330 - DEBUG - Network Policy Logits: [[-0.01771333 -0.00358825  0.02660676 -0.00459123 -0.0330909   0.00497954
  -0.01270905  0.00849709  0.00617907  0.0711939  -0.03054161 -0.01261345
  -0.03814919  0.02230999  0.06237222 -0.01626557  0.01684462 -0.05715102
   0.08036575 -0.07735036]]
2024-10-22 16:59:45,330 - DEBUG - Network Policy after Softmax: [[0.04909511 0.04979351 0.05131995 0.04974359 0.04834592 0.05022195
  0.04934141 0.05039892 0.05028224 0.05365994 0.04846932 0.04934613
  0.04810199 0.05109991 0.05318865 0.04916624 0.05082139 0.0471966
  0.05415436 0.04625282]]
2024-10-22 16:59:45,332 - DEBUG - Normalized Policy: [[0.2497395  0.         0.         0.         0.         0.25547156
  0.         0.         0.         0.         0.         0.
  0.24468763 0.         0.         0.2501013  0.         0.
  0.         0.        ]]
2024-10-22 16:59:45,334 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0)) | P=0.2554715573787689
2024-10-22 16:59:45,335 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0)) | P=0.24973949790000916
2024-10-22 16:59:45,336 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.2501012980937958
2024-10-22 16:59:45,338 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color G)) | P=0.24468763172626495
2024-10-22 16:59:45,338 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 16:59:45,338 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:45,338 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 38, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
R4 || R4|R4
G1 || XX|YGWB125
Y5 || XX|YGWB125
G3 || XX|YGWB1235
B1 || XX|RYGWB1235
Deck size: 38
Discards: B3 R3}
2024-10-22 16:59:45,338 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:45,338 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 16:59:45,338 - DEBUG - --- Rollout #5 ---
2024-10-22 16:59:45,340 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.7757511734962463 | PUCT: 0.7757511734962463
2024-10-22 16:59:45,341 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.4042452573776245 | PUCT: 0.4042452573776245
2024-10-22 16:59:45,342 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4057988226413727 | PUCT: 0.4057988226413727
2024-10-22 16:59:45,342 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.7757511734962463
2024-10-22 16:59:45,342 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 16:59:45,342 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 rank 1))
2024-10-22 16:59:45,342 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 rank 1))']
2024-10-22 16:59:45,343 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 1
2024-10-22 16:59:45,344 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:45,686 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:45,686 - DEBUG - Network Policy Logits: [[-0.03503734 -0.03176878  0.00513193 -0.02674607  0.0088452   0.00114364
  -0.03592733  0.00113269  0.0815374   0.06525421 -0.02272483 -0.06596424
  -0.0408495  -0.01998821  0.0630668  -0.01056584 -0.07636749 -0.03387108
   0.04288837 -0.01983544]]
2024-10-22 16:59:45,686 - DEBUG - Network Policy after Softmax: [[0.04860135 0.04876047 0.05059337 0.04900599 0.05078159 0.05039199
  0.04855811 0.05039144 0.05461049 0.05372846 0.04920345 0.04712126
  0.04831969 0.04933829 0.05361106 0.04980537 0.04663359 0.04865806
  0.05254011 0.04934582]]
2024-10-22 16:59:45,688 - DEBUG - Normalized Policy: [[0.24806736 0.         0.         0.         0.         0.25720704
  0.         0.         0.         0.         0.         0.24051283
  0.         0.         0.         0.25421283 0.         0.
  0.         0.        ]]
2024-10-22 16:59:45,690 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Play 0)) | P=0.2572070360183716
2024-10-22 16:59:45,691 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Discard 0)) | P=0.24806736409664154
2024-10-22 16:59:45,692 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 color Y)) | P=0.24051283299922943
2024-10-22 16:59:45,692 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.2542128264904022
2024-10-22 16:59:45,693 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:45,693 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:45,693 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X1|YGWB1
XX || XX|YGWB25
XX || X1|YGWB1
XX || X1|RYGWB1
XX || X1|RYGWB1
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:45,693 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:45,693 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 16:59:45,693 - DEBUG - --- Rollout #6 ---
2024-10-22 16:59:45,694 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.5456748604774475 | PUCT: 0.5456748604774475
2024-10-22 16:59:45,695 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.42652812600135803 | PUCT: 0.42652812600135803
2024-10-22 16:59:45,695 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.42816731333732605 | PUCT: 0.42816731333732605
2024-10-22 16:59:45,695 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.5456748604774475
2024-10-22 16:59:45,695 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 16:59:45,696 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 1)) | Q: 0.0 | U: 1.3101838827133179 | PUCT: 1.3101838827133179
2024-10-22 16:59:45,696 - DEBUG - Selected Child: ((Discard 0), (Reveal player +1 rank 1)) | PUCT: 1.3101838827133179
2024-10-22 16:59:45,696 - DEBUG - Selected child for exploration: ((Discard 0), (Reveal player +1 rank 1))
2024-10-22 16:59:45,696 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 rank 1))
2024-10-22 16:59:45,696 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 rank 1))', '((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 rank 1))']
2024-10-22 16:59:45,697 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 1
2024-10-22 16:59:45,698 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:45,698 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 3
2024-10-22 16:59:46,024 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:46,025 - DEBUG - Network Policy Logits: [[-0.00400562  0.01404321 -0.01375011 -0.006038    0.01568481 -0.01534216
   0.02618637  0.00504804  0.01103016  0.06955488 -0.05404293 -0.02395631
  -0.06383755  0.0421772   0.06734746 -0.0061933  -0.02001229 -0.01588769
   0.06304692 -0.08089241]]
2024-10-22 16:59:46,025 - DEBUG - Network Policy after Softmax: [[0.04973543 0.05064125 0.04925314 0.04963446 0.05072445 0.04917479
  0.05125995 0.05018777 0.0504889  0.05353192 0.04730804 0.04875301
  0.04684694 0.05208623 0.05341389 0.04962675 0.04894567 0.04914797
  0.05318467 0.04605475]]
2024-10-22 16:59:46,027 - DEBUG - Normalized Policy: [[0.33681664 0.         0.         0.         0.         0.33301988
  0.         0.         0.         0.         0.         0.3301635
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:46,028 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 rank 1), (Play 0)) | P=0.333019882440567
2024-10-22 16:59:46,029 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 rank 1), (Discard 0)) | P=0.3368166387081146
2024-10-22 16:59:46,030 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 rank 1), (Reveal player +1 color Y)) | P=0.33016350865364075
2024-10-22 16:59:46,030 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:46,030 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:46,030 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 13, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 4}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
W5 || XX|YGWB25
Y1 || X1|YGWB1
B2 || XX|YGWB235
Y5 || XX|RYGWB235
Y2 || XX|RYGWB2345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:46,030 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:46,030 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 16:59:46,030 - DEBUG - --- Rollout #7 ---
2024-10-22 16:59:46,031 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.42649775743484497 | PUCT: 0.42649775743484497
2024-10-22 16:59:46,031 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.44449740648269653 | PUCT: 0.44449740648269653
2024-10-22 16:59:46,032 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.44620564579963684 | PUCT: 0.44620564579963684
2024-10-22 16:59:46,032 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.44620564579963684
2024-10-22 16:59:46,032 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:46,032 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 color G))
2024-10-22 16:59:46,032 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 color G))']
2024-10-22 16:59:46,033 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:46,033 - DEBUG - Illegal move encountered: (Reveal player +1 color G)
2024-10-22 16:59:46,033 - DEBUG - Backpropagating reward: 0
2024-10-22 16:59:46,034 - DEBUG - Rollout #7 completed with reward=0
2024-10-22 16:59:46,034 - DEBUG - --- Rollout #8 ---
2024-10-22 16:59:46,035 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4408884346485138 | PUCT: 0.4408884346485138
2024-10-22 16:59:46,038 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.4594954252243042 | PUCT: 0.4594954252243042
2024-10-22 16:59:46,039 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.30750754475593567 | PUCT: 0.30750754475593567
2024-10-22 16:59:46,039 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 0.4594954252243042
2024-10-22 16:59:46,039 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 16:59:46,039 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Discard 1))
2024-10-22 16:59:46,039 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Discard 1))']
2024-10-22 16:59:46,040 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 0 | Depth: 1
2024-10-22 16:59:46,041 - DEBUG - Move: (Discard 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:46,335 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:46,336 - DEBUG - Network Policy Logits: [[-0.00390399  0.03006488  0.02543995 -0.0077935  -0.03563635  0.06272365
   0.0145131  -0.00902056  0.04797656  0.07641064 -0.06670616 -0.02769783
  -0.0202003  -0.00737632  0.01335198  0.03624937 -0.01438703 -0.05419855
   0.07784211 -0.00032604]]
2024-10-22 16:59:46,336 - DEBUG - Network Policy after Softmax: [[0.04942635 0.05113415 0.05089821 0.04923448 0.04788256 0.0528317
  0.05034508 0.04917411 0.0520583  0.05355978 0.04641773 0.04826419
  0.04862741 0.04925502 0.05028665 0.05145137 0.04891092 0.04700196
  0.0536365  0.04960351]]
2024-10-22 16:59:46,338 - DEBUG - Normalized Policy: [[0.3198822  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.3329879  0.         0.
  0.34712985 0.        ]]
2024-10-22 16:59:46,339 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 1), (Discard 0)) | P=0.31988221406936646
2024-10-22 16:59:46,341 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 1), (Reveal player +1 rank 1)) | P=0.332987904548645
2024-10-22 16:59:46,342 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 1), (Reveal player +1 rank 4)) | P=0.34712985157966614
2024-10-22 16:59:46,342 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Discard 1)) | Value: 0.0
2024-10-22 16:59:46,342 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:46,342 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'Y', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || R4|R4
XX || XX|YGWB125
XX || XX|YGWB125
XX || XX|YGWB1235
XX || XX|RYGWB1235
-----
Y1 || YX|Y12345
B4 || XX|RGWB12345
G1 || XX|RGWB12345
Y4 || YX|Y12345
G3 || XX|RYGWB12345
Deck size: 37
Discards: B3 R3 R2}
2024-10-22 16:59:46,342 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:46,342 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 16:59:46,342 - DEBUG - --- Rollout #9 ---
2024-10-22 16:59:46,343 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4532028138637543 | PUCT: 0.4532028138637543
2024-10-22 16:59:46,344 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.31488633155822754 | PUCT: 0.31488633155822754
2024-10-22 16:59:46,344 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3160964548587799 | PUCT: 0.3160964548587799
2024-10-22 16:59:46,345 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.4532028138637543
2024-10-22 16:59:46,345 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 16:59:46,345 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.9811750054359436 | PUCT: 0.9811750054359436
2024-10-22 16:59:46,345 - DEBUG - Selected Child: ((Discard 0), (Reveal player +1 rank 1)) | PUCT: 0.9811750054359436
2024-10-22 16:59:46,345 - DEBUG - Selected child for exploration: ((Discard 0), (Reveal player +1 rank 1))
2024-10-22 16:59:46,345 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 rank 1), (Discard 0))
2024-10-22 16:59:46,345 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 rank 1))', '((Discard 0), (Reveal player +1 rank 1), (Discard 0))']
2024-10-22 16:59:46,346 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 1
2024-10-22 16:59:46,347 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:46,347 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 3
2024-10-22 16:59:46,567 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:46,568 - DEBUG - Network Policy Logits: [[ 0.00711469  0.00650085  0.01432693 -0.00866924 -0.01052693  0.08799361
  -0.03736883 -0.02362609 -0.00505407  0.06878999 -0.02160814  0.01034531
  -0.08425103 -0.0041467   0.05969071 -0.02927823 -0.00876061 -0.03475504
   0.05649725 -0.03101692]]
2024-10-22 16:59:46,568 - DEBUG - Network Policy after Softmax: [[0.05028521 0.05025436 0.0506492  0.04949775 0.04940588 0.05452122
  0.04809738 0.04876292 0.04967701 0.05348421 0.04886143 0.05044793
  0.0458945  0.04972211 0.05299975 0.04848809 0.04949323 0.04822325
  0.05283076 0.04840386]]
2024-10-22 16:59:46,569 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]]
2024-10-22 16:59:46,570 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Discard 0), (Reveal player +1 color W)) | P=1.0
2024-10-22 16:59:46,570 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 rank 1), (Discard 0)) | Value: 0.0
2024-10-22 16:59:46,570 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:46,571 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
W1 || X1|YGWB1
W1 || X1|YGWB1
G1 || X1|RYGWB1
R5 || XX|RYGWB2345
B2 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4 Y2}
2024-10-22 16:59:46,571 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:46,571 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 16:59:46,571 - DEBUG - --- Rollout #10 ---
2024-10-22 16:59:46,572 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.37115317583084106 | PUCT: 0.37115317583084106
2024-10-22 16:59:46,572 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.32234758138656616 | PUCT: 0.32234758138656616
2024-10-22 16:59:46,572 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3235863745212555 | PUCT: 0.3235863745212555
2024-10-22 16:59:46,573 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.37115317583084106
2024-10-22 16:59:46,573 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 16:59:46,573 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.792897641658783 | PUCT: 0.792897641658783
2024-10-22 16:59:46,573 - DEBUG - Selected Child: ((Discard 0), (Reveal player +1 rank 1)) | PUCT: 0.792897641658783
2024-10-22 16:59:46,573 - DEBUG - Selected child for exploration: ((Discard 0), (Reveal player +1 rank 1))
2024-10-22 16:59:46,573 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 color Y))
2024-10-22 16:59:46,573 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 rank 1))', '((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 color Y))']
2024-10-22 16:59:46,574 - DEBUG - Move: (Discard 0) | Reward: 0 | Depth: 1
2024-10-22 16:59:46,575 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:46,575 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 0 | Depth: 3
2024-10-22 16:59:46,869 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:46,869 - DEBUG - Network Policy Logits: [[ 0.00907901  0.03158316  0.00882883  0.00713685 -0.01184389  0.02329342
   0.00430771  0.03277374 -0.0128838   0.08754773 -0.03197236  0.01587991
  -0.00228003  0.04421025  0.04494632 -0.00198034 -0.07245965 -0.05196845
   0.01749096 -0.07203948]]
2024-10-22 16:59:46,870 - DEBUG - Network Policy after Softmax: [[0.05024395 0.05138746 0.05023138 0.05014646 0.04920362 0.05096323
  0.05000479 0.05144868 0.04915248 0.05434534 0.04822313 0.05058681
  0.04967645 0.05204045 0.05207877 0.04969134 0.0463097  0.04726843
  0.05066838 0.04632916]]
2024-10-22 16:59:46,871 - DEBUG - Normalized Policy: [[0.32549185 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.33713    0.33737823 0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:46,872 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 color Y), (Reveal player +1 color W)) | P=0.33713001012802124
2024-10-22 16:59:46,873 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 color Y), (Discard 0)) | P=0.32549184560775757
2024-10-22 16:59:46,873 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 color Y), (Reveal player +1 color B)) | P=0.33737823367118835
2024-10-22 16:59:46,873 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 16:59:46,873 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:46,873 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'Y', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'Y', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'Y', 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || YX|Y12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || YX|Y12345
-----
W2 || XX|YGWB25
B1 || X1|YGWB1
Y1 || X1|YGWB1
W1 || X1|RYGWB1
R4 || XX|RYGWB2345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:46,874 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:46,874 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 16:59:46,874 - INFO - === MCTS Search Completed ===
2024-10-22 16:59:46,874 - DEBUG - Best node chosen by MCTS: ((Discard 0),) | Visit Count: 5
2024-10-22 16:59:46,874 - INFO - Actual Game Score: 0
2024-10-22 16:59:46,874 - DEBUG - === Recording Training Data ===
2024-10-22 16:59:46,874 - DEBUG - State Vector Shape: 658
2024-10-22 16:59:46,874 - DEBUG - Policy Targets: [0.55555556 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.22222222
 0.         0.         0.         0.22222222 0.         0.
 0.         0.        ]
2024-10-22 16:59:46,874 - DEBUG - === End of Training Data ===
2024-10-22 16:59:46,874 - INFO - Chosen Action: (Discard 0) | Visit Count: 5
2024-10-22 16:59:46,875 - DEBUG - Not the current player's turn.
2024-10-22 16:59:49,417 - INFO - Agent state has been reset.
2024-10-22 16:59:49,417 - INFO - === Starting MCTS Search ===
2024-10-22 16:59:49,417 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X2|YGWB2
XX || XX|YGWB15
XX || X2|YGWB2
XX || X2|RYGWB2
XX || XX|RYGWB1345
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:49,417 - INFO - Max Rollouts: 10
2024-10-22 16:59:49,417 - DEBUG - --- Rollout #1 ---
2024-10-22 16:59:49,418 - DEBUG - Node () is a leaf node.
2024-10-22 16:59:49,418 - DEBUG - Traversing Path: ['()']
2024-10-22 16:59:49,750 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:49,750 - DEBUG - Network Policy Logits: [[-0.00246222 -0.01158092 -0.00916536 -0.01237402  0.02489991  0.0479569
   0.00329848 -0.00989416  0.06413493  0.06349115 -0.01989276 -0.02964142
  -0.03686438  0.00218895  0.04377504  0.01502382 -0.06913263 -0.02375512
   0.0457865  -0.04688643]]
2024-10-22 16:59:49,750 - DEBUG - Network Policy after Softmax: [[0.04974784 0.04929626 0.04941548 0.04925718 0.05112784 0.05232039
  0.05003525 0.04937948 0.05317371 0.05313949 0.04888821 0.04841394
  0.04806551 0.04997976 0.05210205 0.05062538 0.04653927 0.04869976
  0.05220695 0.0475862 ]]
2024-10-22 16:59:49,752 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24835753 0.         0.
  0.25228056 0.         0.         0.         0.         0.24410586
  0.         0.         0.         0.25525606 0.         0.
  0.         0.        ]]
2024-10-22 16:59:49,753 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.18626815 0.         0.
 0.3685875  0.         0.         0.         0.         0.25370228
 0.         0.         0.         0.19144204 0.         0.
 0.         0.        ]
2024-10-22 16:59:49,754 - DEBUG - Added Child Node: ((Discard 3),) | P=0.186268150806427
2024-10-22 16:59:49,754 - DEBUG - Added Child Node: ((Reveal player +1 color Y),) | P=0.2537022829055786
2024-10-22 16:59:49,755 - DEBUG - Added Child Node: ((Play 1),) | P=0.3685874938964844
2024-10-22 16:59:49,756 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.19144204258918762
2024-10-22 16:59:49,756 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 16:59:49,756 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:49,756 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X2|YGWB2
XX || XX|YGWB15
XX || X2|YGWB2
XX || X2|RYGWB2
XX || XX|RYGWB1345
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:49,756 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:49,756 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 16:59:49,756 - DEBUG - --- Rollout #2 ---
2024-10-22 16:59:49,757 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y),)
2024-10-22 16:59:49,757 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)']
2024-10-22 16:59:49,757 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 0 | Depth: 1
2024-10-22 16:59:50,127 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:50,128 - DEBUG - Network Policy Logits: [[ 0.0224157  -0.00036884  0.03651159 -0.01621314 -0.02185344  0.02108467
   0.04272481  0.03357591  0.00158391  0.06480074 -0.04145885 -0.00542367
  -0.02980114  0.00653097  0.07400858  0.0189777  -0.0255134  -0.028397
   0.0263015  -0.03061864]]
2024-10-22 16:59:50,128 - DEBUG - Network Policy after Softmax: [[0.05072793 0.04958518 0.05144805 0.04880574 0.04853123 0.05066045
  0.0517687  0.05129723 0.04968211 0.05292425 0.04758902 0.04933517
  0.04814705 0.0499285  0.05341382 0.05055382 0.04835393 0.0482147
  0.05092543 0.0481077 ]]
2024-10-22 16:59:50,131 - DEBUG - Normalized Policy: [[0.32792103 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34528345 0.32679555 0.         0.
  0.         0.        ]]
2024-10-22 16:59:50,131 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 0)) | P=0.3279210329055786
2024-10-22 16:59:50,132 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 rank 1)) | P=0.3267955482006073
2024-10-22 16:59:50,133 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color B)) | P=0.3452834486961365
2024-10-22 16:59:50,134 - DEBUG - Simulating Node: ((Reveal player +1 color Y),) | Value: 0.0
2024-10-22 16:59:50,134 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:50,134 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 1}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'Y', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'Y', 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || YX|Y12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || YX|Y12345
-----
B2 || X2|YGWB2
B1 || XX|YGWB15
W2 || X2|YGWB2
R2 || X2|RYGWB2
Y3 || XX|RYGWB1345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:50,134 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:50,134 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 16:59:50,134 - DEBUG - --- Rollout #3 ---
2024-10-22 16:59:50,134 - DEBUG - Expanding unexplored child: ((Play 1),)
2024-10-22 16:59:50,134 - DEBUG - Traversing Path: ['()', '((Play 1),)']
2024-10-22 16:59:50,135 - DEBUG - Move: (Play 1) | Reward: 1 | Depth: 1
2024-10-22 16:59:50,344 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:50,344 - DEBUG - Network Policy Logits: [[ 0.00049152  0.04575211 -0.03013603 -0.03543259 -0.00989263  0.08665439
   0.00337217  0.05303598 -0.00969011  0.09789099 -0.02618463 -0.03516775
  -0.05027316 -0.02297109  0.06883433 -0.01041797  0.00054574 -0.0380401
   0.03106268 -0.05826176]]
2024-10-22 16:59:50,344 - DEBUG - Network Policy after Softmax: [[0.04982167 0.05212844 0.04831888 0.04806364 0.04930699 0.05430481
  0.0499654  0.05250952 0.04931698 0.05491846 0.04851019 0.04807637
  0.04735561 0.04866633 0.05334567 0.04928109 0.04982437 0.04793847
  0.0513683  0.04697881]]
2024-10-22 16:59:50,346 - DEBUG - Normalized Policy: [[0.3399303  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.32802218
  0.         0.33204746 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:50,346 - DEBUG - Added Child Node: ((Play 1), (Reveal player +1 color W)) | P=0.3320474624633789
2024-10-22 16:59:50,348 - DEBUG - Added Child Node: ((Play 1), (Discard 0)) | P=0.33993029594421387
2024-10-22 16:59:50,348 - DEBUG - Added Child Node: ((Play 1), (Reveal player +1 color Y)) | P=0.32802218198776245
2024-10-22 16:59:50,349 - DEBUG - Simulating Node: ((Play 1),) | Value: 0.0
2024-10-22 16:59:50,349 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:50,349 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
W2 || X2|YGWB2
G2 || X2|YGWB2
Y2 || X2|RYGWB2
W4 || XX|RYGWB1345
G3 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:50,349 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:50,349 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 16:59:50,349 - DEBUG - --- Rollout #4 ---
2024-10-22 16:59:50,349 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 16:59:50,349 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 16:59:50,350 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:50,544 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:50,544 - DEBUG - Network Policy Logits: [[-0.00600908 -0.00529696  0.02507617 -0.01989351  0.01245857  0.01319094
   0.04939742 -0.00808682  0.00894475  0.05279699 -0.04633805 -0.03811639
  -0.05583819  0.00357107  0.07358077  0.00565973  0.00966298 -0.02327695
   0.04745255 -0.05736153]]
2024-10-22 16:59:50,545 - DEBUG - Network Policy after Softmax: [[0.04956614 0.04960145 0.05113112 0.0488827  0.05049002 0.05052701
  0.05238994 0.04946326 0.05031292 0.05256834 0.04760696 0.04799999
  0.04715683 0.05004328 0.05367234 0.05014791 0.05034906 0.04871759
  0.05228814 0.04708505]]
2024-10-22 16:59:50,546 - DEBUG - Normalized Policy: [[0.24307449 0.         0.         0.         0.         0.24778663
  0.         0.         0.         0.         0.         0.
  0.         0.         0.26321146 0.24592748 0.         0.
  0.         0.        ]]
2024-10-22 16:59:50,547 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0)) | P=0.24778662621974945
2024-10-22 16:59:50,548 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0)) | P=0.24307449162006378
2024-10-22 16:59:50,548 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.24592748284339905
2024-10-22 16:59:50,549 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.2632114589214325
2024-10-22 16:59:50,549 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 16:59:50,549 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:50,549 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
B2 || X2|YGWB2
B1 || XX|YGWB15
G2 || X2|YGWB2
B2 || X2|RYGWB2
Y5 || XX|RYGWB1345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:50,549 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:50,549 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 16:59:50,549 - DEBUG - --- Rollout #5 ---
2024-10-22 16:59:50,550 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 16:59:50,550 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 16:59:50,550 - DEBUG - Move: (Discard 3) | Reward: 0 | Depth: 1
2024-10-22 16:59:50,801 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:50,802 - DEBUG - Network Policy Logits: [[ 0.00803205  0.03965903 -0.0089804  -0.03990654  0.00333929  0.07287448
  -0.01149638  0.03067861 -0.01789124  0.068444   -0.03985993  0.00727919
  -0.05730462  0.00814271  0.07690779 -0.00276635  0.00740369 -0.03386038
   0.04018259 -0.0479723 ]]
2024-10-22 16:59:50,802 - DEBUG - Network Policy after Softmax: [[0.05010653 0.05171658 0.04926131 0.04776116 0.04987194 0.05346321
  0.04913752 0.05125422 0.0488243  0.05322687 0.04776338 0.05006882
  0.04693739 0.05011208 0.05367928 0.04956837 0.05007505 0.04805081
  0.05174366 0.04737748]]
2024-10-22 16:59:50,803 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.50272727 0.         0.49727276 0.         0.
  0.         0.        ]]
2024-10-22 16:59:50,804 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color W)) | P=0.5027272701263428
2024-10-22 16:59:50,805 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1)) | P=0.4972727596759796
2024-10-22 16:59:50,805 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 16:59:50,805 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:50,805 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 8, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 12, 13, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 8
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
W2 || X2|YGWB2
G1 || XX|YGWB15
B2 || X2|YGWB2
W3 || XX|RYGWB1345
B1 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4 Y2}
2024-10-22 16:59:50,805 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:50,805 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 16:59:50,805 - DEBUG - --- Rollout #6 ---
2024-10-22 16:59:50,806 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.4244966208934784 | PUCT: 0.4244966208934784
2024-10-22 16:59:50,807 - DEBUG - PUCT Calculation | Child: ((Play 1),) | Q: 0.0 | U: 0.6167234182357788 | PUCT: 0.6167234182357788
2024-10-22 16:59:50,807 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.32032230496406555 | PUCT: 0.32032230496406555
2024-10-22 16:59:50,807 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.31166529655456543 | PUCT: 0.31166529655456543
2024-10-22 16:59:50,808 - DEBUG - Selected Child: ((Play 1),) | PUCT: 0.6167234182357788
2024-10-22 16:59:50,808 - DEBUG - Selected child for exploration: ((Play 1),)
2024-10-22 16:59:50,808 - DEBUG - Expanding unexplored child: ((Play 1), (Reveal player +1 color W))
2024-10-22 16:59:50,808 - DEBUG - Traversing Path: ['()', '((Play 1),)', '((Play 1), (Reveal player +1 color W))']
2024-10-22 16:59:50,809 - DEBUG - Move: (Play 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:50,809 - DEBUG - Move: (Reveal player +1 color W) | Reward: 0 | Depth: 2
2024-10-22 16:59:51,020 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:51,021 - DEBUG - Network Policy Logits: [[-0.03078674 -0.0157196  -0.0196298  -0.03081562  0.01351552  0.03028646
  -0.03069003  0.02585037  0.03881503  0.04280371 -0.02719424 -0.07008278
  -0.05830644  0.0134168   0.05845781  0.02008657 -0.07828142 -0.03103821
   0.05762573 -0.00987004]]
2024-10-22 16:59:51,021 - DEBUG - Network Policy after Softmax: [[0.04869247 0.04943169 0.04923877 0.04869106 0.05089816 0.05175896
  0.04869718 0.05152987 0.05220228 0.05241092 0.04886771 0.04681616
  0.04737074 0.05089313 0.05323782 0.05123372 0.0464339  0.04868023
  0.05319354 0.04972168]]
2024-10-22 16:59:51,022 - DEBUG - Normalized Policy: [[0.         0.33517197 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.31743738
  0.         0.         0.         0.34739065 0.         0.
  0.         0.        ]]
2024-10-22 16:59:51,023 - DEBUG - Added Child Node: ((Play 1), (Reveal player +1 color W), (Reveal player +1 color Y)) | P=0.31743738055229187
2024-10-22 16:59:51,023 - DEBUG - Added Child Node: ((Play 1), (Reveal player +1 color W), (Discard 1)) | P=0.33517196774482727
2024-10-22 16:59:51,024 - DEBUG - Added Child Node: ((Play 1), (Reveal player +1 color W), (Reveal player +1 rank 1)) | P=0.34739065170288086
2024-10-22 16:59:51,024 - DEBUG - Simulating Node: ((Play 1), (Reveal player +1 color W)) | Value: 0.0
2024-10-22 16:59:51,024 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:51,024 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': 'W', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': 'W', 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X2|YGB2
XX || W2|W2
XX || X2|RYGB2
XX || XX|RYGB1345
XX || WX|W12345
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4 G5}
2024-10-22 16:59:51,024 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:51,024 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 16:59:51,024 - DEBUG - --- Rollout #7 ---
2024-10-22 16:59:51,025 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.44238030910491943 | PUCT: 0.44238030910491943
2024-10-22 16:59:51,025 - DEBUG - PUCT Calculation | Child: ((Play 1),) | Q: 0.0 | U: 0.42847034335136414 | PUCT: 0.42847034335136414
2024-10-22 16:59:51,026 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3338172137737274 | PUCT: 0.3338172137737274
2024-10-22 16:59:51,026 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.32479551434516907 | PUCT: 0.32479551434516907
2024-10-22 16:59:51,026 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 0.44238030910491943
2024-10-22 16:59:51,027 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 16:59:51,027 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Reveal player +1 color B))
2024-10-22 16:59:51,027 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 color B))']
2024-10-22 16:59:51,027 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 0 | Depth: 1
2024-10-22 16:59:51,028 - DEBUG - Move: (Reveal player +1 color B) | Reward: 0 | Depth: 2
2024-10-22 16:59:51,215 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:51,216 - DEBUG - Network Policy Logits: [[ 0.01342101  0.00258602 -0.01387947  0.00381801 -0.02123859  0.0187391
  -0.01735481 -0.05370073  0.06412459  0.0431077  -0.04086905 -0.01558028
  -0.04280129 -0.01852988  0.01231272  0.02419922 -0.04729936 -0.02669798
   0.03171331 -0.01221132]]
2024-10-22 16:59:51,216 - DEBUG - Network Policy after Softmax: [[0.05089572 0.05034724 0.04952504 0.05040931 0.04916191 0.05116711
  0.04935322 0.04759164 0.05354286 0.0524293  0.04820625 0.04944088
  0.0481132  0.04929526 0.05083934 0.05144725 0.04789727 0.04889425
  0.05183529 0.04960772]]
2024-10-22 16:59:51,218 - DEBUG - Normalized Policy: [[0.25006315 0.         0.         0.         0.         0.
  0.24248447 0.         0.         0.         0.         0.
  0.         0.         0.         0.25277296 0.         0.
  0.25467947 0.        ]]
2024-10-22 16:59:51,219 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color B), (Discard 0)) | P=0.2500631511211395
2024-10-22 16:59:51,219 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color B), (Reveal player +1 rank 1)) | P=0.2527729570865631
2024-10-22 16:59:51,220 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color B), (Play 1)) | P=0.2424844652414322
2024-10-22 16:59:51,220 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color B), (Reveal player +1 rank 4)) | P=0.25467947125434875
2024-10-22 16:59:51,221 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 16:59:51,221 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:51,221 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 5, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'Y', 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 5
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|YGW15
XX || B2|B2
XX || X2|RYGW2
XX || XX|RYGW1345
-----
Y1 || YX|Y12345
G2 || XX|RGWB12345
B4 || XX|RGWB12345
G1 || XX|RGWB12345
Y4 || YX|Y12345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:51,221 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:51,221 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 16:59:51,221 - DEBUG - --- Rollout #8 ---
2024-10-22 16:59:51,222 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.30487126111984253 | PUCT: 0.30487126111984253
2024-10-22 16:59:51,222 - DEBUG - PUCT Calculation | Child: ((Play 1),) | Q: 0.0 | U: 0.4429275691509247 | PUCT: 0.4429275691509247
2024-10-22 16:59:51,222 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.345080703496933 | PUCT: 0.345080703496933
2024-10-22 16:59:51,223 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3357546031475067 | PUCT: 0.3357546031475067
2024-10-22 16:59:51,223 - DEBUG - Selected Child: ((Play 1),) | PUCT: 0.4429275691509247
2024-10-22 16:59:51,223 - DEBUG - Selected child for exploration: ((Play 1),)
2024-10-22 16:59:51,223 - DEBUG - Expanding unexplored child: ((Play 1), (Reveal player +1 color Y))
2024-10-22 16:59:51,223 - DEBUG - Traversing Path: ['()', '((Play 1),)', '((Play 1), (Reveal player +1 color Y))']
2024-10-22 16:59:51,224 - DEBUG - Move: (Play 1) | Reward: 1 | Depth: 1
2024-10-22 16:59:51,224 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 1 | Depth: 2
2024-10-22 16:59:51,416 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:51,417 - DEBUG - Network Policy Logits: [[-0.02687618  0.00649888 -0.01324513 -0.03203212  0.01008907  0.03390219
  -0.04305746  0.00428656  0.03674424  0.07899153 -0.02559596 -0.0304288
  -0.05502488 -0.01688834  0.06008667  0.02528156 -0.06891137 -0.02641529
   0.05405122 -0.01717543]]
2024-10-22 16:59:51,417 - DEBUG - Network Policy after Softmax: [[0.04874825 0.05040268 0.04941729 0.04849755 0.05058396 0.05180298
  0.04796579 0.0502913  0.05195042 0.0541922  0.0488107  0.04857538
  0.04739519 0.04923758 0.05317733 0.05135833 0.04674158 0.04877073
  0.05285735 0.04922345]]
2024-10-22 16:59:51,418 - DEBUG - Normalized Policy: [[0.         0.         0.         0.3267341  0.         0.
  0.         0.         0.         0.         0.         0.32725844
  0.         0.         0.         0.3460075  0.         0.
  0.         0.        ]]
2024-10-22 16:59:51,419 - DEBUG - Added Child Node: ((Play 1), (Reveal player +1 color Y), (Discard 3)) | P=0.32673409581184387
2024-10-22 16:59:51,420 - DEBUG - Added Child Node: ((Play 1), (Reveal player +1 color Y), (Reveal player +1 color Y)) | P=0.327258437871933
2024-10-22 16:59:51,420 - DEBUG - Added Child Node: ((Play 1), (Reveal player +1 color Y), (Reveal player +1 rank 1)) | P=0.34600749611854553
2024-10-22 16:59:51,420 - DEBUG - Simulating Node: ((Play 1), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 16:59:51,420 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:51,420 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y0 G1 W0 B0 
Hands:
Cur player
XX || X2|GWB2
XX || X2|GWB2
XX || Y2|Y2
XX || XX|RGWB1345
XX || XX|RGWB12345
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:51,420 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:51,421 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 16:59:51,421 - DEBUG - --- Rollout #9 ---
2024-10-22 16:59:51,421 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.31338655948638916 | PUCT: 0.31338655948638916
2024-10-22 16:59:51,422 - DEBUG - PUCT Calculation | Child: ((Play 1),) | Q: 0.0 | U: 0.34147417545318604 | PUCT: 0.34147417545318604
2024-10-22 16:59:51,422 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3547190725803375 | PUCT: 0.3547190725803375
2024-10-22 16:59:51,422 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3451324999332428 | PUCT: 0.3451324999332428
2024-10-22 16:59:51,423 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.3547190725803375
2024-10-22 16:59:51,423 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:51,423 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 color B))
2024-10-22 16:59:51,423 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 color B))']
2024-10-22 16:59:51,423 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 1
2024-10-22 16:59:51,424 - DEBUG - Move: (Reveal player +1 color B) | Reward: 0 | Depth: 2
2024-10-22 16:59:51,609 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:51,609 - DEBUG - Network Policy Logits: [[ 0.00347899 -0.01153771 -0.01468624  0.018135    0.0198673  -0.01910904
  -0.02395727 -0.01005507  0.01841546  0.05248347 -0.04873155 -0.0160433
  -0.00987942  0.05043263  0.02377895  0.01429681 -0.05420971 -0.02705766
   0.04044975 -0.02644831]]
2024-10-22 16:59:51,609 - DEBUG - Network Policy after Softmax: [[0.05020371 0.04945545 0.04929998 0.05094492 0.05103325 0.04908242
  0.04884503 0.04952883 0.05095921 0.0527252  0.0476498  0.04923313
  0.04953753 0.05261718 0.05123326 0.05074975 0.04738948 0.04869383
  0.05209452 0.04872351]]
2024-10-22 16:59:51,611 - DEBUG - Normalized Policy: [[0.         0.         0.         0.34185922 0.         0.
  0.32776824 0.         0.         0.         0.         0.33037248
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:51,612 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Discard 3)) | P=0.34185922145843506
2024-10-22 16:59:51,612 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Reveal player +1 color Y)) | P=0.33037248253822327
2024-10-22 16:59:51,613 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Play 1)) | P=0.3277682363986969
2024-10-22 16:59:51,613 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 16:59:51,613 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:51,613 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 5, 'num_players': 2, 'deck_size': 37, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 5
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X2|YGW2
XX || XX|YGW15
XX || X2|YGW2
XX || X2|RYGW2
XX || BX|B1345
-----
Y1 || X1|RYGWB1
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
Deck size: 37
Discards: B3 R3 R4}
2024-10-22 16:59:51,613 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:51,613 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 16:59:51,613 - DEBUG - --- Rollout #10 ---
2024-10-22 16:59:51,614 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.32081225514411926 | PUCT: 0.32081225514411926
2024-10-22 16:59:51,615 - DEBUG - PUCT Calculation | Child: ((Play 1),) | Q: 0.0 | U: 0.34956541657447815 | PUCT: 0.34956541657447815
2024-10-22 16:59:51,615 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.24208277463912964 | PUCT: 0.24208277463912964
2024-10-22 16:59:51,615 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3533104360103607 | PUCT: 0.3533104360103607
2024-10-22 16:59:51,616 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.3533104360103607
2024-10-22 16:59:51,616 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 16:59:51,616 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 1))
2024-10-22 16:59:51,616 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 1))']
2024-10-22 16:59:51,617 - DEBUG - Move: (Discard 3) | Reward: 0 | Depth: 1
2024-10-22 16:59:51,617 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 0 | Depth: 2
2024-10-22 16:59:51,807 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:51,807 - DEBUG - Network Policy Logits: [[-0.02214952 -0.01513352 -0.01201622  0.00400233  0.01879022  0.04405172
  -0.01971762  0.01680704  0.05407267  0.06632701 -0.04814984 -0.03998138
  -0.04582955 -0.02866602  0.0614132   0.01766335 -0.08888712 -0.00988334
   0.05593755  0.01268053]]
2024-10-22 16:59:51,808 - DEBUG - Network Policy after Softmax: [[0.04881192 0.04915559 0.04930906 0.05010528 0.05085174 0.05215269
  0.04893077 0.05075099 0.05267794 0.05332744 0.04755915 0.04794922
  0.04766963 0.04849487 0.05306604 0.05079446 0.04566065 0.04941434
  0.05277627 0.05054199]]
2024-10-22 16:59:51,809 - DEBUG - Normalized Policy: [[0.         0.2497362  0.         0.         0.         0.
  0.24859403 0.         0.         0.         0.         0.24360725
  0.         0.         0.         0.25806257 0.         0.
  0.         0.        ]]
2024-10-22 16:59:51,810 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Discard 1)) | P=0.24973620474338531
2024-10-22 16:59:51,810 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Reveal player +1 color Y)) | P=0.24360725283622742
2024-10-22 16:59:51,811 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Play 1)) | P=0.2485940307378769
2024-10-22 16:59:51,812 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.25806257128715515
2024-10-22 16:59:51,812 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 16:59:51,812 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:51,812 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 0, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y0 G0 W0 B0 
Hands:
Cur player
XX || X2|YGWB2
XX || X1|YGWB1
XX || X2|YGWB2
XX || XX|RYGWB345
XX || X1|RYGWB1
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4 R2}
2024-10-22 16:59:51,812 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:51,812 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 16:59:51,812 - INFO - === MCTS Search Completed ===
2024-10-22 16:59:51,812 - DEBUG - Best node chosen by MCTS: ((Play 1),) | Visit Count: 3
2024-10-22 16:59:51,812 - INFO - Actual Game Score: 0
2024-10-22 16:59:51,812 - DEBUG - === Recording Training Data ===
2024-10-22 16:59:51,812 - DEBUG - State Vector Shape: 658
2024-10-22 16:59:51,813 - DEBUG - Policy Targets: [0.         0.         0.         0.22222222 0.         0.
 0.33333333 0.         0.         0.         0.         0.22222222
 0.         0.         0.         0.22222222 0.         0.
 0.         0.        ]
2024-10-22 16:59:51,813 - DEBUG - === End of Training Data ===
2024-10-22 16:59:51,813 - INFO - Chosen Action: (Play 1) | Visit Count: 3
2024-10-22 16:59:51,813 - DEBUG - Not the current player's turn.
2024-10-22 16:59:54,199 - INFO - Agent state has been reset.
2024-10-22 16:59:54,199 - INFO - === Starting MCTS Search ===
2024-10-22 16:59:54,199 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYWB12345
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:54,199 - INFO - Max Rollouts: 10
2024-10-22 16:59:54,199 - DEBUG - --- Rollout #1 ---
2024-10-22 16:59:54,199 - DEBUG - Node () is a leaf node.
2024-10-22 16:59:54,199 - DEBUG - Traversing Path: ['()']
2024-10-22 16:59:54,508 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:54,508 - DEBUG - Network Policy Logits: [[ 0.00598761 -0.01115811  0.00449042 -0.0226628  -0.0047989   0.03927831
  -0.01900942 -0.0052437   0.05073275  0.02991335 -0.02277381 -0.06007814
  -0.05270816 -0.01391652  0.04595239  0.00942981 -0.07854847 -0.02635218
   0.05735647 -0.03782059]]
2024-10-22 16:59:54,508 - DEBUG - Network Policy after Softmax: [[0.05054924 0.04968992 0.05047361 0.04912153 0.05000691 0.05226038
  0.04930132 0.04998467 0.05286243 0.05177325 0.04911608 0.04731759
  0.04766761 0.04955304 0.05261033 0.05072353 0.04645164 0.04894064
  0.05321374 0.04838257]]
2024-10-22 16:59:54,510 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33777493 0.
  0.         0.         0.         0.         0.         0.3196097
  0.         0.         0.         0.3426154  0.         0.
  0.         0.        ]]
2024-10-22 16:59:54,511 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.27268842 0.
 0.         0.         0.         0.         0.         0.23973158
 0.         0.         0.         0.48758    0.         0.
 0.         0.        ]
2024-10-22 16:59:54,512 - DEBUG - Added Child Node: ((Discard 4),) | P=0.2726884186267853
2024-10-22 16:59:54,513 - DEBUG - Added Child Node: ((Reveal player +1 color Y),) | P=0.2397315800189972
2024-10-22 16:59:54,514 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.48758000135421753
2024-10-22 16:59:54,514 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 16:59:54,514 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:54,514 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYWB12345
-----
Y1 || XX|RYGWB12345
G2 || XX|RYGWB12345
B4 || XX|RYGWB12345
G1 || XX|RYGWB12345
Y4 || XX|RYGWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:54,514 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:54,514 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 16:59:54,514 - DEBUG - --- Rollout #2 ---
2024-10-22 16:59:54,515 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 16:59:54,515 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 16:59:54,516 - DEBUG - Move: (Discard 4) | Reward: 1 | Depth: 1
2024-10-22 16:59:54,842 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:54,843 - DEBUG - Network Policy Logits: [[ 0.00964818  0.02721646  0.01024629 -0.008363   -0.0131663   0.09145297
  -0.0030241   0.04481005 -0.0251647   0.08490382 -0.04927537 -0.01875517
  -0.01807756 -0.02865903  0.06842669  0.0118055   0.01202029 -0.03090331
   0.02639697 -0.04246406]]
2024-10-22 16:59:54,843 - DEBUG - Network Policy after Softmax: [[0.05007111 0.05095855 0.05010107 0.04917735 0.0489417  0.05433937
  0.0494406  0.05186303 0.04835799 0.05398466 0.04720598 0.04866893
  0.04870192 0.0481893  0.05310243 0.05017925 0.05019003 0.04808127
  0.05091681 0.04752862]]
2024-10-22 16:59:54,845 - DEBUG - Normalized Policy: [[0.3265093  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34627625 0.32721442 0.         0.
  0.         0.        ]]
2024-10-22 16:59:54,846 - DEBUG - Added Child Node: ((Discard 4), (Discard 0)) | P=0.3265092968940735
2024-10-22 16:59:54,847 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1)) | P=0.32721441984176636
2024-10-22 16:59:54,848 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B)) | P=0.34627625346183777
2024-10-22 16:59:54,848 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 16:59:54,849 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:54,849 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 7, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 7
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G2 || G2|G2
B2 || X2|YWB2
W2 || X2|RYWB2
G3 || GX|G1345
R1 || XX|RYGWB12345
Deck size: 35
Discards: B3 R3 R4 R3}
2024-10-22 16:59:54,849 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:54,849 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 16:59:54,849 - DEBUG - --- Rollout #3 ---
2024-10-22 16:59:54,849 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y),)
2024-10-22 16:59:54,850 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)']
2024-10-22 16:59:54,851 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 1 | Depth: 1
2024-10-22 16:59:55,202 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:55,202 - DEBUG - Network Policy Logits: [[ 0.02756136  0.02392403  0.01887979  0.02076638 -0.02665258  0.02647423
  -0.000653    0.04540582 -0.00284975  0.09910995 -0.05277322 -0.03720658
   0.00558644 -0.01432914  0.08061478  0.00979295 -0.02713855 -0.04407678
   0.02835768 -0.01908692]]
2024-10-22 16:59:55,203 - DEBUG - Network Policy after Softmax: [[0.05094617 0.0507612  0.05050579 0.05060117 0.04825772 0.05089082
  0.04952885 0.05186344 0.04942016 0.05472487 0.04701351 0.04775108
  0.04983884 0.0488561  0.05372202 0.05004894 0.04823427 0.04742415
  0.05098676 0.0486242 ]]
2024-10-22 16:59:55,205 - DEBUG - Normalized Policy: [[0.3452729  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.32361907
  0.         0.331108   0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:55,206 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color W)) | P=0.3311080038547516
2024-10-22 16:59:55,206 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 0)) | P=0.34527289867401123
2024-10-22 16:59:55,207 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | P=0.3236190676689148
2024-10-22 16:59:55,207 - DEBUG - Simulating Node: ((Reveal player +1 color Y),) | Value: 0.0
2024-10-22 16:59:55,207 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:55,207 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 5, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'Y', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'Y', 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || YX|Y12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || XX|RGWB12345
XX || YX|Y12345
-----
G2 || G2|G2
W2 || X2|YWB2
Y2 || X2|RYWB2
G4 || GX|G1345
W1 || XX|RYWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:55,208 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:55,208 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 16:59:55,208 - DEBUG - --- Rollout #4 ---
2024-10-22 16:59:55,208 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 16:59:55,208 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 16:59:55,209 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 1 | Depth: 1
2024-10-22 16:59:55,572 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:55,572 - DEBUG - Network Policy Logits: [[-0.01076646  0.00301822  0.02106554 -0.00223649  0.0023059   0.00799348
   0.01769981  0.00671316 -0.00826887  0.06798796 -0.05593704 -0.05334675
  -0.01481237 -0.0109356   0.07851158  0.00277806  0.01193937 -0.01489232
   0.04209889 -0.06199513]]
2024-10-22 16:59:55,573 - DEBUG - Network Policy after Softmax: [[0.04936323 0.0500484  0.05095984 0.0497861  0.05001276 0.05029802
  0.05078861 0.05023367 0.04948668 0.05340799 0.04718308 0.04730545
  0.04916392 0.04935488 0.053973   0.05003638 0.05049689 0.04915999
  0.05204305 0.0468981 ]]
2024-10-22 16:59:55,575 - DEBUG - Normalized Policy: [[0.19678095 0.         0.         0.         0.         0.20050739
  0.         0.         0.         0.         0.18809001 0.
  0.         0.         0.21515727 0.19946438 0.         0.
  0.         0.        ]]
2024-10-22 16:59:55,576 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0)) | P=0.20050738751888275
2024-10-22 16:59:55,577 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.19946438074111938
2024-10-22 16:59:55,578 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0)) | P=0.1967809498310089
2024-10-22 16:59:55,578 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.21515727043151855
2024-10-22 16:59:55,579 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color R)) | P=0.1880900114774704
2024-10-22 16:59:55,579 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 16:59:55,580 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:55,580 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 5, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
-----
G2 || G2|G2
B2 || X2|YWB2
R2 || X2|RYWB2
G3 || GX|G1345
R1 || XX|RYWB12345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:55,580 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:55,580 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 16:59:55,580 - DEBUG - --- Rollout #5 ---
2024-10-22 16:59:55,581 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4324280023574829 | PUCT: 0.4324280023574829
2024-10-22 16:59:55,581 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.3801651895046234 | PUCT: 0.3801651895046234
2024-10-22 16:59:55,582 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.7732020616531372 | PUCT: 0.7732020616531372
2024-10-22 16:59:55,582 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.7732020616531372
2024-10-22 16:59:55,582 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:55,582 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Discard 0))
2024-10-22 16:59:55,582 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Discard 0))']
2024-10-22 16:59:55,583 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 1 | Depth: 1
2024-10-22 16:59:55,585 - DEBUG - Move: (Discard 0) | Reward: 1 | Depth: 2
2024-10-22 16:59:55,973 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:55,974 - DEBUG - Network Policy Logits: [[-0.01120006 -0.01627235 -0.00288406 -0.03425727 -0.02116192  0.05697327
   0.01472673 -0.0180205   0.04810147  0.01294716  0.00578134 -0.04936682
  -0.03538876 -0.02414769 -0.00330638 -0.02244987 -0.10128463 -0.00223197
   0.0486122  -0.05019002]]
2024-10-22 16:59:55,974 - DEBUG - Network Policy after Softmax: [[0.04991999 0.04966742 0.05033686 0.04878214 0.04942516 0.05344189
  0.05123118 0.04958067 0.05296986 0.05114009 0.05077494 0.0480506
  0.04872698 0.04927781 0.0503156  0.04936155 0.04561957 0.05036969
  0.05299691 0.04801106]]
2024-10-22 16:59:55,975 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.32699615 0.
  0.         0.         0.         0.         0.         0.
  0.322377   0.         0.         0.         0.         0.
  0.35062686 0.        ]]
2024-10-22 16:59:55,976 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0), (Discard 4)) | P=0.3269961476325989
2024-10-22 16:59:55,977 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0), (Reveal player +1 color G)) | P=0.3223769962787628
2024-10-22 16:59:55,977 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0), (Reveal player +1 rank 4)) | P=0.3506268560886383
2024-10-22 16:59:55,977 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Discard 0)) | Value: 0.0
2024-10-22 16:59:55,977 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:55,977 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 6, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 6
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
W4 || XX|RYGWB12345
Deck size: 35
Discards: B3 R3 R4 G1}
2024-10-22 16:59:55,977 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:55,978 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 16:59:55,978 - DEBUG - --- Rollout #6 ---
2024-10-22 16:59:55,978 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.45626434683799744 | PUCT: 0.45626434683799744
2024-10-22 16:59:55,979 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.40112072229385376 | PUCT: 0.40112072229385376
2024-10-22 16:59:55,979 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.5438817739486694 | PUCT: 0.5438817739486694
2024-10-22 16:59:55,979 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.5438817739486694
2024-10-22 16:59:55,979 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:55,979 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 color B))
2024-10-22 16:59:55,979 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 color B))']
2024-10-22 16:59:55,980 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 1 | Depth: 1
2024-10-22 16:59:55,980 - DEBUG - Illegal move encountered: (Reveal player +1 color B)
2024-10-22 16:59:55,980 - DEBUG - Backpropagating reward: 1
2024-10-22 16:59:55,980 - DEBUG - Rollout #6 completed with reward=1
2024-10-22 16:59:55,980 - DEBUG - --- Rollout #7 ---
2024-10-22 16:59:55,981 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4754863977432251 | PUCT: 0.4754863977432251
2024-10-22 16:59:55,981 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.4180195927619934 | PUCT: 0.4180195927619934
2024-10-22 16:59:55,982 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.3333333333333333 | U: 0.4250962734222412 | PUCT: 0.7584296464920044
2024-10-22 16:59:55,982 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.7584296464920044
2024-10-22 16:59:55,982 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:55,982 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 rank 1))
2024-10-22 16:59:55,982 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 rank 1))']
2024-10-22 16:59:55,982 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 1 | Depth: 1
2024-10-22 16:59:55,983 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 16:59:55,983 - DEBUG - Backpropagating reward: 1
2024-10-22 16:59:55,983 - DEBUG - Rollout #7 completed with reward=1
2024-10-22 16:59:55,983 - DEBUG - --- Rollout #8 ---
2024-10-22 16:59:55,983 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.49153003096580505 | PUCT: 0.49153003096580505
2024-10-22 16:59:55,984 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.43212419748306274 | PUCT: 0.43212419748306274
2024-10-22 16:59:55,984 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.5 | U: 0.35155174136161804 | PUCT: 0.8515517711639404
2024-10-22 16:59:55,984 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.8515517711639404
2024-10-22 16:59:55,984 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:55,984 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 color R))
2024-10-22 16:59:55,984 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 color R))']
2024-10-22 16:59:55,985 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 1 | Depth: 1
2024-10-22 16:59:55,986 - DEBUG - Move: (Reveal player +1 color R) | Reward: 1 | Depth: 2
2024-10-22 16:59:56,281 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:56,282 - DEBUG - Network Policy Logits: [[ 0.00925374 -0.0135089  -0.00376623 -0.02249204 -0.00796545 -0.00266608
  -0.02442843  0.00489765  0.01592856  0.03699256 -0.0447668  -0.02268011
  -0.04024325  0.02757784  0.05556477 -0.00302735 -0.05172323 -0.03462122
   0.0324942  -0.05229231]]
2024-10-22 16:59:56,282 - DEBUG - Network Policy after Softmax: [[0.05080045 0.04965715 0.05014331 0.04921307 0.04993319 0.05019851
  0.04911787 0.05057964 0.05114066 0.05222932 0.04812898 0.04920382
  0.04834719 0.0517399  0.05320839 0.05018037 0.04779534 0.04861977
  0.0519949  0.04776815]]
2024-10-22 16:59:56,284 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33856636 0.
  0.         0.         0.         0.         0.         0.33362097
  0.32781267 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:56,285 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color R), (Discard 4)) | P=0.3385663628578186
2024-10-22 16:59:56,286 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color R), (Reveal player +1 color Y)) | P=0.33362096548080444
2024-10-22 16:59:56,287 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color R), (Reveal player +1 color G)) | P=0.32781267166137695
2024-10-22 16:59:56,287 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 16:59:56,287 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:56,287 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 4, 'num_players': 2, 'deck_size': 36, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 0}, {'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 4
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || R2|R2
XX || GX|G1345
XX || XX|YWB12345
-----
Y1 || X1|RYGWB1
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
Deck size: 36
Discards: B3 R3 R4}
2024-10-22 16:59:56,287 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:56,287 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 16:59:56,287 - DEBUG - --- Rollout #9 ---
2024-10-22 16:59:56,288 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5052588582038879 | PUCT: 0.5052588582038879
2024-10-22 16:59:56,288 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.4441938102245331 | PUCT: 0.4441938102245331
2024-10-22 16:59:56,289 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.4 | U: 0.3011423945426941 | PUCT: 0.701142430305481
2024-10-22 16:59:56,289 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.701142430305481
2024-10-22 16:59:56,289 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:56,289 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Play 0))
2024-10-22 16:59:56,289 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Play 0))']
2024-10-22 16:59:56,290 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 1 | Depth: 1
2024-10-22 16:59:56,291 - DEBUG - Move: (Play 0) | Reward: 2 | Depth: 2
2024-10-22 16:59:56,579 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:56,580 - DEBUG - Network Policy Logits: [[ 0.00121004 -0.01555627 -0.00104729 -0.02563598 -0.02028031  0.04670366
   0.00582557 -0.01070772  0.04298254  0.01478887  0.01142945 -0.04918505
  -0.04427313 -0.02894873 -0.00292942 -0.01917125 -0.09577904 -0.01089214
   0.05074542 -0.04513365]]
2024-10-22 16:59:56,581 - DEBUG - Network Policy after Softmax: [[0.05052367 0.04968364 0.05040976 0.04918536 0.04944948 0.05287527
  0.05075741 0.04992511 0.05267887 0.05121441 0.05104264 0.04804062
  0.04827717 0.04902269 0.05031497 0.04950436 0.04585357 0.04991591
  0.05308941 0.04823565]]
2024-10-22 16:59:56,582 - DEBUG - Normalized Policy: [[0.        0.        0.        0.        0.5059979 0.        0.
  0.        0.        0.        0.        0.        0.4940021 0.
  0.        0.        0.        0.        0.        0.       ]]
2024-10-22 16:59:56,583 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0), (Discard 4)) | P=0.505997896194458
2024-10-22 16:59:56,584 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 0), (Reveal player +1 color G)) | P=0.494002103805542
2024-10-22 16:59:56,584 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Play 0)) | Value: 0.0
2024-10-22 16:59:56,584 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:56,585 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 3, 'information_tokens': 5, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 3
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B1 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
Y2 || XX|RYGWB12345
Deck size: 35
Discards: B3 R3 R4}
2024-10-22 16:59:56,585 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:56,585 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 16:59:56,585 - DEBUG - --- Rollout #10 ---
2024-10-22 16:59:56,586 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5172309875488281 | PUCT: 0.5172309875488281
2024-10-22 16:59:56,586 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.4547189772129059 | PUCT: 0.4547189772129059
2024-10-22 16:59:56,587 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.3333333333333333 | U: 0.26423826813697815 | PUCT: 0.597571611404419
2024-10-22 16:59:56,587 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.597571611404419
2024-10-22 16:59:56,587 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 16:59:56,588 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1), (Discard 0)) | Q: 0.0 | U: 0.34312665462493896 | PUCT: 0.34312665462493896
2024-10-22 16:59:56,588 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | Q: 1.0 | U: 0.37516942620277405 | PUCT: 1.3751693964004517
2024-10-22 16:59:56,589 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | Q: 1.0 | U: 0.34780576825141907 | PUCT: 1.3478057384490967
2024-10-22 16:59:56,589 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1), (Reveal player +1 color R)) | Q: 0.0 | U: 0.32797229290008545 | PUCT: 0.32797229290008545
2024-10-22 16:59:56,590 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1), (Play 0)) | Q: 0.0 | U: 0.3496244251728058 | PUCT: 0.3496244251728058
2024-10-22 16:59:56,590 - DEBUG - Selected Child: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | PUCT: 1.3751693964004517
2024-10-22 16:59:56,590 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1), (Reveal player +1 color B))
2024-10-22 16:59:56,590 - DEBUG - Node ((Reveal player +1 rank 1), (Reveal player +1 color B)) is a leaf node.
2024-10-22 16:59:56,590 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 color B))']
2024-10-22 16:59:56,591 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 1 | Depth: 1
2024-10-22 16:59:56,591 - DEBUG - Illegal move encountered: (Reveal player +1 color B)
2024-10-22 16:59:56,591 - DEBUG - Backpropagating reward: 1
2024-10-22 16:59:56,591 - DEBUG - Rollout #10 completed with reward=1
2024-10-22 16:59:56,591 - INFO - === MCTS Search Completed ===
2024-10-22 16:59:56,591 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 1),) | Visit Count: 7
2024-10-22 16:59:56,592 - INFO - Actual Game Score: 1
2024-10-22 16:59:56,592 - DEBUG - === Recording Training Data ===
2024-10-22 16:59:56,592 - DEBUG - State Vector Shape: 658
2024-10-22 16:59:56,592 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.11111111 0.
 0.         0.         0.         0.         0.         0.11111111
 0.         0.         0.         0.77777778 0.         0.
 0.         0.        ]
2024-10-22 16:59:56,592 - DEBUG - === End of Training Data ===
2024-10-22 16:59:56,592 - INFO - Chosen Action: (Reveal player +1 rank 1) | Visit Count: 7
2024-10-22 16:59:56,593 - DEBUG - Not the current player's turn.
2024-10-22 16:59:58,529 - INFO - Agent state has been reset.
2024-10-22 16:59:58,529 - INFO - === Starting MCTS Search ===
2024-10-22 16:59:58,529 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
Deck size: 35
Discards: B3 R3 R4 Y1}
2024-10-22 16:59:58,529 - INFO - Max Rollouts: 10
2024-10-22 16:59:58,529 - DEBUG - --- Rollout #1 ---
2024-10-22 16:59:58,530 - DEBUG - Node () is a leaf node.
2024-10-22 16:59:58,530 - DEBUG - Traversing Path: ['()']
2024-10-22 16:59:58,734 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:58,734 - DEBUG - Network Policy Logits: [[ 0.0099996  -0.01657536  0.00100092 -0.03292042 -0.0134998   0.053608
   0.00868472 -0.00861548  0.04460723  0.01346067  0.00453563 -0.06276879
  -0.03589338 -0.03695824 -0.01006093 -0.02988675 -0.0940795  -0.01848878
   0.0342989  -0.05055941]]
2024-10-22 16:59:58,734 - DEBUG - Network Policy after Softmax: [[0.05108124 0.04974164 0.05062364 0.04893522 0.04989486 0.0533581
  0.05101412 0.05013916 0.05287999 0.05125835 0.0508029  0.04749617
  0.04878995 0.04873802 0.05006674 0.0490839  0.04603207 0.04964656
  0.05233769 0.04807962]]
2024-10-22 16:59:58,736 - DEBUG - Normalized Policy: [[0.        0.        0.        0.        0.5055981 0.        0.
  0.        0.        0.        0.        0.        0.4944018 0.
  0.        0.        0.        0.        0.        0.       ]]
2024-10-22 16:59:58,736 - DEBUG - Dirichlet Noise Added: [0.        0.        0.        0.        0.3791991 0.        0.
 0.        0.        0.        0.        0.        0.6208009 0.
 0.        0.        0.        0.        0.        0.       ]
2024-10-22 16:59:58,737 - DEBUG - Added Child Node: ((Discard 4),) | P=0.3791990876197815
2024-10-22 16:59:58,738 - DEBUG - Added Child Node: ((Reveal player +1 color G),) | P=0.6208009123802185
2024-10-22 16:59:58,738 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 16:59:58,738 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:58,738 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
Deck size: 35
Discards: B3 R3 R4 Y1}
2024-10-22 16:59:58,738 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:58,738 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 16:59:58,738 - DEBUG - --- Rollout #2 ---
2024-10-22 16:59:58,738 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G),)
2024-10-22 16:59:58,738 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)']
2024-10-22 16:59:58,739 - DEBUG - Move: (Reveal player +1 color G) | Reward: 1 | Depth: 1
2024-10-22 16:59:58,939 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:58,939 - DEBUG - Network Policy Logits: [[ 0.01242596  0.03853285  0.03586218 -0.01424874  0.0091435   0.07265151
   0.01146373  0.06142398 -0.01599531  0.06396292 -0.02345608 -0.02190726
  -0.01941311 -0.0637933   0.050177    0.00919636  0.02461801 -0.01672303
   0.01290424 -0.02625877]]
2024-10-22 16:59:58,940 - DEBUG - Network Policy after Softmax: [[0.05008925 0.05141415 0.05127702 0.0487708  0.0499251  0.0531986
  0.05004108 0.05260465 0.04868569 0.05273838 0.04832381 0.04839871
  0.04851958 0.04641335 0.05201632 0.04992775 0.05070368 0.04865028
  0.05011322 0.04818857]]
2024-10-22 16:59:58,941 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3230435  0.
  0.         0.34038168 0.         0.         0.         0.
  0.         0.         0.33657485 0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:58,942 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4)) | P=0.32304349541664124
2024-10-22 16:59:58,942 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color B)) | P=0.33657485246658325
2024-10-22 16:59:58,943 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Play 2)) | P=0.3403816819190979
2024-10-22 16:59:58,943 - DEBUG - Simulating Node: ((Reveal player +1 color G),) | Value: 0.0
2024-10-22 16:59:58,943 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:58,943 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': None}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || GX|G2345
XX || XX|RYWB2345
XX || G1|G1
XX || XX|RYWB2345
XX || XX|RYWB12345
-----
G2 || G2|G2
B2 || X2|YWB2
W2 || X2|RYWB2
G3 || GX|G1345
B5 || XX|RYWB12345
Deck size: 35
Discards: B3 R3 R4 Y1}
2024-10-22 16:59:58,943 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:58,943 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 16:59:58,943 - DEBUG - --- Rollout #3 ---
2024-10-22 16:59:58,943 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 16:59:58,943 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 16:59:58,944 - DEBUG - Move: (Discard 4) | Reward: 1 | Depth: 1
2024-10-22 16:59:59,148 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:59,148 - DEBUG - Network Policy Logits: [[ 0.00925745  0.06074345  0.01017196 -0.04407014 -0.00806479  0.10060459
  -0.01207244  0.07998766 -0.0184774   0.09691381 -0.0463057   0.00423796
  -0.00603748 -0.06419277  0.04355389  0.00119021  0.03056299 -0.02478311
  -0.00021495 -0.00088081]]
2024-10-22 16:59:59,148 - DEBUG - Network Policy after Softmax: [[0.04988252 0.05251804 0.04992816 0.04729209 0.04902589 0.05465375
  0.04882981 0.05353849 0.04851805 0.05445241 0.04718649 0.04963277
  0.04912538 0.04634997 0.05162299 0.04948173 0.0509567  0.04821307
  0.04941225 0.04937936]]
2024-10-22 16:59:59,151 - DEBUG - Normalized Policy: [[0.         0.         0.25032997 0.         0.         0.
  0.         0.26843148 0.         0.         0.         0.24884892
  0.         0.2323896  0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 16:59:59,152 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color W)) | P=0.23238959908485413
2024-10-22 16:59:59,152 - DEBUG - Added Child Node: ((Discard 4), (Discard 2)) | P=0.25032997131347656
2024-10-22 16:59:59,153 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color Y)) | P=0.24884891510009766
2024-10-22 16:59:59,153 - DEBUG - Added Child Node: ((Discard 4), (Play 2)) | P=0.26843148469924927
2024-10-22 16:59:59,154 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 16:59:59,154 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:59,154 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
G2 || G2|G2
W2 || X2|YWB2
Y2 || X2|RYWB2
G4 || GX|G1345
B5 || XX|RYGWB12345
Deck size: 34
Discards: B3 R3 R4 Y1 W1}
2024-10-22 16:59:59,154 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:59,154 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 16:59:59,154 - DEBUG - --- Rollout #4 ---
2024-10-22 16:59:59,155 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.9136715531349182 | PUCT: 0.9136715531349182
2024-10-22 16:59:59,155 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5580909848213196 | PUCT: 0.5580909848213196
2024-10-22 16:59:59,155 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.9136715531349182
2024-10-22 16:59:59,155 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 16:59:59,156 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Discard 4))
2024-10-22 16:59:59,156 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Discard 4))']
2024-10-22 16:59:59,156 - DEBUG - Move: (Reveal player +1 color G) | Reward: 1 | Depth: 1
2024-10-22 16:59:59,157 - DEBUG - Move: (Discard 4) | Reward: 1 | Depth: 2
2024-10-22 16:59:59,370 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:59,370 - DEBUG - Network Policy Logits: [[-0.02753597 -0.00906277  0.01507771  0.00608589 -0.03319842  0.05221876
   0.00350123 -0.0110619   0.02867487  0.01727601  0.0104327  -0.01267901
  -0.02761354 -0.03607316 -0.00682031 -0.00610084 -0.06066895 -0.00932412
   0.06564413 -0.04337499]]
2024-10-22 16:59:59,370 - DEBUG - Network Policy after Softmax: [[0.04882585 0.0497362  0.05095146 0.05049537 0.04855016 0.05287944
  0.05036503 0.04963687 0.05164899 0.05106359 0.05071534 0.04955667
  0.04882206 0.04841079 0.04984785 0.04988373 0.04723461 0.0497232
  0.05359415 0.04805858]]
2024-10-22 16:59:59,372 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.32501346 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.3162067  0.
  0.3587799  0.        ]]
2024-10-22 16:59:59,373 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Discard 4)) | P=0.3250134587287903
2024-10-22 16:59:59,374 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Reveal player +1 rank 2)) | P=0.316206693649292
2024-10-22 16:59:59,374 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4), (Reveal player +1 rank 4)) | P=0.3587799072265625
2024-10-22 16:59:59,374 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Discard 4)) | Value: 0.0
2024-10-22 16:59:59,374 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:59,375 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': None}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYWB12345
-----
G2 || GX|G2345
B4 || XX|RYWB2345
G1 || G1|G1
Y4 || XX|RYWB2345
W5 || XX|RYGWB12345
Deck size: 34
Discards: B3 R3 R4 Y1 Y2}
2024-10-22 16:59:59,375 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:59,375 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 16:59:59,375 - DEBUG - --- Rollout #5 ---
2024-10-22 16:59:59,376 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.6563087701797485 | PUCT: 0.6563087701797485
2024-10-22 16:59:59,376 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6013321280479431 | PUCT: 0.6013321280479431
2024-10-22 16:59:59,377 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.6563087701797485
2024-10-22 16:59:59,377 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 16:59:59,377 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Reveal player +1 color B))
2024-10-22 16:59:59,377 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 color B))']
2024-10-22 16:59:59,377 - DEBUG - Move: (Reveal player +1 color G) | Reward: 1 | Depth: 1
2024-10-22 16:59:59,378 - DEBUG - Move: (Reveal player +1 color B) | Reward: 1 | Depth: 2
2024-10-22 16:59:59,588 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:59,588 - DEBUG - Network Policy Logits: [[-0.03592026 -0.00569266  0.00679158  0.01728161 -0.03563268  0.02513397
  -0.01302359 -0.01222586  0.04416718  0.01287313  0.0049512  -0.01885137
  -0.02917828 -0.04062623 -0.00937068 -0.00789931 -0.0574356   0.00800069
   0.06925331 -0.03207996]]
2024-10-22 16:59:59,588 - DEBUG - Network Policy after Softmax: [[0.04847914 0.04996692 0.05059464 0.05112817 0.04849309 0.05153122
  0.04960196 0.04964155 0.05252142 0.05090327 0.05050161 0.04931373
  0.04880709 0.04825154 0.04978348 0.04985679 0.04744724 0.05065585
  0.05385565 0.04866568]]
2024-10-22 16:59:59,590 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.32372755 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.31674573 0.
  0.35952663 0.        ]]
2024-10-22 16:59:59,590 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color B), (Discard 4)) | P=0.323727548122406
2024-10-22 16:59:59,591 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color B), (Reveal player +1 rank 2)) | P=0.31674572825431824
2024-10-22 16:59:59,592 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color B), (Reveal player +1 rank 4)) | P=0.3595266342163086
2024-10-22 16:59:59,592 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 16:59:59,592 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:59,592 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 35, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': None}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || B2|B2
XX || X2|RYW2
XX || GX|G1345
XX || XX|RYW12345
-----
G2 || GX|G2345
B4 || XX|RYWB2345
G1 || G1|G1
Y4 || XX|RYWB2345
R5 || XX|RYWB12345
Deck size: 35
Discards: B3 R3 R4 Y1}
2024-10-22 16:59:59,592 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:59,592 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 16:59:59,592 - DEBUG - --- Rollout #6 ---
2024-10-22 16:59:59,593 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.5193644762039185 | PUCT: 0.5193644762039185
2024-10-22 16:59:59,593 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6344788074493408 | PUCT: 0.6344788074493408
2024-10-22 16:59:59,593 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.6344788074493408
2024-10-22 16:59:59,593 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 16:59:59,594 - DEBUG - Expanding unexplored child: ((Discard 4), (Play 2))
2024-10-22 16:59:59,594 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Play 2))']
2024-10-22 16:59:59,594 - DEBUG - Move: (Discard 4) | Reward: 1 | Depth: 1
2024-10-22 16:59:59,595 - DEBUG - Move: (Play 2) | Reward: 2 | Depth: 2
2024-10-22 16:59:59,786 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:59,787 - DEBUG - Network Policy Logits: [[ 0.00755242  0.01053093 -0.04426225 -0.04537317 -0.02900426  0.00886907
  -0.00831683  0.0036633   0.05994717  0.0520425  -0.02764941 -0.03719313
  -0.06575053 -0.02315299  0.02834392  0.02103444 -0.07853466 -0.01595629
   0.03138984 -0.04537595]]
2024-10-22 16:59:59,787 - DEBUG - Network Policy after Softmax: [[0.05084353 0.05099519 0.04827618 0.04822258 0.04901842 0.05091052
  0.05004305 0.05064617 0.05357849 0.05315664 0.04908488 0.04861866
  0.04724987 0.04930608 0.05191171 0.05153365 0.04664967 0.04966221
  0.05207007 0.04822244]]
2024-10-22 16:59:59,788 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.32117507 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.33765513 0.         0.
  0.34116983 0.        ]]
2024-10-22 16:59:59,789 - DEBUG - Added Child Node: ((Discard 4), (Play 2), (Discard 4)) | P=0.32117506861686707
2024-10-22 16:59:59,790 - DEBUG - Added Child Node: ((Discard 4), (Play 2), (Reveal player +1 rank 1)) | P=0.33765512704849243
2024-10-22 16:59:59,790 - DEBUG - Added Child Node: ((Discard 4), (Play 2), (Reveal player +1 rank 4)) | P=0.3411698341369629
2024-10-22 16:59:59,790 - DEBUG - Simulating Node: ((Discard 4), (Play 2)) | Value: 0.0
2024-10-22 16:59:59,790 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:59,790 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G0 W0 B1 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
W1 || XX|RYGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 16:59:59,790 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:59,790 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 16:59:59,791 - DEBUG - --- Rollout #7 ---
2024-10-22 16:59:59,791 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.5412448644638062 | PUCT: 0.5412448644638062
2024-10-22 16:59:59,792 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.44080591201782227 | PUCT: 0.44080591201782227
2024-10-22 16:59:59,792 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.5412448644638062
2024-10-22 16:59:59,792 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 16:59:59,792 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Play 2))
2024-10-22 16:59:59,792 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Play 2))']
2024-10-22 16:59:59,792 - DEBUG - Move: (Reveal player +1 color G) | Reward: 1 | Depth: 1
2024-10-22 16:59:59,793 - DEBUG - Move: (Play 2) | Reward: 2 | Depth: 2
2024-10-22 16:59:59,979 - DEBUG - Network Value Output: 0.0
2024-10-22 16:59:59,979 - DEBUG - Network Policy Logits: [[-0.02709925  0.0126007  -0.01367033 -0.00055821 -0.02144955  0.02872979
  -0.01804868 -0.01462248  0.03034549  0.02489151 -0.00981382 -0.02595326
  -0.02873953 -0.02501981  0.01978291 -0.00071375 -0.05437564 -0.0185701
   0.03767011 -0.03358459]]
2024-10-22 16:59:59,979 - DEBUG - Network Policy after Softmax: [[0.04898598 0.05096985 0.04964825 0.05030353 0.04926353 0.05179861
  0.04943135 0.049601   0.05188237 0.05160017 0.04984009 0.04904216
  0.0489057  0.04908796 0.05133724 0.05029571 0.04766788 0.04940558
  0.05226378 0.04866932]]
2024-10-22 16:59:59,981 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33587182 0.         0.3458543
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.31827387 0.
  0.         0.        ]]
2024-10-22 16:59:59,981 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Play 2), (Discard 3)) | P=0.3358718156814575
2024-10-22 16:59:59,982 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Play 2), (Play 0)) | P=0.3458543121814728
2024-10-22 16:59:59,983 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Play 2), (Reveal player +1 rank 2)) | P=0.3182738721370697
2024-10-22 16:59:59,983 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Play 2)) | Value: 0.0
2024-10-22 16:59:59,983 - DEBUG - Backpropagating reward: 0.0
2024-10-22 16:59:59,983 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYWB12345
-----
G2 || GX|G2345
B4 || XX|RYWB2345
Y4 || XX|RYWB2345
R5 || XX|RYWB12345
B2 || XX|RYGWB12345
Deck size: 34
Discards: B3 R3 R4 Y1}
2024-10-22 16:59:59,983 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 16:59:59,983 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 16:59:59,983 - DEBUG - --- Rollout #8 ---
2024-10-22 16:59:59,984 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.44760578870773315 | PUCT: 0.44760578870773315
2024-10-22 16:59:59,984 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.45567938685417175 | PUCT: 0.45567938685417175
2024-10-22 16:59:59,984 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.45567938685417175
2024-10-22 16:59:59,984 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 16:59:59,984 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 color W))
2024-10-22 16:59:59,984 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 color W))']
2024-10-22 16:59:59,985 - DEBUG - Move: (Discard 4) | Reward: 1 | Depth: 1
2024-10-22 16:59:59,985 - DEBUG - Illegal move encountered: (Reveal player +1 color W)
2024-10-22 16:59:59,985 - DEBUG - Backpropagating reward: 1
2024-10-22 16:59:59,985 - DEBUG - Rollout #8 completed with reward=1
2024-10-22 16:59:59,985 - DEBUG - --- Rollout #9 ---
2024-10-22 16:59:59,986 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.46010780334472656 | PUCT: 0.46010780334472656
2024-10-22 16:59:59,986 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.3333333333333333 | U: 0.35130515694618225 | PUCT: 0.684638500213623
2024-10-22 16:59:59,986 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.684638500213623
2024-10-22 16:59:59,986 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 16:59:59,987 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 color Y))
2024-10-22 16:59:59,987 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 color Y))']
2024-10-22 16:59:59,987 - DEBUG - Move: (Discard 4) | Reward: 1 | Depth: 1
2024-10-22 16:59:59,987 - DEBUG - Illegal move encountered: (Reveal player +1 color Y)
2024-10-22 16:59:59,987 - DEBUG - Backpropagating reward: 1
2024-10-22 16:59:59,987 - DEBUG - Rollout #9 completed with reward=1
2024-10-22 16:59:59,987 - DEBUG - --- Rollout #10 ---
2024-10-22 16:59:59,988 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.4710100591182709 | PUCT: 0.4710100591182709
2024-10-22 16:59:59,988 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.5 | U: 0.2877034544944763 | PUCT: 0.7877034544944763
2024-10-22 16:59:59,989 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.7877034544944763
2024-10-22 16:59:59,989 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 16:59:59,989 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 2))
2024-10-22 16:59:59,989 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 2))']
2024-10-22 16:59:59,989 - DEBUG - Move: (Discard 4) | Reward: 1 | Depth: 1
2024-10-22 16:59:59,990 - DEBUG - Move: (Discard 2) | Reward: 1 | Depth: 2
2024-10-22 17:00:00,200 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:00,200 - DEBUG - Network Policy Logits: [[ 0.00566294  0.01428588 -0.04315737 -0.04810156 -0.03052301  0.01782641
  -0.00406739  0.00897676  0.06267679  0.05122686 -0.02752997 -0.03344147
  -0.05823101 -0.01625253  0.02818491  0.0189559  -0.08362631 -0.01645457
   0.03075768 -0.05180001]]
2024-10-22 17:00:00,200 - DEBUG - Network Policy after Softmax: [[0.05068897 0.05112795 0.04827376 0.04803567 0.04888754 0.0513093
  0.05019815 0.05085723 0.05366292 0.05305199 0.04903408 0.04874507
  0.04755156 0.04959019 0.05184354 0.05136728 0.04635917 0.04958017
  0.0519771  0.04785835]]
2024-10-22 17:00:00,202 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.32113853 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.3374278  0.         0.
  0.34143364 0.        ]]
2024-10-22 17:00:00,203 - DEBUG - Added Child Node: ((Discard 4), (Discard 2), (Discard 4)) | P=0.32113853096961975
2024-10-22 17:00:00,203 - DEBUG - Added Child Node: ((Discard 4), (Discard 2), (Reveal player +1 rank 1)) | P=0.3374277949333191
2024-10-22 17:00:00,204 - DEBUG - Added Child Node: ((Discard 4), (Discard 2), (Reveal player +1 rank 4)) | P=0.34143364429473877
2024-10-22 17:00:00,204 - DEBUG - Simulating Node: ((Discard 4), (Discard 2)) | Value: 0.0
2024-10-22 17:00:00,204 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:00,204 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || GX|G1345
XX || XX|RYGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
W1 || XX|RYGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1 G1}
2024-10-22 17:00:00,204 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:00,205 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:00,205 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:00,205 - DEBUG - Best node chosen by MCTS: ((Discard 4),) | Visit Count: 5
2024-10-22 17:00:00,205 - INFO - Actual Game Score: 1
2024-10-22 17:00:00,205 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:00,205 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:00,205 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.55555556 0.
 0.         0.         0.         0.         0.         0.
 0.44444444 0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:00,205 - DEBUG - === End of Training Data ===
2024-10-22 17:00:00,205 - INFO - Chosen Action: (Discard 4) | Visit Count: 5
2024-10-22 17:00:00,206 - DEBUG - Not the current player's turn.
2024-10-22 17:00:02,097 - INFO - Agent state has been reset.
2024-10-22 17:00:02,097 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:02,097 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || G1|G1
XX || X1|RYGWB1
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
Deck size: 34
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:02,097 - INFO - Max Rollouts: 10
2024-10-22 17:00:02,097 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:02,097 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:02,097 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:02,321 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:02,321 - DEBUG - Network Policy Logits: [[ 8.2760584e-03 -1.8714508e-02  1.1760052e-02 -6.3940277e-03
   8.9569949e-03  3.2655556e-02 -2.3227280e-02  4.5560263e-03
   5.5055913e-02  2.3312103e-03 -6.4159976e-05 -6.0115702e-02
  -8.9819366e-03 -1.6065765e-02  1.6768157e-02 -2.2637976e-02
  -8.8388376e-02 -1.8897966e-02  4.2782221e-02 -2.3926489e-02]]
2024-10-22 17:00:02,322 - DEBUG - Network Policy after Softmax: [[0.05065372 0.04930484 0.05083051 0.04991605 0.05068823 0.05190381
  0.04908283 0.05046564 0.05307959 0.05035349 0.05023302 0.04730523
  0.04978704 0.0494356  0.05108571 0.04911177 0.04598652 0.04929579
  0.05243209 0.04904853]]
2024-10-22 17:00:02,323 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33009848 0.
  0.         0.         0.34567186 0.         0.         0.
  0.32422966 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:02,323 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.24757385 0.
 0.         0.         0.5092539  0.         0.         0.
 0.24317224 0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:02,324 - DEBUG - Added Child Node: ((Play 3),) | P=0.5092539191246033
2024-10-22 17:00:02,324 - DEBUG - Added Child Node: ((Discard 4),) | P=0.2475738525390625
2024-10-22 17:00:02,325 - DEBUG - Added Child Node: ((Reveal player +1 color G),) | P=0.24317224323749542
2024-10-22 17:00:02,325 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:02,325 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:02,325 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || G1|G1
XX || X1|RYGWB1
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
Deck size: 34
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:02,325 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:02,325 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:02,325 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:02,325 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G),)
2024-10-22 17:00:02,325 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)']
2024-10-22 17:00:02,326 - DEBUG - Move: (Reveal player +1 color G) | Reward: 1 | Depth: 1
2024-10-22 17:00:02,523 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:02,524 - DEBUG - Network Policy Logits: [[ 0.03559013  0.04991092  0.05046936  0.00866261 -0.00916496  0.07031883
   0.03093451  0.0381162  -0.00455681  0.0379206   0.00157869 -0.01079063
  -0.04119207 -0.07211378  0.04741572 -0.01139597  0.0166218  -0.01239731
   0.0170478  -0.01554517]]
2024-10-22 17:00:02,524 - DEBUG - Network Policy after Softmax: [[0.05119636 0.0519348  0.05196381 0.04983616 0.04895558 0.05300558
  0.05095856 0.05132585 0.04918169 0.05131581 0.04948438 0.04887606
  0.04741251 0.04596888 0.05180538 0.04884648 0.0502344  0.04879759
  0.05025581 0.04864423]]
2024-10-22 17:00:02,526 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.24360509 0.
  0.         0.25539964 0.         0.         0.         0.24320939
  0.         0.         0.25778583 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:02,527 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 4)) | P=0.2436050921678543
2024-10-22 17:00:02,528 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color Y)) | P=0.24320939183235168
2024-10-22 17:00:02,528 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color B)) | P=0.257785826921463
2024-10-22 17:00:02,529 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Play 2)) | P=0.2553996443748474
2024-10-22 17:00:02,529 - DEBUG - Simulating Node: ((Reveal player +1 color G),) | Value: 0.0
2024-10-22 17:00:02,529 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:02,529 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': None}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || GX|G2345
XX || XX|RYWB2345
XX || G1|G1
XX || XX|RYWB2345
XX || XX|RYWB12345
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
G1 || G1|G1
B1 || X1|RYGWB1
Deck size: 34
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:02,529 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:02,529 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:02,529 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:02,530 - DEBUG - Expanding unexplored child: ((Play 3),)
2024-10-22 17:00:02,530 - DEBUG - Traversing Path: ['()', '((Play 3),)']
2024-10-22 17:00:02,531 - DEBUG - Move: (Play 3) | Reward: 2 | Depth: 1
2024-10-22 17:00:02,750 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:02,750 - DEBUG - Network Policy Logits: [[ 0.01267073  0.04371893  0.01207371 -0.0238182  -0.0010804   0.07963694
  -0.02141006  0.06090875 -0.02778784  0.08865601 -0.02927112  0.02002514
  -0.01582848 -0.03642949  0.01831777  0.00223169  0.00753972 -0.03308634
   0.00891813 -0.01441754]]
2024-10-22 17:00:02,751 - DEBUG - Network Policy after Softmax: [[0.05022305 0.05180684 0.05019307 0.04842349 0.04953715 0.05370146
  0.04854024 0.05270509 0.04823165 0.05418799 0.04816016 0.05059376
  0.04881193 0.04781665 0.05050746 0.04970149 0.04996601 0.04797677
  0.05003493 0.04888085]]
2024-10-22 17:00:02,752 - DEBUG - Normalized Policy: [[0.        0.        0.5121234 0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.4878766
  0.        0.        0.        0.        0.        0.       ]]
2024-10-22 17:00:02,753 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 color W)) | P=0.4878765940666199
2024-10-22 17:00:02,754 - DEBUG - Added Child Node: ((Play 3), (Discard 2)) | P=0.5121234059333801
2024-10-22 17:00:02,754 - DEBUG - Simulating Node: ((Play 3),) | Value: 0.0
2024-10-22 17:00:02,754 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:02,754 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
G2 || G2|G2
W2 || X2|YWB2
B2 || X2|RYWB2
W1 || X1|RYGWB1
W1 || XX|RYGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:02,754 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:02,754 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:02,755 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:02,755 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:00:02,755 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:00:02,755 - DEBUG - Move: (Discard 4) | Reward: 1 | Depth: 1
2024-10-22 17:00:02,954 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:02,954 - DEBUG - Network Policy Logits: [[ 0.02361768  0.06149694  0.00716345 -0.03634282 -0.00461187  0.07209343
   0.0101582   0.0648189  -0.01608388  0.07211618 -0.03128494  0.01572268
  -0.01708579 -0.06435648  0.03470078 -0.00894895  0.0185894  -0.03245791
   0.0113866  -0.00934129]]
2024-10-22 17:00:02,954 - DEBUG - Network Policy after Softmax: [[0.05072286 0.05268107 0.04989509 0.04777088 0.049311   0.05324227
  0.05004474 0.05285636 0.04874854 0.05324348 0.04801311 0.05032399
  0.04869972 0.04645122 0.05128816 0.0490976  0.05046846 0.04795683
  0.05010625 0.04907834]]
2024-10-22 17:00:02,955 - DEBUG - Normalized Policy: [[0.         0.         0.19579597 0.         0.         0.
  0.         0.20741647 0.         0.         0.         0.19747904
  0.         0.         0.20126261 0.         0.19804597 0.
  0.         0.        ]]
2024-10-22 17:00:02,956 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B)) | P=0.20126260817050934
2024-10-22 17:00:02,957 - DEBUG - Added Child Node: ((Discard 4), (Play 2)) | P=0.20741647481918335
2024-10-22 17:00:02,957 - DEBUG - Added Child Node: ((Discard 4), (Discard 2)) | P=0.1957959681749344
2024-10-22 17:00:02,958 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color Y)) | P=0.1974790394306183
2024-10-22 17:00:02,958 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 2)) | P=0.19804596900939941
2024-10-22 17:00:02,958 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:00:02,958 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:02,958 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
G2 || G2|G2
Y2 || X2|YWB2
B2 || X2|RYWB2
G1 || G1|G1
Y2 || XX|RYGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1 R1}
2024-10-22 17:00:02,958 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:02,958 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:02,959 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:02,959 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.38562139868736267 | PUCT: 0.38562139868736267
2024-10-22 17:00:02,959 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.8075724840164185 | PUCT: 0.8075724840164185
2024-10-22 17:00:02,960 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.39260146021842957 | PUCT: 0.39260146021842957
2024-10-22 17:00:02,960 - DEBUG - Selected Child: ((Play 3),) | PUCT: 0.8075724840164185
2024-10-22 17:00:02,960 - DEBUG - Selected child for exploration: ((Play 3),)
2024-10-22 17:00:02,960 - DEBUG - Expanding unexplored child: ((Play 3), (Reveal player +1 color W))
2024-10-22 17:00:02,960 - DEBUG - Traversing Path: ['()', '((Play 3),)', '((Play 3), (Reveal player +1 color W))']
2024-10-22 17:00:02,961 - DEBUG - Move: (Play 3) | Reward: 2 | Depth: 1
2024-10-22 17:00:02,961 - DEBUG - Move: (Reveal player +1 color W) | Reward: 2 | Depth: 2
2024-10-22 17:00:03,177 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:03,178 - DEBUG - Network Policy Logits: [[-0.00792553 -0.00646873  0.00697971 -0.02612603 -0.00753225  0.01966058
  -0.01134608 -0.00706084  0.04079254  0.04024526  0.02789404 -0.02795468
  -0.04857912 -0.03741674 -0.02652801 -0.00815357 -0.10097005 -0.01866877
   0.03398627 -0.02313098]]
2024-10-22 17:00:03,178 - DEBUG - Network Policy after Softmax: [[0.05004808 0.05012104 0.05079965 0.04914542 0.05006776 0.05144793
  0.04987718 0.05009138 0.05254669 0.05251795 0.05187327 0.04905563
  0.04805425 0.04859366 0.04912567 0.05003667 0.04560145 0.04951328
  0.05219026 0.04929283]]
2024-10-22 17:00:03,180 - DEBUG - Normalized Policy: [[0.         0.         0.         0.25300208 0.         0.2648555
  0.         0.         0.         0.         0.         0.
  0.24738473 0.         0.         0.         0.23475766 0.
  0.         0.        ]]
2024-10-22 17:00:03,181 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 color W), (Discard 3)) | P=0.2530020773410797
2024-10-22 17:00:03,181 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 color W), (Play 0)) | P=0.2648555040359497
2024-10-22 17:00:03,182 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 color W), (Reveal player +1 rank 2)) | P=0.234757661819458
2024-10-22 17:00:03,182 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 color W), (Reveal player +1 color G)) | P=0.24738472700119019
2024-10-22 17:00:03,183 - DEBUG - Simulating Node: ((Play 3), (Reveal player +1 color W)) | Value: 0.0
2024-10-22 17:00:03,183 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:03,183 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'W', 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YB2
XX || W2|W2
XX || X1|RYGB1
XX || XX|RYGB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:03,183 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:03,183 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:03,183 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:03,184 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.40687766671180725 | PUCT: 0.40687766671180725
2024-10-22 17:00:03,184 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.568058431148529 | PUCT: 0.568058431148529
2024-10-22 17:00:03,185 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4142424762248993 | PUCT: 0.4142424762248993
2024-10-22 17:00:03,185 - DEBUG - Selected Child: ((Play 3),) | PUCT: 0.568058431148529
2024-10-22 17:00:03,185 - DEBUG - Selected child for exploration: ((Play 3),)
2024-10-22 17:00:03,185 - DEBUG - Expanding unexplored child: ((Play 3), (Discard 2))
2024-10-22 17:00:03,186 - DEBUG - Traversing Path: ['()', '((Play 3),)', '((Play 3), (Discard 2))']
2024-10-22 17:00:03,186 - DEBUG - Move: (Play 3) | Reward: 2 | Depth: 1
2024-10-22 17:00:03,187 - DEBUG - Move: (Discard 2) | Reward: 2 | Depth: 2
2024-10-22 17:00:03,395 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:03,396 - DEBUG - Network Policy Logits: [[ 0.00374778  0.01175423 -0.02282695 -0.03769107 -0.01098336 -0.0050392
  -0.01050994  0.0064982   0.04905522  0.04190253  0.0042423  -0.05020568
  -0.06141596 -0.0213293   0.04302021  0.01883952 -0.07574216 -0.03662341
   0.02185414 -0.05353239]]
2024-10-22 17:00:03,396 - DEBUG - Network Policy after Softmax: [[0.05062345 0.05103039 0.04929586 0.04856855 0.04988318 0.05018057
  0.0499068  0.05076288 0.05296982 0.0525923  0.05064849 0.04796452
  0.04742983 0.04936975 0.05265111 0.05139324 0.04675518 0.04862043
  0.05154841 0.04780522]]
2024-10-22 17:00:03,398 - DEBUG - Normalized Policy: [[0.         0.         0.         0.3337946  0.         0.3448735
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.32133192 0.
  0.         0.        ]]
2024-10-22 17:00:03,398 - DEBUG - Added Child Node: ((Play 3), (Discard 2), (Discard 3)) | P=0.33379459381103516
2024-10-22 17:00:03,399 - DEBUG - Added Child Node: ((Play 3), (Discard 2), (Play 0)) | P=0.34487348794937134
2024-10-22 17:00:03,400 - DEBUG - Added Child Node: ((Play 3), (Discard 2), (Reveal player +1 rank 2)) | P=0.3213319182395935
2024-10-22 17:00:03,400 - DEBUG - Simulating Node: ((Play 3), (Discard 2)) | Value: 0.0
2024-10-22 17:00:03,400 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:03,400 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || X1|RYGWB1
XX || XX|RYGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
B2 || XX|RYGWB12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1 B1}
2024-10-22 17:00:03,400 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:03,400 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:03,400 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:03,401 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.42401909828186035 | PUCT: 0.42401909828186035
2024-10-22 17:00:03,401 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.4439926743507385 | PUCT: 0.4439926743507385
2024-10-22 17:00:03,402 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4316941797733307 | PUCT: 0.4316941797733307
2024-10-22 17:00:03,402 - DEBUG - Selected Child: ((Play 3),) | PUCT: 0.4439926743507385
2024-10-22 17:00:03,402 - DEBUG - Selected child for exploration: ((Play 3),)
2024-10-22 17:00:03,403 - DEBUG - PUCT Calculation | Child: ((Play 3), (Reveal player +1 color W)) | Q: 0.0 | U: 0.7180384993553162 | PUCT: 0.7180384993553162
2024-10-22 17:00:03,403 - DEBUG - PUCT Calculation | Child: ((Play 3), (Discard 2)) | Q: 0.0 | U: 0.7537240386009216 | PUCT: 0.7537240386009216
2024-10-22 17:00:03,403 - DEBUG - Selected Child: ((Play 3), (Discard 2)) | PUCT: 0.7537240386009216
2024-10-22 17:00:03,403 - DEBUG - Selected child for exploration: ((Play 3), (Discard 2))
2024-10-22 17:00:03,404 - DEBUG - Expanding unexplored child: ((Play 3), (Discard 2), (Play 0))
2024-10-22 17:00:03,404 - DEBUG - Traversing Path: ['()', '((Play 3),)', '((Play 3), (Discard 2))', '((Play 3), (Discard 2), (Play 0))']
2024-10-22 17:00:03,404 - DEBUG - Move: (Play 3) | Reward: 2 | Depth: 1
2024-10-22 17:00:03,405 - DEBUG - Move: (Discard 2) | Reward: 2 | Depth: 2
2024-10-22 17:00:03,406 - DEBUG - Move: (Play 0) | Reward: 3 | Depth: 3
2024-10-22 17:00:03,605 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:03,606 - DEBUG - Network Policy Logits: [[ 0.02718488  0.0150596   0.01093293 -0.02487224 -0.00554197  0.09834654
   0.00789552  0.03791818 -0.03147811  0.0761445  -0.01318913 -0.03391981
  -0.04305403 -0.021484    0.0375523  -0.01670672  0.00381009 -0.05934381
   0.03276693 -0.05598392]]
2024-10-22 17:00:03,606 - DEBUG - Network Policy after Softmax: [[0.0512278  0.0506104  0.05040198 0.04862925 0.04957841 0.0550061
  0.05024912 0.05178061 0.04830907 0.05379831 0.04920072 0.04819126
  0.04775307 0.0487943  0.05176166 0.04902796 0.05004425 0.04698149
  0.05151456 0.04713961]]
2024-10-22 17:00:03,608 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33165893 0.         0.
  0.         0.         0.         0.         0.33555645 0.
  0.         0.33278456 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:03,609 - DEBUG - Added Child Node: ((Play 3), (Discard 2), (Play 0), (Reveal player +1 color W)) | P=0.3327845633029938
2024-10-22 17:00:03,610 - DEBUG - Added Child Node: ((Play 3), (Discard 2), (Play 0), (Reveal player +1 color R)) | P=0.3355564475059509
2024-10-22 17:00:03,610 - DEBUG - Added Child Node: ((Play 3), (Discard 2), (Play 0), (Discard 3)) | P=0.3316589295864105
2024-10-22 17:00:03,610 - DEBUG - Simulating Node: ((Play 3), (Discard 2), (Play 0)) | Value: 0.0
2024-10-22 17:00:03,610 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:03,610 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 31, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'W', 'rank': 1}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 4}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
W2 || X2|YWB2
R2 || X2|RYWB2
R1 || X1|RYGWB1
W5 || XX|RYGWB12345
G5 || XX|RYGWB12345
Deck size: 31
Discards: B3 R3 R4 Y1 R1 G1}
2024-10-22 17:00:03,611 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:03,611 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:03,611 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:03,611 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.4383261203765869 | PUCT: 0.4383261203765869
2024-10-22 17:00:03,612 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.36717891693115234 | PUCT: 0.36717891693115234
2024-10-22 17:00:03,612 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4462601840496063 | PUCT: 0.4462601840496063
2024-10-22 17:00:03,612 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.4462601840496063
2024-10-22 17:00:03,612 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:03,613 - DEBUG - Expanding unexplored child: ((Discard 4), (Play 2))
2024-10-22 17:00:03,613 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Play 2))']
2024-10-22 17:00:03,614 - DEBUG - Move: (Discard 4) | Reward: 1 | Depth: 1
2024-10-22 17:00:03,614 - DEBUG - Move: (Play 2) | Reward: 2 | Depth: 2
2024-10-22 17:00:03,816 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:03,817 - DEBUG - Network Policy Logits: [[ 0.00506239  0.01145719 -0.04642004 -0.03908268 -0.01418513  0.00149644
  -0.01040389  0.00344427  0.06317243  0.04915974 -0.01384549 -0.04278746
  -0.05743585 -0.01412294  0.0364086   0.02096178 -0.08404272 -0.02568353
   0.02732226 -0.04454588]]
2024-10-22 17:00:03,817 - DEBUG - Network Policy after Softmax: [[0.0506591  0.05098409 0.04811705 0.04847139 0.04969336 0.05047878
  0.04988162 0.0505772  0.05369012 0.05294302 0.04971024 0.04829215
  0.04758991 0.04969646 0.05227223 0.05147099 0.04634038 0.04912524
  0.05179941 0.04820731]]
2024-10-22 17:00:03,818 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33361697 0.         0.34743333
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.31894973 0.
  0.         0.        ]]
2024-10-22 17:00:03,818 - DEBUG - Added Child Node: ((Discard 4), (Play 2), (Discard 3)) | P=0.3336169719696045
2024-10-22 17:00:03,819 - DEBUG - Added Child Node: ((Discard 4), (Play 2), (Play 0)) | P=0.34743332862854004
2024-10-22 17:00:03,820 - DEBUG - Added Child Node: ((Discard 4), (Play 2), (Reveal player +1 rank 2)) | P=0.31894972920417786
2024-10-22 17:00:03,820 - DEBUG - Simulating Node: ((Discard 4), (Play 2)) | Value: 0.0
2024-10-22 17:00:03,820 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:03,820 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|YWB2
XX || X2|RYWB2
XX || G1|G1
XX || XX|RYGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
Y2 || XX|RYGWB12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1 R1}
2024-10-22 17:00:03,820 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:03,820 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:03,820 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:03,821 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.45056894421577454 | PUCT: 0.45056894421577454
2024-10-22 17:00:03,821 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.37743455171585083 | PUCT: 0.37743455171585083
2024-10-22 17:00:03,821 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3058163821697235 | PUCT: 0.3058163821697235
2024-10-22 17:00:03,821 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.45056894421577454
2024-10-22 17:00:03,822 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:03,822 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Reveal player +1 color Y))
2024-10-22 17:00:03,822 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 color Y))']
2024-10-22 17:00:03,822 - DEBUG - Move: (Reveal player +1 color G) | Reward: 1 | Depth: 1
2024-10-22 17:00:03,823 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 1 | Depth: 2
2024-10-22 17:00:04,030 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:04,031 - DEBUG - Network Policy Logits: [[-0.04190401 -0.00288897  0.00047607  0.02523081 -0.00540707  0.0089173
  -0.03730641 -0.01071661  0.05011744  0.01760216  0.0125074  -0.03263354
  -0.00543184 -0.03913022  0.00563143 -0.00707841 -0.06544185 -0.00106866
   0.07261253 -0.02525436]]
2024-10-22 17:00:04,031 - DEBUG - Network Policy after Softmax: [[0.04811943 0.05003392 0.05020257 0.05146083 0.04990809 0.05062813
  0.04834117 0.0496438  0.05275758 0.05106974 0.05081022 0.0485676
  0.04990685 0.04825309 0.05046205 0.04982474 0.04700003 0.05012508
  0.05395782 0.04892731]]
2024-10-22 17:00:04,032 - DEBUG - Normalized Policy: [[0.         0.24937712 0.         0.         0.         0.
  0.         0.2474327  0.         0.         0.         0.
  0.         0.         0.         0.         0.23425572 0.
  0.26893446 0.        ]]
2024-10-22 17:00:04,033 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color Y), (Discard 1)) | P=0.24937711656093597
2024-10-22 17:00:04,034 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color Y), (Play 2)) | P=0.24743269383907318
2024-10-22 17:00:04,034 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color Y), (Reveal player +1 rank 2)) | P=0.23425571620464325
2024-10-22 17:00:04,035 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color Y), (Reveal player +1 rank 4)) | P=0.2689344584941864
2024-10-22 17:00:04,035 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 17:00:04,035 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:04,035 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 34, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 0, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': None}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y1 G0 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X2|WB2
XX || Y2|Y2
XX || G1|G1
XX || X1|RGWB1
-----
G2 || GX|G2345
B4 || XX|RYWB2345
G1 || G1|G1
Y4 || XX|RYWB2345
R5 || XX|RYWB12345
Deck size: 34
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:04,035 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:04,036 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:04,036 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:04,036 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.3074967861175537 | PUCT: 0.3074967861175537
2024-10-22 17:00:04,037 - DEBUG - PUCT Calculation | Child: ((Play 3),) | Q: 0.0 | U: 0.38637787103652954 | PUCT: 0.38637787103652954
2024-10-22 17:00:04,037 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.31306272745132446 | PUCT: 0.31306272745132446
2024-10-22 17:00:04,037 - DEBUG - Selected Child: ((Play 3),) | PUCT: 0.38637787103652954
2024-10-22 17:00:04,037 - DEBUG - Selected child for exploration: ((Play 3),)
2024-10-22 17:00:04,038 - DEBUG - PUCT Calculation | Child: ((Play 3), (Reveal player +1 color W)) | Q: 0.0 | U: 0.7736724019050598 | PUCT: 0.7736724019050598
2024-10-22 17:00:04,039 - DEBUG - PUCT Calculation | Child: ((Play 3), (Discard 2)) | Q: 0.0 | U: 0.541415274143219 | PUCT: 0.541415274143219
2024-10-22 17:00:04,039 - DEBUG - Selected Child: ((Play 3), (Reveal player +1 color W)) | PUCT: 0.7736724019050598
2024-10-22 17:00:04,039 - DEBUG - Selected child for exploration: ((Play 3), (Reveal player +1 color W))
2024-10-22 17:00:04,039 - DEBUG - Expanding unexplored child: ((Play 3), (Reveal player +1 color W), (Reveal player +1 rank 2))
2024-10-22 17:00:04,039 - DEBUG - Traversing Path: ['()', '((Play 3),)', '((Play 3), (Reveal player +1 color W))', '((Play 3), (Reveal player +1 color W), (Reveal player +1 rank 2))']
2024-10-22 17:00:04,040 - DEBUG - Move: (Play 3) | Reward: 2 | Depth: 1
2024-10-22 17:00:04,040 - DEBUG - Move: (Reveal player +1 color W) | Reward: 2 | Depth: 2
2024-10-22 17:00:04,041 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 2 | Depth: 3
2024-10-22 17:00:04,244 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:04,245 - DEBUG - Network Policy Logits: [[-0.00215255  0.05190885  0.00533875 -0.01741128 -0.03175     0.05277291
   0.01430567  0.05841103 -0.02309965  0.04501872 -0.02062353  0.03963089
  -0.00461466 -0.05685536  0.04478276  0.00603521 -0.01633149 -0.00487466
   0.01211178 -0.01911137]]
2024-10-22 17:00:04,245 - DEBUG - Network Policy after Softmax: [[0.04953554 0.0522872  0.04990801 0.04878542 0.04809089 0.05233241
  0.05035755 0.05262829 0.0485087  0.05192818 0.04862896 0.05164915
  0.04941372 0.04689858 0.05191593 0.04994278 0.04883813 0.04940088
  0.05024719 0.04870255]]
2024-10-22 17:00:04,247 - DEBUG - Normalized Policy: [[0.         0.         0.24480797 0.         0.         0.
  0.         0.25815144 0.         0.         0.         0.
  0.24238339 0.         0.25465718 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:04,248 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 color W), (Reveal player +1 rank 2), (Discard 2)) | P=0.24480797350406647
2024-10-22 17:00:04,249 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 color W), (Reveal player +1 rank 2), (Play 2)) | P=0.25815144181251526
2024-10-22 17:00:04,249 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 color W), (Reveal player +1 rank 2), (Reveal player +1 color B)) | P=0.25465717911720276
2024-10-22 17:00:04,250 - DEBUG - Added Child Node: ((Play 3), (Reveal player +1 color W), (Reveal player +1 rank 2), (Reveal player +1 color G)) | P=0.24238339066505432
2024-10-22 17:00:04,250 - DEBUG - Simulating Node: ((Play 3), (Reveal player +1 color W), (Reveal player +1 rank 2)) | Value: 0.0
2024-10-22 17:00:04,250 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:04,250 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': 'W', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || XX|RYGWB345
XX || X1|RYGWB1
XX || XX|RYGWB345
XX || XX|RYGWB1345
-----
G2 || G2|G2
B2 || X2|YB2
R2 || X2|RYB2
G1 || X1|RYGB1
W5 || WX|W12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:04,250 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:04,251 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:04,251 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:04,251 - DEBUG - Best node chosen by MCTS: ((Play 3),) | Visit Count: 5
2024-10-22 17:00:04,251 - INFO - Actual Game Score: 2
2024-10-22 17:00:04,251 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:04,251 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:04,251 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.22222222 0.
 0.         0.         0.55555556 0.         0.         0.
 0.22222222 0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:04,251 - DEBUG - === End of Training Data ===
2024-10-22 17:00:04,251 - INFO - Chosen Action: (Play 3) | Visit Count: 5
2024-10-22 17:00:04,252 - DEBUG - Not the current player's turn.
2024-10-22 17:00:06,056 - INFO - Agent state has been reset.
2024-10-22 17:00:06,056 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:06,056 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || Y2|Y2
XX || X2|RWB2
XX || X1|RGWB1
XX || XX|RGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:06,056 - INFO - Max Rollouts: 10
2024-10-22 17:00:06,056 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:06,057 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:06,057 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:06,250 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:06,250 - DEBUG - Network Policy Logits: [[-0.00624283 -0.01002045  0.0036123  -0.02562726 -0.00429642  0.03767462
  -0.01072163 -0.02599329  0.02783619  0.00662069  0.01584763 -0.04880745
  -0.00703181 -0.02630095 -0.01052872  0.00153633 -0.08939739 -0.02932507
   0.04509041 -0.05027824]]
2024-10-22 17:00:06,250 - DEBUG - Network Policy after Softmax: [[0.05018089 0.04999169 0.05067788 0.04921753 0.05027866 0.05243382
  0.04995665 0.04919952 0.05192048 0.05083057 0.05130175 0.04808978
  0.05014132 0.04918439 0.04996628 0.05057278 0.0461769  0.04903587
  0.0528241  0.0480191 ]]
2024-10-22 17:00:06,252 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24861158 0.         0.26485795
  0.         0.         0.         0.         0.         0.
  0.25327787 0.         0.         0.         0.23325251 0.
  0.         0.        ]]
2024-10-22 17:00:06,253 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.1864587  0.         0.44862998
 0.         0.         0.         0.         0.         0.
 0.18997192 0.         0.         0.         0.1749394  0.
 0.         0.        ]
2024-10-22 17:00:06,253 - DEBUG - Added Child Node: ((Discard 3),) | P=0.18645870685577393
2024-10-22 17:00:06,254 - DEBUG - Added Child Node: ((Play 0),) | P=0.4486299753189087
2024-10-22 17:00:06,255 - DEBUG - Added Child Node: ((Reveal player +1 rank 2),) | P=0.17493939399719238
2024-10-22 17:00:06,255 - DEBUG - Added Child Node: ((Reveal player +1 color G),) | P=0.189971923828125
2024-10-22 17:00:06,255 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:06,255 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:06,256 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || Y2|Y2
XX || X2|RWB2
XX || X1|RGWB1
XX || XX|RGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:06,256 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:06,256 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:06,256 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:06,256 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G),)
2024-10-22 17:00:06,256 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)']
2024-10-22 17:00:06,257 - DEBUG - Move: (Reveal player +1 color G) | Reward: 2 | Depth: 1
2024-10-22 17:00:06,460 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:06,460 - DEBUG - Network Policy Logits: [[ 0.02976703  0.04831985  0.02376381 -0.00354867 -0.00062268  0.0623557
   0.01616514  0.03667032 -0.02812995  0.04912818  0.01469416  0.00462301
  -0.02054215 -0.04075407  0.05089907  0.00097136  0.00525637 -0.02985544
   0.00413541 -0.03644316]]
2024-10-22 17:00:06,460 - DEBUG - Network Policy after Softmax: [[0.05100885 0.05196404 0.05070354 0.04933745 0.04948202 0.05269854
  0.05031973 0.05136219 0.04813946 0.05200606 0.05024577 0.04974227
  0.04850612 0.04753556 0.05209824 0.04956096 0.04977379 0.04805646
  0.04971802 0.04774092]]
2024-10-22 17:00:06,461 - DEBUG - Normalized Policy: [[0.         0.         0.33640194 0.         0.         0.
  0.         0.         0.         0.         0.33336473 0.
  0.         0.         0.         0.         0.3302333  0.
  0.         0.        ]]
2024-10-22 17:00:06,462 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color R)) | P=0.33336472511291504
2024-10-22 17:00:06,462 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 2)) | P=0.33640193939208984
2024-10-22 17:00:06,463 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 2)) | P=0.33023330569267273
2024-10-22 17:00:06,463 - DEBUG - Simulating Node: ((Reveal player +1 color G),) | Value: 0.0
2024-10-22 17:00:06,463 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:06,463 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': None}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || GX|G2345
XX || XX|RYWB2345
XX || G1|G1
XX || XX|RYWB2345
XX || XX|RYWB12345
-----
G2 || G2|G2
Y2 || Y2|Y2
R2 || X2|RWB2
R1 || X1|RGWB1
B2 || XX|RGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:06,463 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:06,463 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:06,463 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:06,464 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2),)
2024-10-22 17:00:06,464 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)']
2024-10-22 17:00:06,464 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 2 | Depth: 1
2024-10-22 17:00:06,679 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:06,679 - DEBUG - Network Policy Logits: [[ 0.00020571  0.05676286 -0.01057196 -0.01712735 -0.02254635  0.06211344
   0.01970801  0.05330209 -0.03108175  0.04922872 -0.01984328  0.02637737
   0.00571148 -0.05794739  0.04792006 -0.00900231 -0.01255512 -0.01020199
   0.01195453 -0.01683265]]
2024-10-22 17:00:06,679 - DEBUG - Network Policy after Softmax: [[0.04967067 0.05256085 0.0491382  0.04881714 0.04855331 0.05284284
  0.05064886 0.05237927 0.04814065 0.05216634 0.04868473 0.05098779
  0.04994489 0.04686455 0.05209812 0.0492154  0.04904085 0.04915639
  0.05025768 0.04883153]]
2024-10-22 17:00:06,681 - DEBUG - Normalized Policy: [[0.         0.         0.32714704 0.         0.         0.
  0.         0.34872505 0.         0.         0.32412794 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:06,682 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color R)) | P=0.3241279423236847
2024-10-22 17:00:06,683 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 2)) | P=0.3271470367908478
2024-10-22 17:00:06,683 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Play 2)) | P=0.3487250506877899
2024-10-22 17:00:06,683 - DEBUG - Simulating Node: ((Reveal player +1 rank 2),) | Value: 0.0
2024-10-22 17:00:06,684 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:06,684 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 33, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || XX|RYGWB345
XX || X1|RYGWB1
XX || XX|RYGWB345
XX || XX|RYGWB1345
-----
G2 || G2|G2
Y2 || Y2|Y2
R2 || X2|RWB2
R1 || X1|RGWB1
G4 || XX|RGWB12345
Deck size: 33
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:06,684 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:06,684 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:06,684 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:06,684 - DEBUG - Expanding unexplored child: ((Play 0),)
2024-10-22 17:00:06,684 - DEBUG - Traversing Path: ['()', '((Play 0),)']
2024-10-22 17:00:06,685 - DEBUG - Move: (Play 0) | Reward: 3 | Depth: 1
2024-10-22 17:00:06,872 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:06,872 - DEBUG - Network Policy Logits: [[ 0.02746532  0.02602829  0.01671162 -0.03293035 -0.01420358  0.09659196
  -0.00607103  0.04038572 -0.02825021  0.05092337 -0.02120453  0.01168685
  -0.02701279 -0.06878138  0.01082296 -0.05603345 -0.00572178 -0.02290677
   0.0023458  -0.02010609]]
2024-10-22 17:00:06,872 - DEBUG - Network Policy after Softmax: [[0.05140859 0.05133476 0.05085871 0.04839563 0.04931046 0.055088
  0.04971312 0.05207712 0.04862266 0.05262879 0.04896645 0.05060381
  0.04868286 0.04669133 0.05056011 0.04729036 0.04973048 0.04888317
  0.05013331 0.04902027]]
2024-10-22 17:00:06,874 - DEBUG - Normalized Policy: [[0.         0.         0.2035018  0.         0.         0.
  0.         0.20837703 0.         0.         0.         0.
  0.         0.1868268  0.20230699 0.         0.19898741 0.
  0.         0.        ]]
2024-10-22 17:00:06,874 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color B)) | P=0.20230698585510254
2024-10-22 17:00:06,875 - DEBUG - Added Child Node: ((Play 0), (Play 2)) | P=0.20837703347206116
2024-10-22 17:00:06,875 - DEBUG - Added Child Node: ((Play 0), (Discard 2)) | P=0.20350180566310883
2024-10-22 17:00:06,876 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color W)) | P=0.18682679533958435
2024-10-22 17:00:06,876 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 2)) | P=0.19898740947246552
2024-10-22 17:00:06,876 - DEBUG - Simulating Node: ((Play 0),) | Value: 0.0
2024-10-22 17:00:06,877 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:06,877 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
Y2 || Y2|Y2
B2 || X2|RWB2
W1 || X1|RGWB1
W2 || XX|RGWB12345
G4 || XX|RYGWB12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:06,877 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:06,877 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:06,877 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:06,877 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:00:06,877 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:00:06,878 - DEBUG - Move: (Discard 3) | Reward: 2 | Depth: 1
2024-10-22 17:00:07,059 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:07,059 - DEBUG - Network Policy Logits: [[ 0.02403782  0.04318852  0.00330421 -0.04913644 -0.00614259  0.09178781
  -0.01253824  0.04756784 -0.02088675  0.07778038 -0.01943765  0.01114765
  -0.03350839 -0.05877363  0.04974305 -0.01643782 -0.01502117 -0.03001885
  -0.00136121 -0.01725521]]
2024-10-22 17:00:07,060 - DEBUG - Network Policy after Softmax: [[0.05100229 0.05198843 0.04995572 0.04740351 0.04948601 0.05457744
  0.04917053 0.05221661 0.04876174 0.05381827 0.04883245 0.05034908
  0.04815015 0.04694887 0.05233031 0.04897916 0.0490486  0.04831847
  0.04972319 0.04893914]]
2024-10-22 17:00:07,061 - DEBUG - Normalized Policy: [[0.         0.         0.24971196 0.         0.         0.
  0.         0.2610134  0.         0.         0.24409711 0.
  0.         0.         0.         0.         0.24517755 0.
  0.         0.        ]]
2024-10-22 17:00:07,061 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color R)) | P=0.24409711360931396
2024-10-22 17:00:07,062 - DEBUG - Added Child Node: ((Discard 3), (Discard 2)) | P=0.24971196055412292
2024-10-22 17:00:07,062 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 2)) | P=0.24517755210399628
2024-10-22 17:00:07,063 - DEBUG - Added Child Node: ((Discard 3), (Play 2)) | P=0.261013388633728
2024-10-22 17:00:07,063 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:00:07,063 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:07,063 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 2}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
G2 || G2|G2
Y2 || Y2|Y2
R2 || X2|RWB2
B3 || XX|RGWB12345
Y2 || XX|RYGWB12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1 B1}
2024-10-22 17:00:07,063 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:07,063 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:07,063 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:07,064 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.31786248087882996 | PUCT: 0.31786248087882996
2024-10-22 17:00:07,064 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.29270994663238525 | PUCT: 0.29270994663238525
2024-10-22 17:00:07,065 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.7506511211395264 | PUCT: 0.7506511211395264
2024-10-22 17:00:07,065 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3119841516017914 | PUCT: 0.3119841516017914
2024-10-22 17:00:07,065 - DEBUG - Selected Child: ((Play 0),) | PUCT: 0.7506511211395264
2024-10-22 17:00:07,065 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 17:00:07,065 - DEBUG - Expanding unexplored child: ((Play 0), (Reveal player +1 rank 2))
2024-10-22 17:00:07,065 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Reveal player +1 rank 2))']
2024-10-22 17:00:07,066 - DEBUG - Move: (Play 0) | Reward: 3 | Depth: 1
2024-10-22 17:00:07,066 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 3 | Depth: 2
2024-10-22 17:00:07,249 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:07,250 - DEBUG - Network Policy Logits: [[-0.00531249 -0.00945288  0.0029591  -0.03070143 -0.00432172 -0.00136764
  -0.02189388 -0.02002117  0.05585152  0.01904927  0.00680072 -0.0257275
  -0.03061461 -0.03046811 -0.01888587 -0.01543329 -0.08254408  0.02257921
   0.04398253 -0.03307268]]
2024-10-22 17:00:07,250 - DEBUG - Network Policy after Softmax: [[0.05015938 0.04995213 0.050576   0.04890192 0.0502091  0.05035764
  0.04933453 0.04942701 0.0533231  0.05139636 0.05077067 0.04914576
  0.04890616 0.04891333 0.04948315 0.04965429 0.04643131 0.05157811
  0.05269394 0.0487861 ]]
2024-10-22 17:00:07,251 - DEBUG - Normalized Policy: [[0.         0.         0.33753383 0.         0.         0.33607656
  0.         0.         0.         0.         0.         0.
  0.32638967 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:07,252 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 2), (Discard 2)) | P=0.3375338315963745
2024-10-22 17:00:07,252 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 2), (Play 0)) | P=0.336076557636261
2024-10-22 17:00:07,253 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 2), (Reveal player +1 color G)) | P=0.3263896703720093
2024-10-22 17:00:07,253 - DEBUG - Simulating Node: ((Play 0), (Reveal player +1 rank 2)) | Value: 0.0
2024-10-22 17:00:07,253 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:07,253 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || X2|RWB2
XX || X1|RGWB1
XX || X2|RGWB2
XX || X2|RYGWB2
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:07,253 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:07,253 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:07,253 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:07,254 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.3312537670135498 | PUCT: 0.3312537670135498
2024-10-22 17:00:07,254 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.3050415813922882 | PUCT: 0.3050415813922882
2024-10-22 17:00:07,254 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.5215169191360474 | PUCT: 0.5215169191360474
2024-10-22 17:00:07,255 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3251277804374695 | PUCT: 0.3251277804374695
2024-10-22 17:00:07,255 - DEBUG - Selected Child: ((Play 0),) | PUCT: 0.5215169191360474
2024-10-22 17:00:07,255 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 17:00:07,255 - DEBUG - Expanding unexplored child: ((Play 0), (Reveal player +1 color B))
2024-10-22 17:00:07,255 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Reveal player +1 color B))']
2024-10-22 17:00:07,255 - DEBUG - Move: (Play 0) | Reward: 3 | Depth: 1
2024-10-22 17:00:07,256 - DEBUG - Move: (Reveal player +1 color B) | Reward: 3 | Depth: 2
2024-10-22 17:00:07,439 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:07,439 - DEBUG - Network Policy Logits: [[ 0.00895274  0.00075382  0.0162232  -0.01398904  0.00116502  0.01527293
  -0.00059513  0.00209081  0.03920915  0.05428256  0.02527899 -0.02532146
  -0.03168811 -0.05758433 -0.01635572  0.00818658 -0.07431946 -0.0006742
   0.04186448 -0.04678943]]
2024-10-22 17:00:07,439 - DEBUG - Network Policy after Softmax: [[0.05056031 0.05014747 0.05092925 0.04941358 0.0501681  0.05088088
  0.05007987 0.05021456 0.05211347 0.05290494 0.05139255 0.04885676
  0.04854669 0.04730566 0.04929677 0.05052159 0.04652058 0.05007591
  0.05225203 0.04781909]]
2024-10-22 17:00:07,441 - DEBUG - Normalized Policy: [[0.         0.         0.3387226  0.         0.         0.33840084
  0.         0.         0.         0.         0.         0.
  0.32287654 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:07,441 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color B), (Discard 2)) | P=0.3387225866317749
2024-10-22 17:00:07,442 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color B), (Play 0)) | P=0.33840084075927734
2024-10-22 17:00:07,442 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color B), (Reveal player +1 color G)) | P=0.32287654280662537
2024-10-22 17:00:07,442 - DEBUG - Simulating Node: ((Play 0), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:00:07,442 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:07,442 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || X2|RW2
XX || X1|RGW1
XX || BX|B12345
XX || XX|RYGW12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
G1 || X1|RYGWB1
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1}
2024-10-22 17:00:07,442 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:07,443 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:07,443 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:07,443 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.3424307703971863 | PUCT: 0.3424307703971863
2024-10-22 17:00:07,443 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.31533414125442505 | PUCT: 0.31533414125442505
2024-10-22 17:00:07,444 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.40433526039123535 | PUCT: 0.40433526039123535
2024-10-22 17:00:07,444 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3360980749130249 | PUCT: 0.3360980749130249
2024-10-22 17:00:07,444 - DEBUG - Selected Child: ((Play 0),) | PUCT: 0.40433526039123535
2024-10-22 17:00:07,444 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 17:00:07,444 - DEBUG - Expanding unexplored child: ((Play 0), (Discard 2))
2024-10-22 17:00:07,444 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Discard 2))']
2024-10-22 17:00:07,445 - DEBUG - Move: (Play 0) | Reward: 3 | Depth: 1
2024-10-22 17:00:07,445 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 2
2024-10-22 17:00:07,625 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:07,625 - DEBUG - Network Policy Logits: [[ 0.01257047  0.02588303 -0.02854433 -0.04657005 -0.04202715  0.00589301
  -0.00340941  0.03741136  0.04111545  0.0751899  -0.00114486 -0.02364114
  -0.05120016 -0.04087229  0.02891924  0.02447676 -0.06039741 -0.01927179
   0.02404394 -0.03814925]]
2024-10-22 17:00:07,625 - DEBUG - Network Policy after Softmax: [[0.0508011  0.05148191 0.04875477 0.04788381 0.04810184 0.05046301
  0.04999575 0.05207885 0.05227211 0.05408395 0.0501091  0.04899441
  0.04766262 0.04815742 0.05163846 0.05140957 0.04722626 0.04920896
  0.05138732 0.04828873]]
2024-10-22 17:00:07,627 - DEBUG - Normalized Policy: [[0.         0.         0.33292428 0.         0.         0.344589
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.32248676 0.
  0.         0.        ]]
2024-10-22 17:00:07,627 - DEBUG - Added Child Node: ((Play 0), (Discard 2), (Discard 2)) | P=0.3329242765903473
2024-10-22 17:00:07,628 - DEBUG - Added Child Node: ((Play 0), (Discard 2), (Play 0)) | P=0.3445889949798584
2024-10-22 17:00:07,628 - DEBUG - Added Child Node: ((Play 0), (Discard 2), (Reveal player +1 rank 2)) | P=0.3224867582321167
2024-10-22 17:00:07,628 - DEBUG - Simulating Node: ((Play 0), (Discard 2)) | Value: 0.0
2024-10-22 17:00:07,628 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:07,629 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 31, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || X2|RWB2
XX || X1|RGWB1
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
Y2 || XX|RYGWB12345
Deck size: 31
Discards: B3 R3 R4 Y1 R1 R1}
2024-10-22 17:00:07,629 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:07,629 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:07,629 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:07,629 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.3519951403141022 | PUCT: 0.3519951403141022
2024-10-22 17:00:07,630 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.3241416811943054 | PUCT: 0.3241416811943054
2024-10-22 17:00:07,630 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.33250296115875244 | PUCT: 0.33250296115875244
2024-10-22 17:00:07,630 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3454855680465698 | PUCT: 0.3454855680465698
2024-10-22 17:00:07,630 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.3519951403141022
2024-10-22 17:00:07,631 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:07,631 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Reveal player +1 color R))
2024-10-22 17:00:07,631 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 color R))']
2024-10-22 17:00:07,631 - DEBUG - Move: (Reveal player +1 color G) | Reward: 2 | Depth: 1
2024-10-22 17:00:07,631 - DEBUG - Illegal move encountered: (Reveal player +1 color R)
2024-10-22 17:00:07,631 - DEBUG - Backpropagating reward: 2
2024-10-22 17:00:07,631 - DEBUG - Rollout #9 completed with reward=2
2024-10-22 17:00:07,631 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:07,632 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 1.0 | U: 0.24022378027439117 | PUCT: 1.24022376537323
2024-10-22 17:00:07,632 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.3318222165107727 | PUCT: 0.3318222165107727
2024-10-22 17:00:07,633 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.3403816223144531 | PUCT: 0.3403816223144531
2024-10-22 17:00:07,633 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.3536718785762787 | PUCT: 0.3536718785762787
2024-10-22 17:00:07,633 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 1.24022376537323
2024-10-22 17:00:07,633 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:00:07,633 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Discard 2))
2024-10-22 17:00:07,634 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Discard 2))']
2024-10-22 17:00:07,634 - DEBUG - Move: (Reveal player +1 color G) | Reward: 2 | Depth: 1
2024-10-22 17:00:07,635 - DEBUG - Move: (Discard 2) | Reward: 2 | Depth: 2
2024-10-22 17:00:07,853 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:07,853 - DEBUG - Network Policy Logits: [[-0.03011824  0.00424682 -0.00764698 -0.00341641 -0.00290471  0.01762864
  -0.02477456 -0.02814438  0.02380695  0.02295717 -0.00591813 -0.02882295
  -0.00798214 -0.04501465  0.02009753  0.00741152 -0.05658292 -0.03341195
   0.04147402 -0.0380961 ]]
2024-10-22 17:00:07,854 - DEBUG - Network Policy after Softmax: [[0.0489273  0.05063792 0.05003921 0.05025135 0.05027707 0.0513201
  0.04918946 0.04902398 0.05163816 0.05159429 0.0501258  0.04899072
  0.05002244 0.04820387 0.05144696 0.05079843 0.04764944 0.04876642
  0.05255856 0.04853852]]
2024-10-22 17:00:07,855 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33675814 0.         0.34392035
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.3193215  0.
  0.         0.        ]]
2024-10-22 17:00:07,855 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 2), (Discard 3)) | P=0.3367581367492676
2024-10-22 17:00:07,856 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 2), (Play 0)) | P=0.34392035007476807
2024-10-22 17:00:07,857 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 2), (Reveal player +1 rank 2)) | P=0.31932151317596436
2024-10-22 17:00:07,857 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Discard 2)) | Value: 0.0
2024-10-22 17:00:07,857 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:07,857 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 32, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 1, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G1 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || Y2|Y2
XX || X2|RWB2
XX || X1|RGWB1
XX || XX|RGWB12345
-----
G2 || GX|G2345
B4 || XX|RYWB2345
Y4 || XX|RYWB2345
R5 || XX|RYWB12345
B2 || XX|RYGWB12345
Deck size: 32
Discards: B3 R3 R4 Y1 R1 G1}
2024-10-22 17:00:07,857 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:07,857 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:07,857 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:07,857 - DEBUG - Best node chosen by MCTS: ((Play 0),) | Visit Count: 4
2024-10-22 17:00:07,857 - INFO - Actual Game Score: 2
2024-10-22 17:00:07,857 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:07,857 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:07,857 - DEBUG - Policy Targets: [0.         0.         0.         0.11111111 0.         0.44444444
 0.         0.         0.         0.         0.         0.
 0.33333333 0.         0.         0.         0.11111111 0.
 0.         0.        ]
2024-10-22 17:00:07,858 - DEBUG - === End of Training Data ===
2024-10-22 17:00:07,858 - INFO - Chosen Action: (Play 0) | Visit Count: 4
2024-10-22 17:00:07,858 - DEBUG - Not the current player's turn.
2024-10-22 17:00:09,842 - INFO - Agent state has been reset.
2024-10-22 17:00:09,842 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:09,842 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 31, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || X2|RWB2
XX || X1|RGWB1
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
R2 || XX|RYGWB12345
Deck size: 31
Discards: B3 R3 R4 Y1 R1 G1}
2024-10-22 17:00:09,842 - INFO - Max Rollouts: 10
2024-10-22 17:00:09,842 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:09,842 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:09,842 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:10,059 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:10,059 - DEBUG - Network Policy Logits: [[ 0.01328667  0.02042179 -0.02184143 -0.05355412 -0.03349131  0.00427532
   0.00413593  0.0344885   0.04974142  0.0621605   0.00049406 -0.02169316
  -0.03398257 -0.0318841   0.03917448  0.02181641 -0.06441274 -0.00908086
   0.0157511  -0.04474173]]
2024-10-22 17:00:10,059 - DEBUG - Network Policy after Softmax: [[0.05076288 0.05112638 0.04901064 0.04748076 0.04844298 0.05030749
  0.05030048 0.05185064 0.05264757 0.05330548 0.05011763 0.0490179
  0.04841919 0.0485209  0.05209418 0.05119773 0.04696797 0.04964004
  0.05088814 0.04790103]]
2024-10-22 17:00:10,060 - DEBUG - Normalized Policy: [[0.         0.         0.33503276 0.         0.         0.34389797
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.32106927 0.
  0.         0.        ]]
2024-10-22 17:00:10,061 - DEBUG - Dirichlet Noise Added: [0.         0.         0.49541974 0.         0.         0.25793168
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.2466486  0.
 0.         0.        ]
2024-10-22 17:00:10,061 - DEBUG - Added Child Node: ((Discard 2),) | P=0.4954197406768799
2024-10-22 17:00:10,062 - DEBUG - Added Child Node: ((Play 0),) | P=0.2579316794872284
2024-10-22 17:00:10,062 - DEBUG - Added Child Node: ((Reveal player +1 rank 2),) | P=0.24664859473705292
2024-10-22 17:00:10,063 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:10,063 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:10,063 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 31, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || X2|RWB2
XX || X1|RGWB1
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
R2 || XX|RYGWB12345
Deck size: 31
Discards: B3 R3 R4 Y1 R1 G1}
2024-10-22 17:00:10,063 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:10,063 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:10,063 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:10,063 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2),)
2024-10-22 17:00:10,063 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)']
2024-10-22 17:00:10,064 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 3 | Depth: 1
2024-10-22 17:00:10,286 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:10,286 - DEBUG - Network Policy Logits: [[ 0.03791878 -0.00235309  0.03812182 -0.00936117 -0.01675779  0.04567302
   0.01426967  0.03652595 -0.02805473  0.03964818 -0.04440251 -0.05748954
  -0.02785208 -0.03869653  0.02900087 -0.0202534  -0.00856765 -0.00527318
   0.03594493 -0.01418778]]
2024-10-22 17:00:10,286 - DEBUG - Network Policy after Softmax: [[0.05189686 0.0498484  0.05190739 0.04950028 0.04913549 0.05230084
  0.05068394 0.05182463 0.04858353 0.05198668 0.04779576 0.04717433
  0.04859338 0.04806926 0.0514361  0.04896403 0.04953957 0.04970305
  0.05179452 0.04926193]]
2024-10-22 17:00:10,287 - DEBUG - Normalized Policy: [[0.26380286 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.2429561  0.
  0.         0.24434637 0.         0.24889468 0.         0.
  0.         0.        ]]
2024-10-22 17:00:10,288 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color R)) | P=0.24295610189437866
2024-10-22 17:00:10,289 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color W)) | P=0.24434636533260345
2024-10-22 17:00:10,289 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 1)) | P=0.24889467656612396
2024-10-22 17:00:10,290 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 0)) | P=0.2638028562068939
2024-10-22 17:00:10,290 - DEBUG - Simulating Node: ((Reveal player +1 rank 2),) | Value: 0.0
2024-10-22 17:00:10,290 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:10,290 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 31, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}], [{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || XX|RYGWB345
XX || XX|RYGWB345
XX || XX|RYGWB1345
XX || X2|RYGWB2
-----
Y2 || Y2|Y2
W2 || X2|RWB2
R1 || X1|RGWB1
W1 || XX|RGWB12345
G1 || XX|RYGWB12345
Deck size: 31
Discards: B3 R3 R4 Y1 R1 G1}
2024-10-22 17:00:10,290 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:10,290 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:10,290 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:10,290 - DEBUG - Expanding unexplored child: ((Discard 2),)
2024-10-22 17:00:10,290 - DEBUG - Traversing Path: ['()', '((Discard 2),)']
2024-10-22 17:00:10,291 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 1
2024-10-22 17:00:10,516 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:10,517 - DEBUG - Network Policy Logits: [[ 0.02920415  0.0257893  -0.0108724  -0.01179735 -0.02489889  0.09409349
   0.01561074  0.03982018 -0.02060166  0.08449775 -0.03830552 -0.04006209
  -0.0409024  -0.01617427  0.05430728 -0.00833752  0.0179725  -0.05532656
   0.02049727 -0.02854514]]
2024-10-22 17:00:10,517 - DEBUG - Network Policy after Softmax: [[0.05121838 0.05104377 0.04920631 0.04916082 0.04852094 0.05465211
  0.05052685 0.05176501 0.04872989 0.05413019 0.04787477 0.04779075
  0.04775061 0.04894612 0.05252039 0.0493312  0.05064633 0.04706679
  0.05077436 0.04834434]]
2024-10-22 17:00:10,519 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33049732 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.353083   0.         0.         0.3164197
  0.         0.        ]]
2024-10-22 17:00:10,520 - DEBUG - Added Child Node: ((Discard 2), (Discard 3)) | P=0.3304973244667053
2024-10-22 17:00:10,520 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 color B)) | P=0.3530830144882202
2024-10-22 17:00:10,522 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 rank 3)) | P=0.31641969084739685
2024-10-22 17:00:10,522 - DEBUG - Simulating Node: ((Discard 2),) | Value: 0.0
2024-10-22 17:00:10,522 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:10,522 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 30, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
Y2 || Y2|Y2
B2 || X2|RWB2
W3 || XX|RGWB12345
W3 || XX|RYGWB12345
G3 || XX|RYGWB12345
Deck size: 30
Discards: B3 R3 R4 Y1 R1 G1 G1}
2024-10-22 17:00:10,522 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:10,523 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:10,523 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:10,523 - DEBUG - Expanding unexplored child: ((Play 0),)
2024-10-22 17:00:10,523 - DEBUG - Traversing Path: ['()', '((Play 0),)']
2024-10-22 17:00:10,524 - DEBUG - Move: (Play 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:10,744 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:10,744 - DEBUG - Network Policy Logits: [[ 0.02661544  0.04152541 -0.00825247 -0.02176372 -0.00405176  0.08836281
   0.00034899  0.00908538 -0.02655094  0.09164889 -0.03369534 -0.01584253
  -0.07809696 -0.00096529  0.07648253  0.02937441  0.00598437 -0.05449769
   0.02081525 -0.01549533]]
2024-10-22 17:00:10,745 - DEBUG - Network Policy after Softmax: [[0.05096591 0.0517315  0.04921946 0.04855891 0.04942665 0.05421211
  0.04964464 0.05008025 0.04832701 0.05439055 0.04798297 0.04884729
  0.04589905 0.04957944 0.05357186 0.05110671 0.0499252  0.04699512
  0.05067115 0.04886425]]
2024-10-22 17:00:10,747 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32348078 0.         0.
  0.         0.         0.         0.         0.31964406 0.
  0.         0.         0.35687515 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:10,747 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color R)) | P=0.3196440637111664
2024-10-22 17:00:10,748 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color B)) | P=0.35687515139579773
2024-10-22 17:00:10,750 - DEBUG - Added Child Node: ((Play 0), (Discard 3)) | P=0.3234807848930359
2024-10-22 17:00:10,750 - DEBUG - Simulating Node: ((Play 0),) | Value: 0.0
2024-10-22 17:00:10,750 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:10,750 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 30, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || X2|RWB2
R1 || X1|RGWB1
B5 || XX|RGWB12345
R2 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 30
Discards: B3 R3 R4 Y1 R1 G1}
2024-10-22 17:00:10,750 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:10,750 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:10,750 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:10,751 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.3911341726779938 | PUCT: 0.3911341726779938
2024-10-22 17:00:10,751 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 0.0 | U: 0.7856342792510986 | PUCT: 0.7856342792510986
2024-10-22 17:00:10,751 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.4090268611907959 | PUCT: 0.4090268611907959
2024-10-22 17:00:10,752 - DEBUG - Selected Child: ((Discard 2),) | PUCT: 0.7856342792510986
2024-10-22 17:00:10,752 - DEBUG - Selected child for exploration: ((Discard 2),)
2024-10-22 17:00:10,752 - DEBUG - Expanding unexplored child: ((Discard 2), (Reveal player +1 rank 3))
2024-10-22 17:00:10,752 - DEBUG - Traversing Path: ['()', '((Discard 2),)', '((Discard 2), (Reveal player +1 rank 3))']
2024-10-22 17:00:10,753 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 1
2024-10-22 17:00:10,753 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:10,754 - DEBUG - Backpropagating reward: 3
2024-10-22 17:00:10,754 - DEBUG - Rollout #5 completed with reward=3
2024-10-22 17:00:10,754 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:10,754 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.4126943349838257 | PUCT: 0.4126943349838257
2024-10-22 17:00:10,755 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 1.5 | U: 0.5526267886161804 | PUCT: 2.052626848220825
2024-10-22 17:00:10,755 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.4315733015537262 | PUCT: 0.4315733015537262
2024-10-22 17:00:10,756 - DEBUG - Selected Child: ((Discard 2),) | PUCT: 2.052626848220825
2024-10-22 17:00:10,756 - DEBUG - Selected child for exploration: ((Discard 2),)
2024-10-22 17:00:10,756 - DEBUG - Expanding unexplored child: ((Discard 2), (Discard 3))
2024-10-22 17:00:10,756 - DEBUG - Traversing Path: ['()', '((Discard 2),)', '((Discard 2), (Discard 3))']
2024-10-22 17:00:10,757 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 1
2024-10-22 17:00:10,758 - DEBUG - Move: (Discard 3) | Reward: 3 | Depth: 2
2024-10-22 17:00:10,977 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:10,978 - DEBUG - Network Policy Logits: [[ 0.01644619  0.00257486 -0.01859602 -0.05782668 -0.02076572  0.01874558
   0.02617747  0.02638046  0.0323331   0.08319215 -0.0195963  -0.04999021
  -0.06253798 -0.01565426  0.05467065  0.02415544 -0.05504617 -0.02213122
   0.04110743 -0.02628977]]
2024-10-22 17:00:10,978 - DEBUG - Network Policy after Softmax: [[0.05084773 0.05014727 0.04909677 0.04720796 0.04899036 0.05096478
  0.05134496 0.05135538 0.05166199 0.05435744 0.04904768 0.04757936
  0.04698607 0.04924141 0.05282898 0.05124124 0.04733941 0.04892351
  0.05211729 0.04872048]]
2024-10-22 17:00:10,980 - DEBUG - Normalized Policy: [[0.         0.         0.33308312 0.         0.         0.34575608
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.32116076 0.
  0.         0.        ]]
2024-10-22 17:00:10,980 - DEBUG - Added Child Node: ((Discard 2), (Discard 3), (Discard 2)) | P=0.3330831229686737
2024-10-22 17:00:10,981 - DEBUG - Added Child Node: ((Discard 2), (Discard 3), (Play 0)) | P=0.34575608372688293
2024-10-22 17:00:10,982 - DEBUG - Added Child Node: ((Discard 2), (Discard 3), (Reveal player +1 rank 2)) | P=0.32116076350212097
2024-10-22 17:00:10,982 - DEBUG - Simulating Node: ((Discard 2), (Discard 3)) | Value: 0.0
2024-10-22 17:00:10,982 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:10,982 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || X2|RWB2
XX || XX|RGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R2 || XX|RYGWB12345
Y1 || XX|RYGWB12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1 R5}
2024-10-22 17:00:10,982 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:10,982 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:10,982 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:10,983 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.4300808012485504 | PUCT: 0.4300808012485504
2024-10-22 17:00:10,984 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 1.0 | U: 0.43193134665489197 | PUCT: 1.4319313764572144
2024-10-22 17:00:10,984 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.44975510239601135 | PUCT: 0.44975510239601135
2024-10-22 17:00:10,984 - DEBUG - Selected Child: ((Discard 2),) | PUCT: 1.4319313764572144
2024-10-22 17:00:10,984 - DEBUG - Selected child for exploration: ((Discard 2),)
2024-10-22 17:00:10,985 - DEBUG - Expanding unexplored child: ((Discard 2), (Reveal player +1 color B))
2024-10-22 17:00:10,985 - DEBUG - Traversing Path: ['()', '((Discard 2),)', '((Discard 2), (Reveal player +1 color B))']
2024-10-22 17:00:10,985 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 1
2024-10-22 17:00:10,986 - DEBUG - Illegal move encountered: (Reveal player +1 color B)
2024-10-22 17:00:10,986 - DEBUG - Backpropagating reward: 3
2024-10-22 17:00:10,986 - DEBUG - Rollout #7 completed with reward=3
2024-10-22 17:00:10,986 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:10,987 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.4445923864841461 | PUCT: 0.4445923864841461
2024-10-22 17:00:10,987 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 1.5 | U: 0.35720428824424744 | PUCT: 1.8572043180465698
2024-10-22 17:00:10,988 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.46493053436279297 | PUCT: 0.46493053436279297
2024-10-22 17:00:10,988 - DEBUG - Selected Child: ((Discard 2),) | PUCT: 1.8572043180465698
2024-10-22 17:00:10,988 - DEBUG - Selected child for exploration: ((Discard 2),)
2024-10-22 17:00:10,989 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Reveal player +1 rank 3)) | Q: 3.0 | U: 0.5017768740653992 | PUCT: 3.501776933670044
2024-10-22 17:00:10,989 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Discard 3)) | Q: 0.0 | U: 0.5241010785102844 | PUCT: 0.5241010785102844
2024-10-22 17:00:10,990 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Reveal player +1 color B)) | Q: 3.0 | U: 0.5599173903465271 | PUCT: 3.559917449951172
2024-10-22 17:00:10,991 - DEBUG - Selected Child: ((Discard 2), (Reveal player +1 color B)) | PUCT: 3.559917449951172
2024-10-22 17:00:10,991 - DEBUG - Selected child for exploration: ((Discard 2), (Reveal player +1 color B))
2024-10-22 17:00:10,991 - DEBUG - Node ((Discard 2), (Reveal player +1 color B)) is a leaf node.
2024-10-22 17:00:10,991 - DEBUG - Traversing Path: ['()', '((Discard 2),)', '((Discard 2), (Reveal player +1 color B))']
2024-10-22 17:00:10,991 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 1
2024-10-22 17:00:10,991 - DEBUG - Illegal move encountered: (Reveal player +1 color B)
2024-10-22 17:00:10,991 - DEBUG - Backpropagating reward: 3
2024-10-22 17:00:10,992 - DEBUG - Rollout #8 completed with reward=3
2024-10-22 17:00:10,992 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:10,993 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.4570102095603943 | PUCT: 0.4570102095603943
2024-10-22 17:00:10,993 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 1.8 | U: 0.30598440766334534 | PUCT: 2.1059844493865967
2024-10-22 17:00:10,994 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.477916419506073 | PUCT: 0.477916419506073
2024-10-22 17:00:10,994 - DEBUG - Selected Child: ((Discard 2),) | PUCT: 2.1059844493865967
2024-10-22 17:00:10,994 - DEBUG - Selected child for exploration: ((Discard 2),)
2024-10-22 17:00:10,995 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Reveal player +1 rank 3)) | Q: 3.0 | U: 0.5294358730316162 | PUCT: 3.529435873031616
2024-10-22 17:00:10,995 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Discard 3)) | Q: 0.0 | U: 0.5529906749725342 | PUCT: 0.5529906749725342
2024-10-22 17:00:10,996 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Reveal player +1 color B)) | Q: 3.0 | U: 0.39385414123535156 | PUCT: 3.3938541412353516
2024-10-22 17:00:10,996 - DEBUG - Selected Child: ((Discard 2), (Reveal player +1 rank 3)) | PUCT: 3.529435873031616
2024-10-22 17:00:10,996 - DEBUG - Selected child for exploration: ((Discard 2), (Reveal player +1 rank 3))
2024-10-22 17:00:10,996 - DEBUG - Node ((Discard 2), (Reveal player +1 rank 3)) is a leaf node.
2024-10-22 17:00:10,996 - DEBUG - Traversing Path: ['()', '((Discard 2),)', '((Discard 2), (Reveal player +1 rank 3))']
2024-10-22 17:00:10,996 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 1
2024-10-22 17:00:10,996 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:10,997 - DEBUG - Backpropagating reward: 3
2024-10-22 17:00:10,997 - DEBUG - Rollout #9 completed with reward=3
2024-10-22 17:00:10,997 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:10,997 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.4678390920162201 | PUCT: 0.4678390920162201
2024-10-22 17:00:10,998 - DEBUG - PUCT Calculation | Child: ((Discard 2),) | Q: 2.0 | U: 0.2684869170188904 | PUCT: 2.268486976623535
2024-10-22 17:00:10,998 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.4892406463623047 | PUCT: 0.4892406463623047
2024-10-22 17:00:10,998 - DEBUG - Selected Child: ((Discard 2),) | PUCT: 2.268486976623535
2024-10-22 17:00:10,998 - DEBUG - Selected child for exploration: ((Discard 2),)
2024-10-22 17:00:10,998 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Reveal player +1 rank 3)) | Q: 3.0 | U: 0.36782705783843994 | PUCT: 3.3678269386291504
2024-10-22 17:00:10,999 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Discard 3)) | Q: 0.0 | U: 0.5762876868247986 | PUCT: 0.5762876868247986
2024-10-22 17:00:10,999 - DEBUG - PUCT Calculation | Child: ((Discard 2), (Reveal player +1 color B)) | Q: 3.0 | U: 0.4104468822479248 | PUCT: 3.410446882247925
2024-10-22 17:00:10,999 - DEBUG - Selected Child: ((Discard 2), (Reveal player +1 color B)) | PUCT: 3.410446882247925
2024-10-22 17:00:10,999 - DEBUG - Selected child for exploration: ((Discard 2), (Reveal player +1 color B))
2024-10-22 17:00:10,999 - DEBUG - Node ((Discard 2), (Reveal player +1 color B)) is a leaf node.
2024-10-22 17:00:10,999 - DEBUG - Traversing Path: ['()', '((Discard 2),)', '((Discard 2), (Reveal player +1 color B))']
2024-10-22 17:00:11,000 - DEBUG - Move: (Discard 2) | Reward: 3 | Depth: 1
2024-10-22 17:00:11,000 - DEBUG - Move: (Reveal player +1 color B) | Reward: 3 | Depth: 2
2024-10-22 17:00:11,209 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:11,210 - DEBUG - Network Policy Logits: [[ 0.01233162 -0.00397841 -0.03491812 -0.04557426 -0.03140796  0.00438086
   0.00165461  0.02556765  0.04413791  0.07613654 -0.02841864 -0.05601393
  -0.05654666 -0.01862044  0.05635481  0.03725069 -0.06734676 -0.00394952
   0.02410083 -0.03122389]]
2024-10-22 17:00:11,210 - DEBUG - Network Policy after Softmax: [[0.05082517 0.05000294 0.04847955 0.04796569 0.04865002 0.05042268
  0.0502854  0.05150237 0.05246772 0.05417376 0.04879567 0.04746755
  0.04744227 0.04927613 0.05311264 0.05210761 0.04693264 0.05000438
  0.05142688 0.04865898]]
2024-10-22 17:00:11,211 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33006713 0.         0.34697443
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.3229584  0.
  0.         0.        ]]
2024-10-22 17:00:11,212 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 color B), (Discard 3)) | P=0.33006712794303894
2024-10-22 17:00:11,213 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 color B), (Play 0)) | P=0.3469744324684143
2024-10-22 17:00:11,213 - DEBUG - Added Child Node: ((Discard 2), (Reveal player +1 color B), (Reveal player +1 rank 2)) | P=0.32295840978622437
2024-10-22 17:00:11,213 - DEBUG - Simulating Node: ((Discard 2), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:00:11,213 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:11,213 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 30, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || B2|B2
XX || XX|RGW12345
XX || XX|RYGW12345
XX || XX|RYGW12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
R2 || XX|RYGWB12345
Deck size: 30
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:11,214 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:11,214 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:11,214 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:11,214 - DEBUG - Best node chosen by MCTS: ((Discard 2),) | Visit Count: 7
2024-10-22 17:00:11,214 - INFO - Actual Game Score: 3
2024-10-22 17:00:11,214 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:11,214 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:11,214 - DEBUG - Policy Targets: [0.         0.         0.77777778 0.         0.         0.11111111
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.11111111 0.
 0.         0.        ]
2024-10-22 17:00:11,214 - DEBUG - === End of Training Data ===
2024-10-22 17:00:11,214 - INFO - Chosen Action: (Discard 2) | Visit Count: 7
2024-10-22 17:00:11,215 - DEBUG - Not the current player's turn.
2024-10-22 17:00:13,008 - INFO - Agent state has been reset.
2024-10-22 17:00:13,008 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:13,008 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 30, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || B2|B2
XX || XX|RGW12345
XX || XX|RYGW12345
XX || XX|RYGW12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
R2 || XX|RYGWB12345
Deck size: 30
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:13,008 - INFO - Max Rollouts: 10
2024-10-22 17:00:13,008 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:13,009 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:13,009 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:13,218 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:13,218 - DEBUG - Network Policy Logits: [[ 0.02479894 -0.00092135 -0.02954113 -0.04480813 -0.03634641  0.0066272
   0.00549758  0.02821883  0.0434772   0.05979272 -0.03123091 -0.06155446
  -0.038285   -0.01433333  0.0617022   0.04382785 -0.06274875 -0.00950177
   0.02609821 -0.03318083]]
2024-10-22 17:00:13,219 - DEBUG - Network Policy after Softmax: [[0.0513784  0.05007378 0.048661   0.04792373 0.04833097 0.0504532
  0.05039624 0.05155441 0.05234708 0.05320815 0.04857884 0.04712787
  0.04823736 0.04940668 0.05330985 0.05236544 0.04707162 0.04964597
  0.0514452  0.04848421]]
2024-10-22 17:00:13,221 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32948923 0.         0.34688002
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.32363072 0.
  0.         0.        ]]
2024-10-22 17:00:13,221 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.4569254  0.         0.30035156
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.24272305 0.
 0.         0.        ]
2024-10-22 17:00:13,222 - DEBUG - Added Child Node: ((Discard 3),) | P=0.4569253921508789
2024-10-22 17:00:13,222 - DEBUG - Added Child Node: ((Play 0),) | P=0.3003515601158142
2024-10-22 17:00:13,224 - DEBUG - Added Child Node: ((Reveal player +1 rank 2),) | P=0.24272304773330688
2024-10-22 17:00:13,224 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:13,224 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:13,224 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 30, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || B2|B2
XX || XX|RGW12345
XX || XX|RYGW12345
XX || XX|RYGW12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
R2 || XX|RYGWB12345
Deck size: 30
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:13,224 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:13,224 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:13,224 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:13,224 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2),)
2024-10-22 17:00:13,224 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)']
2024-10-22 17:00:13,225 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 3 | Depth: 1
2024-10-22 17:00:13,435 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:13,437 - DEBUG - Network Policy Logits: [[ 0.00813057  0.01608002  0.03468585 -0.00189786 -0.03658801  0.05663343
   0.04244846  0.04439097 -0.02073508  0.06187619 -0.06896232 -0.06847728
  -0.04002256 -0.02772341  0.05401665  0.03126367  0.02071759 -0.01627707
   0.03796942 -0.00822261]]
2024-10-22 17:00:13,437 - DEBUG - Network Policy after Softmax: [[0.05006938 0.05046899 0.0514168  0.04956977 0.04787967 0.05255774
  0.05181748 0.05191823 0.04864476 0.05283402 0.04635442 0.04637691
  0.04771551 0.04830599 0.05242039 0.05124114 0.05070359 0.0488621
  0.0515859  0.04925724]]
2024-10-22 17:00:13,438 - DEBUG - Normalized Policy: [[0.4968533 0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.5031467 0.        0.        0.       ]]
2024-10-22 17:00:13,439 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 0)) | P=0.4968532919883728
2024-10-22 17:00:13,440 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 2)) | P=0.5031467080116272
2024-10-22 17:00:13,440 - DEBUG - Simulating Node: ((Reveal player +1 rank 2),) | Value: 0.0
2024-10-22 17:00:13,440 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:13,440 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 30, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || XX|RYGWB345
XX || XX|RYGWB345
XX || XX|RYGWB1345
XX || X2|RYGWB2
-----
Y2 || Y2|Y2
B2 || B2|B2
W2 || XX|RGW12345
Y2 || XX|RYGW12345
R1 || XX|RYGW12345
Deck size: 30
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:13,440 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:13,440 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:13,440 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:13,441 - DEBUG - Expanding unexplored child: ((Play 0),)
2024-10-22 17:00:13,441 - DEBUG - Traversing Path: ['()', '((Play 0),)']
2024-10-22 17:00:13,441 - DEBUG - Move: (Play 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:13,668 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:13,668 - DEBUG - Network Policy Logits: [[ 0.01467079  0.0167214   0.02164624 -0.02870086  0.01449734  0.0848006
   0.00706494  0.00516678 -0.017519    0.09508766 -0.05157192 -0.01173299
  -0.08563849  0.02893854  0.06685649  0.01934997  0.0139487  -0.04773343
   0.0374958  -0.0231237 ]]
2024-10-22 17:00:13,669 - DEBUG - Network Policy after Softmax: [[0.05028683 0.05039005 0.05063883 0.04815243 0.05027811 0.05394004
  0.04990581 0.04981117 0.04869388 0.05449779 0.04706363 0.04897644
  0.04548733 0.05100945 0.05298077 0.05052268 0.05025053 0.04724463
  0.05144783 0.04842173]]
2024-10-22 17:00:13,670 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32169268 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.34077966 0.         0.33752766 0.         0.
  0.         0.        ]]
2024-10-22 17:00:13,671 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color W)) | P=0.3407796621322632
2024-10-22 17:00:13,671 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 1)) | P=0.33752766251564026
2024-10-22 17:00:13,672 - DEBUG - Added Child Node: ((Play 0), (Discard 3)) | P=0.32169267535209656
2024-10-22 17:00:13,672 - DEBUG - Simulating Node: ((Play 0),) | Value: 0.0
2024-10-22 17:00:13,672 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:13,672 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 15, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'G', 'rank': 3}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
W1 || XX|RGW12345
G4 || XX|RYGW12345
W3 || XX|RYGW12345
G5 || XX|RYGWB12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:13,672 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:13,672 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:13,672 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:13,673 - DEBUG - Expanding unexplored child: ((Discard 3),)
2024-10-22 17:00:13,673 - DEBUG - Traversing Path: ['()', '((Discard 3),)']
2024-10-22 17:00:13,673 - DEBUG - Move: (Discard 3) | Reward: 3 | Depth: 1
2024-10-22 17:00:13,870 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:13,870 - DEBUG - Network Policy Logits: [[ 0.02552682  0.01661808  0.00888599 -0.0201707  -0.01264811  0.09293181
   0.04720143  0.03518549 -0.03056635  0.10667309 -0.04440805 -0.03221944
  -0.05001974 -0.02019823  0.06850377  0.01346959  0.01392239 -0.06220658
   0.01521247 -0.04233633]]
2024-10-22 17:00:13,871 - DEBUG - Network Policy after Softmax: [[0.05090811 0.05045659 0.05006796 0.04863408 0.04900132 0.05445786
  0.05202356 0.05140219 0.04813112 0.05521134 0.04746949 0.04805162
  0.04720385 0.04863274 0.05314367 0.05029798 0.05032076 0.04663208
  0.05038572 0.04756794]]
2024-10-22 17:00:13,872 - DEBUG - Normalized Policy: [[0.         0.         0.         0.34136364 0.         0.
  0.         0.         0.         0.         0.         0.
  0.33132482 0.         0.         0.         0.         0.32731155
  0.         0.        ]]
2024-10-22 17:00:13,873 - DEBUG - Added Child Node: ((Discard 3), (Discard 3)) | P=0.3413636386394501
2024-10-22 17:00:13,873 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3)) | P=0.32731154561042786
2024-10-22 17:00:13,874 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 color G)) | P=0.33132481575012207
2024-10-22 17:00:13,874 - DEBUG - Simulating Node: ((Discard 3),) | Value: 0.0
2024-10-22 17:00:13,874 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:13,874 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 0}, {'color': 'G', 'rank': 2}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
Y2 || Y2|Y2
B2 || B2|B2
G1 || XX|RGW12345
G3 || XX|RYGW12345
Y3 || XX|RYGWB12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1 G3}
2024-10-22 17:00:13,874 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:13,874 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:13,874 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:13,875 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.3849090337753296 | PUCT: 0.3849090337753296
2024-10-22 17:00:13,875 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.4762960970401764 | PUCT: 0.4762960970401764
2024-10-22 17:00:13,876 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.7245901226997375 | PUCT: 0.7245901226997375
2024-10-22 17:00:13,876 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.7245901226997375
2024-10-22 17:00:13,876 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:13,876 - DEBUG - Expanding unexplored child: ((Discard 3), (Discard 3))
2024-10-22 17:00:13,876 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Discard 3))']
2024-10-22 17:00:13,877 - DEBUG - Move: (Discard 3) | Reward: 3 | Depth: 1
2024-10-22 17:00:13,877 - DEBUG - Move: (Discard 3) | Reward: 3 | Depth: 2
2024-10-22 17:00:14,083 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:14,083 - DEBUG - Network Policy Logits: [[-0.00085762 -0.00524663 -0.03287799 -0.06743117 -0.02596194  0.01323196
   0.01749619  0.02133003  0.0274225   0.06923895 -0.0272037  -0.03328492
  -0.0572126  -0.02158962  0.05625329  0.02162434 -0.06506132  0.00461077
   0.02170172 -0.03650638]]
2024-10-22 17:00:14,083 - DEBUG - Network Policy after Softmax: [[0.05022417 0.05000422 0.04864145 0.04698944 0.04897902 0.05093682
  0.05115449 0.05135098 0.05166479 0.05387104 0.04891824 0.04862166
  0.04747207 0.04919365 0.05317601 0.0513661  0.04710093 0.05049957
  0.05137007 0.04846528]]
2024-10-22 17:00:14,085 - DEBUG - Normalized Policy: [[0.         0.         0.3316179  0.         0.         0.34726682
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.32111526 0.
  0.         0.        ]]
2024-10-22 17:00:14,085 - DEBUG - Added Child Node: ((Discard 3), (Discard 3), (Discard 2)) | P=0.33161789178848267
2024-10-22 17:00:14,086 - DEBUG - Added Child Node: ((Discard 3), (Discard 3), (Play 0)) | P=0.34726682305336
2024-10-22 17:00:14,086 - DEBUG - Added Child Node: ((Discard 3), (Discard 3), (Reveal player +1 rank 2)) | P=0.32111525535583496
2024-10-22 17:00:14,086 - DEBUG - Simulating Node: ((Discard 3), (Discard 3)) | Value: 0.0
2024-10-22 17:00:14,086 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:14,087 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 28, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || B2|B2
XX || XX|RGW12345
XX || XX|RYGW12345
XX || XX|RYGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R2 || XX|RYGWB12345
W2 || XX|RYGWB12345
Deck size: 28
Discards: B3 R3 R4 Y1 R1 G1 W1 Y4 Y1}
2024-10-22 17:00:14,087 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:14,087 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:14,087 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:14,087 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.4061260521411896 | PUCT: 0.4061260521411896
2024-10-22 17:00:14,088 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.5025505423545837 | PUCT: 0.5025505423545837
2024-10-22 17:00:14,088 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.5096873641014099 | PUCT: 0.5096873641014099
2024-10-22 17:00:14,088 - DEBUG - Selected Child: ((Discard 3),) | PUCT: 0.5096873641014099
2024-10-22 17:00:14,088 - DEBUG - Selected child for exploration: ((Discard 3),)
2024-10-22 17:00:14,088 - DEBUG - Expanding unexplored child: ((Discard 3), (Reveal player +1 rank 3))
2024-10-22 17:00:14,089 - DEBUG - Traversing Path: ['()', '((Discard 3),)', '((Discard 3), (Reveal player +1 rank 3))']
2024-10-22 17:00:14,089 - DEBUG - Move: (Discard 3) | Reward: 3 | Depth: 1
2024-10-22 17:00:14,090 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 3 | Depth: 2
2024-10-22 17:00:14,285 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:14,285 - DEBUG - Network Policy Logits: [[-0.00618895  0.01108674 -0.03176259 -0.04040929 -0.02786849 -0.00107737
   0.0109152   0.00914715  0.0460944   0.06843604 -0.00292093 -0.02874896
  -0.05297923 -0.01271801  0.05298731 -0.00047405 -0.05886399 -0.01342221
   0.03147286 -0.03333111]]
2024-10-22 17:00:14,285 - DEBUG - Network Policy after Softmax: [[0.04986388 0.0507328  0.04860485 0.04818639 0.04879449 0.05011942
  0.05072409 0.05063449 0.05254029 0.05372734 0.05002711 0.04875154
  0.04758448 0.04953938 0.0529037  0.05014966 0.04730528 0.04950451
  0.05177766 0.04852867]]
2024-10-22 17:00:14,287 - DEBUG - Normalized Policy: [[0.         0.         0.         0.3309253  0.         0.34420058
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.32487416 0.
  0.         0.        ]]
2024-10-22 17:00:14,288 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Discard 3)) | P=0.3309252858161926
2024-10-22 17:00:14,289 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Play 0)) | P=0.34420058131217957
2024-10-22 17:00:14,290 - DEBUG - Added Child Node: ((Discard 3), (Reveal player +1 rank 3), (Reveal player +1 rank 2)) | P=0.3248741626739502
2024-10-22 17:00:14,290 - DEBUG - Simulating Node: ((Discard 3), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:00:14,290 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:14,290 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 1, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'Y', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y1 G2 W0 B0 
Hands:
Cur player
XX || Y2|Y2
XX || B2|B2
XX || X3|RGW3
XX || XX|RYGW1245
XX || XX|RYGWB1245
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
R2 || XX|RYGWB12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1 W5}
2024-10-22 17:00:14,290 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:14,290 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:14,290 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:14,291 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.42323580384254456 | PUCT: 0.42323580384254456
2024-10-22 17:00:14,291 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.5237225890159607 | PUCT: 0.5237225890159607
2024-10-22 17:00:14,292 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.39837008714675903 | PUCT: 0.39837008714675903
2024-10-22 17:00:14,292 - DEBUG - Selected Child: ((Play 0),) | PUCT: 0.5237225890159607
2024-10-22 17:00:14,292 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 17:00:14,292 - DEBUG - Expanding unexplored child: ((Play 0), (Reveal player +1 rank 1))
2024-10-22 17:00:14,292 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Reveal player +1 rank 1))']
2024-10-22 17:00:14,293 - DEBUG - Move: (Play 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:14,293 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:00:14,293 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:14,293 - DEBUG - Rollout #7 completed with reward=4
2024-10-22 17:00:14,293 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:14,294 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.4375164210796356 | PUCT: 0.4375164210796356
2024-10-22 17:00:14,294 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 2.0 | U: 0.3609292209148407 | PUCT: 2.360929250717163
2024-10-22 17:00:14,295 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4118116796016693 | PUCT: 0.4118116796016693
2024-10-22 17:00:14,295 - DEBUG - Selected Child: ((Play 0),) | PUCT: 2.360929250717163
2024-10-22 17:00:14,295 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 17:00:14,295 - DEBUG - Expanding unexplored child: ((Play 0), (Discard 3))
2024-10-22 17:00:14,295 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Discard 3))']
2024-10-22 17:00:14,296 - DEBUG - Move: (Play 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:14,297 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:14,514 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:14,514 - DEBUG - Network Policy Logits: [[-0.00354369 -0.00045017 -0.04860666 -0.07853144 -0.01550902  0.04031436
   0.02049365  0.01759972  0.01286461  0.0597293  -0.0473627  -0.01272441
  -0.05654933 -0.00646626  0.05827978  0.03780814 -0.05134892  0.01832588
   0.02024921 -0.04840609]]
2024-10-22 17:00:14,514 - DEBUG - Network Policy after Softmax: [[0.04999409 0.05014899 0.04779121 0.04638226 0.04939946 0.05223553
  0.05121037 0.05106239 0.05082117 0.05325959 0.0478507  0.04953721
  0.04741313 0.0498482  0.05318244 0.05210478 0.04766034 0.05109948
  0.05119786 0.0478008 ]]
2024-10-22 17:00:14,516 - DEBUG - Normalized Policy: [[0.         0.         0.5006856  0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.49931443 0.
  0.         0.        ]]
2024-10-22 17:00:14,517 - DEBUG - Added Child Node: ((Play 0), (Discard 3), (Discard 2)) | P=0.5006855726242065
2024-10-22 17:00:14,518 - DEBUG - Added Child Node: ((Play 0), (Discard 3), (Reveal player +1 rank 2)) | P=0.49931442737579346
2024-10-22 17:00:14,518 - DEBUG - Simulating Node: ((Play 0), (Discard 3)) | Value: 0.0
2024-10-22 17:00:14,518 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:14,518 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 28, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RGW12345
XX || XX|RYGW12345
XX || XX|RYGW12345
XX || XX|RYGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R2 || XX|RYGWB12345
R2 || XX|RYGWB12345
Deck size: 28
Discards: B3 R3 R4 Y1 R1 G1 W1 W4}
2024-10-22 17:00:14,518 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:14,518 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:14,518 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:14,519 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.449736624956131 | PUCT: 0.449736624956131
2024-10-22 17:00:14,520 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 1.3333333333333333 | U: 0.27825769782066345 | PUCT: 1.611591100692749
2024-10-22 17:00:14,520 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.4233139157295227 | PUCT: 0.4233139157295227
2024-10-22 17:00:14,521 - DEBUG - Selected Child: ((Play 0),) | PUCT: 1.611591100692749
2024-10-22 17:00:14,521 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 17:00:14,521 - DEBUG - Expanding unexplored child: ((Play 0), (Reveal player +1 color W))
2024-10-22 17:00:14,521 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Reveal player +1 color W))']
2024-10-22 17:00:14,522 - DEBUG - Move: (Play 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:14,522 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 2
2024-10-22 17:00:14,736 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:14,737 - DEBUG - Network Policy Logits: [[-0.00886281  0.00601598 -0.0271863  -0.04977085  0.0163151   0.0134555
  -0.00706384  0.01416009  0.02789798  0.05856989 -0.06089553 -0.01833811
  -0.02252942  0.01367866  0.06082564  0.0290959  -0.05779527 -0.01303074
   0.03519184 -0.01374939]]
2024-10-22 17:00:14,737 - DEBUG - Network Policy after Softmax: [[0.04954096 0.05028358 0.04864147 0.04755523 0.05080414 0.05065906
  0.04963017 0.05069477 0.05139602 0.05299686 0.04702913 0.04907376
  0.04886851 0.05067037 0.05311654 0.05145762 0.04717516 0.04933491
  0.05177226 0.04929947]]
2024-10-22 17:00:14,738 - DEBUG - Normalized Policy: [[0.        0.5159474 0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.4840526 0.        0.        0.       ]]
2024-10-22 17:00:14,738 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color W), (Discard 1)) | P=0.5159474015235901
2024-10-22 17:00:14,739 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color W), (Reveal player +1 rank 2)) | P=0.4840525984764099
2024-10-22 17:00:14,739 - DEBUG - Simulating Node: ((Play 0), (Reveal player +1 color W)) | Value: 0.0
2024-10-22 17:00:14,739 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:14,739 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'W', 'rank': None}, {'color': 'W', 'rank': None}, {'color': 'W', 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RG12345
XX || WX|W12345
XX || WX|W12345
XX || WX|W12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
R2 || XX|RYGWB12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:14,739 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:14,739 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:14,739 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:14,740 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.46039313077926636 | PUCT: 0.46039313077926636
2024-10-22 17:00:14,740 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 1.0 | U: 0.2278808057308197 | PUCT: 1.227880835533142
2024-10-22 17:00:14,741 - DEBUG - PUCT Calculation | Child: ((Discard 3),) | Q: 0.0 | U: 0.43334436416625977 | PUCT: 0.43334436416625977
2024-10-22 17:00:14,741 - DEBUG - Selected Child: ((Play 0),) | PUCT: 1.227880835533142
2024-10-22 17:00:14,741 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 17:00:14,741 - DEBUG - PUCT Calculation | Child: ((Play 0), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.5352497696876526 | PUCT: 4.535249710083008
2024-10-22 17:00:14,742 - DEBUG - PUCT Calculation | Child: ((Play 0), (Discard 3)) | Q: 0.0 | U: 0.510138750076294 | PUCT: 0.510138750076294
2024-10-22 17:00:14,742 - DEBUG - PUCT Calculation | Child: ((Play 0), (Reveal player +1 color W)) | Q: 0.0 | U: 0.5404067635536194 | PUCT: 0.5404067635536194
2024-10-22 17:00:14,742 - DEBUG - Selected Child: ((Play 0), (Reveal player +1 rank 1)) | PUCT: 4.535249710083008
2024-10-22 17:00:14,742 - DEBUG - Selected child for exploration: ((Play 0), (Reveal player +1 rank 1))
2024-10-22 17:00:14,742 - DEBUG - Node ((Play 0), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:00:14,742 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Reveal player +1 rank 1))']
2024-10-22 17:00:14,743 - DEBUG - Move: (Play 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:14,743 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:14,925 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:14,943 - DEBUG - Network Policy Logits: [[-0.00127409  0.00504359 -0.02310839 -0.05856444  0.00723487 -0.01490702
  -0.00627508  0.01980421  0.03149262  0.06523335 -0.02093944 -0.0411078
  -0.00652763 -0.02088651  0.04369842  0.00607864 -0.05646199 -0.01608874
   0.01829399 -0.0115201 ]]
2024-10-22 17:00:14,943 - DEBUG - Network Policy after Softmax: [[0.05011572 0.05043333 0.04903334 0.04732527 0.05054397 0.04943713
  0.04986572 0.05118328 0.05178504 0.05356212 0.0491398  0.04815866
  0.04985312 0.0491424  0.05242099 0.05048556 0.04742487 0.04937874
  0.05110604 0.04960485]]
2024-10-22 17:00:14,944 - DEBUG - Normalized Policy: [[0.         0.         0.3268446  0.         0.         0.
  0.         0.         0.         0.35703242 0.         0.
  0.         0.         0.         0.         0.31612295 0.
  0.         0.        ]]
2024-10-22 17:00:14,945 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 1), (Discard 2)) | P=0.32684460282325745
2024-10-22 17:00:14,945 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 1), (Play 4)) | P=0.3570324182510376
2024-10-22 17:00:14,946 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 1), (Reveal player +1 rank 2)) | P=0.31612294912338257
2024-10-22 17:00:14,946 - DEBUG - Simulating Node: ((Play 0), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:00:14,946 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:14,946 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RGW2345
XX || X1|RYGW1
XX || X1|RYGW1
XX || X1|RYGWB1
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
R2 || XX|RYGWB12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:14,946 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:14,946 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:14,946 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:14,946 - DEBUG - Best node chosen by MCTS: ((Play 0),) | Visit Count: 5
2024-10-22 17:00:14,946 - INFO - Actual Game Score: 4
2024-10-22 17:00:14,946 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:14,946 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:14,946 - DEBUG - Policy Targets: [0.         0.         0.         0.33333333 0.         0.55555556
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.11111111 0.
 0.         0.        ]
2024-10-22 17:00:14,946 - DEBUG - === End of Training Data ===
2024-10-22 17:00:14,946 - INFO - Chosen Action: (Play 0) | Visit Count: 5
2024-10-22 17:00:14,947 - DEBUG - Not the current player's turn.
2024-10-22 17:00:16,978 - INFO - Agent state has been reset.
2024-10-22 17:00:16,978 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:16,978 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || X1|RGW1
XX || XX|RYGW2345
XX || XX|RYGW2345
XX || XX|RYGWB2345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
R2 || XX|RYGWB12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:16,978 - INFO - Max Rollouts: 10
2024-10-22 17:00:16,978 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:16,979 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:16,979 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:17,164 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:17,164 - DEBUG - Network Policy Logits: [[ 0.0155061   0.01491818 -0.04709248 -0.05915054 -0.01082182  0.04318441
   0.01644485 -0.0073603   0.03674219  0.03554602 -0.03925112 -0.02354274
  -0.03610187  0.03238018  0.05636031  0.04466279 -0.05661046  0.01585024
   0.02891674 -0.04244609]]
2024-10-22 17:00:17,165 - DEBUG - Network Policy after Softmax: [[0.05070145 0.05067165 0.04762491 0.0470541  0.04938401 0.05212438
  0.05074907 0.04955525 0.05178967 0.05172776 0.04799983 0.04875978
  0.04815123 0.05156425 0.05281572 0.0522015  0.04717377 0.05071891
  0.05138597 0.04784671]]
2024-10-22 17:00:17,166 - DEBUG - Normalized Policy: [[0.         0.34100625 0.         0.         0.         0.
  0.34152728 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.31746647 0.
  0.         0.        ]]
2024-10-22 17:00:17,166 - DEBUG - Dirichlet Noise Added: [0.         0.50362355 0.         0.         0.         0.
 0.25827658 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.23809984 0.
 0.         0.        ]
2024-10-22 17:00:17,167 - DEBUG - Added Child Node: ((Discard 1),) | P=0.5036235451698303
2024-10-22 17:00:17,167 - DEBUG - Added Child Node: ((Reveal player +1 rank 2),) | P=0.2380998432636261
2024-10-22 17:00:17,168 - DEBUG - Added Child Node: ((Play 1),) | P=0.2582765817642212
2024-10-22 17:00:17,168 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:17,168 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:17,168 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || X1|RGW1
XX || XX|RYGW2345
XX || XX|RYGW2345
XX || XX|RYGWB2345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
R2 || XX|RYGWB12345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:17,168 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:17,168 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:17,168 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:17,168 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2),)
2024-10-22 17:00:17,168 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)']
2024-10-22 17:00:17,169 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:17,366 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:17,366 - DEBUG - Network Policy Logits: [[ 0.0127139   0.03562415  0.02182126 -0.02640546 -0.00274602  0.01365598
   0.02490944  0.0514002  -0.02972727  0.07617584 -0.07160322 -0.0249053
  -0.06737773  0.03135047  0.08341547  0.02382862  0.0129219  -0.00187707
   0.02978099  0.00990219]]
2024-10-22 17:00:17,367 - DEBUG - Network Policy after Softmax: [[0.05009048 0.05125132 0.05054877 0.04816881 0.04932205 0.0501377
  0.05070511 0.05206627 0.04800907 0.05337236 0.04604015 0.04824113
  0.04623511 0.05103275 0.05376016 0.05065033 0.05010091 0.04936492
  0.05095272 0.04994984]]
2024-10-22 17:00:17,368 - DEBUG - Normalized Policy: [[0.5210668  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.47893322 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:17,369 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color R)) | P=0.4789332151412964
2024-10-22 17:00:17,370 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 0)) | P=0.5210667848587036
2024-10-22 17:00:17,370 - DEBUG - Simulating Node: ((Reveal player +1 rank 2),) | Value: 0.0
2024-10-22 17:00:17,370 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:17,370 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 29, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 4}, {'color': 'R', 'rank': 2}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || XX|RYGWB345
XX || XX|RYGWB345
XX || XX|RYGWB1345
XX || X2|RYGWB2
-----
B2 || B2|B2
R1 || X1|RGW1
W5 || XX|RYGW2345
R3 || XX|RYGW2345
G3 || XX|RYGWB2345
Deck size: 29
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:17,370 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:17,370 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:17,370 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:17,371 - DEBUG - Expanding unexplored child: ((Discard 1),)
2024-10-22 17:00:17,371 - DEBUG - Traversing Path: ['()', '((Discard 1),)']
2024-10-22 17:00:17,371 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:17,588 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:17,589 - DEBUG - Network Policy Logits: [[ 0.02588979  0.00499783  0.00579121 -0.03547788  0.02523364  0.07587917
   0.02193392  0.01015393 -0.01840907  0.10227433 -0.03665562 -0.02145015
  -0.08062137  0.02467203  0.04400197  0.02640076  0.03060891 -0.03098841
   0.04185729 -0.01777888]]
2024-10-22 17:00:17,589 - DEBUG - Network Policy after Softmax: [[0.05076279 0.04971326 0.04975271 0.04774126 0.05072949 0.05336488
  0.05056238 0.04997024 0.04856314 0.05479221 0.04768506 0.04841568
  0.04563397 0.05070101 0.05169059 0.05078873 0.05100291 0.04795607
  0.05157985 0.04859375]]
2024-10-22 17:00:17,590 - DEBUG - Normalized Policy: [[0.         0.         0.         0.31780767 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.3440979  0.33809435 0.         0.
  0.         0.        ]]
2024-10-22 17:00:17,591 - DEBUG - Added Child Node: ((Discard 1), (Discard 3)) | P=0.317807674407959
2024-10-22 17:00:17,592 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1)) | P=0.3380943536758423
2024-10-22 17:00:17,593 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color B)) | P=0.34409791231155396
2024-10-22 17:00:17,593 - DEBUG - Simulating Node: ((Discard 1),) | Value: 0.0
2024-10-22 17:00:17,593 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:17,593 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 28, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 4}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
R4 || XX|RYGW2345
R2 || XX|RYGW2345
B5 || XX|RYGWB2345
B1 || XX|RYGWB12345
Deck size: 28
Discards: B3 R3 R4 Y1 R1 G1 W1 R1}
2024-10-22 17:00:17,593 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:17,593 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:17,593 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:17,593 - DEBUG - Expanding unexplored child: ((Play 1),)
2024-10-22 17:00:17,593 - DEBUG - Traversing Path: ['()', '((Play 1),)']
2024-10-22 17:00:17,594 - DEBUG - Move: (Play 1) | Reward: 5 | Depth: 1
2024-10-22 17:00:17,792 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:17,792 - DEBUG - Network Policy Logits: [[ 0.03055711  0.02005733  0.00211917 -0.03773838  0.01264372  0.07108862
   0.01915893  0.00601035 -0.01540059  0.09621161 -0.04730966 -0.01529796
  -0.08590957  0.02938611  0.04257129  0.01406638  0.00982082 -0.04781142
   0.04195521 -0.0212893 ]]
2024-10-22 17:00:17,792 - DEBUG - Network Policy after Softmax: [[0.05118651 0.05065187 0.04975137 0.0478074  0.05027775 0.05330379
  0.05060638 0.04994534 0.04888733 0.05465991 0.047352   0.04889235
  0.04555905 0.0511266  0.05180518 0.05034932 0.05013602 0.04732825
  0.05177327 0.04860029]]
2024-10-22 17:00:17,793 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32542202 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.32216045
  0.35241744 0.        ]]
2024-10-22 17:00:17,794 - DEBUG - Added Child Node: ((Play 1), (Discard 3)) | P=0.3254220187664032
2024-10-22 17:00:17,795 - DEBUG - Added Child Node: ((Play 1), (Reveal player +1 rank 3)) | P=0.3221604526042938
2024-10-22 17:00:17,795 - DEBUG - Added Child Node: ((Play 1), (Reveal player +1 rank 4)) | P=0.3524174392223358
2024-10-22 17:00:17,795 - DEBUG - Simulating Node: ((Play 1),) | Value: 0.0
2024-10-22 17:00:17,795 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:17,795 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 28, 'turns_to_play': 2, 'fireworks': {'R': 1, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R1 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
Y4 || XX|RYGW2345
G3 || XX|RYGW2345
B4 || XX|RYGWB2345
G1 || XX|RYGWB12345
Deck size: 28
Discards: B3 R3 R4 Y1 R1 G1 W1}
2024-10-22 17:00:17,795 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:17,795 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:17,795 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:17,796 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.37757760286331177 | PUCT: 0.37757760286331177
2024-10-22 17:00:17,796 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.7986438274383545 | PUCT: 0.7986438274383545
2024-10-22 17:00:17,797 - DEBUG - PUCT Calculation | Child: ((Play 1),) | Q: 0.0 | U: 0.4095737934112549 | PUCT: 0.4095737934112549
2024-10-22 17:00:17,797 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.7986438274383545
2024-10-22 17:00:17,797 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:17,797 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:00:17,797 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 1))']
2024-10-22 17:00:17,797 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:17,798 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:00:17,798 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:17,798 - DEBUG - Rollout #5 completed with reward=4
2024-10-22 17:00:17,798 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:17,798 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.3983905017375946 | PUCT: 0.3983905017375946
2024-10-22 17:00:17,799 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 2.0 | U: 0.5617778897285461 | PUCT: 2.5617778301239014
2024-10-22 17:00:17,799 - DEBUG - PUCT Calculation | Child: ((Play 1),) | Q: 0.0 | U: 0.43215036392211914 | PUCT: 0.43215036392211914
2024-10-22 17:00:17,799 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 2.5617778301239014
2024-10-22 17:00:17,799 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:17,800 - DEBUG - Expanding unexplored child: ((Discard 1), (Discard 3))
2024-10-22 17:00:17,800 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Discard 3))']
2024-10-22 17:00:17,800 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:17,801 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:18,017 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:18,017 - DEBUG - Network Policy Logits: [[ 0.00077306  0.01076426 -0.0209628  -0.05672558 -0.00589026  0.03888491
   0.0344784   0.01789255  0.02566524  0.07881445 -0.05380632 -0.00997839
  -0.07865766  0.00423039  0.06032802  0.05749451 -0.03524849  0.01175762
   0.02678905 -0.0532909 ]]
2024-10-22 17:00:18,017 - DEBUG - Network Policy after Softmax: [[0.04986238 0.05036306 0.04879027 0.04707623 0.04953123 0.0517994
  0.05157165 0.05072334 0.05111914 0.05390958 0.04721386 0.04932915
  0.04605499 0.05003507 0.05292214 0.0527724  0.04809822 0.05041311
  0.05117662 0.04723819]]
2024-10-22 17:00:18,019 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.5181838  0.
  0.         0.         0.         0.         0.         0.
  0.48181617 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:18,019 - DEBUG - Added Child Node: ((Discard 1), (Discard 3), (Discard 4)) | P=0.5181838274002075
2024-10-22 17:00:18,020 - DEBUG - Added Child Node: ((Discard 1), (Discard 3), (Reveal player +1 color G)) | P=0.4818161725997925
2024-10-22 17:00:18,020 - DEBUG - Simulating Node: ((Discard 1), (Discard 3)) | Value: 0.0
2024-10-22 17:00:18,020 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:18,020 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYGW2345
XX || XX|RYGW2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R2 || XX|RYGWB12345
G5 || XX|RYGWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 W1 G1}
2024-10-22 17:00:18,020 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:18,020 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:18,021 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:18,021 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.41517433524131775 | PUCT: 0.41517433524131775
2024-10-22 17:00:18,022 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 1.3333333333333333 | U: 0.4390838146209717 | PUCT: 1.7724171876907349
2024-10-22 17:00:18,023 - DEBUG - PUCT Calculation | Child: ((Play 1),) | Q: 0.0 | U: 0.45035651326179504 | PUCT: 0.45035651326179504
2024-10-22 17:00:18,023 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 1.7724171876907349
2024-10-22 17:00:18,023 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:18,023 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 color B))
2024-10-22 17:00:18,023 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 color B))']
2024-10-22 17:00:18,024 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:18,024 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:00:18,216 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:18,216 - DEBUG - Network Policy Logits: [[-0.00357146  0.00168194 -0.04387144 -0.04429484  0.00288644  0.032244
   0.01838693  0.01111973  0.03685677  0.07546741 -0.05538788 -0.00955293
  -0.06724754  0.00939438  0.05061374  0.05602498 -0.03444219  0.02308143
   0.02296536 -0.05422597]]
2024-10-22 17:00:18,216 - DEBUG - Network Policy after Softmax: [[0.04971313 0.04997499 0.04774953 0.04772932 0.05003522 0.05152591
  0.05081683 0.05044887 0.05176413 0.05380186 0.04720278 0.04941666
  0.04664627 0.05036191 0.05248117 0.05276592 0.0482019  0.05105595
  0.05105002 0.04725766]]
2024-10-22 17:00:18,218 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50933105 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.49066895 0.
  0.         0.        ]]
2024-10-22 17:00:18,218 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color B), (Discard 4)) | P=0.5093310475349426
2024-10-22 17:00:18,219 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color B), (Reveal player +1 rank 2)) | P=0.4906689524650574
2024-10-22 17:00:18,219 - DEBUG - Simulating Node: ((Discard 1), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:00:18,219 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:18,219 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 28, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYGW2345
XX || XX|RYGW2345
XX || XX|RYGW2345
XX || XX|RYGW12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
R2 || XX|RYGWB12345
Deck size: 28
Discards: B3 R3 R4 Y1 R1 G1 W1 R1}
2024-10-22 17:00:18,219 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:18,219 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:18,219 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:18,220 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.4291829466819763 | PUCT: 0.4291829466819763
2024-10-22 17:00:18,220 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 1.0 | U: 0.36311933398246765 | PUCT: 1.36311936378479
2024-10-22 17:00:18,221 - DEBUG - PUCT Calculation | Child: ((Play 1),) | Q: 0.0 | U: 0.4655522108078003 | PUCT: 0.4655522108078003
2024-10-22 17:00:18,221 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 1.36311936378479
2024-10-22 17:00:18,221 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:18,221 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.5361484289169312 | PUCT: 4.536148548126221
2024-10-22 17:00:18,222 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Discard 3)) | Q: 0.0 | U: 0.50397789478302 | PUCT: 0.50397789478302
2024-10-22 17:00:18,222 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Reveal player +1 color B)) | Q: 0.0 | U: 0.5456688404083252 | PUCT: 0.5456688404083252
2024-10-22 17:00:18,222 - DEBUG - Selected Child: ((Discard 1), (Reveal player +1 rank 1)) | PUCT: 4.536148548126221
2024-10-22 17:00:18,222 - DEBUG - Selected child for exploration: ((Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:00:18,222 - DEBUG - Node ((Discard 1), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:00:18,222 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 1))']
2024-10-22 17:00:18,223 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:18,223 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:00:18,223 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:18,223 - DEBUG - Rollout #8 completed with reward=4
2024-10-22 17:00:18,223 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:18,224 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.4411703944206238 | PUCT: 0.4411703944206238
2024-10-22 17:00:18,224 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 1.6 | U: 0.31105127930641174 | PUCT: 1.9110512733459473
2024-10-22 17:00:18,224 - DEBUG - PUCT Calculation | Child: ((Play 1),) | Q: 0.0 | U: 0.47855547070503235 | PUCT: 0.47855547070503235
2024-10-22 17:00:18,224 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 1.9110512733459473
2024-10-22 17:00:18,224 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:18,225 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.3771347105503082 | PUCT: 4.377134799957275
2024-10-22 17:00:18,225 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Discard 3)) | Q: 0.0 | U: 0.5317582488059998 | PUCT: 0.5317582488059998
2024-10-22 17:00:18,225 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Reveal player +1 color B)) | Q: 0.0 | U: 0.5757472515106201 | PUCT: 0.5757472515106201
2024-10-22 17:00:18,226 - DEBUG - Selected Child: ((Discard 1), (Reveal player +1 rank 1)) | PUCT: 4.377134799957275
2024-10-22 17:00:18,226 - DEBUG - Selected child for exploration: ((Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:00:18,226 - DEBUG - Node ((Discard 1), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:00:18,226 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 1))']
2024-10-22 17:00:18,226 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:18,227 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:18,428 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:18,428 - DEBUG - Network Policy Logits: [[ 0.00594813  0.01045177 -0.02930588 -0.03011243  0.01824833  0.03296981
   0.00883677  0.01632178  0.03184361  0.07299013 -0.05368512 -0.03185056
  -0.06197188  0.01570633  0.07153673  0.05322505 -0.04661569  0.00505173
   0.02816517 -0.03237994]]
2024-10-22 17:00:18,429 - DEBUG - Network Policy after Softmax: [[0.05004696 0.05027286 0.04831334 0.04827439 0.05066635 0.05141775
  0.05019173 0.05056883 0.05135987 0.05351723 0.04714974 0.04819055
  0.04676063 0.05053771 0.05343951 0.05246985 0.04748424 0.05000212
  0.0511713  0.04816505]]
2024-10-22 17:00:18,430 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33406126 0.
  0.         0.         0.         0.35285816 0.         0.
  0.         0.         0.         0.         0.3130805  0.
  0.         0.        ]]
2024-10-22 17:00:18,431 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Play 4)) | P=0.35285815596580505
2024-10-22 17:00:18,432 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Discard 4)) | P=0.33406126499176025
2024-10-22 17:00:18,432 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Reveal player +1 rank 2)) | P=0.31308048963546753
2024-10-22 17:00:18,432 - DEBUG - Simulating Node: ((Discard 1), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:00:18,433 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:18,433 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 28, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 0}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYGW2345
XX || XX|RYGW2345
XX || XX|RYGWB2345
XX || X1|RYGWB1
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R5 || XX|RYGWB12345
R2 || XX|RYGWB12345
Deck size: 28
Discards: B3 R3 R4 Y1 R1 G1 W1 W1}
2024-10-22 17:00:18,433 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:18,433 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:18,433 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:18,433 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.45162391662597656 | PUCT: 0.45162391662597656
2024-10-22 17:00:18,434 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 1.3333333333333333 | U: 0.27293285727500916 | PUCT: 1.6062662601470947
2024-10-22 17:00:18,434 - DEBUG - PUCT Calculation | Child: ((Play 1),) | Q: 0.0 | U: 0.489894837141037 | PUCT: 0.489894837141037
2024-10-22 17:00:18,434 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 1.6062662601470947
2024-10-22 17:00:18,434 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:18,435 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Reveal player +1 rank 1)) | Q: 2.6666666666666665 | U: 0.2947673201560974 | PUCT: 2.9614341259002686
2024-10-22 17:00:18,435 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Discard 3)) | Q: 0.0 | U: 0.5541607737541199 | PUCT: 0.5541607737541199
2024-10-22 17:00:18,436 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Reveal player +1 color B)) | Q: 0.0 | U: 0.6000030040740967 | PUCT: 0.6000030040740967
2024-10-22 17:00:18,436 - DEBUG - Selected Child: ((Discard 1), (Reveal player +1 rank 1)) | PUCT: 2.9614341259002686
2024-10-22 17:00:18,436 - DEBUG - Selected child for exploration: ((Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:00:18,436 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 rank 1), (Play 4))
2024-10-22 17:00:18,436 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 1))', '((Discard 1), (Reveal player +1 rank 1), (Play 4))']
2024-10-22 17:00:18,437 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:18,437 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:00:18,437 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:18,437 - DEBUG - Rollout #10 completed with reward=4
2024-10-22 17:00:18,437 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:18,437 - DEBUG - Best node chosen by MCTS: ((Discard 1),) | Visit Count: 7
2024-10-22 17:00:18,437 - INFO - Actual Game Score: 4
2024-10-22 17:00:18,438 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:18,438 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:18,438 - DEBUG - Policy Targets: [0.         0.77777778 0.         0.         0.         0.
 0.11111111 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.11111111 0.
 0.         0.        ]
2024-10-22 17:00:18,438 - DEBUG - === End of Training Data ===
2024-10-22 17:00:18,438 - INFO - Chosen Action: (Discard 1) | Visit Count: 7
2024-10-22 17:00:18,439 - DEBUG - Not the current player's turn.
2024-10-22 17:00:20,108 - INFO - Agent state has been reset.
2024-10-22 17:00:20,108 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:20,108 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYGW2345
XX || XX|RYGW2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R2 || XX|RYGWB12345
Y3 || XX|RYGWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:20,108 - INFO - Max Rollouts: 10
2024-10-22 17:00:20,108 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:20,108 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:20,108 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:20,303 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:20,303 - DEBUG - Network Policy Logits: [[-0.01104138  0.00860471 -0.02761292 -0.06002235 -0.00747741  0.03080736
   0.03626928  0.02793444  0.02818321  0.07594226 -0.0396879  -0.01299741
  -0.08231083  0.0102813   0.05947518  0.06436489 -0.02165041  0.01712681
   0.02424116 -0.04805963]]
2024-10-22 17:00:20,303 - DEBUG - Network Policy after Softmax: [[0.04923071 0.05020746 0.0484216  0.04687744 0.04940648 0.05133467
  0.05161582 0.0511874  0.05120013 0.05370473 0.04784043 0.0491345
  0.04584417 0.05029171 0.05282762 0.05308656 0.04871117 0.05063716
  0.0509987  0.04744159]]
2024-10-22 17:00:20,305 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33213365 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.32745948 0.3404069
  0.         0.        ]]
2024-10-22 17:00:20,305 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.24910024 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.49541897 0.2554808
 0.         0.        ]
2024-10-22 17:00:20,306 - DEBUG - Added Child Node: ((Discard 4),) | P=0.2491002380847931
2024-10-22 17:00:20,307 - DEBUG - Added Child Node: ((Reveal player +1 rank 2),) | P=0.4954189658164978
2024-10-22 17:00:20,307 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.2554807960987091
2024-10-22 17:00:20,307 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:20,307 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:20,308 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYGW2345
XX || XX|RYGW2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
G2 || XX|RYGWB2345
B4 || XX|RYGWB2345
Y4 || XX|RYGWB2345
R2 || XX|RYGWB12345
Y3 || XX|RYGWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:20,308 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:20,308 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:20,308 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:20,308 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2),)
2024-10-22 17:00:20,308 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)']
2024-10-22 17:00:20,309 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:20,514 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:20,515 - DEBUG - Network Policy Logits: [[-0.00153537  0.01719266 -0.01151547 -0.03749838  0.02244046  0.02873214
   0.05675736 -0.00714906  0.01615506  0.07939482 -0.03824058 -0.01874289
  -0.0696306   0.0177507   0.02761629  0.03636054  0.00386168 -0.00752374
   0.04940588 -0.03695186]]
2024-10-22 17:00:20,515 - DEBUG - Network Policy after Softmax: [[0.04957644 0.05051366 0.04908412 0.0478252  0.05077944 0.05109993
  0.05255228 0.04929891 0.05046127 0.0537555  0.04778972 0.04873065
  0.04631289 0.05054186 0.05104295 0.05149124 0.04984473 0.04928045
  0.05216736 0.04785135]]
2024-10-22 17:00:20,516 - DEBUG - Normalized Policy: [[0.5014971  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.49850294
  0.         0.        ]]
2024-10-22 17:00:20,517 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 0)) | P=0.5014970898628235
2024-10-22 17:00:20,517 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3)) | P=0.4985029399394989
2024-10-22 17:00:20,518 - DEBUG - Simulating Node: ((Reveal player +1 rank 2),) | Value: 0.0
2024-10-22 17:00:20,518 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:20,518 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || XX|RYGWB345
XX || XX|RYGWB345
XX || X2|RYGWB2
XX || XX|RYGWB1345
-----
B2 || B2|B2
Y3 || XX|RYGW2345
R3 || XX|RYGW2345
B2 || XX|RYGWB2345
W3 || XX|RYGWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:20,518 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:20,518 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:20,518 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:20,518 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:00:20,518 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:00:20,519 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:20,714 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:20,714 - DEBUG - Network Policy Logits: [[-0.00789424  0.01332602 -0.00889615 -0.05317261  0.01117975  0.08689925
   0.02855351  0.03152393 -0.00707854  0.09673245 -0.03916762 -0.02312059
  -0.08773458  0.0303164   0.05413122  0.03485622  0.01699824 -0.05531528
   0.02916268 -0.02319922]]
2024-10-22 17:00:20,715 - DEBUG - Network Policy after Softmax: [[0.04923989 0.05029593 0.04919058 0.0470601  0.0501881  0.05413589
  0.05106768 0.05121959 0.04928007 0.05467085 0.04772382 0.04849582
  0.04546141 0.05115778 0.05239072 0.05139056 0.05048097 0.04695938
  0.0510988  0.04849201]]
2024-10-22 17:00:20,716 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33739462 0.         0.
  0.         0.         0.         0.         0.         0.
  0.32593286 0.         0.         0.         0.         0.33667248
  0.         0.        ]]
2024-10-22 17:00:20,717 - DEBUG - Added Child Node: ((Discard 4), (Discard 3)) | P=0.3373946249485016
2024-10-22 17:00:20,718 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3)) | P=0.33667248487472534
2024-10-22 17:00:20,718 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color G)) | P=0.3259328603744507
2024-10-22 17:00:20,718 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:00:20,719 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:20,719 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || XX|RYGW2345
W2 || XX|RYGW2345
R4 || XX|RYGWB2345
G3 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 Y5}
2024-10-22 17:00:20,719 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:20,719 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:20,719 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:20,719 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:00:20,719 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:00:20,720 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:20,944 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:20,944 - DEBUG - Network Policy Logits: [[-0.02245692 -0.01079833  0.03053796 -0.02963592  0.04529168  0.04976095
  -0.00060291  0.03756583  0.01428602  0.08952363 -0.04250882 -0.05575875
  -0.05625862  0.02921634  0.04508604  0.02355201  0.00079178 -0.03182461
   0.03438076 -0.00245676]]
2024-10-22 17:00:20,945 - DEBUG - Network Policy after Softmax: [[0.04849452 0.04906321 0.0511338  0.04814762 0.0518938  0.05212625
  0.04956599 0.05149443 0.05030949 0.05424069 0.04753179 0.04690616
  0.04688272 0.05106626 0.05188313 0.05077783 0.04963516 0.04804236
  0.05133067 0.04947418]]
2024-10-22 17:00:20,946 - DEBUG - Normalized Policy: [[0.         0.         0.         0.3301737  0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.34037453 0.32945183
  0.         0.        ]]
2024-10-22 17:00:20,947 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3)) | P=0.33017370104789734
2024-10-22 17:00:20,948 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 2)) | P=0.34037452936172485
2024-10-22 17:00:20,948 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 3)) | P=0.3294518291950226
2024-10-22 17:00:20,948 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:00:20,949 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:20,949 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || XX|RYGWB245
XX || XX|RYGWB245
XX || XX|RYGWB245
XX || XX|RYGWB1245
XX || X3|RYGWB3
-----
B2 || B2|B2
R2 || XX|RYGW2345
Y3 || XX|RYGW2345
W4 || XX|RYGWB2345
W1 || XX|RYGWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:20,949 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:20,949 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:20,949 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:20,950 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.7856330871582031 | PUCT: 0.7856330871582031
2024-10-22 17:00:20,950 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3950219750404358 | PUCT: 0.3950219750404358
2024-10-22 17:00:20,951 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.405140221118927 | PUCT: 0.405140221118927
2024-10-22 17:00:20,951 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.7856330871582031
2024-10-22 17:00:20,952 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:00:20,952 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Reveal player +1 rank 3))
2024-10-22 17:00:20,952 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 rank 3))']
2024-10-22 17:00:20,952 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:20,952 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:20,953 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:20,953 - DEBUG - Rollout #5 completed with reward=4
2024-10-22 17:00:20,953 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:20,953 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 2.0 | U: 0.5526258945465088 | PUCT: 2.552625894546509
2024-10-22 17:00:20,954 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4167964458465576 | PUCT: 0.4167964458465576
2024-10-22 17:00:20,954 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.42747244238853455 | PUCT: 0.42747244238853455
2024-10-22 17:00:20,954 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 2.552625894546509
2024-10-22 17:00:20,954 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:00:20,954 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Discard 0))
2024-10-22 17:00:20,955 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Discard 0))']
2024-10-22 17:00:20,955 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:20,956 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:00:21,153 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:21,154 - DEBUG - Network Policy Logits: [[-0.01197982  0.01576924 -0.01226677 -0.07504781  0.00586897  0.04616487
   0.01410612  0.02051573  0.00283589  0.0726998  -0.04129658 -0.01475647
  -0.07310865 -0.0053167   0.07793924  0.05308522 -0.02903874 -0.0329502
   0.02198391 -0.02910987]]
2024-10-22 17:00:21,154 - DEBUG - Network Policy after Softmax: [[0.04934788 0.05073642 0.04933373 0.04633172 0.05023659 0.05230226
  0.05065211 0.05097781 0.05008445 0.05370867 0.04792216 0.04921105
  0.04642165 0.04967779 0.05399081 0.05266546 0.0485132  0.04832381
  0.05105271 0.04850975]]
2024-10-22 17:00:21,155 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.25431705 0.
  0.         0.         0.         0.         0.24260053 0.
  0.         0.         0.         0.         0.         0.24463384
  0.25844857 0.        ]]
2024-10-22 17:00:21,156 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 0), (Reveal player +1 color R)) | P=0.24260053038597107
2024-10-22 17:00:21,157 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 0), (Discard 4)) | P=0.254317045211792
2024-10-22 17:00:21,157 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 0), (Reveal player +1 rank 3)) | P=0.24463383853435516
2024-10-22 17:00:21,158 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 0), (Reveal player +1 rank 4)) | P=0.2584485709667206
2024-10-22 17:00:21,158 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Discard 0)) | Value: 0.0
2024-10-22 17:00:21,158 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:21,158 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'R', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYGW2345
XX || XX|RYGW2345
XX || XX|RYGWB2345
XX || XX|RYGWB12345
-----
B4 || XX|RYGWB345
Y4 || XX|RYGWB345
R2 || X2|RYGWB2
Y3 || XX|RYGWB1345
R3 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 W2}
2024-10-22 17:00:21,158 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:21,158 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:21,158 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:21,159 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 1.3333333333333333 | U: 0.43193069100379944 | PUCT: 1.7652640342712402
2024-10-22 17:00:21,159 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4343557059764862 | PUCT: 0.4343557059764862
2024-10-22 17:00:21,160 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.44548147916793823 | PUCT: 0.44548147916793823
2024-10-22 17:00:21,160 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 1.7652640342712402
2024-10-22 17:00:21,161 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:00:21,161 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 3)) | Q: 4.0 | U: 0.7336779236793518 | PUCT: 4.733677864074707
2024-10-22 17:00:21,161 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Discard 0)) | Q: 0.0 | U: 0.738084614276886 | PUCT: 0.738084614276886
2024-10-22 17:00:21,162 - DEBUG - Selected Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 3)) | PUCT: 4.733677864074707
2024-10-22 17:00:21,162 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2), (Reveal player +1 rank 3))
2024-10-22 17:00:21,162 - DEBUG - Node ((Reveal player +1 rank 2), (Reveal player +1 rank 3)) is a leaf node.
2024-10-22 17:00:21,162 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 rank 3))']
2024-10-22 17:00:21,163 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:21,163 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:21,356 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:21,356 - DEBUG - Network Policy Logits: [[ 0.00288906 -0.023651    0.00794143 -0.02500794  0.02803854  0.02428571
   0.03568336 -0.01641027  0.04018277  0.0198878  -0.03708271  0.03241631
  -0.06047838 -0.00885139  0.0417309   0.02680255 -0.02171835 -0.00587283
   0.01448387 -0.02682531]]
2024-10-22 17:00:21,356 - DEBUG - Network Policy after Softmax: [[0.05000326 0.04869362 0.05025653 0.04862759 0.05127676 0.05108469
  0.05167026 0.04904748 0.05190327 0.05086051 0.04804396 0.05150173
  0.04693298 0.04941963 0.05198369 0.05121342 0.04878782 0.04956705
  0.05058641 0.0485393 ]]
2024-10-22 17:00:21,358 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.20809768 0.
  0.         0.         0.         0.         0.19497792 0.
  0.19046925 0.         0.         0.         0.         0.20115913
  0.20529602 0.        ]]
2024-10-22 17:00:21,358 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 color G)) | P=0.19046925008296967
2024-10-22 17:00:21,359 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 rank 4)) | P=0.20529602468013763
2024-10-22 17:00:21,360 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Discard 4)) | P=0.2080976814031601
2024-10-22 17:00:21,361 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 rank 3)) | P=0.20115913450717926
2024-10-22 17:00:21,361 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 color R)) | P=0.19497792422771454
2024-10-22 17:00:21,361 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:00:21,361 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:21,362 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYGW245
XX || X3|RYGW3
XX || XX|RYGWB245
XX || XX|RYGWB1245
-----
G2 || X2|RYGWB2
B4 || XX|RYGWB345
Y4 || XX|RYGWB345
R2 || X2|RYGWB2
Y3 || XX|RYGWB1345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:21,362 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:21,362 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:21,362 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:21,363 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 1.0 | U: 0.35720375180244446 | PUCT: 1.357203722000122
2024-10-22 17:00:21,364 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.44901153445243835 | PUCT: 0.44901153445243835
2024-10-22 17:00:21,364 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4605126976966858 | PUCT: 0.4605126976966858
2024-10-22 17:00:21,364 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 1.357203722000122
2024-10-22 17:00:21,364 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:00:21,365 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 3)) | Q: 2.0 | U: 0.527015745639801 | PUCT: 2.5270156860351562
2024-10-22 17:00:21,365 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Discard 0)) | Q: 0.0 | U: 0.7952716946601868 | PUCT: 0.7952716946601868
2024-10-22 17:00:21,365 - DEBUG - Selected Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 3)) | PUCT: 2.5270156860351562
2024-10-22 17:00:21,365 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2), (Reveal player +1 rank 3))
2024-10-22 17:00:21,365 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 rank 4))
2024-10-22 17:00:21,365 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 rank 3))', '((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 rank 4))']
2024-10-22 17:00:21,366 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:21,367 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:21,367 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 3
2024-10-22 17:00:21,568 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:21,569 - DEBUG - Network Policy Logits: [[-0.00484923  0.02334759  0.02889371 -0.06956204  0.03383607  0.0048285
   0.00267019 -0.00063018  0.01190566  0.04735612 -0.03046782 -0.00435555
  -0.04840512  0.05578092 -0.0304501   0.03371932 -0.02125553 -0.01424709
   0.05403908 -0.02088771]]
2024-10-22 17:00:21,569 - DEBUG - Network Policy after Softmax: [[0.04960333 0.0510219  0.05130565 0.04649502 0.05155985 0.05008571
  0.04997773 0.04981305 0.05044143 0.05226168 0.04834871 0.04962782
  0.04748919 0.05270383 0.04834956 0.05155383 0.04879617 0.04913935
  0.05261211 0.04881411]]
2024-10-22 17:00:21,570 - DEBUG - Normalized Policy: [[0.32924736 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.34982726 0.32092535 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:21,571 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 rank 4), (Reveal player +1 color W)) | P=0.34982725977897644
2024-10-22 17:00:21,572 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 rank 4), (Discard 0)) | P=0.3292473554611206
2024-10-22 17:00:21,572 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 rank 4), (Reveal player +1 color B)) | P=0.32092535495758057
2024-10-22 17:00:21,572 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:00:21,572 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:21,573 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || X4|RYGWB4
XX || X4|RYGWB4
XX || X2|RYGWB2
XX || XX|RYGWB135
-----
B2 || B2|B2
W2 || XX|RYGW245
W3 || X3|RYGW3
B3 || X3|RYGWB3
B4 || XX|RYGWB1245
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:21,573 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:21,573 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:21,573 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:21,574 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.8 | U: 0.30598393082618713 | PUCT: 1.1059839725494385
2024-10-22 17:00:21,574 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.46155279874801636 | PUCT: 0.46155279874801636
2024-10-22 17:00:21,574 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.47337520122528076 | PUCT: 0.47337520122528076
2024-10-22 17:00:21,575 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 1.1059839725494385
2024-10-22 17:00:21,575 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:00:21,575 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 3)) | Q: 1.3333333333333333 | U: 0.41704946756362915 | PUCT: 1.750382900238037
2024-10-22 17:00:21,576 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Discard 0)) | Q: 0.0 | U: 0.8391087651252747 | PUCT: 0.8391087651252747
2024-10-22 17:00:21,576 - DEBUG - Selected Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 3)) | PUCT: 1.750382900238037
2024-10-22 17:00:21,576 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2), (Reveal player +1 rank 3))
2024-10-22 17:00:21,576 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 color R))
2024-10-22 17:00:21,576 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 rank 3))', '((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 color R))']
2024-10-22 17:00:21,577 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:21,577 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:21,578 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 3
2024-10-22 17:00:21,773 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:21,773 - DEBUG - Network Policy Logits: [[-0.02116485  0.03715212 -0.00231245 -0.00375551 -0.02253136  0.0123827
   0.06332009  0.01548227  0.04055769  0.05213917  0.00116651 -0.0219928
  -0.06739734  0.0207857   0.06722137  0.00944617 -0.00888223 -0.00819398
   0.0294846  -0.02441695]]
2024-10-22 17:00:21,773 - DEBUG - Network Policy after Softmax: [[0.04851628 0.05142973 0.04943961 0.04936832 0.04845003 0.05017149
  0.05279331 0.05032725 0.05160518 0.05220632 0.04961191 0.04847613
  0.04632432 0.05059486 0.05299967 0.05002438 0.04911587 0.04914968
  0.0510369  0.04835876]]
2024-10-22 17:00:21,775 - DEBUG - Normalized Policy: [[0.25064158 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.2563017  0.
  0.23931758 0.         0.         0.         0.2537391  0.
  0.         0.        ]]
2024-10-22 17:00:21,775 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 color R), (Reveal player +1 color R)) | P=0.2563017010688782
2024-10-22 17:00:21,776 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 color R), (Discard 0)) | P=0.2506415843963623
2024-10-22 17:00:21,777 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 color R), (Reveal player +1 rank 2)) | P=0.2537390887737274
2024-10-22 17:00:21,777 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 color R), (Reveal player +1 color G)) | P=0.23931758105754852
2024-10-22 17:00:21,777 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:00:21,777 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:21,778 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|YGWB2
XX || XX|YGWB345
XX || XX|YGWB345
XX || R2|R2
XX || XX|YGWB1345
-----
B2 || B2|B2
R3 || X3|RYGW3
W2 || XX|RYGW245
G4 || XX|RYGWB245
G3 || X3|RYGWB3
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:21,778 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:21,778 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:21,778 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:21,778 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.6666666666666666 | U: 0.26848649978637695 | PUCT: 0.9351531863212585
2024-10-22 17:00:21,779 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.47248929738998413 | PUCT: 0.47248929738998413
2024-10-22 17:00:21,779 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.48459184169769287 | PUCT: 0.48459184169769287
2024-10-22 17:00:21,779 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.9351531863212585
2024-10-22 17:00:21,779 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:00:21,780 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 3)) | Q: 1.0 | U: 0.347695529460907 | PUCT: 1.3476955890655518
2024-10-22 17:00:21,780 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Discard 0)) | Q: 0.0 | U: 0.8744597434997559 | PUCT: 0.8744597434997559
2024-10-22 17:00:21,780 - DEBUG - Selected Child: ((Reveal player +1 rank 2), (Reveal player +1 rank 3)) | PUCT: 1.3476955890655518
2024-10-22 17:00:21,780 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2), (Reveal player +1 rank 3))
2024-10-22 17:00:21,780 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 rank 3))
2024-10-22 17:00:21,781 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 rank 3))', '((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 rank 3))']
2024-10-22 17:00:21,781 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:00:21,782 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:21,782 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 3
2024-10-22 17:00:21,967 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:21,967 - DEBUG - Network Policy Logits: [[-0.02018695 -0.00440326  0.0343299  -0.04606935  0.02902053  0.04133286
   0.01010404 -0.00713335  0.02822621  0.06287462 -0.03051036 -0.03732164
  -0.05816047  0.04431117 -0.02275328  0.03129662 -0.00609866  0.01036486
   0.03801208 -0.02434321]]
2024-10-22 17:00:21,968 - DEBUG - Network Policy after Softmax: [[0.04879537 0.04957166 0.05152939 0.04754864 0.05125653 0.05189152
  0.05029605 0.04943651 0.05121583 0.05302148 0.04829423 0.04796641
  0.04697718 0.0520463  0.04867031 0.05137333 0.04948768 0.05030917
  0.05171948 0.04859299]]
2024-10-22 17:00:21,969 - DEBUG - Normalized Policy: [[0.5094923  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.49050778 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:21,970 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 rank 3), (Discard 0)) | P=0.5094922780990601
2024-10-22 17:00:21,970 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 rank 3), (Reveal player +1 color G)) | P=0.4905077815055847
2024-10-22 17:00:21,970 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Reveal player +1 rank 3), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:00:21,970 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:21,971 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': 2}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || XX|RYGWB45
XX || XX|RYGWB45
XX || X2|RYGWB2
XX || X3|RYGWB3
-----
B2 || B2|B2
Y5 || XX|RYGW245
G3 || X3|RYGW3
G4 || XX|RYGWB245
W4 || XX|RYGWB1245
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:21,971 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:21,971 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:21,971 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:21,971 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 2),) | Visit Count: 7
2024-10-22 17:00:21,971 - INFO - Actual Game Score: 4
2024-10-22 17:00:21,971 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:21,971 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:21,971 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.11111111 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.77777778 0.11111111
 0.         0.        ]
2024-10-22 17:00:21,971 - DEBUG - === End of Training Data ===
2024-10-22 17:00:21,971 - INFO - Chosen Action: (Reveal player +1 rank 2) | Visit Count: 7
2024-10-22 17:00:21,972 - DEBUG - Not the current player's turn.
2024-10-22 17:00:23,395 - INFO - Agent state has been reset.
2024-10-22 17:00:23,395 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:23,395 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW2345
XX || GX|G2345
XX || GX|G2345
XX || XX|RYWB12345
-----
G2 || X2|RYGWB2
B4 || XX|RYGWB345
Y4 || XX|RYGWB345
R2 || X2|RYGWB2
Y3 || XX|RYGWB1345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:23,395 - INFO - Max Rollouts: 10
2024-10-22 17:00:23,395 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:23,395 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:23,395 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:23,596 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:23,596 - DEBUG - Network Policy Logits: [[ 0.02788603 -0.01577442  0.00725975 -0.0152298  -0.01495198  0.02359243
   0.05932768 -0.01506971  0.00969792 -0.01977535 -0.02987635 -0.01017627
  -0.01633155 -0.02253901  0.04208206  0.025821   -0.02493097  0.01200501
   0.0169965  -0.03895655]]
2024-10-22 17:00:23,596 - DEBUG - Network Policy after Softmax: [[0.05139428 0.04919866 0.05034506 0.04922546 0.04923914 0.05117409
  0.05303587 0.04923334 0.05046796 0.04900222 0.04850974 0.04947486
  0.04917126 0.04886698 0.05212908 0.05128826 0.04875023 0.05058453
  0.05083765 0.04807125]]
2024-10-22 17:00:23,598 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.19827124 0.
  0.         0.         0.         0.         0.19533415 0.
  0.1979979  0.         0.         0.         0.         0.20368873
  0.20470797 0.        ]]
2024-10-22 17:00:23,599 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.15948445 0.
 0.         0.         0.         0.         0.19618705 0.
 0.14849842 0.         0.         0.         0.         0.15276654
 0.34306353 0.        ]
2024-10-22 17:00:23,600 - DEBUG - Added Child Node: ((Reveal player +1 color G),) | P=0.14849841594696045
2024-10-22 17:00:23,601 - DEBUG - Added Child Node: ((Reveal player +1 rank 4),) | P=0.3430635333061218
2024-10-22 17:00:23,602 - DEBUG - Added Child Node: ((Discard 4),) | P=0.15948444604873657
2024-10-22 17:00:23,602 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.15276654064655304
2024-10-22 17:00:23,603 - DEBUG - Added Child Node: ((Reveal player +1 color R),) | P=0.19618704915046692
2024-10-22 17:00:23,603 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:23,603 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:23,603 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW2345
XX || GX|G2345
XX || GX|G2345
XX || XX|RYWB12345
-----
G2 || X2|RYGWB2
B4 || XX|RYGWB345
Y4 || XX|RYGWB345
R2 || X2|RYGWB2
Y3 || XX|RYGWB1345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:23,603 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:23,603 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:23,603 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:23,604 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:00:23,604 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:00:23,605 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:23,815 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:23,816 - DEBUG - Network Policy Logits: [[-0.01293569  0.00357653  0.03492281 -0.06011204  0.03481587  0.03404131
   0.01735757  0.01817409  0.0009445   0.05599767 -0.01544701 -0.0241104
  -0.0317031   0.0300661   0.00109898  0.05483139  0.00885578 -0.0023542
   0.04275275 -0.03289056]]
2024-10-22 17:00:23,816 - DEBUG - Network Policy after Softmax: [[0.04894654 0.04976147 0.05134601 0.04669105 0.05134052 0.05130077
  0.05045198 0.05049319 0.04963066 0.0524396  0.04882378 0.04840263
  0.04803651 0.05109724 0.04963833 0.05237848 0.05002487 0.04946722
  0.05174962 0.0479795 ]]
2024-10-22 17:00:23,818 - DEBUG - Normalized Policy: [[0.2470265  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.2496543
  0.26117328 0.24214597]]
2024-10-22 17:00:23,819 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 5)) | P=0.24214597046375275
2024-10-22 17:00:23,820 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 0)) | P=0.2470265030860901
2024-10-22 17:00:23,821 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 3)) | P=0.24965429306030273
2024-10-22 17:00:23,821 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 4)) | P=0.261173278093338
2024-10-22 17:00:23,821 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:00:23,821 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:23,822 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': 2}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || XX|RYGWB45
XX || XX|RYGWB45
XX || X2|RYGWB2
XX || X3|RYGWB3
-----
B2 || B2|B2
W4 || XX|RYW2345
G5 || GX|G2345
G4 || GX|G2345
Y3 || XX|RYWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:23,822 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:23,822 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:23,822 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:23,822 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G),)
2024-10-22 17:00:23,822 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)']
2024-10-22 17:00:23,823 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:24,043 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:24,044 - DEBUG - Network Policy Logits: [[ 0.01880052  0.00252395  0.01068895 -0.06135475  0.03372915  0.04436438
   0.01985983  0.00579665 -0.02012916  0.04557398 -0.00105517 -0.00852563
  -0.03497643  0.01597667  0.0174587   0.02795103  0.01627264 -0.02125699
   0.02660353 -0.04833941]]
2024-10-22 17:00:24,044 - DEBUG - Network Policy after Softmax: [[0.0506998  0.04988126 0.05029021 0.04679455 0.05146236 0.05201259
  0.05075354 0.05004478 0.048764   0.05207555 0.04970305 0.04933313
  0.04804533 0.05055683 0.05063182 0.05116586 0.0505718  0.04870903
  0.05109696 0.04740758]]
2024-10-22 17:00:24,045 - DEBUG - Normalized Policy: [[0.25687274 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.25614837 0.         0.         0.         0.2467864
  0.         0.24019253]]
2024-10-22 17:00:24,046 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color W)) | P=0.2561483681201935
2024-10-22 17:00:24,047 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 5)) | P=0.24019253253936768
2024-10-22 17:00:24,047 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 0)) | P=0.2568727433681488
2024-10-22 17:00:24,048 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 3)) | P=0.24678640067577362
2024-10-22 17:00:24,048 - DEBUG - Simulating Node: ((Reveal player +1 color G),) | Value: 0.0
2024-10-22 17:00:24,048 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:24,048 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || XX|RYWB345
XX || XX|RYWB345
XX || X2|RYWB2
XX || XX|RYWB1345
-----
B2 || B2|B2
W4 || XX|RYW2345
G5 || GX|G2345
G3 || GX|G2345
W4 || XX|RYWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:24,049 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:24,049 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:24,049 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:24,049 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:00:24,049 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:00:24,050 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:24,253 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:24,253 - DEBUG - Network Policy Logits: [[ 0.01244292  0.01737157 -0.00594792 -0.04800826  0.02085117  0.04458304
   0.03046396  0.01986459 -0.01057454  0.07532322 -0.03799994  0.00713592
  -0.03454414  0.02552411  0.02945536  0.02131741  0.01633884 -0.01945292
   0.03555713 -0.06335476]]
2024-10-22 17:00:24,253 - DEBUG - Network Policy after Softmax: [[0.05025456 0.05050285 0.04933878 0.04730661 0.05067889 0.05189598
  0.0511684  0.05062891 0.04911103 0.05351604 0.04778244 0.04998856
  0.04794786 0.05091626 0.05111682 0.05070252 0.05045072 0.04867693
  0.05142968 0.04658616]]
2024-10-22 17:00:24,255 - DEBUG - Normalized Policy: [[0.25083417 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.2495065
  0.         0.         0.         0.         0.         0.24295983
  0.25669953 0.        ]]
2024-10-22 17:00:24,256 - DEBUG - Added Child Node: ((Discard 4), (Discard 0)) | P=0.2508341670036316
2024-10-22 17:00:24,257 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color Y)) | P=0.24950650334358215
2024-10-22 17:00:24,257 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3)) | P=0.24295982718467712
2024-10-22 17:00:24,258 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4)) | P=0.2566995322704315
2024-10-22 17:00:24,258 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:00:24,258 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:24,258 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || XX|RYGWB345
XX || XX|RYGWB345
XX || X2|RYGWB2
XX || XX|RYGWB1345
-----
B2 || B2|B2
Y4 || XX|RYW2345
G4 || GX|G2345
G3 || GX|G2345
Y5 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 W3}
2024-10-22 17:00:24,258 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:24,258 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:24,258 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:24,259 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4),)
2024-10-22 17:00:24,259 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)']
2024-10-22 17:00:24,260 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:24,480 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:24,480 - DEBUG - Network Policy Logits: [[ 0.00234072  0.02214639  0.01095442 -0.06681412  0.03307145  0.01784695
   0.02305554 -0.0033787   0.01342718  0.05253517 -0.03173716  0.01084054
  -0.03631153  0.02676316  0.01377316  0.03180337 -0.0145331  -0.02508984
   0.04063326 -0.01360485]]
2024-10-22 17:00:24,481 - DEBUG - Network Policy after Softmax: [[0.04982762 0.05082433 0.05025868 0.04649825 0.05138263 0.05060628
  0.05087056 0.04954345 0.05038311 0.05239253 0.04815821 0.05025296
  0.04793842 0.05105951 0.05040054 0.05131752 0.0489939  0.0484794
  0.05177265 0.0490394 ]]
2024-10-22 17:00:24,483 - DEBUG - Normalized Policy: [[0.2511398  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.25734872 0.         0.         0.         0.2443445
  0.         0.24716699]]
2024-10-22 17:00:24,484 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color W)) | P=0.2573487162590027
2024-10-22 17:00:24,484 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 5)) | P=0.24716699123382568
2024-10-22 17:00:24,485 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0)) | P=0.2511397898197174
2024-10-22 17:00:24,486 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 3)) | P=0.24434450268745422
2024-10-22 17:00:24,486 - DEBUG - Simulating Node: ((Reveal player +1 rank 4),) | Value: 0.0
2024-10-22 17:00:24,486 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:24,486 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 2}, {'color': 'G', 'rank': 4}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || X4|RYGWB4
XX || X4|RYGWB4
XX || X2|RYGWB2
XX || XX|RYGWB135
-----
B2 || B2|B2
W3 || XX|RYW2345
G3 || GX|G2345
G5 || GX|G2345
W5 || XX|RYWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:24,486 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:24,486 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:24,486 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:24,486 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R),)
2024-10-22 17:00:24,486 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)']
2024-10-22 17:00:24,488 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:24,697 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:24,697 - DEBUG - Network Policy Logits: [[-0.01620324  0.01714314 -0.008638   -0.0347286   0.01585102  0.02463098
   0.03096075  0.00904945  0.00310365  0.0462771  -0.01471481 -0.00886133
  -0.03115833  0.04372719  0.03962453  0.00945967  0.00463759 -0.02028355
   0.06496331 -0.04219517]]
2024-10-22 17:00:24,698 - DEBUG - Network Policy after Softmax: [[0.04885124 0.05050772 0.04922222 0.04795459 0.0504425  0.05088734
  0.05121046 0.05010058 0.04980357 0.05200085 0.04892401 0.04921122
  0.04812611 0.05186842 0.05165606 0.05012113 0.04988002 0.04865232
  0.05298169 0.04759786]]
2024-10-22 17:00:24,699 - DEBUG - Normalized Policy: [[0.24381094 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.24894546 0.24281813
  0.26442552 0.        ]]
2024-10-22 17:00:24,701 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0)) | P=0.24381093680858612
2024-10-22 17:00:24,701 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 2)) | P=0.2489454597234726
2024-10-22 17:00:24,703 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 3)) | P=0.24281813204288483
2024-10-22 17:00:24,703 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 4)) | P=0.26442551612854004
2024-10-22 17:00:24,703 - DEBUG - Simulating Node: ((Reveal player +1 color R),) | Value: 0.0
2024-10-22 17:00:24,704 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:24,704 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|YGWB2
XX || XX|YGWB345
XX || XX|YGWB345
XX || R2|R2
XX || XX|YGWB1345
-----
B2 || B2|B2
R2 || XX|RYW2345
G3 || GX|G2345
G4 || GX|G2345
W4 || XX|RYWB12345
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:24,704 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:24,704 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:24,704 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:24,705 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.266378790140152 | PUCT: 0.266378790140152
2024-10-22 17:00:24,705 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.25893646478652954 | PUCT: 0.25893646478652954
2024-10-22 17:00:24,706 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.27809280157089233 | PUCT: 0.27809280157089233
2024-10-22 17:00:24,706 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.5981994271278381 | PUCT: 0.5981994271278381
2024-10-22 17:00:24,707 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.34209105372428894 | PUCT: 0.34209105372428894
2024-10-22 17:00:24,707 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.5981994271278381
2024-10-22 17:00:24,707 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:00:24,707 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Reveal player +1 rank 3))
2024-10-22 17:00:24,707 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 rank 3))']
2024-10-22 17:00:24,708 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:24,708 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:24,916 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:24,917 - DEBUG - Network Policy Logits: [[ 0.02278882 -0.01409048 -0.0024448  -0.01914324 -0.00548932  0.02845484
   0.05445478 -0.00756993  0.03982831 -0.0122509   0.02152754 -0.00494031
  -0.02721303 -0.04175736  0.00361891  0.00814639  0.00222744  0.00065998
   0.0158379  -0.05939118]]
2024-10-22 17:00:24,917 - DEBUG - Network Policy after Softmax: [[0.05112693 0.04927575 0.04985296 0.0490274  0.04970141 0.05141744
  0.05277182 0.04959811 0.05200557 0.04936648 0.05106249 0.0497287
  0.04863335 0.04793113 0.05015617 0.05038377 0.05008643 0.05000798
  0.05077278 0.04709333]]
2024-10-22 17:00:24,919 - DEBUG - Normalized Policy: [[0.         0.16568843 0.         0.         0.         0.
  0.         0.16677237 0.         0.         0.         0.16721147
  0.16352838 0.         0.16864882 0.         0.         0.16815053
  0.         0.        ]]
2024-10-22 17:00:24,920 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 3), (Reveal player +1 color G)) | P=0.16352838277816772
2024-10-22 17:00:24,920 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 3), (Reveal player +1 color B)) | P=0.168648824095726
2024-10-22 17:00:24,921 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 3), (Reveal player +1 rank 3)) | P=0.16815052926540375
2024-10-22 17:00:24,922 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 3), (Play 2)) | P=0.16677236557006836
2024-10-22 17:00:24,923 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 3), (Reveal player +1 color Y)) | P=0.16721147298812866
2024-10-22 17:00:24,924 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 3), (Discard 1)) | P=0.1656884253025055
2024-10-22 17:00:24,924 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:00:24,924 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:24,924 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 2}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW245
XX || G3|G3
XX || GX|G245
XX || XX|RYWB1245
-----
G2 || X2|RYGWB2
B4 || X4|RYGWB4
Y4 || X4|RYGWB4
R2 || X2|RYGWB2
Y3 || XX|RYGWB135
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:24,924 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:24,924 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:24,924 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:24,925 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.27536681294441223 | PUCT: 0.27536681294441223
2024-10-22 17:00:24,925 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.2676733732223511 | PUCT: 0.2676733732223511
2024-10-22 17:00:24,926 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.2874760627746582 | PUCT: 0.2874760627746582
2024-10-22 17:00:24,926 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.4122556746006012 | PUCT: 0.4122556746006012
2024-10-22 17:00:24,927 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.35363373160362244 | PUCT: 0.35363373160362244
2024-10-22 17:00:24,927 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.4122556746006012
2024-10-22 17:00:24,927 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:00:24,927 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Reveal player +1 color W))
2024-10-22 17:00:24,927 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 color W))']
2024-10-22 17:00:24,928 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:24,928 - DEBUG - Illegal move encountered: (Reveal player +1 color W)
2024-10-22 17:00:24,928 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:24,928 - DEBUG - Rollout #8 completed with reward=4
2024-10-22 17:00:24,928 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:24,929 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.2830580472946167 | PUCT: 0.2830580472946167
2024-10-22 17:00:24,929 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.27514973282814026 | PUCT: 0.27514973282814026
2024-10-22 17:00:24,930 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.2955055236816406 | PUCT: 0.2955055236816406
2024-10-22 17:00:24,930 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 1.3333333333333333 | U: 0.3178277611732483 | PUCT: 1.6511611938476562
2024-10-22 17:00:24,931 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.36351102590560913 | PUCT: 0.36351102590560913
2024-10-22 17:00:24,931 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 1.6511611938476562
2024-10-22 17:00:24,931 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:00:24,931 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Discard 0))
2024-10-22 17:00:24,931 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Discard 0))']
2024-10-22 17:00:24,932 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:24,933 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:00:25,190 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:25,197 - DEBUG - Network Policy Logits: [[ 0.02148879  0.00966744 -0.02573956 -0.06744637 -0.02164275  0.03054862
   0.02253983  0.02983543 -0.01997998  0.01968704 -0.00037447 -0.0536695
  -0.01573844 -0.02314534  0.05043697  0.01328362 -0.00074544 -0.01532259
   0.03340944 -0.0431547 ]]
2024-10-22 17:00:25,197 - DEBUG - Network Policy after Softmax: [[0.05120548 0.05060373 0.04884335 0.04684815 0.04904386 0.0516715
  0.05125933 0.05163467 0.04912548 0.05111331 0.05009812 0.04749803
  0.04933429 0.04897023 0.05270945 0.05078705 0.05007954 0.04935481
  0.05181954 0.0480001 ]]
2024-10-22 17:00:25,199 - DEBUG - Normalized Policy: [[0.         0.         0.24617924 0.         0.         0.
  0.         0.         0.         0.         0.         0.2393986
  0.         0.         0.26566508 0.         0.         0.2487571
  0.         0.        ]]
2024-10-22 17:00:25,200 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Discard 2)) | P=0.2461792379617691
2024-10-22 17:00:25,201 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 color Y)) | P=0.23939859867095947
2024-10-22 17:00:25,202 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 color B)) | P=0.26566508412361145
2024-10-22 17:00:25,202 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 rank 3)) | P=0.24875709414482117
2024-10-22 17:00:25,203 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Discard 0)) | Value: 0.0
2024-10-22 17:00:25,203 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:25,203 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW2345
XX || GX|G2345
XX || GX|G2345
XX || XX|RYWB12345
-----
B4 || X4|RYGWB4
Y4 || X4|RYGWB4
R2 || X2|RYGWB2
Y3 || XX|RYGWB135
G5 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 Y2}
2024-10-22 17:00:25,203 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:25,203 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:25,203 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:25,204 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.2897650897502899 | PUCT: 0.2897650897502899
2024-10-22 17:00:25,205 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.28166940808296204 | PUCT: 0.28166940808296204
2024-10-22 17:00:25,205 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.30250751972198486 | PUCT: 0.30250751972198486
2024-10-22 17:00:25,206 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 1.0 | U: 0.26028695702552795 | PUCT: 1.2602869272232056
2024-10-22 17:00:25,206 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.37212440371513367 | PUCT: 0.37212440371513367
2024-10-22 17:00:25,207 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 1.2602869272232056
2024-10-22 17:00:25,207 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:00:25,207 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Reveal player +1 rank 5))
2024-10-22 17:00:25,207 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 rank 5))']
2024-10-22 17:00:25,208 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:25,208 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 2
2024-10-22 17:00:25,435 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:25,435 - DEBUG - Network Policy Logits: [[ 0.01682839 -0.01696093  0.01031188 -0.02475403  0.00089109  0.0142066
   0.05312007 -0.00557687  0.03696161 -0.01558126  0.01715934 -0.02071613
  -0.01799704 -0.04241983  0.00982452  0.02338605 -0.01777539  0.0040165
   0.01748277 -0.05274224]]
2024-10-22 17:00:25,436 - DEBUG - Network Policy after Softmax: [[0.05085848 0.04916871 0.05052814 0.04878702 0.05005436 0.05072531
  0.05273812 0.04973165 0.0518928  0.0492366  0.05087531 0.04898442
  0.0491178  0.04793273 0.05050351 0.05119309 0.04912868 0.05021104
  0.05089177 0.0474405 ]]
2024-10-22 17:00:25,437 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.2011256  0.
  0.         0.         0.         0.         0.         0.19682646
  0.19736236 0.         0.20293039 0.         0.         0.20175518
  0.         0.        ]]
2024-10-22 17:00:25,438 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 5), (Reveal player +1 color G)) | P=0.19736236333847046
2024-10-22 17:00:25,439 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 5), (Discard 4)) | P=0.2011256068944931
2024-10-22 17:00:25,440 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 5), (Reveal player +1 color B)) | P=0.20293039083480835
2024-10-22 17:00:25,441 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 5), (Reveal player +1 rank 3)) | P=0.20175518095493317
2024-10-22 17:00:25,441 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 5), (Reveal player +1 color Y)) | P=0.19682645797729492
2024-10-22 17:00:25,441 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 5)) | Value: 0.0
2024-10-22 17:00:25,442 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:25,442 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': 4}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': 4}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || X5|RYW5
XX || GX|G234
XX || G5|G5
XX || XX|RYWB1234
-----
G2 || X2|RYGWB2
B4 || X4|RYGWB4
Y4 || X4|RYGWB4
R2 || X2|RYGWB2
Y3 || XX|RYGWB135
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:25,442 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:25,442 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:25,442 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:25,442 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 4),) | Visit Count: 5
2024-10-22 17:00:25,442 - INFO - Actual Game Score: 4
2024-10-22 17:00:25,442 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:25,442 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:25,443 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.11111111 0.
 0.         0.         0.         0.         0.11111111 0.
 0.11111111 0.         0.         0.         0.         0.11111111
 0.55555556 0.        ]
2024-10-22 17:00:25,443 - DEBUG - === End of Training Data ===
2024-10-22 17:00:25,443 - INFO - Chosen Action: (Reveal player +1 rank 4) | Visit Count: 5
2024-10-22 17:00:25,445 - DEBUG - Not the current player's turn.
2024-10-22 17:00:27,544 - INFO - Agent state has been reset.
2024-10-22 17:00:27,544 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:27,544 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
-----
G2 || X2|RYGWB2
B4 || X4|RYGWB4
Y4 || X4|RYGWB4
R2 || X2|RYGWB2
Y3 || XX|RYGWB135
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:27,544 - INFO - Max Rollouts: 10
2024-10-22 17:00:27,544 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:27,545 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:27,545 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:27,835 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:27,836 - DEBUG - Network Policy Logits: [[ 0.04084413 -0.01930609  0.02521508 -0.03097922  0.00903176  0.03574628
   0.05190157 -0.01626685  0.03340423 -0.03682616  0.01452475 -0.02875887
  -0.02055588 -0.05209207  0.02675906  0.01903114  0.00745844  0.00264774
   0.00628767 -0.04630813]]
2024-10-22 17:00:27,836 - DEBUG - Network Policy after Softmax: [[0.05200461 0.04896874 0.05119815 0.04840045 0.05037626 0.05174018
  0.05258284 0.0491178  0.05161914 0.04811828 0.05065374 0.04850803
  0.04890758 0.04738929 0.05127726 0.05088252 0.05029706 0.05005568
  0.05023821 0.04766418]]
2024-10-22 17:00:27,838 - DEBUG - Normalized Policy: [[0.         0.19767995 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.19582012
  0.19743304 0.         0.20699911 0.         0.         0.20206776
  0.         0.        ]]
2024-10-22 17:00:27,838 - DEBUG - Dirichlet Noise Added: [0.         0.14825997 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.1470253
 0.14807478 0.         0.4050891  0.         0.         0.15155083
 0.         0.        ]
2024-10-22 17:00:27,839 - DEBUG - Added Child Node: ((Reveal player +1 color G),) | P=0.14807477593421936
2024-10-22 17:00:27,840 - DEBUG - Added Child Node: ((Reveal player +1 color B),) | P=0.4050891101360321
2024-10-22 17:00:27,841 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.15155082941055298
2024-10-22 17:00:27,841 - DEBUG - Added Child Node: ((Reveal player +1 color Y),) | P=0.14702530205249786
2024-10-22 17:00:27,842 - DEBUG - Added Child Node: ((Discard 1),) | P=0.1482599675655365
2024-10-22 17:00:27,842 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:27,842 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:27,842 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
-----
G2 || X2|RYGWB2
B4 || X4|RYGWB4
Y4 || X4|RYGWB4
R2 || X2|RYGWB2
Y3 || XX|RYGWB135
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:27,842 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:27,843 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:27,843 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:27,843 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:00:27,843 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:00:27,844 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:28,108 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:28,109 - DEBUG - Network Policy Logits: [[-0.01672053  0.02009535  0.04497202 -0.03407446  0.02295524  0.00716422
   0.00894223  0.01726883  0.03672834  0.0242214   0.00071144 -0.00348052
  -0.02989904 -0.00069871  0.00294787  0.02775759  0.00792966 -0.03472954
   0.01577572 -0.0096809 ]]
2024-10-22 17:00:28,109 - DEBUG - Network Policy after Softmax: [[0.04889411 0.05072774 0.0520055  0.04805293 0.05087302 0.05007599
  0.05016511 0.05058455 0.05157855 0.05093747 0.0497539  0.04954577
  0.04825399 0.04968379 0.0498653  0.05111792 0.05011434 0.04802145
  0.05050908 0.04923952]]
2024-10-22 17:00:28,110 - DEBUG - Normalized Policy: [[0.49599463 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.5040054  0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:28,111 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color W)) | P=0.5040053725242615
2024-10-22 17:00:28,112 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 0)) | P=0.4959946274757385
2024-10-22 17:00:28,112 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:00:28,112 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:28,112 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'Y', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': 2}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || X4|RYGWB4
XX || X4|RYGWB4
XX || X2|RYGWB2
XX || X3|RYGWB3
-----
B2 || B2|B2
W3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
Y1 || XX|RYWB1235
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:28,112 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:28,112 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:28,112 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:28,113 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G),)
2024-10-22 17:00:28,113 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)']
2024-10-22 17:00:28,114 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:00:28,354 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:28,354 - DEBUG - Network Policy Logits: [[-0.00669237  0.02488027  0.03726541 -0.03895254  0.01540963  0.01926005
   0.00951732  0.03116642  0.02550688  0.01122089  0.02588534 -0.00288806
  -0.0359378  -0.02158189  0.01748778  0.01246381  0.00301032 -0.06384683
   0.00612857 -0.01248572]]
2024-10-22 17:00:28,355 - DEBUG - Network Policy after Softmax: [[0.04950961 0.0510977  0.05173449 0.04793791 0.05061606 0.05081132
  0.05031869 0.05141992 0.05112973 0.05040448 0.05114908 0.04969832
  0.04808265 0.0487779  0.05072135 0.05046717 0.04999233 0.04675927
  0.05014846 0.04922362]]
2024-10-22 17:00:28,356 - DEBUG - Normalized Policy: [[0.49757433 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.5024257  0.
  0.         0.        ]]
2024-10-22 17:00:28,357 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 0)) | P=0.4975743293762207
2024-10-22 17:00:28,358 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 2)) | P=0.5024256706237793
2024-10-22 17:00:28,358 - DEBUG - Simulating Node: ((Reveal player +1 color G),) | Value: 0.0
2024-10-22 17:00:28,358 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:28,358 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G2|G2
XX || X4|RYWB4
XX || X4|RYWB4
XX || X2|RYWB2
XX || XX|RYWB135
-----
B2 || B2|B2
R3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
W2 || XX|RYWB1235
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:28,358 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:28,358 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:28,358 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:28,359 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B),)
2024-10-22 17:00:28,359 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)']
2024-10-22 17:00:28,359 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:28,590 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:28,591 - DEBUG - Network Policy Logits: [[-0.00631378  0.01953137  0.00753968 -0.04863101  0.0024171   0.02058958
  -0.00033421  0.02311258  0.04445483  0.02595519 -0.00745894 -0.00497883
  -0.03190348 -0.02498247 -0.00098781  0.03443084  0.00360433 -0.05335584
   0.00583997 -0.02152357]]
2024-10-22 17:00:28,591 - DEBUG - Network Policy after Softmax: [[0.04970184 0.05100314 0.05039518 0.04764248 0.05013769 0.05105714
  0.04999993 0.05118612 0.05229029 0.05133183 0.04964496 0.04976824
  0.04844612 0.04878258 0.04996726 0.05176875 0.05019724 0.04741791
  0.05030959 0.04895161]]
2024-10-22 17:00:28,593 - DEBUG - Normalized Policy: [[0.50466704 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.49533296 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:28,593 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color W)) | P=0.4953329563140869
2024-10-22 17:00:28,594 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0)) | P=0.5046670436859131
2024-10-22 17:00:28,594 - DEBUG - Simulating Node: ((Reveal player +1 color B),) | Value: 0.0
2024-10-22 17:00:28,594 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:28,594 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGW2
XX || B4|B4
XX || X4|RYGW4
XX || X2|RYGW2
XX || XX|RYGW135
-----
B2 || B2|B2
W3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
W3 || XX|RYWB1235
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:28,595 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:28,595 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:28,595 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:28,595 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y),)
2024-10-22 17:00:28,595 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)']
2024-10-22 17:00:28,596 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:00:28,807 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:28,808 - DEBUG - Network Policy Logits: [[-0.0182697   0.01880676  0.04438443 -0.01294609  0.0197058   0.00433796
  -0.0137515   0.02503544  0.03253455  0.02272471 -0.00340501 -0.00631949
  -0.02408792  0.00060535  0.00627935  0.01715916  0.00953835 -0.04055572
   0.01318687 -0.01368308]]
2024-10-22 17:00:28,808 - DEBUG - Network Policy after Softmax: [[0.04888549 0.05073201 0.05204635 0.04914643 0.05077764 0.05000326
  0.04910686 0.05104899 0.05143325 0.05093116 0.04961758 0.04947318
  0.04860188 0.04981697 0.05010043 0.05064849 0.05026397 0.04780807
  0.0504477  0.04911022]]
2024-10-22 17:00:28,810 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33474588 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.33389452 0.33135962 0.
  0.         0.        ]]
2024-10-22 17:00:28,811 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 4)) | P=0.3347458839416504
2024-10-22 17:00:28,812 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 rank 1)) | P=0.3338945209980011
2024-10-22 17:00:28,813 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 rank 2)) | P=0.3313596248626709
2024-10-22 17:00:28,813 - DEBUG - Simulating Node: ((Reveal player +1 color Y),) | Value: 0.0
2024-10-22 17:00:28,813 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:28,813 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': 'Y', 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RGWB2
XX || X4|RGWB4
XX || Y4|Y4
XX || X2|RGWB2
XX || YX|Y135
-----
B2 || B2|B2
R2 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
W1 || XX|RYWB1235
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:28,813 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:28,813 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:28,813 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:28,813 - DEBUG - Expanding unexplored child: ((Discard 1),)
2024-10-22 17:00:28,813 - DEBUG - Traversing Path: ['()', '((Discard 1),)']
2024-10-22 17:00:28,814 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:29,030 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:29,031 - DEBUG - Network Policy Logits: [[-0.00621579  0.02103755  0.01526789 -0.03872367  0.01111191  0.02739086
   0.03908585  0.00788013  0.02001104  0.04430946 -0.01321411 -0.00081708
  -0.0604085   0.00966408  0.02526119  0.02537163 -0.03090886 -0.04039257
   0.03047615 -0.04515582]]
2024-10-22 17:00:29,031 - DEBUG - Network Policy after Softmax: [[0.04956652 0.05093595 0.05064291 0.04798112 0.05043288 0.05126059
  0.0518636  0.05027015 0.05088369 0.05213523 0.04922085 0.04983484
  0.04695186 0.05035991 0.05115154 0.05115719 0.04835756 0.04790112
  0.05141899 0.04767349]]
2024-10-22 17:00:29,033 - DEBUG - Normalized Policy: [[0.3432121  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.3251075  0.         0.         0.         0.         0.33168042
  0.         0.        ]]
2024-10-22 17:00:29,034 - DEBUG - Added Child Node: ((Discard 1), (Discard 0)) | P=0.3432120978832245
2024-10-22 17:00:29,034 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 3)) | P=0.33168041706085205
2024-10-22 17:00:29,035 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color G)) | P=0.32510751485824585
2024-10-22 17:00:29,035 - DEBUG - Simulating Node: ((Discard 1),) | Value: 0.0
2024-10-22 17:00:29,035 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:29,035 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': None, 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGWB2
XX || X4|RYGWB4
XX || X4|RYGWB4
XX || X2|RYGWB2
XX || XX|RYGWB135
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
Y5 || XX|RYWB1235
G3 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 W5}
2024-10-22 17:00:29,035 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:29,035 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:29,035 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:29,036 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.2642589509487152 | PUCT: 0.2642589509487152
2024-10-22 17:00:29,037 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.25819775462150574 | PUCT: 0.25819775462150574
2024-10-22 17:00:29,037 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 0.0 | U: 0.7063532471656799 | PUCT: 0.7063532471656799
2024-10-22 17:00:29,038 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.2563678026199341 | PUCT: 0.2563678026199341
2024-10-22 17:00:29,038 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.2585206925868988 | PUCT: 0.2585206925868988
2024-10-22 17:00:29,038 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 0.7063532471656799
2024-10-22 17:00:29,038 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:29,038 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 color W))
2024-10-22 17:00:29,038 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 color W))']
2024-10-22 17:00:29,039 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:29,039 - DEBUG - Illegal move encountered: (Reveal player +1 color W)
2024-10-22 17:00:29,039 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:29,039 - DEBUG - Rollout #7 completed with reward=4
2024-10-22 17:00:29,039 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:29,040 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.273175448179245 | PUCT: 0.273175448179245
2024-10-22 17:00:29,041 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.26690974831581116 | PUCT: 0.26690974831581116
2024-10-22 17:00:29,041 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 2.0 | U: 0.48679113388061523 | PUCT: 2.4867911338806152
2024-10-22 17:00:29,042 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.2650180459022522 | PUCT: 0.2650180459022522
2024-10-22 17:00:29,042 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.26724356412887573 | PUCT: 0.26724356412887573
2024-10-22 17:00:29,042 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 2.4867911338806152
2024-10-22 17:00:29,042 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:29,043 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Discard 0))
2024-10-22 17:00:29,043 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Discard 0))']
2024-10-22 17:00:29,043 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:29,044 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:00:29,247 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:29,247 - DEBUG - Network Policy Logits: [[-0.00144746  0.00317651  0.00097311 -0.05975669  0.01503936  0.02011092
   0.01176802  0.00919843 -0.01319719  0.00685309 -0.02479789 -0.05214085
  -0.02836509 -0.02618611  0.03295202  0.01527569 -0.02493213 -0.02060448
   0.02352431 -0.01358222]]
2024-10-22 17:00:29,248 - DEBUG - Network Policy after Softmax: [[0.05022882 0.05046161 0.05035055 0.04738377 0.05106379 0.05132343
  0.05089702 0.0507664  0.0496421  0.05064748 0.04906954 0.04774601
  0.04889482 0.04900147 0.05198672 0.05107586 0.04906295 0.04927574
  0.05149891 0.04962298]]
2024-10-22 17:00:29,249 - DEBUG - Normalized Policy: [[0.         0.34215122 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.32373825
  0.         0.         0.         0.         0.         0.3341105
  0.         0.        ]]
2024-10-22 17:00:29,250 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0), (Reveal player +1 color Y)) | P=0.3237382471561432
2024-10-22 17:00:29,251 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0), (Discard 1)) | P=0.3421512246131897
2024-10-22 17:00:29,251 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Discard 0), (Reveal player +1 rank 3)) | P=0.3341104984283447
2024-10-22 17:00:29,251 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Discard 0)) | Value: 0.0
2024-10-22 17:00:29,252 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:29,252 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'R', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
-----
B4 || B4|B4
Y4 || X4|RYGW4
R2 || X2|RYGW2
Y3 || XX|RYGW135
R3 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 R2}
2024-10-22 17:00:29,252 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:29,252 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:29,252 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:29,253 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.28080546855926514 | PUCT: 0.28080546855926514
2024-10-22 17:00:29,253 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.27436473965644836 | PUCT: 0.27436473965644836
2024-10-22 17:00:29,253 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 1.3333333333333333 | U: 0.3752906918525696 | PUCT: 1.7086241245269775
2024-10-22 17:00:29,254 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.272420197725296 | PUCT: 0.272420197725296
2024-10-22 17:00:29,254 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.2747079133987427 | PUCT: 0.2747079133987427
2024-10-22 17:00:29,255 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 1.7086241245269775
2024-10-22 17:00:29,255 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:29,255 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Reveal player +1 color W)) | Q: 4.0 | U: 0.7290124893188477 | PUCT: 4.729012489318848
2024-10-22 17:00:29,256 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Discard 0)) | Q: 0.0 | U: 0.7427500486373901 | PUCT: 0.7427500486373901
2024-10-22 17:00:29,256 - DEBUG - Selected Child: ((Reveal player +1 color B), (Reveal player +1 color W)) | PUCT: 4.729012489318848
2024-10-22 17:00:29,256 - DEBUG - Selected child for exploration: ((Reveal player +1 color B), (Reveal player +1 color W))
2024-10-22 17:00:29,256 - DEBUG - Node ((Reveal player +1 color B), (Reveal player +1 color W)) is a leaf node.
2024-10-22 17:00:29,256 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 color W))']
2024-10-22 17:00:29,257 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:29,257 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 2
2024-10-22 17:00:29,475 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:29,476 - DEBUG - Network Policy Logits: [[ 0.01630024  0.01281509  0.03132841 -0.02105716 -0.00251388  0.03700866
   0.04815742 -0.01776073  0.03421241 -0.00330856  0.01120646 -0.02286255
  -0.01638224 -0.05985912  0.01662287  0.01130277 -0.02055725  0.00049304
   0.00867847 -0.03191154]]
2024-10-22 17:00:29,476 - DEBUG - Network Policy after Softmax: [[0.05072369 0.05054722 0.05149173 0.04886375 0.04977829 0.05178505
  0.05236562 0.04902508 0.05164045 0.04973875 0.05046597 0.04877561
  0.04909271 0.04700405 0.05074006 0.05047083 0.04888818 0.0499282
  0.05033856 0.04833623]]
2024-10-22 17:00:29,477 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:29,478 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color W), (Discard 4)) | P=1.0
2024-10-22 17:00:29,478 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Reveal player +1 color W)) | Value: 0.0
2024-10-22 17:00:29,478 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:29,478 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 27, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': None, 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || WX|W235
XX || G4|G4
XX || G4|G4
XX || XX|RYB1235
-----
G2 || X2|RYGW2
B4 || B4|B4
Y4 || X4|RYGW4
R2 || X2|RYGW2
Y3 || XX|RYGW135
Deck size: 27
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5}
2024-10-22 17:00:29,478 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:29,478 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:29,478 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:29,479 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.2874591648578644 | PUCT: 0.2874591648578644
2024-10-22 17:00:29,479 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.2808658480644226 | PUCT: 0.2808658480644226
2024-10-22 17:00:29,480 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B),) | Q: 1.0 | U: 0.3073465824127197 | PUCT: 1.3073465824127197
2024-10-22 17:00:29,480 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.2788752019405365 | PUCT: 0.2788752019405365
2024-10-22 17:00:29,480 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.28121712803840637 | PUCT: 0.28121712803840637
2024-10-22 17:00:29,481 - DEBUG - Selected Child: ((Reveal player +1 color B),) | PUCT: 1.3073465824127197
2024-10-22 17:00:29,481 - DEBUG - Selected child for exploration: ((Reveal player +1 color B),)
2024-10-22 17:00:29,481 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Reveal player +1 color W)) | Q: 2.0 | U: 0.5236644148826599 | PUCT: 2.5236644744873047
2024-10-22 17:00:29,482 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color B), (Discard 0)) | Q: 0.0 | U: 0.8002986311912537 | PUCT: 0.8002986311912537
2024-10-22 17:00:29,482 - DEBUG - Selected Child: ((Reveal player +1 color B), (Reveal player +1 color W)) | PUCT: 2.5236644744873047
2024-10-22 17:00:29,482 - DEBUG - Selected child for exploration: ((Reveal player +1 color B), (Reveal player +1 color W))
2024-10-22 17:00:29,482 - DEBUG - Expanding unexplored child: ((Reveal player +1 color B), (Reveal player +1 color W), (Discard 4))
2024-10-22 17:00:29,482 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color B),)', '((Reveal player +1 color B), (Reveal player +1 color W))', '((Reveal player +1 color B), (Reveal player +1 color W), (Discard 4))']
2024-10-22 17:00:29,483 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 1
2024-10-22 17:00:29,483 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 2
2024-10-22 17:00:29,484 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:00:29,705 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:29,706 - DEBUG - Network Policy Logits: [[ 0.0232952   0.02352322  0.01581151 -0.04715225  0.00519824  0.0217724
   0.00077944  0.04187519  0.02583109  0.04506807 -0.02214807 -0.00948809
  -0.0403551  -0.01647819  0.01431906  0.03625341  0.00671882 -0.03172554
   0.00338713 -0.01414022]]
2024-10-22 17:00:29,706 - DEBUG - Network Policy after Softmax: [[0.05095107 0.05096269 0.05057119 0.04748521 0.05003731 0.05087354
  0.04981669 0.05190659 0.05108044 0.05207259 0.04868751 0.04930781
  0.04780908 0.04896435 0.05049577 0.0516156  0.05011345 0.04822343
  0.04994677 0.04907896]]
2024-10-22 17:00:29,707 - DEBUG - Normalized Policy: [[0.3337112  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.33806366 0.3282251  0.
  0.         0.        ]]
2024-10-22 17:00:29,708 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color W), (Discard 4), (Discard 0)) | P=0.3337112069129944
2024-10-22 17:00:29,709 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color W), (Discard 4), (Reveal player +1 rank 1)) | P=0.33806365728378296
2024-10-22 17:00:29,709 - DEBUG - Added Child Node: ((Reveal player +1 color B), (Reveal player +1 color W), (Discard 4), (Reveal player +1 rank 2)) | P=0.32822510600090027
2024-10-22 17:00:29,709 - DEBUG - Simulating Node: ((Reveal player +1 color B), (Reveal player +1 color W), (Discard 4)) | Value: 0.0
2024-10-22 17:00:29,709 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:29,709 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': None, 'rank': 1}, {'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'W', 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || X2|RYGW2
XX || B4|B4
XX || X4|RYGW4
XX || X2|RYGW2
XX || XX|RYGW135
-----
B2 || B2|B2
W2 || WX|W235
G4 || G4|G4
G4 || G4|G4
W1 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 B1}
2024-10-22 17:00:29,709 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:29,709 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:29,710 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:29,710 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color B),) | Visit Count: 5
2024-10-22 17:00:29,710 - INFO - Actual Game Score: 4
2024-10-22 17:00:29,710 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:29,710 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:29,710 - DEBUG - Policy Targets: [0.         0.11111111 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.11111111
 0.11111111 0.         0.55555556 0.         0.         0.11111111
 0.         0.        ]
2024-10-22 17:00:29,710 - DEBUG - === End of Training Data ===
2024-10-22 17:00:29,710 - INFO - Chosen Action: (Reveal player +1 color B) | Visit Count: 5
2024-10-22 17:00:29,711 - DEBUG - Not the current player's turn.
2024-10-22 17:00:31,697 - INFO - Agent state has been reset.
2024-10-22 17:00:31,697 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:31,697 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'R', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
-----
B4 || B4|B4
Y4 || X4|RYGW4
R2 || X2|RYGW2
Y3 || XX|RYGW135
R3 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2}
2024-10-22 17:00:31,697 - INFO - Max Rollouts: 10
2024-10-22 17:00:31,697 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:31,698 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:31,698 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:31,913 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:31,914 - DEBUG - Network Policy Logits: [[ 0.01117456  0.00790445  0.00082205 -0.07394493  0.01024428  0.01436291
   0.01524821  0.01637431 -0.00449299  0.00448148 -0.01526544 -0.04789846
  -0.02160108 -0.02218117  0.03701724  0.00070862 -0.0200725  -0.02826041
   0.01858934 -0.0243652 ]]
2024-10-22 17:00:31,914 - DEBUG - Network Policy after Softmax: [[0.05085296 0.05068693 0.05032922 0.04670349 0.05080568 0.05101535
  0.05106054 0.05111807 0.05006243 0.05051373 0.04952603 0.04793593
  0.04921324 0.0491847  0.05218427 0.05032351 0.04928853 0.0488866
  0.05123143 0.0490774 ]]
2024-10-22 17:00:31,916 - DEBUG - Normalized Policy: [[0.         0.34361818 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.32496852
  0.         0.         0.         0.         0.         0.33141333
  0.         0.        ]]
2024-10-22 17:00:31,916 - DEBUG - Dirichlet Noise Added: [0.         0.25771365 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.49372637
 0.         0.         0.         0.         0.         0.24856
 0.         0.        ]
2024-10-22 17:00:31,917 - DEBUG - Added Child Node: ((Reveal player +1 color Y),) | P=0.49372637271881104
2024-10-22 17:00:31,918 - DEBUG - Added Child Node: ((Discard 1),) | P=0.25771364569664
2024-10-22 17:00:31,918 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.24855999648571014
2024-10-22 17:00:31,918 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:31,918 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:31,918 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'R', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
-----
B4 || B4|B4
Y4 || X4|RYGW4
R2 || X2|RYGW2
Y3 || XX|RYGW135
R3 || XX|RYGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2}
2024-10-22 17:00:31,918 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:31,919 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:31,919 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:31,919 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y),)
2024-10-22 17:00:31,920 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)']
2024-10-22 17:00:31,920 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:00:32,130 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:32,130 - DEBUG - Network Policy Logits: [[-0.0333182   0.0195181   0.02282935 -0.0454084  -0.00322029  0.05694181
   0.00959893  0.00597924  0.02709991  0.00599524 -0.01078921  0.01192596
  -0.00841079 -0.03511131  0.02096077  0.03499188  0.00140565 -0.07100447
   0.02955282 -0.01685257]]
2024-10-22 17:00:32,130 - DEBUG - Network Policy after Softmax: [[0.04828555 0.05090538 0.05107422 0.04770529 0.04976094 0.05284655
  0.05040294 0.05022082 0.05129281 0.05022163 0.04938572 0.05052036
  0.04950332 0.04819905 0.05097887 0.05169921 0.04999166 0.04649971
  0.05141878 0.04908719]]
2024-10-22 17:00:32,132 - DEBUG - Normalized Policy: [[0.         0.         0.         0.3296263  0.         0.
  0.         0.         0.         0.         0.         0.34907746
  0.         0.         0.         0.         0.         0.3212962
  0.         0.        ]]
2024-10-22 17:00:32,132 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 3)) | P=0.32962629199028015
2024-10-22 17:00:32,133 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | P=0.3490774631500244
2024-10-22 17:00:32,134 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 rank 3)) | P=0.32129618525505066
2024-10-22 17:00:32,134 - DEBUG - Simulating Node: ((Reveal player +1 color Y),) | Value: 0.0
2024-10-22 17:00:32,134 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:32,134 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'Y', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': 'Y', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || YX|Y135
XX || XX|RGWB12345
-----
B2 || B2|B2
Y2 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
Y3 || XX|RYWB1235
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2}
2024-10-22 17:00:32,134 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:32,134 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:32,134 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:32,134 - DEBUG - Expanding unexplored child: ((Discard 1),)
2024-10-22 17:00:32,134 - DEBUG - Traversing Path: ['()', '((Discard 1),)']
2024-10-22 17:00:32,135 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:32,339 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:32,340 - DEBUG - Network Policy Logits: [[-0.02248219  0.00579753  0.02958128 -0.04405538 -0.01522663  0.04291106
   0.03208453  0.02210058 -0.0046723   0.04140645 -0.0166444   0.0028923
  -0.04332969 -0.03011347  0.04412059  0.01882302 -0.02614496 -0.05720773
   0.02324826 -0.03811143]]
2024-10-22 17:00:32,340 - DEBUG - Network Policy after Softmax: [[0.04894973 0.05035377 0.05156573 0.04790503 0.04930618 0.05225769
  0.05169497 0.05118142 0.04982932 0.05217912 0.04923632 0.05020769
  0.04793981 0.0485776  0.05232093 0.05101394 0.04877076 0.04727909
  0.05124019 0.04819063]]
2024-10-22 17:00:32,341 - DEBUG - Normalized Policy: [[0.         0.         0.35130197 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.32659966 0.         0.         0.         0.         0.32209837
  0.         0.        ]]
2024-10-22 17:00:32,342 - DEBUG - Added Child Node: ((Discard 1), (Discard 2)) | P=0.35130196809768677
2024-10-22 17:00:32,342 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 3)) | P=0.32209837436676025
2024-10-22 17:00:32,343 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color G)) | P=0.326599657535553
2024-10-22 17:00:32,343 - DEBUG - Simulating Node: ((Discard 1),) | Value: 0.0
2024-10-22 17:00:32,343 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:32,343 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 25, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || X4|RYGW4
XX || X2|RYGW2
XX || XX|RYGW135
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
G3 || XX|RYGWB12345
Deck size: 25
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 W2}
2024-10-22 17:00:32,343 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:32,343 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:32,343 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:32,344 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:00:32,344 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:00:32,344 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:32,563 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:32,563 - DEBUG - Network Policy Logits: [[-0.03091327  0.00230748  0.05014354 -0.03069663  0.01972464  0.02837358
  -0.01005032  0.01296584  0.02602767  0.01883842 -0.01714466  0.01487355
  -0.01167921 -0.0156122   0.03052896  0.01457438 -0.00930082 -0.0523708
   0.0030314  -0.00403653]]
2024-10-22 17:00:32,563 - DEBUG - Network Policy after Softmax: [[0.04836796 0.05000177 0.05245179 0.04837845 0.05088029 0.05132226
  0.04938766 0.05053756 0.051202   0.05083522 0.04903853 0.05063406
  0.04930728 0.04911374 0.051433   0.05061892 0.04942469 0.04734116
  0.05003798 0.04968556]]
2024-10-22 17:00:32,565 - DEBUG - Normalized Policy: [[0.         0.         0.35151199 0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.3312255  0.31726247
  0.         0.        ]]
2024-10-22 17:00:32,566 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 2)) | P=0.35151198506355286
2024-10-22 17:00:32,566 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 2)) | P=0.33122551441192627
2024-10-22 17:00:32,567 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 3)) | P=0.3172624707221985
2024-10-22 17:00:32,567 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:00:32,567 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:32,567 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': None, 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': 2}, {'color': None, 'rank': 2}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || X4|RYGW4
XX || X2|RYGW2
XX || X3|RYGW3
XX || X3|RYGWB3
-----
B2 || B2|B2
Y3 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
W2 || XX|RYWB1235
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2}
2024-10-22 17:00:32,567 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:32,567 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:32,568 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:32,568 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.782948911190033 | PUCT: 0.782948911190033
2024-10-22 17:00:32,569 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.40868109464645386 | PUCT: 0.40868109464645386
2024-10-22 17:00:32,569 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.3941652774810791 | PUCT: 0.3941652774810791
2024-10-22 17:00:32,569 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 0.782948911190033
2024-10-22 17:00:32,570 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:00:32,570 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Reveal player +1 rank 3))
2024-10-22 17:00:32,570 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 rank 3))']
2024-10-22 17:00:32,570 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:00:32,570 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:32,570 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:32,571 - DEBUG - Rollout #5 completed with reward=4
2024-10-22 17:00:32,571 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:32,571 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 2.0 | U: 0.5507377982139587 | PUCT: 2.5507378578186035
2024-10-22 17:00:32,572 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.43120846152305603 | PUCT: 0.43120846152305603
2024-10-22 17:00:32,572 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.41589251160621643 | PUCT: 0.41589251160621643
2024-10-22 17:00:32,572 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 2.5507378578186035
2024-10-22 17:00:32,572 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:00:32,572 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Reveal player +1 color Y))
2024-10-22 17:00:32,572 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 color Y))']
2024-10-22 17:00:32,573 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:00:32,573 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 2
2024-10-22 17:00:32,782 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:32,783 - DEBUG - Network Policy Logits: [[-0.01721432  0.01939716 -0.01123041 -0.04064368 -0.00487255  0.01799882
   0.01853658 -0.00902452 -0.01218808  0.00558142  0.00476047 -0.05778116
   0.00986379 -0.00970868  0.03494578  0.02873677 -0.02341716 -0.02384739
   0.03557157  0.01023436]]
2024-10-22 17:00:32,783 - DEBUG - Network Policy after Softmax: [[0.04919236 0.05102674 0.0494876  0.04805321 0.04980324 0.05095543
  0.05098284 0.04959689 0.04944023 0.05032661 0.05028531 0.04723671
  0.05054259 0.04956296 0.05182633 0.05150554 0.04888817 0.04886714
  0.05185878 0.05056132]]
2024-10-22 17:00:32,784 - DEBUG - Normalized Policy: [[0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:32,785 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color Y), (Discard 1)) | P=1.0
2024-10-22 17:00:32,785 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 17:00:32,786 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:32,786 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'R', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': 'Y', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || YX|Y235
XX || G4|G4
XX || G4|G4
XX || XX|RWB1235
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
Y3 || YX|Y135
R3 || XX|RGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2}
2024-10-22 17:00:32,786 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:32,786 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:32,786 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:32,787 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 1.3333333333333333 | U: 0.43045496940612793 | PUCT: 1.7637883424758911
2024-10-22 17:00:32,787 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.4493749141693115 | PUCT: 0.4493749141693115
2024-10-22 17:00:32,787 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.43341371417045593 | PUCT: 0.43341371417045593
2024-10-22 17:00:32,787 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 1.7637883424758911
2024-10-22 17:00:32,788 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:00:32,788 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Discard 3))
2024-10-22 17:00:32,788 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Discard 3))']
2024-10-22 17:00:32,788 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:00:32,789 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:32,996 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:32,996 - DEBUG - Network Policy Logits: [[ 0.02200567  0.00372822 -0.01831064 -0.06864341 -0.00428875  0.03945753
   0.02864361  0.00825383 -0.01774207  0.01329618 -0.01428088 -0.05682027
  -0.02175679 -0.02510839  0.05111951 -0.01742581 -0.03422384 -0.00550877
  -0.00383415 -0.02982791]]
2024-10-22 17:00:32,997 - DEBUG - Network Policy after Softmax: [[0.05147875 0.0505464  0.0494446  0.04701751 0.05014279 0.05238504
  0.0518216  0.05077567 0.04947272 0.05103235 0.04964425 0.0475767
  0.0492745  0.04910963 0.05299953 0.04948837 0.048664   0.05008165
  0.05016559 0.0488784 ]]
2024-10-22 17:00:32,998 - DEBUG - Normalized Policy: [[0.         0.5045021  0.         0.         0.         0.
  0.         0.         0.         0.         0.49549785 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:32,999 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 3), (Reveal player +1 color R)) | P=0.49549785256385803
2024-10-22 17:00:32,999 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 3), (Discard 1)) | P=0.5045021176338196
2024-10-22 17:00:32,999 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Discard 3)) | Value: 0.0
2024-10-22 17:00:32,999 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:33,000 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 25, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R3 || XX|RGWB12345
W2 || XX|RYGWB12345
Deck size: 25
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3}
2024-10-22 17:00:33,000 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:33,000 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:33,000 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:33,001 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 1.0 | U: 0.35598331689834595 | PUCT: 1.3559832572937012
2024-10-22 17:00:33,001 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.46453750133514404 | PUCT: 0.46453750133514404
2024-10-22 17:00:33,002 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4480377435684204 | PUCT: 0.4480377435684204
2024-10-22 17:00:33,002 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 1.3559832572937012
2024-10-22 17:00:33,002 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:00:33,003 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Reveal player +1 rank 3)) | Q: 4.0 | U: 0.5095099806785583 | PUCT: 4.509510040283203
2024-10-22 17:00:33,003 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | Q: 0.0 | U: 0.5535653829574585 | PUCT: 0.5535653829574585
2024-10-22 17:00:33,003 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Discard 3)) | Q: 0.0 | U: 0.5227198004722595 | PUCT: 0.5227198004722595
2024-10-22 17:00:33,004 - DEBUG - Selected Child: ((Reveal player +1 color Y), (Reveal player +1 rank 3)) | PUCT: 4.509510040283203
2024-10-22 17:00:33,004 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y), (Reveal player +1 rank 3))
2024-10-22 17:00:33,004 - DEBUG - Node ((Reveal player +1 color Y), (Reveal player +1 rank 3)) is a leaf node.
2024-10-22 17:00:33,004 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 rank 3))']
2024-10-22 17:00:33,005 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:00:33,005 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:33,226 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:33,226 - DEBUG - Network Policy Logits: [[-0.01241403  0.00959854 -0.01080776 -0.01674711  0.00319876  0.01239516
   0.02757873  0.01856789 -0.00065249  0.01060111  0.00053756 -0.06262471
  -0.000159    0.00177833  0.03805263  0.03101309 -0.01319972 -0.02034386
   0.00837221  0.00209686]]
2024-10-22 17:00:33,227 - DEBUG - Network Policy after Softmax: [[0.0493059  0.05040328 0.04938516 0.04909271 0.05008174 0.05054444
  0.05131774 0.0508574  0.04988924 0.05045384 0.04994864 0.04689134
  0.04991386 0.05001066 0.05185806 0.05149429 0.04926718 0.04891646
  0.05034151 0.05002658]]
2024-10-22 17:00:33,228 - DEBUG - Normalized Policy: [[0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:33,229 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 rank 3), (Discard 1)) | P=1.0
2024-10-22 17:00:33,229 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:00:33,229 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:33,229 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 26, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'R', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': 2}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': 'Y', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW25
XX || G4|G4
XX || G4|G4
XX || X3|RYWB3
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
Y3 || YX|Y135
R3 || XX|RGWB12345
Deck size: 26
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2}
2024-10-22 17:00:33,229 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:33,229 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:33,229 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:33,230 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.8 | U: 0.30493852496147156 | PUCT: 1.1049385070800781
2024-10-22 17:00:33,230 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.4775124192237854 | PUCT: 0.4775124192237854
2024-10-22 17:00:33,231 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.46055179834365845 | PUCT: 0.46055179834365845
2024-10-22 17:00:33,231 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 1.1049385070800781
2024-10-22 17:00:33,231 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:00:33,232 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Reveal player +1 rank 3)) | Q: 2.0 | U: 0.35839685797691345 | PUCT: 2.3583967685699463
2024-10-22 17:00:33,232 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | Q: 0.0 | U: 0.5840790867805481 | PUCT: 0.5840790867805481
2024-10-22 17:00:33,233 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Discard 3)) | Q: 0.0 | U: 0.5515332818031311 | PUCT: 0.5515332818031311
2024-10-22 17:00:33,233 - DEBUG - Selected Child: ((Reveal player +1 color Y), (Reveal player +1 rank 3)) | PUCT: 2.3583967685699463
2024-10-22 17:00:33,233 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y), (Reveal player +1 rank 3))
2024-10-22 17:00:33,233 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Reveal player +1 rank 3), (Discard 1))
2024-10-22 17:00:33,233 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 rank 3))', '((Reveal player +1 color Y), (Reveal player +1 rank 3), (Discard 1))']
2024-10-22 17:00:33,234 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:00:33,234 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:33,234 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:33,234 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:00:33,234 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:33,235 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 1.3333333333333333 | U: 0.2675691843032837 | PUCT: 1.6009025573730469
2024-10-22 17:00:33,236 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.488827109336853 | PUCT: 0.488827109336853
2024-10-22 17:00:33,236 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.471464604139328 | PUCT: 0.471464604139328
2024-10-22 17:00:33,236 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 1.6009025573730469
2024-10-22 17:00:33,237 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:00:33,237 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Reveal player +1 rank 3)) | Q: 2.6666666666666665 | U: 0.2801218628883362 | PUCT: 2.9467885494232178
2024-10-22 17:00:33,237 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | Q: 0.0 | U: 0.6086858510971069 | PUCT: 0.6086858510971069
2024-10-22 17:00:33,238 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Discard 3)) | Q: 0.0 | U: 0.5747689008712769 | PUCT: 0.5747689008712769
2024-10-22 17:00:33,238 - DEBUG - Selected Child: ((Reveal player +1 color Y), (Reveal player +1 rank 3)) | PUCT: 2.9467885494232178
2024-10-22 17:00:33,238 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y), (Reveal player +1 rank 3))
2024-10-22 17:00:33,238 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Reveal player +1 rank 3), (Discard 1)) | Q: 4.0 | U: 1.4717625379562378 | PUCT: 5.471762657165527
2024-10-22 17:00:33,239 - DEBUG - Selected Child: ((Reveal player +1 color Y), (Reveal player +1 rank 3), (Discard 1)) | PUCT: 5.471762657165527
2024-10-22 17:00:33,239 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y), (Reveal player +1 rank 3), (Discard 1))
2024-10-22 17:00:33,239 - DEBUG - Node ((Reveal player +1 color Y), (Reveal player +1 rank 3), (Discard 1)) is a leaf node.
2024-10-22 17:00:33,239 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 rank 3))', '((Reveal player +1 color Y), (Reveal player +1 rank 3), (Discard 1))']
2024-10-22 17:00:33,239 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:00:33,239 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:33,240 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:33,240 - DEBUG - Rollout #10 completed with reward=4
2024-10-22 17:00:33,240 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:33,240 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color Y),) | Visit Count: 7
2024-10-22 17:00:33,240 - INFO - Actual Game Score: 4
2024-10-22 17:00:33,240 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:33,240 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:33,241 - DEBUG - Policy Targets: [0.         0.11111111 0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.77777778
 0.         0.         0.         0.         0.         0.11111111
 0.         0.        ]
2024-10-22 17:00:33,241 - DEBUG - === End of Training Data ===
2024-10-22 17:00:33,241 - INFO - Chosen Action: (Reveal player +1 color Y) | Visit Count: 7
2024-10-22 17:00:33,242 - DEBUG - Not the current player's turn.
2024-10-22 17:00:35,302 - INFO - Agent state has been reset.
2024-10-22 17:00:35,302 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:35,302 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 25, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 25
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3}
2024-10-22 17:00:35,302 - INFO - Max Rollouts: 10
2024-10-22 17:00:35,302 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:35,303 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:35,303 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:35,509 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:35,509 - DEBUG - Network Policy Logits: [[ 0.02945651  0.00578782 -0.0174066  -0.064954   -0.00607396  0.03706198
   0.03894024  0.01598983 -0.01183474  0.00657241  0.00044174 -0.05250909
  -0.01243612 -0.03493324  0.04497527 -0.01069611 -0.03618876 -0.01729087
   0.00755598 -0.03312755]]
2024-10-22 17:00:35,509 - DEBUG - Network Policy after Softmax: [[0.05175821 0.05054754 0.04938862 0.04709527 0.0499515  0.05215336
  0.05225141 0.05106587 0.04966457 0.05058722 0.05027803 0.04768503
  0.04963471 0.04853055 0.0525677  0.04972115 0.04846965 0.04939433
  0.050637   0.04861825]]
2024-10-22 17:00:35,511 - DEBUG - Normalized Policy: [[0.         0.5013365  0.         0.         0.         0.
  0.         0.         0.         0.         0.49866349 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:35,511 - DEBUG - Dirichlet Noise Added: [0.         0.6260024  0.         0.         0.         0.
 0.         0.         0.         0.         0.37399766 0.
 0.         0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:35,512 - DEBUG - Added Child Node: ((Reveal player +1 color R),) | P=0.37399765849113464
2024-10-22 17:00:35,513 - DEBUG - Added Child Node: ((Discard 1),) | P=0.6260023713111877
2024-10-22 17:00:35,513 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:35,513 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:35,513 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 25, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || XX|RYW235
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 25
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3}
2024-10-22 17:00:35,513 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:35,513 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:35,513 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:35,513 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R),)
2024-10-22 17:00:35,514 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)']
2024-10-22 17:00:35,514 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:35,721 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:35,721 - DEBUG - Network Policy Logits: [[-3.9475661e-02  4.7948072e-03  3.5882749e-02 -5.1620040e-02
  -9.6673276e-03  4.7926284e-02  1.0447111e-05  1.7949294e-02
   4.2773139e-02  2.0005541e-02  5.2138278e-03  1.3136670e-02
  -4.0992018e-02 -2.1968249e-02  5.0428234e-02 -7.2742747e-03
   3.3691549e-03 -6.6476613e-02 -4.2283968e-03 -4.4190422e-02]]
2024-10-22 17:00:35,722 - DEBUG - Network Policy after Softmax: [[0.04814538 0.05032468 0.05191374 0.04756422 0.04960211 0.05254275
  0.05008449 0.05099105 0.05227268 0.05109601 0.05034577 0.05074624
  0.04807243 0.0489957  0.05267437 0.04972096 0.05025299 0.0468628
  0.04987263 0.04791892]]
2024-10-22 17:00:35,723 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.5086299  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.49137008]]
2024-10-22 17:00:35,724 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 5)) | P=0.4913700819015503
2024-10-22 17:00:35,724 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 4)) | P=0.5086299180984497
2024-10-22 17:00:35,725 - DEBUG - Simulating Node: ((Reveal player +1 color R),) | Value: 0.0
2024-10-22 17:00:35,725 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:35,725 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 25, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
-----
B2 || B2|B2
Y5 || XX|RYW235
G4 || G4|G4
G4 || G4|G4
B5 || XX|RYWB1235
Deck size: 25
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3}
2024-10-22 17:00:35,725 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:35,725 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:35,725 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:35,725 - DEBUG - Expanding unexplored child: ((Discard 1),)
2024-10-22 17:00:35,725 - DEBUG - Traversing Path: ['()', '((Discard 1),)']
2024-10-22 17:00:35,726 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:35,928 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:35,928 - DEBUG - Network Policy Logits: [[-0.00554184  0.01282234  0.0253899  -0.03844936 -0.0348318   0.05898845
   0.02318415  0.02237092  0.00583997  0.0572814  -0.00545228  0.00643382
  -0.05370914 -0.01885762  0.0487152   0.02291382 -0.02388477 -0.06641424
   0.00255676 -0.06020651]]
2024-10-22 17:00:35,929 - DEBUG - Network Policy after Softmax: [[0.04974306 0.05066498 0.05130574 0.04813278 0.04830721 0.05305882
  0.0511927  0.05115108 0.05031246 0.05296832 0.04974751 0.05034234
  0.04740386 0.04908508 0.05251653 0.05117886 0.04883894 0.04680539
  0.05014754 0.04709686]]
2024-10-22 17:00:35,930 - DEBUG - Normalized Policy: [[0.         0.3394691  0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.31761867 0.         0.         0.3429122  0.         0.
  0.         0.        ]]
2024-10-22 17:00:35,930 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1)) | P=0.3429121971130371
2024-10-22 17:00:35,931 - DEBUG - Added Child Node: ((Discard 1), (Discard 1)) | P=0.3394691050052643
2024-10-22 17:00:35,932 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color G)) | P=0.3176186680793762
2024-10-22 17:00:35,932 - DEBUG - Simulating Node: ((Discard 1),) | Value: 0.0
2024-10-22 17:00:35,932 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:35,932 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 0}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B1 || XX|RYWB1235
G3 || XX|RYGWB12345
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 Y3}
2024-10-22 17:00:35,932 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:35,932 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:35,932 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:35,933 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5504357218742371 | PUCT: 0.5504357218742371
2024-10-22 17:00:35,934 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.9213268160820007 | PUCT: 0.9213268160820007
2024-10-22 17:00:35,934 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.9213268160820007
2024-10-22 17:00:35,934 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:35,934 - DEBUG - Expanding unexplored child: ((Discard 1), (Discard 1))
2024-10-22 17:00:35,934 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Discard 1))']
2024-10-22 17:00:35,935 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:35,935 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:36,136 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:36,137 - DEBUG - Network Policy Logits: [[-0.02010152  0.01681947  0.0178868  -0.04014904 -0.02264618  0.06469928
   0.00687391  0.01872415  0.02470865  0.06294453  0.00069195 -0.02209856
  -0.0641647  -0.0122112   0.03251474  0.01786535  0.00817149 -0.05381325
   0.03551942  0.00264425]]
2024-10-22 17:00:36,137 - DEBUG - Network Policy after Softmax: [[0.04879459 0.0506298  0.05068387 0.04782612 0.04867058 0.05311292
  0.05012875 0.05072632 0.05103081 0.0530198  0.04981982 0.04869724
  0.04669122 0.04918111 0.05143072 0.05068278 0.05019384 0.04717705
  0.05158548 0.04991717]]
2024-10-22 17:00:36,138 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.32626897 0.
  0.         0.         0.         0.         0.33397302 0.
  0.         0.         0.         0.339758   0.         0.
  0.         0.        ]]
2024-10-22 17:00:36,139 - DEBUG - Added Child Node: ((Discard 1), (Discard 1), (Reveal player +1 color R)) | P=0.3339730203151703
2024-10-22 17:00:36,140 - DEBUG - Added Child Node: ((Discard 1), (Discard 1), (Discard 4)) | P=0.3262689709663391
2024-10-22 17:00:36,140 - DEBUG - Added Child Node: ((Discard 1), (Discard 1), (Reveal player +1 rank 1)) | P=0.3397580087184906
2024-10-22 17:00:36,141 - DEBUG - Simulating Node: ((Discard 1), (Discard 1)) | Value: 0.0
2024-10-22 17:00:36,141 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:36,141 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 Y2 Y4}
2024-10-22 17:00:36,141 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:36,141 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:36,141 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:36,142 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5930837392807007 | PUCT: 0.5930837392807007
2024-10-22 17:00:36,142 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.6618077158927917 | PUCT: 0.6618077158927917
2024-10-22 17:00:36,142 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.6618077158927917
2024-10-22 17:00:36,143 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:36,143 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:00:36,143 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 1))']
2024-10-22 17:00:36,143 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:36,143 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:00:36,144 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:36,144 - DEBUG - Rollout #5 completed with reward=4
2024-10-22 17:00:36,144 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:36,144 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.6257757544517517 | PUCT: 0.6257757544517517
2024-10-22 17:00:36,145 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 1.3333333333333333 | U: 0.5237159729003906 | PUCT: 1.8570493459701538
2024-10-22 17:00:36,145 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 1.8570493459701538
2024-10-22 17:00:36,145 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:36,145 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 color G))
2024-10-22 17:00:36,145 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 color G))']
2024-10-22 17:00:36,146 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:36,147 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 2
2024-10-22 17:00:36,347 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:36,347 - DEBUG - Network Policy Logits: [[ 0.00653852  0.00716696  0.01316684 -0.08382949 -0.02479222  0.04663346
   0.03014253  0.02374764 -0.01996325  0.04634713  0.01454795 -0.04771761
  -0.04908589 -0.02309219  0.03722181  0.00329523 -0.03536589 -0.04523324
   0.00551124 -0.01725384]]
2024-10-22 17:00:36,347 - DEBUG - Network Policy after Softmax: [[0.05058051 0.05061231 0.05091689 0.0462101  0.04902036 0.05264974
  0.05178862 0.0514585  0.04925765 0.05263467 0.05098726 0.04790933
  0.04784382 0.04910377 0.05215655 0.05041673 0.04850477 0.0480285
  0.05052858 0.04939129]]
2024-10-22 17:00:36,349 - DEBUG - Normalized Policy: [[0.         0.         0.         0.47542545 0.         0.
  0.         0.         0.         0.         0.5245745  0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:36,349 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color G), (Reveal player +1 color R)) | P=0.5245745182037354
2024-10-22 17:00:36,350 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color G), (Discard 3)) | P=0.47542545199394226
2024-10-22 17:00:36,350 - DEBUG - Simulating Node: ((Discard 1), (Reveal player +1 color G)) | Value: 0.0
2024-10-22 17:00:36,350 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:36,351 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || XX|RYWB1235
XX || XX|RYWB12345
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W5}
2024-10-22 17:00:36,351 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:36,351 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:36,351 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:36,352 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.6521391868591309 | PUCT: 0.6521391868591309
2024-10-22 17:00:36,352 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 1.0 | U: 0.436623752117157 | PUCT: 1.4366238117218018
2024-10-22 17:00:36,352 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 1.4366238117218018
2024-10-22 17:00:36,352 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:36,353 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Discard 1)) | Q: 0.0 | U: 0.5383284687995911 | PUCT: 0.5383284687995911
2024-10-22 17:00:36,353 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.5437885522842407 | PUCT: 4.543788433074951
2024-10-22 17:00:36,353 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Reveal player +1 color G)) | Q: 0.0 | U: 0.5036781430244446 | PUCT: 0.5036781430244446
2024-10-22 17:00:36,354 - DEBUG - Selected Child: ((Discard 1), (Reveal player +1 rank 1)) | PUCT: 4.543788433074951
2024-10-22 17:00:36,354 - DEBUG - Selected child for exploration: ((Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:00:36,354 - DEBUG - Node ((Discard 1), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:00:36,354 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 1))']
2024-10-22 17:00:36,355 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:36,355 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:00:36,355 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:36,355 - DEBUG - Rollout #7 completed with reward=4
2024-10-22 17:00:36,355 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:36,356 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.6741433143615723 | PUCT: 0.6741433143615723
2024-10-22 17:00:36,356 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 1.6 | U: 0.3761301040649414 | PUCT: 1.9761301279067993
2024-10-22 17:00:36,356 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 1.9761301279067993
2024-10-22 17:00:36,357 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:36,357 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Discard 1)) | Q: 0.0 | U: 0.5680023431777954 | PUCT: 0.5680023431777954
2024-10-22 17:00:36,357 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.38250887393951416 | PUCT: 4.382508754730225
2024-10-22 17:00:36,358 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Reveal player +1 color G)) | Q: 0.0 | U: 0.5314419865608215 | PUCT: 0.5314419865608215
2024-10-22 17:00:36,358 - DEBUG - Selected Child: ((Discard 1), (Reveal player +1 rank 1)) | PUCT: 4.382508754730225
2024-10-22 17:00:36,358 - DEBUG - Selected child for exploration: ((Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:00:36,358 - DEBUG - Node ((Discard 1), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:00:36,358 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 1))']
2024-10-22 17:00:36,359 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:36,360 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:36,561 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:36,562 - DEBUG - Network Policy Logits: [[-0.00425004  0.0017989  -0.00396128 -0.08746295 -0.02633233  0.01622234
   0.02788588  0.00609012 -0.01572284  0.03249322  0.00395527 -0.05184259
  -0.03334266 -0.02347843  0.04371576  0.00040004 -0.04599242 -0.03357209
   0.01373333 -0.02168249]]
2024-10-22 17:00:36,562 - DEBUG - Network Policy after Softmax: [[0.05026805 0.05057305 0.05028258 0.04625442 0.04917019 0.05130777
  0.0519097  0.05079053 0.04969464 0.05214942 0.05068222 0.04793171
  0.04882669 0.04931071 0.05273797 0.05050235 0.04821294 0.04881549
  0.05118022 0.04939935]]
2024-10-22 17:00:36,564 - DEBUG - Normalized Policy: [[0.         0.         0.         0.31544715 0.         0.
  0.         0.         0.33890888 0.         0.345644   0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:36,564 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Reveal player +1 color R)) | P=0.3456439971923828
2024-10-22 17:00:36,566 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Play 3)) | P=0.3389088809490204
2024-10-22 17:00:36,567 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Discard 3)) | P=0.3154471516609192
2024-10-22 17:00:36,567 - DEBUG - Simulating Node: ((Discard 1), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:00:36,567 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:36,567 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || X1|RYWB1
XX || XX|RYGWB2345
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W5}
2024-10-22 17:00:36,567 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:36,567 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:36,567 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:36,568 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.692972719669342 | PUCT: 0.692972719669342
2024-10-22 17:00:36,568 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 1.3333333333333333 | U: 0.3314020335674286 | PUCT: 1.6647354364395142
2024-10-22 17:00:36,569 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 1.6647354364395142
2024-10-22 17:00:36,569 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:36,570 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Discard 1)) | Q: 0.0 | U: 0.5919317603111267 | PUCT: 0.5919317603111267
2024-10-22 17:00:36,570 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Reveal player +1 rank 1)) | Q: 2.6666666666666665 | U: 0.29896774888038635 | PUCT: 2.96563458442688
2024-10-22 17:00:36,571 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Reveal player +1 color G)) | Q: 0.0 | U: 0.5538312196731567 | PUCT: 0.5538312196731567
2024-10-22 17:00:36,571 - DEBUG - Selected Child: ((Discard 1), (Reveal player +1 rank 1)) | PUCT: 2.96563458442688
2024-10-22 17:00:36,571 - DEBUG - Selected child for exploration: ((Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:00:36,571 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 rank 1), (Discard 3))
2024-10-22 17:00:36,571 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 1))', '((Discard 1), (Reveal player +1 rank 1), (Discard 3))']
2024-10-22 17:00:36,572 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:36,572 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:00:36,572 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:36,572 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:00:36,572 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:36,573 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.7093927264213562 | PUCT: 0.7093927264213562
2024-10-22 17:00:36,574 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 1.7142857142857142 | U: 0.29684779047966003 | PUCT: 2.0111334323883057
2024-10-22 17:00:36,574 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 2.0111334323883057
2024-10-22 17:00:36,574 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:00:36,574 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Discard 1)) | Q: 0.0 | U: 0.6119044423103333 | PUCT: 0.6119044423103333
2024-10-22 17:00:36,575 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Reveal player +1 rank 1)) | Q: 3.0 | U: 0.24724428355693817 | PUCT: 3.247244358062744
2024-10-22 17:00:36,575 - DEBUG - PUCT Calculation | Child: ((Discard 1), (Reveal player +1 color G)) | Q: 0.0 | U: 0.5725182890892029 | PUCT: 0.5725182890892029
2024-10-22 17:00:36,575 - DEBUG - Selected Child: ((Discard 1), (Reveal player +1 rank 1)) | PUCT: 3.247244358062744
2024-10-22 17:00:36,575 - DEBUG - Selected child for exploration: ((Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:00:36,575 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 rank 1), (Reveal player +1 color R))
2024-10-22 17:00:36,575 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 1))', '((Discard 1), (Reveal player +1 rank 1), (Reveal player +1 color R))']
2024-10-22 17:00:36,577 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:00:36,577 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:36,578 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 3
2024-10-22 17:00:36,789 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:36,790 - DEBUG - Network Policy Logits: [[-0.01974671  0.00853197  0.04076776 -0.04415176 -0.03255918  0.04920185
   0.02343562 -0.01123543  0.01125866 -0.00448037  0.01759463  0.00840294
  -0.06280304 -0.01271582  0.05910129 -0.01776498 -0.02948731 -0.03966049
  -0.02940814 -0.04285344]]
2024-10-22 17:00:36,790 - DEBUG - Network Policy after Softmax: [[0.04931252 0.05072692 0.05238878 0.04812361 0.04868473 0.0528325
  0.0514886  0.04973403 0.05086543 0.05007112 0.05118873 0.05072038
  0.04723437 0.04966046 0.05335812 0.04941035 0.04883453 0.04834023
  0.04883839 0.04818614]]
2024-10-22 17:00:36,791 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.31869406 0.
  0.         0.         0.         0.         0.         0.33201954
  0.         0.         0.34928638 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:36,792 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Reveal player +1 color R), (Discard 4)) | P=0.3186940550804138
2024-10-22 17:00:36,793 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Reveal player +1 color R), (Reveal player +1 color Y)) | P=0.33201953768730164
2024-10-22 17:00:36,793 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Reveal player +1 color R), (Reveal player +1 color B)) | P=0.34928637742996216
2024-10-22 17:00:36,793 - DEBUG - Simulating Node: ((Discard 1), (Reveal player +1 rank 1), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:00:36,793 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:36,794 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
Y1 || X1|RYWB1
B1 || X1|RYGWB1
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 R2}
2024-10-22 17:00:36,794 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:36,794 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:36,794 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:36,794 - DEBUG - Best node chosen by MCTS: ((Discard 1),) | Visit Count: 8
2024-10-22 17:00:36,794 - INFO - Actual Game Score: 4
2024-10-22 17:00:36,794 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:36,794 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:36,794 - DEBUG - Policy Targets: [0.         0.88888889 0.         0.         0.         0.
 0.         0.         0.         0.         0.11111111 0.
 0.         0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:36,794 - DEBUG - === End of Training Data ===
2024-10-22 17:00:36,794 - INFO - Chosen Action: (Discard 1) | Visit Count: 8
2024-10-22 17:00:36,795 - DEBUG - Not the current player's turn.
2024-10-22 17:00:38,520 - INFO - Agent state has been reset.
2024-10-22 17:00:38,520 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:38,520 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || BX|B1235
XX || XX|RYGW12345
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3}
2024-10-22 17:00:38,520 - INFO - Max Rollouts: 10
2024-10-22 17:00:38,520 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:38,521 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:38,521 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:38,739 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:38,739 - DEBUG - Network Policy Logits: [[ 0.02442461  0.01577853  0.01935744 -0.06635667 -0.00907473  0.03851456
   0.02700757  0.02576448  0.00068713  0.04422855 -0.01636591 -0.03299885
  -0.01394163 -0.02427546  0.03781972  0.03322915 -0.03424334 -0.04035121
   0.01827819 -0.03535443]]
2024-10-22 17:00:38,740 - DEBUG - Network Policy after Softmax: [[0.05118023 0.05073963 0.05092155 0.04673868 0.04949412 0.05190646
  0.0513126  0.05124885 0.04997965 0.0522039  0.04913457 0.04832407
  0.04925383 0.04874747 0.05187041 0.05163284 0.04826397 0.04797008
  0.05086662 0.04821038]]
2024-10-22 17:00:38,741 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50182277 0.
  0.         0.         0.         0.         0.49817723 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:38,741 - DEBUG - Dirichlet Noise Added: [0.        0.        0.        0.        0.6263671 0.        0.
 0.        0.        0.        0.3736329 0.        0.        0.
 0.        0.        0.        0.        0.        0.       ]
2024-10-22 17:00:38,742 - DEBUG - Added Child Node: ((Reveal player +1 color R),) | P=0.37363290786743164
2024-10-22 17:00:38,742 - DEBUG - Added Child Node: ((Discard 4),) | P=0.6263670921325684
2024-10-22 17:00:38,743 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:38,743 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:38,743 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || BX|B1235
XX || XX|RYGW12345
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3}
2024-10-22 17:00:38,743 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:38,743 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:38,743 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:38,743 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R),)
2024-10-22 17:00:38,743 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)']
2024-10-22 17:00:38,744 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:38,933 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:38,934 - DEBUG - Network Policy Logits: [[-0.00950593  0.00974729  0.02586892 -0.06641985 -0.0136616   0.06066315
   0.03245652  0.0200368   0.01704687  0.01078141 -0.02217629 -0.00608321
  -0.03589665  0.0124767   0.0488348  -0.01468891 -0.01895517 -0.03328463
  -0.01233105 -0.07004812]]
2024-10-22 17:00:38,934 - DEBUG - Network Policy after Softmax: [[0.0496614  0.05062681 0.05144961 0.0469139  0.04945545 0.05327126
  0.05178966 0.05115042 0.05099771 0.05067919 0.04903614 0.04983167
  0.04836794 0.05076518 0.05264486 0.04940467 0.04919435 0.04849445
  0.0495213  0.04674399]]
2024-10-22 17:00:38,935 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3337726  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.33201042 0.
  0.33421698 0.        ]]
2024-10-22 17:00:38,936 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 4)) | P=0.33377259969711304
2024-10-22 17:00:38,937 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 2)) | P=0.332010418176651
2024-10-22 17:00:38,938 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 4)) | P=0.33421698212623596
2024-10-22 17:00:38,938 - DEBUG - Simulating Node: ((Reveal player +1 color R),) | Value: 0.0
2024-10-22 17:00:38,938 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:38,938 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B2 || BX|B1235
W4 || XX|RYGW12345
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3}
2024-10-22 17:00:38,938 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:38,938 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:38,938 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:38,939 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:00:38,939 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:00:38,939 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:39,138 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:39,138 - DEBUG - Network Policy Logits: [[ 0.02115199  0.01800583  0.02187128 -0.05140969 -0.00724079  0.0562817
   0.02714318  0.02802198 -0.00679745  0.04561675 -0.02106116  0.0056293
  -0.02429913 -0.01032892  0.03210301  0.00668354 -0.01031908 -0.05076433
  -0.00640077 -0.05832212]]
2024-10-22 17:00:39,138 - DEBUG - Network Policy after Softmax: [[0.05100481 0.05084459 0.05104151 0.0474349  0.04957701 0.05282844
  0.05131131 0.05135642 0.049599   0.05226802 0.04889655 0.0502192
  0.04873848 0.04942415 0.05156644 0.05027217 0.04942463 0.04746553
  0.04961867 0.04710814]]
2024-10-22 17:00:39,140 - DEBUG - Normalized Policy: [[0.         0.50708073 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.49291927 0.
  0.         0.        ]]
2024-10-22 17:00:39,141 - DEBUG - Added Child Node: ((Discard 4), (Discard 1)) | P=0.5070807337760925
2024-10-22 17:00:39,142 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 2)) | P=0.49291926622390747
2024-10-22 17:00:39,142 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:00:39,142 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:39,142 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B2 || BX|B1235
W2 || XX|RYGWB12345
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3}
2024-10-22 17:00:39,142 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:39,142 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:39,142 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:39,143 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5498989224433899 | PUCT: 0.5498989224433899
2024-10-22 17:00:39,144 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.9218636155128479 | PUCT: 0.9218636155128479
2024-10-22 17:00:39,144 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.9218636155128479
2024-10-22 17:00:39,144 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:39,144 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 2))
2024-10-22 17:00:39,144 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 2))']
2024-10-22 17:00:39,145 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:39,146 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 2
2024-10-22 17:00:39,347 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:39,347 - DEBUG - Network Policy Logits: [[ 0.00900412  0.02461626 -0.01549501 -0.0776978  -0.02601621  0.04717726
   0.03388599  0.02351046 -0.01487196  0.05789119 -0.00436029 -0.03357928
  -0.01604788 -0.0307566   0.04127108  0.00355998 -0.04778777 -0.0394782
   0.01314503 -0.02521479]]
2024-10-22 17:00:39,348 - DEBUG - Network Policy after Softmax: [[0.05061767 0.05141412 0.04939265 0.04641389 0.0488757  0.05258726
  0.05189293 0.0513573  0.04942343 0.0531537  0.0499457  0.04850744
  0.04936535 0.04864456 0.05227758 0.05034285 0.04782311 0.04822215
  0.05082771 0.04891489]]
2024-10-22 17:00:39,349 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.49458623 0.
  0.         0.         0.         0.         0.5054138  0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:39,349 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 2), (Reveal player +1 color R)) | P=0.5054137706756592
2024-10-22 17:00:39,350 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 2), (Discard 4)) | P=0.4945862293243408
2024-10-22 17:00:39,350 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 2)) | Value: 0.0
2024-10-22 17:00:39,350 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:39,350 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || BX|B135
XX || XX|RYGWB1345
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 G3}
2024-10-22 17:00:39,350 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:39,350 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:39,350 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:39,351 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5925052762031555 | PUCT: 0.5925052762031555
2024-10-22 17:00:39,351 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6621933579444885 | PUCT: 0.6621933579444885
2024-10-22 17:00:39,352 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.6621933579444885
2024-10-22 17:00:39,352 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:39,352 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 1))
2024-10-22 17:00:39,352 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 1))']
2024-10-22 17:00:39,352 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:39,353 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:39,560 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:39,560 - DEBUG - Network Policy Logits: [[-0.01677347  0.02994473  0.00759533 -0.03712154 -0.02995702  0.05462133
   0.00885742  0.00532445  0.01748077  0.06993122 -0.02546235 -0.0219612
  -0.04234073 -0.00428009  0.0172451   0.01835879  0.00209908 -0.03609491
   0.04878497 -0.01259474]]
2024-10-22 17:00:39,560 - DEBUG - Network Policy after Softmax: [[0.04901309 0.05135723 0.05022215 0.04802585 0.04837117 0.05264032
  0.05028558 0.05010824 0.05072109 0.05345244 0.04858907 0.04875949
  0.04777585 0.04962928 0.05070914 0.05076564 0.04994688 0.04807518
  0.05233398 0.04921833]]
2024-10-22 17:00:39,562 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.32743868 0.
  0.         0.         0.         0.         0.32891372 0.
  0.         0.         0.         0.34364757 0.         0.
  0.         0.        ]]
2024-10-22 17:00:39,562 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Reveal player +1 color R)) | P=0.32891371846199036
2024-10-22 17:00:39,563 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Discard 4)) | P=0.32743868231773376
2024-10-22 17:00:39,564 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Reveal player +1 rank 1)) | P=0.3436475694179535
2024-10-22 17:00:39,564 - DEBUG - Simulating Node: ((Discard 4), (Discard 1)) | Value: 0.0
2024-10-22 17:00:39,564 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:39,564 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'R', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || BX|B1235
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
W1 || XX|RYGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 R1 Y4}
2024-10-22 17:00:39,564 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:39,564 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:39,564 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:39,565 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.6251654624938965 | PUCT: 0.6251654624938965
2024-10-22 17:00:39,565 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5240211486816406 | PUCT: 0.5240211486816406
2024-10-22 17:00:39,565 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.6251654624938965
2024-10-22 17:00:39,565 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:00:39,565 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Reveal player +1 rank 2))
2024-10-22 17:00:39,565 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Reveal player +1 rank 2))']
2024-10-22 17:00:39,566 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:39,566 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 2
2024-10-22 17:00:39,751 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:39,751 - DEBUG - Network Policy Logits: [[ 0.01012328  0.00687274  0.03199579 -0.05661244 -0.0191771   0.00096274
   0.00850037  0.00231969  0.00988601  0.02584897 -0.01381233 -0.03262275
  -0.0141302  -0.00297826  0.01436286  0.01697929 -0.0271787  -0.03070482
   0.01487457  0.00633761]]
2024-10-22 17:00:39,751 - DEBUG - Network Policy after Softmax: [[0.05061868 0.05045441 0.05173803 0.04735086 0.04915705 0.0501571
  0.0505366  0.05022521 0.05060667 0.05142099 0.04942148 0.04850053
  0.04940577 0.04995982 0.05083374 0.05096691 0.04876529 0.04859364
  0.05085976 0.05042742]]
2024-10-22 17:00:39,752 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:39,753 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 2), (Discard 4)) | P=1.0
2024-10-22 17:00:39,753 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Reveal player +1 rank 2)) | Value: 0.0
2024-10-22 17:00:39,753 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:39,753 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 24, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': 1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || BX|B135
XX || X2|RYGW2
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
Deck size: 24
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3}
2024-10-22 17:00:39,753 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:39,753 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:39,753 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:39,754 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.4343354403972626 | PUCT: 0.4343354403972626
2024-10-22 17:00:39,754 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5460976958274841 | PUCT: 0.5460976958274841
2024-10-22 17:00:39,754 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.5460976958274841
2024-10-22 17:00:39,754 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:39,755 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 2)) | Q: 0.0 | U: 0.7254600524902344 | PUCT: 0.7254600524902344
2024-10-22 17:00:39,755 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 1)) | Q: 0.0 | U: 0.7463024258613586 | PUCT: 0.7463024258613586
2024-10-22 17:00:39,755 - DEBUG - Selected Child: ((Discard 4), (Discard 1)) | PUCT: 0.7463024258613586
2024-10-22 17:00:39,755 - DEBUG - Selected child for exploration: ((Discard 4), (Discard 1))
2024-10-22 17:00:39,755 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 1), (Reveal player +1 color R))
2024-10-22 17:00:39,755 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 1))', '((Discard 4), (Discard 1), (Reveal player +1 color R))']
2024-10-22 17:00:39,756 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:39,757 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:39,757 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 3
2024-10-22 17:00:39,953 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:39,953 - DEBUG - Network Policy Logits: [[ 0.03639111 -0.01314866  0.01306104 -0.06302994  0.00616196  0.05018819
   0.04128536  0.04146546 -0.02243233  0.01156399 -0.04215243 -0.02966134
  -0.05534494 -0.01152365  0.03714738 -0.01502132  0.01264603 -0.04256557
  -0.01716158 -0.05371176]]
2024-10-22 17:00:39,954 - DEBUG - Network Policy after Softmax: [[0.05212273 0.0496035  0.05092078 0.04718991 0.05057069 0.05284686
  0.05237846 0.05238789 0.04914513 0.05084461 0.04818548 0.04879114
  0.04755396 0.04968417 0.05216217 0.0495107  0.05089965 0.04816557
  0.04940485 0.04763169]]
2024-10-22 17:00:39,956 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24766259 0.         0.
  0.         0.         0.         0.         0.         0.
  0.2495732  0.         0.         0.         0.         0.25278306
  0.         0.24998114]]
2024-10-22 17:00:39,956 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Reveal player +1 color R), (Discard 3)) | P=0.24766258895397186
2024-10-22 17:00:39,957 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Reveal player +1 color R), (Reveal player +1 rank 5)) | P=0.2499811351299286
2024-10-22 17:00:39,957 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Reveal player +1 color R), (Reveal player +1 rank 3)) | P=0.25278306007385254
2024-10-22 17:00:39,958 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Reveal player +1 color R), (Reveal player +1 color G)) | P=0.24957320094108582
2024-10-22 17:00:39,958 - DEBUG - Simulating Node: ((Discard 4), (Discard 1), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:00:39,958 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:39,958 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
XX || XX|YGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || BX|B1235
G3 || XX|RYGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 W2 Y4}
2024-10-22 17:00:39,958 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:39,959 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:39,959 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:39,959 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.4489905834197998 | PUCT: 0.4489905834197998
2024-10-22 17:00:39,960 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.45161908864974976 | PUCT: 0.45161908864974976
2024-10-22 17:00:39,960 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.45161908864974976
2024-10-22 17:00:39,960 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:39,961 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 2)) | Q: 0.0 | U: 0.781669020652771 | PUCT: 0.781669020652771
2024-10-22 17:00:39,961 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 1)) | Q: 0.0 | U: 0.5360841751098633 | PUCT: 0.5360841751098633
2024-10-22 17:00:39,961 - DEBUG - Selected Child: ((Discard 4), (Reveal player +1 rank 2)) | PUCT: 0.781669020652771
2024-10-22 17:00:39,961 - DEBUG - Selected child for exploration: ((Discard 4), (Reveal player +1 rank 2))
2024-10-22 17:00:39,961 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 2), (Discard 4))
2024-10-22 17:00:39,962 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 2))', '((Discard 4), (Reveal player +1 rank 2), (Discard 4))']
2024-10-22 17:00:39,962 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:39,963 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 2
2024-10-22 17:00:39,964 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:00:40,162 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:40,162 - DEBUG - Network Policy Logits: [[ 0.01321362  0.02739407  0.01616194 -0.04878288 -0.02786409  0.05798276
   0.03610347  0.02589954 -0.01086956  0.0388857  -0.02508171  0.01255304
  -0.03808866 -0.01212326  0.0421314   0.00373083 -0.00996295 -0.054655
  -0.00985909 -0.06185898]]
2024-10-22 17:00:40,162 - DEBUG - Network Policy after Softmax: [[0.05070023 0.05142431 0.05084993 0.04765245 0.04865978 0.05302161
  0.05187414 0.05134751 0.0494938  0.05201866 0.04879535 0.05066675
  0.04816478 0.04943178 0.05218777 0.05022173 0.04953869 0.04737345
  0.04954383 0.0470334 ]]
2024-10-22 17:00:40,164 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33091468 0.
  0.         0.         0.         0.         0.         0.
  0.32754844 0.         0.         0.34153682 0.         0.
  0.         0.        ]]
2024-10-22 17:00:40,164 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 2), (Discard 4), (Discard 4)) | P=0.3309146761894226
2024-10-22 17:00:40,165 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 2), (Discard 4), (Reveal player +1 rank 1)) | P=0.34153681993484497
2024-10-22 17:00:40,166 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 2), (Discard 4), (Reveal player +1 color G)) | P=0.32754844427108765
2024-10-22 17:00:40,166 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 2), (Discard 4)) | Value: 0.0
2024-10-22 17:00:40,166 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:40,166 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 0}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B1 || BX|B135
G3 || XX|RYGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y4 G1}
2024-10-22 17:00:40,166 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:40,166 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:40,166 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:40,167 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.46153125166893005 | PUCT: 0.46153125166893005
2024-10-22 17:00:40,167 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3868609666824341 | PUCT: 0.3868609666824341
2024-10-22 17:00:40,168 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.46153125166893005
2024-10-22 17:00:40,168 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:00:40,168 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 4))
2024-10-22 17:00:40,168 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 4))']
2024-10-22 17:00:40,168 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:40,169 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:40,386 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:40,386 - DEBUG - Network Policy Logits: [[ 0.00635027  0.01095631  0.03105571 -0.0672247   0.00654356  0.02008552
   0.02710712  0.01191217  0.01529935  0.05090828 -0.0147439  -0.0308404
  -0.03337124 -0.00885867  0.01574495  0.03104875 -0.01594753 -0.02546292
   0.00460928 -0.01274628]]
2024-10-22 17:00:40,386 - DEBUG - Network Policy after Softmax: [[0.0502441  0.05047606 0.05150086 0.04668011 0.05025381 0.05093897
  0.05129791 0.05052433 0.05069575 0.0525335  0.04919534 0.0484098
  0.04828744 0.04948572 0.05071835 0.0515005  0.04913616 0.04867083
  0.0501567  0.04929371]]
2024-10-22 17:00:40,388 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33708987 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.32647166
  0.33643848 0.        ]]
2024-10-22 17:00:40,388 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 4), (Discard 4)) | P=0.337089866399765
2024-10-22 17:00:40,389 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 4), (Reveal player +1 rank 3)) | P=0.3264716565608978
2024-10-22 17:00:40,390 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 4), (Reveal player +1 rank 4)) | P=0.33643847703933716
2024-10-22 17:00:40,390 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 4)) | Value: 0.0
2024-10-22 17:00:40,390 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:40,390 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || BX|B1235
XX || XX|RYGW12345
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || R2|R2
R3 || RX|R12345
W4 || XX|RYGWB12345
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 G5}
2024-10-22 17:00:40,390 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:40,390 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:40,390 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:40,391 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.3543504476547241 | PUCT: 0.3543504476547241
2024-10-22 17:00:40,391 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.39602765440940857 | PUCT: 0.39602765440940857
2024-10-22 17:00:40,391 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.39602765440940857
2024-10-22 17:00:40,391 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:40,392 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 2)) | Q: 0.0 | U: 0.5498375296592712 | PUCT: 0.5498375296592712
2024-10-22 17:00:40,392 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 1)) | Q: 0.0 | U: 0.5656343102455139 | PUCT: 0.5656343102455139
2024-10-22 17:00:40,392 - DEBUG - Selected Child: ((Discard 4), (Discard 1)) | PUCT: 0.5656343102455139
2024-10-22 17:00:40,392 - DEBUG - Selected child for exploration: ((Discard 4), (Discard 1))
2024-10-22 17:00:40,392 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 1), (Discard 4))
2024-10-22 17:00:40,392 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 1))', '((Discard 4), (Discard 1), (Discard 4))']
2024-10-22 17:00:40,393 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:40,394 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:40,394 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:00:40,580 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:40,581 - DEBUG - Network Policy Logits: [[ 0.05136137 -0.00796475  0.01210197 -0.05473178  0.00151773  0.04509311
   0.04192521  0.0336521  -0.01229529  0.03576714 -0.01390542 -0.01852692
  -0.06184732  0.00388434  0.05785582  0.00214114 -0.0174389  -0.05767964
   0.01737273 -0.04669441]]
2024-10-22 17:00:40,581 - DEBUG - Network Policy after Softmax: [[0.05257052 0.04954243 0.05054662 0.04727882 0.05001445 0.05224203
  0.05207679 0.05164773 0.04932835 0.05175709 0.04924899 0.04902191
  0.0469436  0.05013296 0.05291305 0.05004564 0.04907527 0.04713966
  0.05081375 0.04766035]]
2024-10-22 17:00:40,582 - DEBUG - Normalized Policy: [[0.         0.         0.         0.31469384 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.352196   0.33311012 0.         0.
  0.         0.        ]]
2024-10-22 17:00:40,583 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Discard 4), (Discard 3)) | P=0.3146938383579254
2024-10-22 17:00:40,584 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Discard 4), (Reveal player +1 rank 1)) | P=0.33311012387275696
2024-10-22 17:00:40,584 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Discard 4), (Reveal player +1 color B)) | P=0.35219600796699524
2024-10-22 17:00:40,585 - DEBUG - Simulating Node: ((Discard 4), (Discard 1), (Discard 4)) | Value: 0.0
2024-10-22 17:00:40,585 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:40,585 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B1 || BX|B1235
B2 || XX|RYGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y4 Y4 B1}
2024-10-22 17:00:40,585 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:40,585 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:40,585 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:40,585 - DEBUG - Best node chosen by MCTS: ((Discard 4),) | Visit Count: 6
2024-10-22 17:00:40,585 - INFO - Actual Game Score: 4
2024-10-22 17:00:40,585 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:40,585 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:40,585 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.66666667 0.
 0.         0.         0.         0.         0.33333333 0.
 0.         0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:40,585 - DEBUG - === End of Training Data ===
2024-10-22 17:00:40,586 - INFO - Chosen Action: (Discard 4) | Visit Count: 6
2024-10-22 17:00:40,586 - DEBUG - Not the current player's turn.
2024-10-22 17:00:42,433 - INFO - Agent state has been reset.
2024-10-22 17:00:42,433 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:42,433 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || XX|RYGWB1234
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3}
2024-10-22 17:00:42,433 - INFO - Max Rollouts: 10
2024-10-22 17:00:42,433 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:42,434 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:42,434 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:42,613 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:42,614 - DEBUG - Network Policy Logits: [[ 0.01377529  0.00957767  0.01077881 -0.08251095 -0.01010584  0.05142518
   0.0147482   0.01810042  0.00113329  0.02208075 -0.01133097 -0.03429975
  -0.01360383 -0.04781832  0.04825997  0.00656396 -0.02839866 -0.02673705
   0.02501552 -0.03118313]]
2024-10-22 17:00:42,614 - DEBUG - Network Policy after Softmax: [[0.05083201 0.05061908 0.05067991 0.04616583 0.04963246 0.05278231
  0.05088148 0.05105234 0.05019343 0.05125595 0.04957169 0.04844606
  0.04945915 0.04779555 0.05261551 0.05046676 0.04873279 0.04881384
  0.05140659 0.04859729]]
2024-10-22 17:00:42,615 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50030625 0.
  0.         0.         0.         0.         0.4996937  0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:42,615 - DEBUG - Dirichlet Noise Added: [0.        0.        0.        0.        0.3752297 0.        0.
 0.        0.        0.        0.6247703 0.        0.        0.
 0.        0.        0.        0.        0.        0.       ]
2024-10-22 17:00:42,616 - DEBUG - Added Child Node: ((Reveal player +1 color R),) | P=0.6247702836990356
2024-10-22 17:00:42,616 - DEBUG - Added Child Node: ((Discard 4),) | P=0.37522968649864197
2024-10-22 17:00:42,617 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:42,617 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:42,617 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || XX|RYGWB1234
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3}
2024-10-22 17:00:42,617 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:42,617 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:42,617 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:42,617 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R),)
2024-10-22 17:00:42,617 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)']
2024-10-22 17:00:42,618 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:42,796 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:42,796 - DEBUG - Network Policy Logits: [[-0.01227495  0.00575655  0.03569959 -0.07937224 -0.01703358  0.0353488
   0.05067093  0.0163014   0.01212959  0.01173666 -0.01876808 -0.00648773
  -0.02418575 -0.00382916  0.03771553 -0.01581066 -0.01801587 -0.02376831
  -0.0096535  -0.04269914]]
2024-10-22 17:00:42,796 - DEBUG - Network Policy after Softmax: [[0.04953279 0.05043405 0.05196703 0.04631832 0.04929764 0.0519488
  0.0527509  0.05096868 0.05075649 0.05073655 0.04921221 0.04982028
  0.04894631 0.04995291 0.0520719  0.04935797 0.04924924 0.04896675
  0.04966281 0.04804849]]
2024-10-22 17:00:42,797 - DEBUG - Normalized Policy: [[0.         0.5038525  0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.49614757 0.        ]]
2024-10-22 17:00:42,797 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 1)) | P=0.5038524866104126
2024-10-22 17:00:42,798 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 4)) | P=0.4961475729942322
2024-10-22 17:00:42,798 - DEBUG - Simulating Node: ((Reveal player +1 color R),) | Value: 0.0
2024-10-22 17:00:42,798 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:42,798 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
W4 || XX|RYGWB1234
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3}
2024-10-22 17:00:42,798 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:42,798 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:42,798 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:42,799 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:00:42,799 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:00:42,799 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:43,001 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:43,002 - DEBUG - Network Policy Logits: [[ 0.01067053  0.01953052  0.02909034 -0.05501575 -0.01280571  0.04438569
   0.04146889  0.02776423 -0.00616804  0.04845599 -0.02328668  0.0011378
  -0.03255143 -0.02207193  0.03327892  0.02035091 -0.00491396 -0.05677637
  -0.008771   -0.04233024]]
2024-10-22 17:00:43,002 - DEBUG - Network Policy after Softmax: [[0.05048217 0.05093143 0.05142066 0.04727275 0.04931084 0.0522132
  0.05206113 0.05135252 0.04963924 0.05242616 0.04879672 0.05000322
  0.04834671 0.04885603 0.05163649 0.05097323 0.04970153 0.04718959
  0.0495102  0.04787625]]
2024-10-22 17:00:43,004 - DEBUG - Normalized Policy: [[0.         0.34773138 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.3300844  0.         0.         0.         0.         0.32218423
  0.         0.        ]]
2024-10-22 17:00:43,004 - DEBUG - Added Child Node: ((Discard 4), (Discard 1)) | P=0.3477313816547394
2024-10-22 17:00:43,005 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3)) | P=0.3221842348575592
2024-10-22 17:00:43,006 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color G)) | P=0.3300844132900238
2024-10-22 17:00:43,006 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:00:43,006 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:43,006 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
G3 || XX|RYGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y2}
2024-10-22 17:00:43,006 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:43,006 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:43,006 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:43,007 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.919513463973999 | PUCT: 0.919513463973999
2024-10-22 17:00:43,008 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.552249014377594 | PUCT: 0.552249014377594
2024-10-22 17:00:43,008 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.919513463973999
2024-10-22 17:00:43,009 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:00:43,009 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 1))
2024-10-22 17:00:43,009 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 1))']
2024-10-22 17:00:43,009 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:43,010 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:43,206 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:43,207 - DEBUG - Network Policy Logits: [[-0.02117532  0.00667868  0.02046646 -0.06077991 -0.01682485  0.02771977
   0.00160088  0.0270972   0.01095615  0.03657338  0.01111052 -0.03915207
  -0.02122197 -0.02342924  0.00563078 -0.00758254  0.01315978 -0.03096022
   0.06422962 -0.04311915]]
2024-10-22 17:00:43,207 - DEBUG - Network Policy after Softmax: [[0.04902633 0.05041111 0.05111098 0.04712261 0.04924009 0.05148305
  0.05015578 0.05145101 0.05062721 0.05194088 0.05063502 0.04815287
  0.04902405 0.04891596 0.05035831 0.04969729 0.05073889 0.04854896
  0.05339742 0.04796223]]
2024-10-22 17:00:43,208 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.5035338  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.49646622
  0.         0.        ]]
2024-10-22 17:00:43,209 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 1), (Discard 4)) | P=0.5035337805747986
2024-10-22 17:00:43,209 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 1), (Reveal player +1 rank 3)) | P=0.4964662194252014
2024-10-22 17:00:43,209 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 1)) | Value: 0.0
2024-10-22 17:00:43,209 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:43,209 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || XX|RYGWB1234
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
B4 || XX|RYGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y4}
2024-10-22 17:00:43,209 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:43,209 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:43,209 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:43,210 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.6605051159858704 | PUCT: 0.6605051159858704
2024-10-22 17:00:43,210 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5950374603271484 | PUCT: 0.5950374603271484
2024-10-22 17:00:43,210 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.6605051159858704
2024-10-22 17:00:43,211 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:00:43,211 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Reveal player +1 rank 4))
2024-10-22 17:00:43,211 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Reveal player +1 rank 4))']
2024-10-22 17:00:43,211 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:43,212 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:43,404 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:43,405 - DEBUG - Network Policy Logits: [[-0.0066772   0.01433411  0.00891661 -0.05211128 -0.02216481  0.01467523
   0.01191606  0.00553504 -0.00138758  0.02663854 -0.00276145 -0.04370822
  -0.01023179 -0.01318195  0.01683991  0.00866638 -0.02839556 -0.03494225
   0.0167373   0.01155751]]
2024-10-22 17:00:43,405 - DEBUG - Network Policy after Softmax: [[0.04985414 0.05091272 0.05063764 0.04763975 0.04908797 0.05093009
  0.05078976 0.0504667  0.05011855 0.05154304 0.05004974 0.04804175
  0.04967724 0.0495309  0.05104046 0.05062497 0.04878306 0.04846473
  0.05103522 0.05077155]]
2024-10-22 17:00:43,406 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:43,407 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 4), (Discard 4)) | P=1.0
2024-10-22 17:00:43,407 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:00:43,407 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:43,407 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 23, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': 3}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || X4|RYGWB4
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
Deck size: 23
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3}
2024-10-22 17:00:43,407 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:43,407 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:43,407 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:43,408 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5226852297782898 | PUCT: 0.5226852297782898
2024-10-22 17:00:43,409 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6278372406959534 | PUCT: 0.6278372406959534
2024-10-22 17:00:43,409 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.6278372406959534
2024-10-22 17:00:43,409 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:43,409 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 3))
2024-10-22 17:00:43,409 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 3))']
2024-10-22 17:00:43,410 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:43,410 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:43,410 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:43,410 - DEBUG - Rollout #6 completed with reward=4
2024-10-22 17:00:43,410 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:43,411 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5447055101394653 | PUCT: 0.5447055101394653
2024-10-22 17:00:43,411 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 2.0 | U: 0.4361916482448578 | PUCT: 2.4361915588378906
2024-10-22 17:00:43,411 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 2.4361915588378906
2024-10-22 17:00:43,411 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:43,411 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 color G))
2024-10-22 17:00:43,411 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 color G))']
2024-10-22 17:00:43,412 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:43,413 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 2
2024-10-22 17:00:43,623 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:43,623 - DEBUG - Network Policy Logits: [[ 0.01154463  0.00978182 -0.01125462 -0.08555758 -0.01676046  0.03969389
   0.02098906  0.01494362 -0.02279923  0.02882048 -0.00588903 -0.0395214
  -0.0283792  -0.02942485  0.03901453 -0.00417042 -0.03588583 -0.02932967
   0.0227408  -0.01258069]]
2024-10-22 17:00:43,623 - DEBUG - Network Policy after Softmax: [[0.05089752 0.05080787 0.04975022 0.04618763 0.04947706 0.0523506
  0.0513805  0.05107081 0.04917918 0.05178446 0.05001788 0.04836363
  0.04890553 0.04885441 0.05231505 0.05010391 0.04853978 0.04885906
  0.05147058 0.04968429]]
2024-10-22 17:00:43,625 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.49728215 0.
  0.         0.         0.         0.         0.50271785 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:43,625 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color G), (Reveal player +1 color R)) | P=0.5027178525924683
2024-10-22 17:00:43,626 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color G), (Discard 4)) | P=0.49728214740753174
2024-10-22 17:00:43,626 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 color G)) | Value: 0.0
2024-10-22 17:00:43,626 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:43,626 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || XX|RYWB12345
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 W2}
2024-10-22 17:00:43,626 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:43,626 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:43,626 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:43,626 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5630846619606018 | PUCT: 0.5630846619606018
2024-10-22 17:00:43,627 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 1.3333333333333333 | U: 0.3381820619106293 | PUCT: 1.6715154647827148
2024-10-22 17:00:43,627 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 1.6715154647827148
2024-10-22 17:00:43,627 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:43,627 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 1))
2024-10-22 17:00:43,627 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 1))']
2024-10-22 17:00:43,628 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:43,628 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:43,819 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:43,820 - DEBUG - Network Policy Logits: [[-0.0101081   0.02336734 -0.00871237 -0.04436275 -0.02583982  0.05647161
   0.00904805  0.01522425  0.02554652  0.04476629 -0.03402695 -0.01542098
  -0.03260463 -0.02112367  0.03405771 -0.00031102 -0.00801474 -0.04527643
   0.04698588  0.00310864]]
2024-10-22 17:00:43,820 - DEBUG - Network Policy after Softmax: [[0.04944335 0.0511265  0.0495124  0.04777836 0.0486716  0.05284733
  0.05039962 0.05071186 0.05123803 0.05223234 0.04827475 0.04918135
  0.04834346 0.04890169 0.05167599 0.04993013 0.04954696 0.04773473
  0.0523484  0.05010116]]
2024-10-22 17:00:43,822 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33640614 0.
  0.         0.         0.         0.         0.3336632  0.
  0.         0.         0.         0.         0.         0.3299307
  0.         0.        ]]
2024-10-22 17:00:43,822 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Reveal player +1 color R)) | P=0.3336631953716278
2024-10-22 17:00:43,823 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Discard 4)) | P=0.3364061415195465
2024-10-22 17:00:43,824 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Reveal player +1 rank 3)) | P=0.32993069291114807
2024-10-22 17:00:43,824 - DEBUG - Simulating Node: ((Discard 4), (Discard 1)) | Value: 0.0
2024-10-22 17:00:43,824 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:43,824 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 3}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
G3 || XX|RYGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y4 Y4}
2024-10-22 17:00:43,824 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:43,824 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:43,824 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:43,825 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5788121223449707 | PUCT: 0.5788121223449707
2024-10-22 17:00:43,825 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 1.0 | U: 0.27810221910476685 | PUCT: 1.278102159500122
2024-10-22 17:00:43,825 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 1.278102159500122
2024-10-22 17:00:43,825 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:43,826 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 3)) | Q: 4.0 | U: 0.5109182596206665 | PUCT: 4.510918140411377
2024-10-22 17:00:43,827 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 color G)) | Q: 0.0 | U: 0.5234463214874268 | PUCT: 0.5234463214874268
2024-10-22 17:00:43,827 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 1)) | Q: 0.0 | U: 0.5514307618141174 | PUCT: 0.5514307618141174
2024-10-22 17:00:43,827 - DEBUG - Selected Child: ((Discard 4), (Reveal player +1 rank 3)) | PUCT: 4.510918140411377
2024-10-22 17:00:43,828 - DEBUG - Selected child for exploration: ((Discard 4), (Reveal player +1 rank 3))
2024-10-22 17:00:43,828 - DEBUG - Node ((Discard 4), (Reveal player +1 rank 3)) is a leaf node.
2024-10-22 17:00:43,828 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 3))']
2024-10-22 17:00:43,828 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:43,828 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:43,828 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:43,828 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:00:43,828 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:43,829 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5925270915031433 | PUCT: 0.5925270915031433
2024-10-22 17:00:43,829 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 1.6 | U: 0.23724322021007538 | PUCT: 1.8372431993484497
2024-10-22 17:00:43,829 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 1.8372431993484497
2024-10-22 17:00:43,830 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:43,830 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 3)) | Q: 4.0 | U: 0.35938742756843567 | PUCT: 4.359387397766113
2024-10-22 17:00:43,831 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 color G)) | Q: 0.0 | U: 0.5522997975349426 | PUCT: 0.5522997975349426
2024-10-22 17:00:43,831 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 1)) | Q: 0.0 | U: 0.5818268060684204 | PUCT: 0.5818268060684204
2024-10-22 17:00:43,831 - DEBUG - Selected Child: ((Discard 4), (Reveal player +1 rank 3)) | PUCT: 4.359387397766113
2024-10-22 17:00:43,831 - DEBUG - Selected child for exploration: ((Discard 4), (Reveal player +1 rank 3))
2024-10-22 17:00:43,831 - DEBUG - Node ((Discard 4), (Reveal player +1 rank 3)) is a leaf node.
2024-10-22 17:00:43,831 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 3))']
2024-10-22 17:00:43,832 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:43,832 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:43,832 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:43,832 - DEBUG - Rollout #10 completed with reward=4
2024-10-22 17:00:43,832 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:43,832 - DEBUG - Best node chosen by MCTS: ((Discard 4),) | Visit Count: 6
2024-10-22 17:00:43,832 - INFO - Actual Game Score: 4
2024-10-22 17:00:43,832 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:43,832 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:43,833 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.66666667 0.
 0.         0.         0.         0.         0.33333333 0.
 0.         0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:43,833 - DEBUG - === End of Training Data ===
2024-10-22 17:00:43,833 - INFO - Chosen Action: (Discard 4) | Visit Count: 6
2024-10-22 17:00:43,833 - DEBUG - Not the current player's turn.
2024-10-22 17:00:45,033 - INFO - Agent state has been reset.
2024-10-22 17:00:45,033 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:45,033 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': 1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || X2|RYGWB2
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1}
2024-10-22 17:00:45,033 - INFO - Max Rollouts: 10
2024-10-22 17:00:45,033 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:45,034 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:45,034 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:45,238 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:45,238 - DEBUG - Network Policy Logits: [[ 0.01715165  0.00314062  0.00880798 -0.08177516 -0.00743985  0.02705124
   0.01443513  0.00656058 -0.00262506  0.02273799 -0.02236217 -0.04728594
  -0.00447455 -0.01232498  0.04103629 -0.00138747 -0.02898444 -0.01441458
   0.02487824  0.00267785]]
2024-10-22 17:00:45,238 - DEBUG - Network Policy after Softmax: [[0.0509854  0.05027603 0.05056177 0.04618304 0.04974689 0.05149264
  0.05084709 0.05044826 0.04998698 0.05127103 0.04901006 0.04780364
  0.04989462 0.04950446 0.05221783 0.05004888 0.04868657 0.04940112
  0.05138087 0.05025277]]
2024-10-22 17:00:45,240 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50373054 0.
  0.         0.         0.         0.         0.4962695  0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:45,240 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.6277979  0.
 0.         0.         0.         0.         0.37220213 0.
 0.         0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:45,241 - DEBUG - Added Child Node: ((Reveal player +1 color R),) | P=0.3722021281719208
2024-10-22 17:00:45,242 - DEBUG - Added Child Node: ((Discard 4),) | P=0.6277979016304016
2024-10-22 17:00:45,242 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:45,242 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:45,242 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': 1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || X2|RYGWB2
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1}
2024-10-22 17:00:45,242 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:45,242 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:45,242 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:45,242 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R),)
2024-10-22 17:00:45,242 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)']
2024-10-22 17:00:45,243 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:45,430 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:45,431 - DEBUG - Network Policy Logits: [[-0.0156877   0.01659413  0.02984999 -0.06130587 -0.02217284  0.01729753
   0.02502715  0.01783811  0.01785521  0.01117706 -0.00425847  0.01248824
  -0.02771361  0.00961514  0.03648639 -0.00956317 -0.00427652 -0.04056594
  -0.02639353 -0.05866227]]
2024-10-22 17:00:45,431 - DEBUG - Network Policy after Softmax: [[0.04939124 0.05101169 0.0516924  0.04718873 0.04907197 0.05104759
  0.0514437  0.05107519 0.05107607 0.05073611 0.04995899 0.05080268
  0.04880083 0.05065693 0.05203659 0.04969467 0.04995808 0.04817763
  0.04886529 0.04731363]]
2024-10-22 17:00:45,432 - DEBUG - Normalized Policy: [[0.         0.50521296 0.         0.         0.         0.
  0.         0.         0.         0.         0.49478707 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:45,433 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color R)) | P=0.4947870671749115
2024-10-22 17:00:45,434 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 1)) | P=0.5052129626274109
2024-10-22 17:00:45,434 - DEBUG - Simulating Node: ((Reveal player +1 color R),) | Value: 0.0
2024-10-22 17:00:45,434 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:45,434 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': 1}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || X2|RYGWB2
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1}
2024-10-22 17:00:45,434 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:45,434 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:45,434 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:45,434 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:00:45,434 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:00:45,435 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:45,627 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:45,628 - DEBUG - Network Policy Logits: [[ 0.0041623   0.01881137  0.03376624 -0.05057355 -0.00869328  0.04349981
   0.03998017  0.02843075  0.00366949  0.04963233 -0.03700292  0.01514514
  -0.02525574 -0.01484895  0.02066518  0.01389516 -0.0023495  -0.05997802
  -0.00355107 -0.04888467]]
2024-10-22 17:00:45,628 - DEBUG - Network Policy after Softmax: [[0.05013212 0.05087191 0.05163841 0.04746183 0.04949176 0.05214349
  0.05196029 0.05136362 0.05010741 0.05246424 0.04811032 0.05068574
  0.04867881 0.04918804 0.0509663  0.05062243 0.04980673 0.04701757
  0.04974691 0.04754206]]
2024-10-22 17:00:45,629 - DEBUG - Normalized Policy: [[0.       0.511015 0.       0.       0.       0.       0.       0.
  0.       0.       0.       0.       0.488985 0.       0.       0.
  0.       0.       0.       0.      ]]
2024-10-22 17:00:45,630 - DEBUG - Added Child Node: ((Discard 4), (Discard 1)) | P=0.511014997959137
2024-10-22 17:00:45,630 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color G)) | P=0.48898500204086304
2024-10-22 17:00:45,630 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:00:45,630 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:45,630 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'G', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || X2|RGW2
XX || XX|RGWB12345
XX || XX|RYGWB12345
-----
B2 || B2|B2
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
G1 || XX|RYGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2}
2024-10-22 17:00:45,630 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:45,631 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:45,631 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:45,631 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5477931499481201 | PUCT: 0.5477931499481201
2024-10-22 17:00:45,632 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.9239693880081177 | PUCT: 0.9239693880081177
2024-10-22 17:00:45,632 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.9239693880081177
2024-10-22 17:00:45,632 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:45,632 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 color G))
2024-10-22 17:00:45,632 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 color G))']
2024-10-22 17:00:45,633 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:45,633 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 2
2024-10-22 17:00:45,821 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:45,821 - DEBUG - Network Policy Logits: [[ 0.00820115  0.005589   -0.01110387 -0.08409873 -0.01588604  0.03387976
   0.02267795  0.01574269 -0.02080979  0.03324088 -0.01323776 -0.02932261
  -0.02629821 -0.02935029  0.03785489 -0.00215871 -0.04086892 -0.03553744
   0.02034024 -0.01044494]]
2024-10-22 17:00:45,822 - DEBUG - Network Policy after Softmax: [[0.05074784 0.05061545 0.04977755 0.04627348 0.04954007 0.05206785
  0.05148785 0.051132   0.04929674 0.05203459 0.04967144 0.04887887
  0.04902693 0.04887752 0.05227524 0.05022481 0.04831775 0.04857604
  0.05136763 0.04981036]]
2024-10-22 17:00:45,823 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.49933794 0.
  0.         0.         0.         0.         0.5006621  0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:45,824 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color G), (Reveal player +1 color R)) | P=0.500662088394165
2024-10-22 17:00:45,825 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color G), (Discard 4)) | P=0.49933794140815735
2024-10-22 17:00:45,825 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 color G)) | Value: 0.0
2024-10-22 17:00:45,825 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:45,825 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || XX|RYWB12345
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 W2}
2024-10-22 17:00:45,825 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:45,825 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:45,825 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:45,826 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5902363657951355 | PUCT: 0.5902363657951355
2024-10-22 17:00:45,826 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6637059450149536 | PUCT: 0.6637059450149536
2024-10-22 17:00:45,826 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.6637059450149536
2024-10-22 17:00:45,826 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:45,826 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 1))
2024-10-22 17:00:45,826 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 1))']
2024-10-22 17:00:45,827 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:45,828 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:46,015 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:46,015 - DEBUG - Network Policy Logits: [[-0.02380581  0.01525734 -0.01103283 -0.04185392 -0.01694274  0.05349055
   0.00331033  0.0104674   0.02486261  0.05580449 -0.02461061 -0.00613585
  -0.02875674 -0.00961845  0.0346851   0.00098473  0.00438998 -0.05522585
   0.04771284  0.00165554]]
2024-10-22 17:00:46,016 - DEBUG - Network Policy after Softmax: [[0.04871764 0.05065837 0.0493439  0.04784627 0.04905315 0.0526327
  0.05005675 0.0504163  0.0511473  0.05275463 0.04867845 0.04958613
  0.04847704 0.04941374 0.05165216 0.04994047 0.05011082 0.04721073
  0.05232948 0.04997399]]
2024-10-22 17:00:46,017 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50191694 0.
  0.         0.         0.         0.         0.49808303 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:46,018 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Reveal player +1 color R)) | P=0.4980830252170563
2024-10-22 17:00:46,018 - DEBUG - Added Child Node: ((Discard 4), (Discard 1), (Discard 4)) | P=0.5019169449806213
2024-10-22 17:00:46,018 - DEBUG - Simulating Node: ((Discard 4), (Discard 1)) | Value: 0.0
2024-10-22 17:00:46,018 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:46,018 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || X2|RGW2
R3 || XX|RGWB12345
W3 || XX|RYGWB12345
R4 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 Y2 Y4}
2024-10-22 17:00:46,018 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:46,018 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:46,019 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:46,019 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.6227715015411377 | PUCT: 0.6227715015411377
2024-10-22 17:00:46,020 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.52521812915802 | PUCT: 0.52521812915802
2024-10-22 17:00:46,020 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.6227715015411377
2024-10-22 17:00:46,020 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:00:46,020 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Reveal player +1 color R))
2024-10-22 17:00:46,020 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Reveal player +1 color R))']
2024-10-22 17:00:46,020 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:46,021 - DEBUG - Illegal move encountered: (Reveal player +1 color R)
2024-10-22 17:00:46,021 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:46,021 - DEBUG - Rollout #6 completed with reward=4
2024-10-22 17:00:46,021 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:46,021 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 2.0 | U: 0.4326722323894501 | PUCT: 2.4326722621917725
2024-10-22 17:00:46,022 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5473451614379883 | PUCT: 0.5473451614379883
2024-10-22 17:00:46,022 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 2.4326722621917725
2024-10-22 17:00:46,022 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:00:46,022 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 1))
2024-10-22 17:00:46,022 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 1))']
2024-10-22 17:00:46,023 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:46,023 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:46,212 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:46,212 - DEBUG - Network Policy Logits: [[-0.02044984 -0.00455175  0.01745961 -0.05099056 -0.00163664  0.01235384
  -0.0085785   0.02309276  0.01766961  0.02592286 -0.00764935 -0.02922924
  -0.01827717 -0.00275257  0.00367153 -0.0088164   0.00500961 -0.02865455
   0.06441975 -0.01466487]]
2024-10-22 17:00:46,213 - DEBUG - Network Policy after Softmax: [[0.04903891 0.04982477 0.05093364 0.04756387 0.04997023 0.05067425
  0.04962454 0.05122137 0.05094434 0.05136653 0.04967067 0.04861027
  0.04914558 0.0499145  0.05023618 0.04961274 0.05030345 0.04863821
  0.05338254 0.04932343]]
2024-10-22 17:00:46,214 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33713284 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.33472097 0.         0.32814616
  0.         0.        ]]
2024-10-22 17:00:46,215 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 1), (Discard 4)) | P=0.33713284134864807
2024-10-22 17:00:46,215 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 1), (Reveal player +1 rank 1)) | P=0.3347209692001343
2024-10-22 17:00:46,216 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 1), (Reveal player +1 rank 3)) | P=0.32814615964889526
2024-10-22 17:00:46,216 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 1)) | Value: 0.0
2024-10-22 17:00:46,216 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:46,216 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': None, 'rank': 1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || X2|RYGWB2
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
B1 || XX|RYGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 Y4}
2024-10-22 17:00:46,216 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:46,216 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:46,216 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:46,217 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 1.3333333333333333 | U: 0.33545342087745667 | PUCT: 1.6687867641448975
2024-10-22 17:00:46,217 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5658133625984192 | PUCT: 0.5658133625984192
2024-10-22 17:00:46,217 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 1.6687867641448975
2024-10-22 17:00:46,217 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:00:46,218 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Reveal player +1 color R)) | Q: 4.0 | U: 0.7282090783119202 | PUCT: 4.728209018707275
2024-10-22 17:00:46,218 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 1)) | Q: 0.0 | U: 0.7435535192489624 | PUCT: 0.7435535192489624
2024-10-22 17:00:46,218 - DEBUG - Selected Child: ((Reveal player +1 color R), (Reveal player +1 color R)) | PUCT: 4.728209018707275
2024-10-22 17:00:46,218 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Reveal player +1 color R))
2024-10-22 17:00:46,218 - DEBUG - Node ((Reveal player +1 color R), (Reveal player +1 color R)) is a leaf node.
2024-10-22 17:00:46,218 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Reveal player +1 color R))']
2024-10-22 17:00:46,219 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:46,219 - DEBUG - Illegal move encountered: (Reveal player +1 color R)
2024-10-22 17:00:46,219 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:46,219 - DEBUG - Rollout #8 completed with reward=4
2024-10-22 17:00:46,219 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:46,220 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 2.0 | U: 0.2758583426475525 | PUCT: 2.2758584022521973
2024-10-22 17:00:46,220 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.581616997718811 | PUCT: 0.581616997718811
2024-10-22 17:00:46,220 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 2.2758584022521973
2024-10-22 17:00:46,220 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:00:46,221 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Reveal player +1 color R)) | Q: 4.0 | U: 0.5230873227119446 | PUCT: 4.523087501525879
2024-10-22 17:00:46,221 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 1)) | Q: 0.0 | U: 0.8011643290519714 | PUCT: 0.8011643290519714
2024-10-22 17:00:46,221 - DEBUG - Selected Child: ((Reveal player +1 color R), (Reveal player +1 color R)) | PUCT: 4.523087501525879
2024-10-22 17:00:46,221 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Reveal player +1 color R))
2024-10-22 17:00:46,221 - DEBUG - Node ((Reveal player +1 color R), (Reveal player +1 color R)) is a leaf node.
2024-10-22 17:00:46,222 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Reveal player +1 color R))']
2024-10-22 17:00:46,222 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:46,222 - DEBUG - Illegal move encountered: (Reveal player +1 color R)
2024-10-22 17:00:46,222 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:46,222 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:00:46,222 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:46,223 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 2.4 | U: 0.23532898724079132 | PUCT: 2.635329008102417
2024-10-22 17:00:46,223 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5953984260559082 | PUCT: 0.5953984260559082
2024-10-22 17:00:46,224 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 2.635329008102417
2024-10-22 17:00:46,224 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:00:46,224 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Reveal player +1 color R)) | Q: 4.0 | U: 0.41394078731536865 | PUCT: 4.413940906524658
2024-10-22 17:00:46,224 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 1)) | Q: 0.0 | U: 0.8453262448310852 | PUCT: 0.8453262448310852
2024-10-22 17:00:46,224 - DEBUG - Selected Child: ((Reveal player +1 color R), (Reveal player +1 color R)) | PUCT: 4.413940906524658
2024-10-22 17:00:46,225 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Reveal player +1 color R))
2024-10-22 17:00:46,225 - DEBUG - Node ((Reveal player +1 color R), (Reveal player +1 color R)) is a leaf node.
2024-10-22 17:00:46,225 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Reveal player +1 color R))']
2024-10-22 17:00:46,225 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:00:46,226 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:00:46,414 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:46,414 - DEBUG - Network Policy Logits: [[-0.00332972  0.00498416  0.01288585 -0.05696079 -0.01400269  0.00288729
   0.00534533  0.00017024  0.00855562  0.02807065 -0.01484591 -0.03490287
  -0.00869716 -0.00857255  0.00711666  0.00051932 -0.0192507  -0.03125278
   0.01628715  0.02993207]]
2024-10-22 17:00:46,414 - DEBUG - Network Policy after Softmax: [[0.05001071 0.05042822 0.05082827 0.04739923 0.04947978 0.0503226
  0.05044644 0.05018605 0.05060865 0.05160597 0.04943808 0.04845638
  0.049743   0.0497492  0.05053588 0.05020357 0.04922079 0.04863357
  0.05100145 0.05170213]]
2024-10-22 17:00:46,415 - DEBUG - Normalized Policy: [[1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:46,416 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color R), (Discard 0)) | P=1.0
2024-10-22 17:00:46,416 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:00:46,416 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:46,416 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1}
2024-10-22 17:00:46,416 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:46,416 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:46,416 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:46,417 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color R),) | Visit Count: 6
2024-10-22 17:00:46,417 - INFO - Actual Game Score: 4
2024-10-22 17:00:46,417 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:46,417 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:46,417 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.33333333 0.
 0.         0.         0.         0.         0.66666667 0.
 0.         0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:00:46,417 - DEBUG - === End of Training Data ===
2024-10-22 17:00:46,417 - INFO - Chosen Action: (Reveal player +1 color R) | Visit Count: 6
2024-10-22 17:00:46,418 - DEBUG - Not the current player's turn.
2024-10-22 17:00:48,439 - INFO - Agent state has been reset.
2024-10-22 17:00:48,439 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:48,439 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1}
2024-10-22 17:00:48,439 - INFO - Max Rollouts: 10
2024-10-22 17:00:48,439 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:48,439 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:48,439 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:48,649 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:48,650 - DEBUG - Network Policy Logits: [[ 0.00583643  0.00229198  0.02897771 -0.06212497 -0.01631701  0.00449225
   0.00888921  0.00630694  0.00775747  0.01152049 -0.01135324 -0.0336062
   0.01049344  0.00105669  0.01373435  0.00532961 -0.01959376 -0.02666409
   0.022519    0.03050497]]
2024-10-22 17:00:48,650 - DEBUG - Network Policy after Softmax: [[0.0503059  0.05012791 0.05148362 0.04700063 0.04920371 0.05023833
  0.05045971 0.05032958 0.05040263 0.05059266 0.04944855 0.04836033
  0.05054072 0.05006603 0.05070479 0.05028041 0.04904274 0.04869722
  0.05115217 0.05156231]]
2024-10-22 17:00:48,651 - DEBUG - Normalized Policy: [[1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:48,652 - DEBUG - Dirichlet Noise Added: [1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2024-10-22 17:00:48,653 - DEBUG - Added Child Node: ((Discard 0),) | P=1.0
2024-10-22 17:00:48,653 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:48,653 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:48,653 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 22, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B2|B2
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
Deck size: 22
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1}
2024-10-22 17:00:48,653 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:48,653 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:48,653 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:48,654 - DEBUG - Expanding unexplored child: ((Discard 0),)
2024-10-22 17:00:48,654 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 17:00:48,654 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:48,872 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:48,873 - DEBUG - Network Policy Logits: [[-0.01408746  0.00114463  0.02958562 -0.06316419 -0.00205542  0.03484563
   0.01878558  0.01453065 -0.01008634  0.01795072 -0.01750459  0.0149013
  -0.02555959 -0.00747993  0.03712566 -0.01611616 -0.00290134 -0.03433118
  -0.01717414 -0.03753949]]
2024-10-22 17:00:48,873 - DEBUG - Network Policy after Softmax: [[0.0494803  0.05023976 0.05168914 0.04711059 0.05007925 0.05196174
  0.0511339  0.05091679 0.04967867 0.05109123 0.04931151 0.05093567
  0.0489159  0.04980832 0.05208035 0.04938002 0.0500369  0.04848871
  0.04932781 0.04833339]]
2024-10-22 17:00:48,875 - DEBUG - Normalized Policy: [[0.        0.5096698 0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.4903302]]
2024-10-22 17:00:48,875 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 5)) | P=0.49033018946647644
2024-10-22 17:00:48,876 - DEBUG - Added Child Node: ((Discard 0), (Discard 1)) | P=0.5096697807312012
2024-10-22 17:00:48,877 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 17:00:48,877 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:48,877 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || XX|RYGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2}
2024-10-22 17:00:48,877 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:48,877 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:48,877 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:48,878 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 1.3101838827133179 | PUCT: 1.3101838827133179
2024-10-22 17:00:48,878 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 1.3101838827133179
2024-10-22 17:00:48,878 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:00:48,878 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 rank 5))
2024-10-22 17:00:48,878 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 rank 5))']
2024-10-22 17:00:48,878 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:48,879 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 2
2024-10-22 17:00:49,088 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:49,088 - DEBUG - Network Policy Logits: [[ 0.00182828 -0.00908495  0.0394312  -0.06011727 -0.02429682  0.01379218
   0.01494808 -0.00309671  0.00798918  0.01164041  0.00407632 -0.00711363
  -0.0276522  -0.03725479  0.01515802 -0.01495703  0.00375805 -0.03438035
  -0.00564931 -0.01069318]]
2024-10-22 17:00:49,088 - DEBUG - Network Policy after Softmax: [[0.05038493 0.04983806 0.05231563 0.04735852 0.04908567 0.05099136
  0.05105033 0.0501374  0.05069631 0.05088175 0.05049833 0.04993641
  0.04892124 0.04845372 0.05106105 0.04954626 0.05048226 0.0485932
  0.05000958 0.04975798]]
2024-10-22 17:00:49,090 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:49,091 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 5), (Discard 4)) | P=1.0
2024-10-22 17:00:49,091 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 rank 5)) | Value: 0.0
2024-10-22 17:00:49,091 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:49,091 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 21, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB1234
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
Deck size: 21
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2}
2024-10-22 17:00:49,091 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:49,091 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:49,091 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:49,092 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.9811750054359436 | PUCT: 0.9811750054359436
2024-10-22 17:00:49,092 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.9811750054359436
2024-10-22 17:00:49,092 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:00:49,092 - DEBUG - Expanding unexplored child: ((Discard 0), (Discard 1))
2024-10-22 17:00:49,092 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Discard 1))']
2024-10-22 17:00:49,093 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:49,093 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:49,294 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:49,295 - DEBUG - Network Policy Logits: [[-0.02444749 -0.00413302  0.01923463 -0.0628065  -0.00639572  0.0282663
   0.00522242  0.0194865   0.01306384  0.02662297  0.02266248 -0.00412041
  -0.02528909 -0.01688847  0.01142172 -0.03879448  0.02963872 -0.0466143
   0.03979161 -0.04122436]]
2024-10-22 17:00:49,295 - DEBUG - Network Policy after Softmax: [[0.04890767 0.04991136 0.05109141 0.04706715 0.04979856 0.05155494
  0.05038049 0.05110428 0.0507771  0.05147029 0.05126684 0.04991199
  0.04886653 0.04927876 0.05069379 0.048211   0.05162574 0.04783547
  0.05215256 0.048094  ]]
2024-10-22 17:00:49,297 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.334441   0.
  0.         0.         0.         0.         0.34430185 0.
  0.         0.         0.         0.         0.         0.32125714
  0.         0.        ]]
2024-10-22 17:00:49,297 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Reveal player +1 color R)) | P=0.34430184960365295
2024-10-22 17:00:49,298 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Discard 4)) | P=0.33444100618362427
2024-10-22 17:00:49,299 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Reveal player +1 rank 3)) | P=0.3212571442127228
2024-10-22 17:00:49,299 - DEBUG - Simulating Node: ((Discard 0), (Discard 1)) | Value: 0.0
2024-10-22 17:00:49,299 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:49,299 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
R4 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4}
2024-10-22 17:00:49,299 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:49,299 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:49,299 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:49,300 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.792897641658783 | PUCT: 0.792897641658783
2024-10-22 17:00:49,300 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.792897641658783
2024-10-22 17:00:49,300 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:00:49,301 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 5)) | Q: 0.0 | U: 0.7216495871543884 | PUCT: 0.7216495871543884
2024-10-22 17:00:49,301 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Discard 1)) | Q: 0.0 | U: 0.7501128911972046 | PUCT: 0.7501128911972046
2024-10-22 17:00:49,302 - DEBUG - Selected Child: ((Discard 0), (Discard 1)) | PUCT: 0.7501128911972046
2024-10-22 17:00:49,302 - DEBUG - Selected child for exploration: ((Discard 0), (Discard 1))
2024-10-22 17:00:49,302 - DEBUG - Expanding unexplored child: ((Discard 0), (Discard 1), (Discard 4))
2024-10-22 17:00:49,302 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Discard 1))', '((Discard 0), (Discard 1), (Discard 4))']
2024-10-22 17:00:49,302 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:49,303 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:49,304 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:00:49,510 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:49,510 - DEBUG - Network Policy Logits: [[ 0.04651351 -0.01352363  0.01603582 -0.06009722  0.01610797  0.04988512
   0.02928281  0.02653946 -0.02712938  0.03118449 -0.04259733  0.00219368
  -0.0333328  -0.02411163  0.00723076 -0.01417977  0.02221527 -0.04507183
  -0.02523842 -0.02451897]]
2024-10-22 17:00:49,511 - DEBUG - Network Policy after Softmax: [[0.05251915 0.04945884 0.05094264 0.04720818 0.05094631 0.05269653
  0.05162196 0.05148054 0.04879047 0.05172022 0.04804159 0.05024234
  0.04848874 0.04893793 0.05049605 0.0494264  0.05125841 0.04792286
  0.04888282 0.048918  ]]
2024-10-22 17:00:49,512 - DEBUG - Normalized Policy: [[0.         0.         0.         0.47943348 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.5205665  0.
  0.         0.        ]]
2024-10-22 17:00:49,513 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Discard 4), (Discard 3)) | P=0.47943347692489624
2024-10-22 17:00:49,514 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Discard 4), (Reveal player +1 rank 2)) | P=0.5205665230751038
2024-10-22 17:00:49,514 - DEBUG - Simulating Node: ((Discard 0), (Discard 1), (Discard 4)) | Value: 0.0
2024-10-22 17:00:49,514 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:49,514 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 19, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y2 || XX|RYGWB12345
Deck size: 19
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1}
2024-10-22 17:00:49,514 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:49,514 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:49,514 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:49,515 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.6692830920219421 | PUCT: 0.6692830920219421
2024-10-22 17:00:49,515 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.6692830920219421
2024-10-22 17:00:49,515 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:00:49,515 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 5)) | Q: 0.0 | U: 0.7775632739067078 | PUCT: 0.7775632739067078
2024-10-22 17:00:49,516 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Discard 1)) | Q: 0.0 | U: 0.538821280002594 | PUCT: 0.538821280002594
2024-10-22 17:00:49,516 - DEBUG - Selected Child: ((Discard 0), (Reveal player +1 rank 5)) | PUCT: 0.7775632739067078
2024-10-22 17:00:49,516 - DEBUG - Selected child for exploration: ((Discard 0), (Reveal player +1 rank 5))
2024-10-22 17:00:49,516 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 rank 5), (Discard 4))
2024-10-22 17:00:49,516 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 rank 5))', '((Discard 0), (Reveal player +1 rank 5), (Discard 4))']
2024-10-22 17:00:49,517 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:49,518 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 2
2024-10-22 17:00:49,518 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:00:49,723 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:49,723 - DEBUG - Network Policy Logits: [[-1.32421404e-02  1.29702613e-02  3.34856398e-02 -6.39097095e-02
  -9.81418416e-05  3.08468062e-02  1.41634718e-02  2.03672610e-02
  -3.66622675e-03  1.58028230e-02 -1.51737230e-02  1.66337751e-02
  -2.46081166e-02 -1.30027905e-02  4.53672186e-02 -1.97135247e-02
  -8.92826356e-04 -3.91529091e-02 -1.11833895e-02 -3.62564027e-02]]
2024-10-22 17:00:49,724 - DEBUG - Network Policy after Softmax: [[0.04945169 0.05076507 0.05181729 0.04700851 0.05010597 0.05168074
  0.05082568 0.05114197 0.0499275  0.05090907 0.04935626 0.05095139
  0.0488928  0.04946352 0.05243663 0.0491327  0.05006617 0.04818681
  0.0495536  0.04832659]]
2024-10-22 17:00:49,725 - DEBUG - Normalized Policy: [[0.         0.5060381  0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.49396187 0.        ]]
2024-10-22 17:00:49,726 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 5), (Discard 4), (Discard 1)) | P=0.5060381293296814
2024-10-22 17:00:49,727 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 5), (Discard 4), (Reveal player +1 rank 4)) | P=0.4939618706703186
2024-10-22 17:00:49,727 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 rank 5), (Discard 4)) | Value: 0.0
2024-10-22 17:00:49,727 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:49,727 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || Y4|Y4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B4 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 B1}
2024-10-22 17:00:49,727 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:49,727 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:49,727 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:49,728 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.5812328457832336 | PUCT: 0.5812328457832336
2024-10-22 17:00:49,728 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.5812328457832336
2024-10-22 17:00:49,728 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:00:49,728 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 5)) | Q: 0.0 | U: 0.5469495058059692 | PUCT: 0.5469495058059692
2024-10-22 17:00:49,729 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Discard 1)) | Q: 0.0 | U: 0.5685222744941711 | PUCT: 0.5685222744941711
2024-10-22 17:00:49,729 - DEBUG - Selected Child: ((Discard 0), (Discard 1)) | PUCT: 0.5685222744941711
2024-10-22 17:00:49,729 - DEBUG - Selected child for exploration: ((Discard 0), (Discard 1))
2024-10-22 17:00:49,729 - DEBUG - Expanding unexplored child: ((Discard 0), (Discard 1), (Reveal player +1 rank 3))
2024-10-22 17:00:49,729 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Discard 1))', '((Discard 0), (Discard 1), (Reveal player +1 rank 3))']
2024-10-22 17:00:49,730 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:49,730 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:49,731 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 3
2024-10-22 17:00:49,936 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:49,936 - DEBUG - Network Policy Logits: [[ 0.00496566 -0.00794375 -0.00216726 -0.0532569   0.00990352  0.03080557
   0.01972201  0.00847213 -0.03178416  0.026049   -0.02399097  0.01313593
  -0.03463287 -0.01748045  0.01002634 -0.02557043  0.01573492 -0.04082075
   0.00130987 -0.03531867]]
2024-10-22 17:00:49,937 - DEBUG - Network Policy after Softmax: [[0.05056937 0.04992074 0.05020995 0.04770916 0.05081969 0.05189311
  0.05132113 0.050747   0.04874469 0.05164686 0.04912605 0.05098423
  0.04860603 0.04944693 0.05082593 0.04904852 0.05111691 0.04830619
  0.05038484 0.0485727 ]]
2024-10-22 17:00:49,938 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50214845 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.4978516  0.        ]]
2024-10-22 17:00:49,939 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Reveal player +1 rank 3), (Discard 4)) | P=0.502148449420929
2024-10-22 17:00:49,939 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Reveal player +1 rank 3), (Reveal player +1 rank 4)) | P=0.4978516101837158
2024-10-22 17:00:49,939 - DEBUG - Simulating Node: ((Discard 0), (Discard 1), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:00:49,939 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:49,940 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || X3|YGWB3
XX || XX|RYGWB1245
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
R4 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4}
2024-10-22 17:00:49,940 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:49,940 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:49,940 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:49,941 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.5150095820426941 | PUCT: 0.5150095820426941
2024-10-22 17:00:49,941 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.5150095820426941
2024-10-22 17:00:49,941 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:00:49,941 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 5)) | Q: 0.0 | U: 0.5699920058250427 | PUCT: 0.5699920058250427
2024-10-22 17:00:49,942 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Discard 1)) | Q: 0.0 | U: 0.44435521960258484 | PUCT: 0.44435521960258484
2024-10-22 17:00:49,942 - DEBUG - Selected Child: ((Discard 0), (Reveal player +1 rank 5)) | PUCT: 0.5699920058250427
2024-10-22 17:00:49,942 - DEBUG - Selected child for exploration: ((Discard 0), (Reveal player +1 rank 5))
2024-10-22 17:00:49,943 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 5), (Discard 4)) | Q: 0.0 | U: 1.3101838827133179 | PUCT: 1.3101838827133179
2024-10-22 17:00:49,943 - DEBUG - Selected Child: ((Discard 0), (Reveal player +1 rank 5), (Discard 4)) | PUCT: 1.3101838827133179
2024-10-22 17:00:49,943 - DEBUG - Selected child for exploration: ((Discard 0), (Reveal player +1 rank 5), (Discard 4))
2024-10-22 17:00:49,943 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 rank 5), (Discard 4), (Reveal player +1 rank 4))
2024-10-22 17:00:49,943 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 rank 5))', '((Discard 0), (Reveal player +1 rank 5), (Discard 4))', '((Discard 0), (Reveal player +1 rank 5), (Discard 4), (Reveal player +1 rank 4))']
2024-10-22 17:00:49,944 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:49,944 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 2
2024-10-22 17:00:49,945 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:00:49,945 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 4
2024-10-22 17:00:50,165 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:50,166 - DEBUG - Network Policy Logits: [[ 0.00700084 -0.0013899   0.03436993 -0.07569136 -0.00703964  0.02468195
   0.01917206  0.00196297  0.01394699  0.01272666 -0.00729603  0.01104336
  -0.01794958 -0.03299681  0.02074513 -0.01961044  0.00049428 -0.04422151
  -0.0004761   0.00939081]]
2024-10-22 17:00:50,166 - DEBUG - Network Policy after Softmax: [[0.05046436 0.0500427  0.0518646  0.04645923 0.04976077 0.05136456
  0.05108233 0.05021077 0.05081611 0.05075414 0.04974801 0.05066878
  0.04922083 0.04848574 0.05116275 0.04913915 0.05013708 0.04794455
  0.05008845 0.05058511]]
2024-10-22 17:00:50,167 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:50,168 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 5), (Discard 4), (Reveal player +1 rank 4), (Discard 4)) | P=1.0
2024-10-22 17:00:50,168 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 rank 5), (Discard 4), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:00:50,168 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:50,168 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB1235
-----
B4 || B4|B4
Y4 || Y4|Y4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 W4}
2024-10-22 17:00:50,168 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:50,169 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:50,169 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:50,170 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.46321994066238403 | PUCT: 0.46321994066238403
2024-10-22 17:00:50,170 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.46321994066238403
2024-10-22 17:00:50,170 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:00:50,170 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 5)) | Q: 0.0 | U: 0.441918283700943 | PUCT: 0.441918283700943
2024-10-22 17:00:50,171 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Discard 1)) | Q: 0.0 | U: 0.4593484401702881 | PUCT: 0.4593484401702881
2024-10-22 17:00:50,171 - DEBUG - Selected Child: ((Discard 0), (Discard 1)) | PUCT: 0.4593484401702881
2024-10-22 17:00:50,171 - DEBUG - Selected child for exploration: ((Discard 0), (Discard 1))
2024-10-22 17:00:50,171 - DEBUG - Expanding unexplored child: ((Discard 0), (Discard 1), (Reveal player +1 color R))
2024-10-22 17:00:50,171 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Discard 1))', '((Discard 0), (Discard 1), (Reveal player +1 color R))']
2024-10-22 17:00:50,172 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:50,172 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 2
2024-10-22 17:00:50,173 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 3
2024-10-22 17:00:50,388 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:50,389 - DEBUG - Network Policy Logits: [[ 0.02730036 -0.0165651   0.01606301 -0.05714068  0.01823149  0.05406414
   0.01630225  0.04177787 -0.0363798   0.01638482 -0.04578283 -0.01073567
  -0.03399713 -0.01668405  0.02538354 -0.0217897   0.02523398 -0.03833346
  -0.02499364 -0.02502613]]
2024-10-22 17:00:50,389 - DEBUG - Network Policy after Softmax: [[0.05158229 0.04936852 0.05100589 0.04740546 0.05111661 0.05298147
  0.0510181  0.05233451 0.04839993 0.05102231 0.04794695 0.04965715
  0.04851539 0.04936265 0.05148351 0.04911126 0.05147582 0.04830546
  0.04895417 0.04895258]]
2024-10-22 17:00:50,391 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32496342 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.3383799  0.         0.33665666 0.         0.
  0.         0.        ]]
2024-10-22 17:00:50,392 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Reveal player +1 color R), (Reveal player +1 color W)) | P=0.3383798897266388
2024-10-22 17:00:50,392 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Reveal player +1 color R), (Reveal player +1 rank 1)) | P=0.3366566598415375
2024-10-22 17:00:50,393 - DEBUG - Added Child Node: ((Discard 0), (Discard 1), (Reveal player +1 color R), (Discard 3)) | P=0.32496342062950134
2024-10-22 17:00:50,393 - DEBUG - Simulating Node: ((Discard 0), (Discard 1), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:00:50,393 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:50,393 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
XX || XX|YGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W1 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4}
2024-10-22 17:00:50,393 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:50,393 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:50,394 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:50,394 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.42150750756263733 | PUCT: 0.42150750756263733
2024-10-22 17:00:50,394 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.42150750756263733
2024-10-22 17:00:50,394 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:00:50,395 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 5)) | Q: 0.0 | U: 0.45426145195961 | PUCT: 0.45426145195961
2024-10-22 17:00:50,396 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Discard 1)) | Q: 0.0 | U: 0.377742737531662 | PUCT: 0.377742737531662
2024-10-22 17:00:50,396 - DEBUG - Selected Child: ((Discard 0), (Reveal player +1 rank 5)) | PUCT: 0.45426145195961
2024-10-22 17:00:50,396 - DEBUG - Selected child for exploration: ((Discard 0), (Reveal player +1 rank 5))
2024-10-22 17:00:50,396 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 5), (Discard 4)) | Q: 0.0 | U: 0.9811750054359436 | PUCT: 0.9811750054359436
2024-10-22 17:00:50,396 - DEBUG - Selected Child: ((Discard 0), (Reveal player +1 rank 5), (Discard 4)) | PUCT: 0.9811750054359436
2024-10-22 17:00:50,396 - DEBUG - Selected child for exploration: ((Discard 0), (Reveal player +1 rank 5), (Discard 4))
2024-10-22 17:00:50,396 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 rank 5), (Discard 4), (Discard 1))
2024-10-22 17:00:50,396 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 rank 5))', '((Discard 0), (Reveal player +1 rank 5), (Discard 4))', '((Discard 0), (Reveal player +1 rank 5), (Discard 4), (Discard 1))']
2024-10-22 17:00:50,397 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:00:50,398 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 2
2024-10-22 17:00:50,398 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:00:50,399 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 4
2024-10-22 17:00:50,610 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:50,611 - DEBUG - Network Policy Logits: [[-0.02060246 -0.01228042  0.01691835 -0.060763   -0.00523004  0.03022011
   0.00650118  0.01538077  0.0225793   0.02488597  0.01821435 -0.00217218
  -0.02271872 -0.01038696  0.01656453 -0.03491504  0.03254558 -0.04200907
   0.04238852 -0.03549937]]
2024-10-22 17:00:50,611 - DEBUG - Network Policy after Softmax: [[0.04901178 0.04942136 0.05088568 0.04708244 0.04977103 0.05156707
  0.05035834 0.05080749 0.05117455 0.05129273 0.05095167 0.04992345
  0.04890817 0.04951502 0.05086767 0.04831529 0.05168712 0.04797375
  0.05219839 0.04828706]]
2024-10-22 17:00:50,612 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.5091937  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.49080628
  0.         0.        ]]
2024-10-22 17:00:50,613 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 5), (Discard 4), (Discard 1), (Discard 4)) | P=0.5091937184333801
2024-10-22 17:00:50,614 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 5), (Discard 4), (Discard 1), (Reveal player +1 rank 3)) | P=0.4908062815666199
2024-10-22 17:00:50,614 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 rank 5), (Discard 4), (Discard 1)) | Value: 0.0
2024-10-22 17:00:50,614 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:50,614 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 19, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
W4 || XX|RYGWB12345
Deck size: 19
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y2 Y4}
2024-10-22 17:00:50,614 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:50,614 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:00:50,614 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:50,614 - DEBUG - Best node chosen by MCTS: ((Discard 0),) | Visit Count: 9
2024-10-22 17:00:50,614 - INFO - Actual Game Score: 4
2024-10-22 17:00:50,615 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:50,615 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:50,615 - DEBUG - Policy Targets: [1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
2024-10-22 17:00:50,615 - DEBUG - === End of Training Data ===
2024-10-22 17:00:50,615 - INFO - Chosen Action: (Discard 0) | Visit Count: 9
2024-10-22 17:00:50,616 - DEBUG - Not the current player's turn.
2024-10-22 17:00:52,587 - INFO - Agent state has been reset.
2024-10-22 17:00:52,587 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:52,587 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
Y4 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4}
2024-10-22 17:00:52,587 - INFO - Max Rollouts: 10
2024-10-22 17:00:52,587 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:52,587 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:52,587 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:52,798 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:52,799 - DEBUG - Network Policy Logits: [[-0.01372322 -0.01171284  0.02152253 -0.06827739 -0.00686874  0.02094282
   0.01388946  0.02753813  0.02588564  0.02478627  0.02337039 -0.00991877
  -0.01499871 -0.01964255  0.02374528 -0.0345865   0.03997813 -0.044418
   0.04400008 -0.04020998]]
2024-10-22 17:00:52,799 - DEBUG - Network Policy after Softmax: [[0.04929286 0.04939206 0.05106121 0.04667577 0.0496319  0.05103161
  0.05067294 0.05136929 0.05128448 0.05122813 0.05115565 0.04948075
  0.04923003 0.04900194 0.05117483 0.0482751  0.05201232 0.04780281
  0.05222193 0.04800439]]
2024-10-22 17:00:52,801 - DEBUG - Normalized Policy: [[0.        0.        0.        0.        0.5093862 0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.4906138 0.        0.       ]]
2024-10-22 17:00:52,801 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.38203964 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.61796033
 0.         0.        ]
2024-10-22 17:00:52,802 - DEBUG - Added Child Node: ((Discard 4),) | P=0.3820396363735199
2024-10-22 17:00:52,802 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.6179603338241577
2024-10-22 17:00:52,802 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:52,803 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:52,803 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
Y4 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4}
2024-10-22 17:00:52,803 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:52,803 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:52,803 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:52,803 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:00:52,803 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:00:52,804 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:53,007 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:53,008 - DEBUG - Network Policy Logits: [[ 0.04073652 -0.01619766  0.01629765 -0.06237476  0.01095772  0.05588088
   0.03173982  0.02430598 -0.03116865  0.0277457  -0.04455613 -0.00038669
  -0.03632819 -0.02680501  0.01033898 -0.01521637  0.01969602 -0.04475813
  -0.02797892 -0.02384806]]
2024-10-22 17:00:53,008 - DEBUG - Network Policy after Softmax: [[0.05229216 0.04939812 0.05102969 0.04716892 0.05075792 0.05309012
  0.05182382 0.05143999 0.04866409 0.05161724 0.04801694 0.05018536
  0.04841365 0.0488769  0.05072653 0.04944662 0.0512034  0.04800724
  0.04881956 0.04902165]]
2024-10-22 17:00:53,009 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32849765 0.         0.
  0.         0.         0.         0.         0.         0.
  0.3371663  0.         0.         0.         0.         0.33433595
  0.         0.        ]]
2024-10-22 17:00:53,010 - DEBUG - Added Child Node: ((Discard 4), (Discard 3)) | P=0.32849764823913574
2024-10-22 17:00:53,011 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3)) | P=0.33433595299720764
2024-10-22 17:00:53,011 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color G)) | P=0.33716630935668945
2024-10-22 17:00:53,012 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:00:53,012 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:53,012 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 19, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|YGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G3 || XX|RYGWB12345
Deck size: 19
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1}
2024-10-22 17:00:53,012 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:53,012 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:53,012 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:53,012 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:00:53,012 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:00:53,013 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:53,234 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:53,235 - DEBUG - Network Policy Logits: [[ 0.0061575  -0.01114469 -0.00126146 -0.05427171  0.00651253  0.03495108
   0.02393575  0.00698066 -0.0234309   0.02132873 -0.02234234  0.01406359
  -0.03593367 -0.02071138  0.01713477 -0.02378184  0.01324797 -0.04390098
   0.00908438 -0.03826377]]
2024-10-22 17:00:53,235 - DEBUG - Network Policy after Softmax: [[0.05060037 0.04973241 0.05022636 0.04763319 0.05061834 0.05207852
  0.051508   0.05064204 0.04912512 0.0513739  0.04917862 0.05100201
  0.04851474 0.0492589  0.05115889 0.04910788 0.05096043 0.04812975
  0.05074869 0.04840183]]
2024-10-22 17:00:53,236 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.49734443 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.50265557 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:00:53,237 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 4)) | P=0.497344434261322
2024-10-22 17:00:53,238 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color B)) | P=0.502655565738678
2024-10-22 17:00:53,238 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:00:53,238 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:53,238 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || X3|YGWB3
XX || XX|RYGWB1245
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B3 || XX|RYGWB12345
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4}
2024-10-22 17:00:53,238 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:53,238 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:53,238 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:53,239 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5622715950012207 | PUCT: 0.5622715950012207
2024-10-22 17:00:53,240 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.9094908833503723 | PUCT: 0.9094908833503723
2024-10-22 17:00:53,240 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.9094908833503723
2024-10-22 17:00:53,240 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:00:53,240 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Reveal player +1 color B))
2024-10-22 17:00:53,240 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 color B))']
2024-10-22 17:00:53,241 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:53,241 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:00:53,450 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:53,451 - DEBUG - Network Policy Logits: [[-1.8784663e-02 -8.4276777e-05  2.8960662e-02 -3.0921375e-02
   7.6383865e-03  2.8718911e-02 -2.0571992e-02  5.7396106e-03
   6.3668462e-03 -2.2777356e-05  1.5820786e-02 -1.3655545e-02
  -2.3868792e-02  2.6867503e-02 -8.9255220e-05 -2.9072912e-02
   2.8642364e-02 -2.5172669e-02  5.1322185e-02 -1.9071029e-02]]
2024-10-22 17:00:53,451 - DEBUG - Network Policy after Softmax: [[0.04901058 0.04993572 0.05140737 0.04841935 0.05032285 0.05139494
  0.04892306 0.05022739 0.0502589  0.04993879 0.0507363  0.04926261
  0.04876203 0.05129988 0.04993547 0.04850893 0.05139101 0.0486985
  0.05256986 0.04899655]]
2024-10-22 17:00:53,452 - DEBUG - Normalized Policy: [[1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:00:53,453 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color B), (Discard 0)) | P=1.0
2024-10-22 17:00:53,453 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:00:53,453 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:53,453 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 0, 'num_players': 2, 'deck_size': 20, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 0
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
W3 || X3|YGWB3
Y4 || XX|RYGWB1245
Deck size: 20
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4}
2024-10-22 17:00:53,453 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:53,454 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:53,454 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:53,455 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6058366894721985 | PUCT: 0.6058366894721985
2024-10-22 17:00:53,456 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.65330570936203 | PUCT: 0.65330570936203
2024-10-22 17:00:53,456 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.65330570936203
2024-10-22 17:00:53,456 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:00:53,456 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Discard 4))
2024-10-22 17:00:53,456 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Discard 4))']
2024-10-22 17:00:53,457 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:53,458 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:00:53,679 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:53,680 - DEBUG - Network Policy Logits: [[ 0.00104351 -0.00058958  0.04277291 -0.03802506  0.0177745   0.03389066
   0.01817988  0.02174469  0.00804347  0.0137478   0.01401933  0.02316458
  -0.02943053  0.01468382 -0.00629995 -0.02302765  0.03055025 -0.02324788
   0.04509987 -0.04265277]]
2024-10-22 17:00:53,680 - DEBUG - Network Policy after Softmax: [[0.04973337 0.04965222 0.05185263 0.04782783 0.05057246 0.0513941
  0.05059297 0.05077364 0.05008273 0.05036923 0.05038291 0.05084579
  0.04824065 0.0504164  0.0493695  0.04855053 0.05122271 0.04853984
  0.05197343 0.04760701]]
2024-10-22 17:00:53,681 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.2529606  0.
  0.         0.         0.         0.         0.25201246 0.
  0.         0.25217998 0.         0.242847   0.         0.
  0.         0.        ]]
2024-10-22 17:00:53,682 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 4), (Reveal player +1 color R)) | P=0.2520124614238739
2024-10-22 17:00:53,683 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 4), (Reveal player +1 color W)) | P=0.25217998027801514
2024-10-22 17:00:53,683 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 4), (Discard 4)) | P=0.25296059250831604
2024-10-22 17:00:53,684 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 4), (Reveal player +1 rank 1)) | P=0.2428469955921173
2024-10-22 17:00:53,684 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Discard 4)) | Value: 0.0
2024-10-22 17:00:53,684 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:53,684 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 19, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
W3 || X3|YGWB3
R1 || XX|RYGWB12345
Deck size: 19
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 B1}
2024-10-22 17:00:53,684 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:53,684 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:53,684 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:53,685 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6392316818237305 | PUCT: 0.6392316818237305
2024-10-22 17:00:53,685 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.5169880390167236 | PUCT: 0.5169880390167236
2024-10-22 17:00:53,686 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.6392316818237305
2024-10-22 17:00:53,686 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:53,686 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 3))
2024-10-22 17:00:53,686 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 3))']
2024-10-22 17:00:53,686 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:53,687 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:53,913 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:53,913 - DEBUG - Network Policy Logits: [[-0.0199765  -0.00567346  0.03252978 -0.04613047 -0.01555438  0.04009461
   0.01666564  0.00670446  0.01507954  0.0378221   0.00607463 -0.00179309
  -0.03064486 -0.0178353   0.01463725 -0.02282569  0.0195762  -0.03979571
   0.02478212 -0.02812805]]
2024-10-22 17:00:53,914 - DEBUG - Network Policy after Softmax: [[0.04903063 0.04973696 0.05167384 0.04776491 0.04924794 0.05206622
  0.05086054 0.05035643 0.05077994 0.05194804 0.05032472 0.04993033
  0.04851034 0.04913573 0.05075748 0.04889113 0.05100879 0.04806845
  0.05127503 0.04863258]]
2024-10-22 17:00:53,915 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3368359  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.33439547 0.         0.3287687
  0.         0.        ]]
2024-10-22 17:00:53,916 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Discard 4)) | P=0.3368358910083771
2024-10-22 17:00:53,916 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Reveal player +1 rank 1)) | P=0.33439546823501587
2024-10-22 17:00:53,917 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Reveal player +1 rank 3)) | P=0.32876870036125183
2024-10-22 17:00:53,917 - DEBUG - Simulating Node: ((Discard 4), (Discard 3)) | Value: 0.0
2024-10-22 17:00:53,917 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:53,917 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 18, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|RYGWB12345
W1 || XX|RYGWB12345
Deck size: 18
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G3 Y4}
2024-10-22 17:00:53,917 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:53,918 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:53,918 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:53,918 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4441079795360565 | PUCT: 0.4441079795360565
2024-10-22 17:00:53,919 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.5387682914733887 | PUCT: 0.5387682914733887
2024-10-22 17:00:53,919 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.5387682914733887
2024-10-22 17:00:53,919 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:00:53,919 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Reveal player +1 color B)) | Q: 0.0 | U: 0.739789605140686 | PUCT: 0.739789605140686
2024-10-22 17:00:53,920 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Discard 4)) | Q: 0.0 | U: 0.7319729328155518 | PUCT: 0.7319729328155518
2024-10-22 17:00:53,920 - DEBUG - Selected Child: ((Reveal player +1 rank 3), (Reveal player +1 color B)) | PUCT: 0.739789605140686
2024-10-22 17:00:53,920 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3), (Reveal player +1 color B))
2024-10-22 17:00:53,920 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Reveal player +1 color B), (Discard 0))
2024-10-22 17:00:53,920 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 color B))', '((Reveal player +1 rank 3), (Reveal player +1 color B), (Discard 0))']
2024-10-22 17:00:53,921 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:53,921 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:00:53,922 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 3
2024-10-22 17:00:54,137 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:54,138 - DEBUG - Network Policy Logits: [[-0.02680608 -0.01277657 -0.00100934 -0.02921743 -0.02007581  0.03557654
   0.00423106  0.0382242   0.00050325  0.05004654 -0.02122469 -0.01745641
  -0.01517022 -0.02724377  0.03988769 -0.02681124  0.04025728 -0.02081678
   0.01165088 -0.02524283]]
2024-10-22 17:00:54,138 - DEBUG - Network Policy after Softmax: [[0.04871723 0.04940552 0.04999032 0.04859989 0.04904621 0.05185313
  0.05025298 0.0519906  0.05006599 0.0526089  0.0489899  0.04917485
  0.0492874  0.04869591 0.05207716 0.04871697 0.05209641 0.04900988
  0.05062724 0.04879344]]
2024-10-22 17:00:54,139 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33052143 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.3283027  0.         0.
  0.3411759  0.        ]]
2024-10-22 17:00:54,140 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color B), (Discard 0), (Discard 4)) | P=0.33052143454551697
2024-10-22 17:00:54,140 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color B), (Discard 0), (Reveal player +1 rank 1)) | P=0.3283027112483978
2024-10-22 17:00:54,141 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color B), (Discard 0), (Reveal player +1 rank 4)) | P=0.34117591381073
2024-10-22 17:00:54,141 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Reveal player +1 color B), (Discard 0)) | Value: 0.0
2024-10-22 17:00:54,141 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:54,141 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 19, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 3}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 2}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || X3|YGWB3
XX || XX|RYGWB1245
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W4 || XX|RYGW12345
R1 || XX|RYGWB12345
Deck size: 19
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G4}
2024-10-22 17:00:54,141 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:54,141 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:54,141 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:54,142 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4590928554534912 | PUCT: 0.4590928554534912
2024-10-22 17:00:54,142 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.44555774331092834 | PUCT: 0.44555774331092834
2024-10-22 17:00:54,143 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.4590928554534912
2024-10-22 17:00:54,143 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:54,143 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 3))
2024-10-22 17:00:54,143 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 3))']
2024-10-22 17:00:54,143 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:54,144 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:54,144 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:54,144 - DEBUG - Rollout #8 completed with reward=4
2024-10-22 17:00:54,144 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:54,144 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 1.3333333333333333 | U: 0.3539367616176605 | PUCT: 1.687270164489746
2024-10-22 17:00:54,145 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.458002507686615 | PUCT: 0.458002507686615
2024-10-22 17:00:54,145 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 1.687270164489746
2024-10-22 17:00:54,145 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:54,145 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 color G))
2024-10-22 17:00:54,145 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 color G))']
2024-10-22 17:00:54,146 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:54,146 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 2
2024-10-22 17:00:54,372 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:54,373 - DEBUG - Network Policy Logits: [[-0.02017332 -0.00795007  0.03038536 -0.06199091 -0.01250868  0.03349631
   0.00703177  0.01946196  0.01667191  0.0100097   0.02751584 -0.01689445
  -0.02321649 -0.00995689  0.00632788 -0.03391184  0.02493038 -0.03654972
   0.03567415 -0.02883267]]
2024-10-22 17:00:54,373 - DEBUG - Network Policy after Softmax: [[0.04908338 0.04968702 0.05162878 0.04707316 0.04946103 0.05178965
  0.05043703 0.05106789 0.0509256  0.05058745 0.05148084 0.04924459
  0.04893424 0.04958741 0.05040154 0.04841366 0.05134791 0.04828612
  0.05190255 0.04866019]]
2024-10-22 17:00:54,374 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50601    0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.49399003
  0.         0.        ]]
2024-10-22 17:00:54,375 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color G), (Discard 4)) | P=0.5060099959373474
2024-10-22 17:00:54,376 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color G), (Reveal player +1 rank 3)) | P=0.493990033864975
2024-10-22 17:00:54,376 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 color G)) | Value: 0.0
2024-10-22 17:00:54,376 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:54,376 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 19, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W3 || XX|YGWB12345
Y4 || XX|RYGWB12345
Deck size: 19
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 W4}
2024-10-22 17:00:54,376 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:54,376 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:00:54,376 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:54,377 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 1.0 | U: 0.2898586392402649 | PUCT: 1.2898585796356201
2024-10-22 17:00:54,377 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4688549041748047 | PUCT: 0.4688549041748047
2024-10-22 17:00:54,377 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 1.2898585796356201
2024-10-22 17:00:54,377 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:54,378 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 3)) | Q: 0.0 | U: 0.5209299921989441 | PUCT: 0.5209299921989441
2024-10-22 17:00:54,378 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 3)) | Q: 4.0 | U: 0.5301883816719055 | PUCT: 4.53018856048584
2024-10-22 17:00:54,378 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 color G)) | Q: 0.0 | U: 0.534676730632782 | PUCT: 0.534676730632782
2024-10-22 17:00:54,379 - DEBUG - Selected Child: ((Discard 4), (Reveal player +1 rank 3)) | PUCT: 4.53018856048584
2024-10-22 17:00:54,379 - DEBUG - Selected child for exploration: ((Discard 4), (Reveal player +1 rank 3))
2024-10-22 17:00:54,379 - DEBUG - Node ((Discard 4), (Reveal player +1 rank 3)) is a leaf node.
2024-10-22 17:00:54,379 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 3))']
2024-10-22 17:00:54,379 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:54,380 - DEBUG - Illegal move encountered: (Reveal player +1 rank 3)
2024-10-22 17:00:54,380 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:54,380 - DEBUG - Rollout #10 completed with reward=4
2024-10-22 17:00:54,380 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:54,380 - DEBUG - Best node chosen by MCTS: ((Discard 4),) | Visit Count: 5
2024-10-22 17:00:54,380 - INFO - Actual Game Score: 4
2024-10-22 17:00:54,380 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:54,380 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:54,380 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.55555556 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.44444444
 0.         0.        ]
2024-10-22 17:00:54,380 - DEBUG - === End of Training Data ===
2024-10-22 17:00:54,380 - INFO - Chosen Action: (Discard 4) | Visit Count: 5
2024-10-22 17:00:54,382 - DEBUG - Not the current player's turn.
2024-10-22 17:00:56,309 - INFO - Agent state has been reset.
2024-10-22 17:00:56,309 - INFO - === Starting MCTS Search ===
2024-10-22 17:00:56,309 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 18, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
Y4 || XX|RYGWB12345
W2 || XX|RYGWB12345
Deck size: 18
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3}
2024-10-22 17:00:56,310 - INFO - Max Rollouts: 10
2024-10-22 17:00:56,310 - DEBUG - --- Rollout #1 ---
2024-10-22 17:00:56,310 - DEBUG - Node () is a leaf node.
2024-10-22 17:00:56,310 - DEBUG - Traversing Path: ['()']
2024-10-22 17:00:56,524 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:56,525 - DEBUG - Network Policy Logits: [[-0.02168876 -0.01843493  0.03621393 -0.05080382 -0.01716246  0.02547619
   0.01760236 -0.01206067  0.02592098  0.02310098  0.01204144 -0.0035774
  -0.02248489 -0.02460379  0.02376227 -0.03358235  0.02041297 -0.03995889
   0.02212621 -0.03344064]]
2024-10-22 17:00:56,525 - DEBUG - Network Policy after Softmax: [[0.04908486 0.04924483 0.0520109  0.04767635 0.04930754 0.05145541
  0.05105185 0.04955973 0.0514783  0.05133333 0.05076874 0.04998195
  0.0490458  0.04894198 0.05136729 0.04850452 0.05119554 0.04819622
  0.05128332 0.0485114 ]]
2024-10-22 17:00:56,526 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3313966  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.32392743
  0.3446759  0.        ]]
2024-10-22 17:00:56,527 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.4838178  0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.24294762
 0.27323458 0.        ]
2024-10-22 17:00:56,527 - DEBUG - Added Child Node: ((Discard 4),) | P=0.48381778597831726
2024-10-22 17:00:56,528 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.24294762313365936
2024-10-22 17:00:56,529 - DEBUG - Added Child Node: ((Reveal player +1 rank 4),) | P=0.2732345759868622
2024-10-22 17:00:56,529 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:00:56,529 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:56,529 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 18, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
Y4 || XX|RYGWB12345
W2 || XX|RYGWB12345
Deck size: 18
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3}
2024-10-22 17:00:56,529 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:56,529 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:00:56,529 - DEBUG - --- Rollout #2 ---
2024-10-22 17:00:56,529 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:00:56,529 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:00:56,530 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:56,745 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:56,746 - DEBUG - Network Policy Logits: [[ 0.03341845 -0.01723188  0.03502394 -0.05148017  0.00988033  0.06682305
   0.01953854  0.02011986 -0.02448605  0.02725628 -0.03011947 -0.0035963
  -0.04324585 -0.01873621  0.01474049 -0.01043607  0.01447546 -0.03416859
  -0.02720849 -0.0247876 ]]
2024-10-22 17:00:56,746 - DEBUG - Network Policy after Softmax: [[0.05179008 0.04923222 0.0518733  0.04757465 0.05058528 0.05354933
  0.05107621 0.05110591 0.04887638 0.05147193 0.04860181 0.04990813
  0.04796801 0.04915822 0.05083173 0.04956793 0.05081826 0.04840542
  0.0487435  0.04886164]]
2024-10-22 17:00:56,747 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32150614 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34351727 0.3349766  0.         0.
  0.         0.        ]]
2024-10-22 17:00:56,748 - DEBUG - Added Child Node: ((Discard 4), (Discard 3)) | P=0.321506142616272
2024-10-22 17:00:56,749 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1)) | P=0.3349766135215759
2024-10-22 17:00:56,750 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B)) | P=0.3435172736644745
2024-10-22 17:00:56,750 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:00:56,750 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:56,750 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 17, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 17
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 B4}
2024-10-22 17:00:56,750 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:56,750 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:00:56,750 - DEBUG - --- Rollout #3 ---
2024-10-22 17:00:56,751 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4),)
2024-10-22 17:00:56,751 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)']
2024-10-22 17:00:56,751 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:56,947 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:56,947 - DEBUG - Network Policy Logits: [[ 0.0299551  -0.01480546  0.0361995  -0.06013904  0.03276159  0.03255048
   0.02151664 -0.00559348 -0.00162381  0.00953846 -0.04386752  0.00739099
  -0.02139157 -0.0130356   0.02224433 -0.021447    0.00347911 -0.0200223
  -0.00119185 -0.02402254]]
2024-10-22 17:00:56,947 - DEBUG - Network Policy after Softmax: [[0.05158457 0.04932653 0.05190769 0.04714031 0.05172954 0.05171863
  0.05115111 0.04978302 0.04998104 0.05054206 0.04791363 0.05043364
  0.04900273 0.0494139  0.05118834 0.04900001 0.05023674 0.04906987
  0.05000263 0.04887397]]
2024-10-22 17:00:56,949 - DEBUG - Normalized Policy: [[0.         0.         0.         0.48526746 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.51473254 0.        ]]
2024-10-22 17:00:56,950 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 3)) | P=0.4852674603462219
2024-10-22 17:00:56,950 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 4)) | P=0.5147325396537781
2024-10-22 17:00:56,950 - DEBUG - Simulating Node: ((Reveal player +1 rank 4),) | Value: 0.0
2024-10-22 17:00:56,951 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:56,951 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 18, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R1235
XX || X4|RYGWB4
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B4 || XX|RYGWB12345
Deck size: 18
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3}
2024-10-22 17:00:56,951 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:56,951 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:00:56,951 - DEBUG - --- Rollout #4 ---
2024-10-22 17:00:56,951 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:00:56,951 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:00:56,952 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:57,155 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:57,155 - DEBUG - Network Policy Logits: [[ 0.02254875 -0.01495659  0.01232279 -0.04912005  0.01305488  0.0464922
   0.0243239   0.01913804 -0.01571321  0.03549206 -0.02249033 -0.00167479
  -0.03530584 -0.00955178  0.02740929 -0.02040237  0.00710694 -0.04866591
  -0.00585035 -0.03105786]]
2024-10-22 17:00:57,155 - DEBUG - Network Policy after Softmax: [[0.05124186 0.0493556  0.05072052 0.04769792 0.05075767 0.05248357
  0.0513329  0.05106738 0.04931827 0.0519094  0.04898517 0.05001551
  0.04836141 0.04962308 0.05149152 0.04908755 0.05045666 0.04771959
  0.0498071  0.04856728]]
2024-10-22 17:00:57,156 - DEBUG - Normalized Policy: [[0.        0.        0.        0.3317449 0.        0.        0.
  0.        0.        0.        0.        0.        0.3363595 0.
  0.        0.        0.        0.3318956 0.        0.       ]]
2024-10-22 17:00:57,157 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3)) | P=0.331744909286499
2024-10-22 17:00:57,158 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 3)) | P=0.3318955898284912
2024-10-22 17:00:57,158 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color G)) | P=0.33635950088500977
2024-10-22 17:00:57,159 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:00:57,159 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:57,159 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 18, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || XX|RYGWB1245
XX || XX|RYGWB1245
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G3 || XX|RYGWB12345
Deck size: 18
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3}
2024-10-22 17:00:57,159 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:57,159 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:00:57,159 - DEBUG - --- Rollout #5 ---
2024-10-22 17:00:57,160 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.7672359347343445 | PUCT: 0.7672359347343445
2024-10-22 17:00:57,161 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.4332941174507141 | PUCT: 0.4332941174507141
2024-10-22 17:00:57,161 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.38526520133018494 | PUCT: 0.38526520133018494
2024-10-22 17:00:57,161 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.7672359347343445
2024-10-22 17:00:57,161 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:57,161 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 3))
2024-10-22 17:00:57,162 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 3))']
2024-10-22 17:00:57,162 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:57,163 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:57,371 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:57,371 - DEBUG - Network Policy Logits: [[-0.02947037 -0.0150593   0.03661856 -0.04729876 -0.02851074  0.0382589
   0.02389774 -0.00371919  0.02108589  0.03756584  0.00810837 -0.01077031
  -0.02768762 -0.01658608  0.01209606 -0.02731389  0.01488786 -0.04373582
   0.02286263 -0.03574696]]
2024-10-22 17:00:57,371 - DEBUG - Network Policy after Softmax: [[0.04870095 0.04940786 0.05202828 0.04784038 0.0487477  0.05211369
  0.05137063 0.04997134 0.05122638 0.05207759 0.05056589 0.04962023
  0.04878785 0.04933248 0.05076793 0.04880608 0.05090986 0.04801114
  0.05131748 0.04839623]]
2024-10-22 17:00:57,373 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.2501198  0.
  0.         0.         0.         0.         0.         0.
  0.         0.25312027 0.         0.25041935 0.         0.24634054
  0.         0.        ]]
2024-10-22 17:00:57,374 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Reveal player +1 color W)) | P=0.2531202733516693
2024-10-22 17:00:57,374 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Discard 4)) | P=0.25011980533599854
2024-10-22 17:00:57,375 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Reveal player +1 rank 1)) | P=0.25041934847831726
2024-10-22 17:00:57,375 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Reveal player +1 rank 3)) | P=0.2463405430316925
2024-10-22 17:00:57,375 - DEBUG - Simulating Node: ((Discard 4), (Discard 3)) | Value: 0.0
2024-10-22 17:00:57,375 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:57,376 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W2 || XX|RYGWB12345
W1 || XX|RYGWB12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W4 G3}
2024-10-22 17:00:57,376 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:57,376 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:00:57,376 - DEBUG - --- Rollout #6 ---
2024-10-22 17:00:57,376 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.539685070514679 | PUCT: 0.539685070514679
2024-10-22 17:00:57,377 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.4571782052516937 | PUCT: 0.4571782052516937
2024-10-22 17:00:57,377 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4065018594264984 | PUCT: 0.4065018594264984
2024-10-22 17:00:57,377 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.539685070514679
2024-10-22 17:00:57,377 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:57,378 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 color B))
2024-10-22 17:00:57,378 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 color B))']
2024-10-22 17:00:57,378 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:57,379 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:00:57,602 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:57,603 - DEBUG - Network Policy Logits: [[-0.01643685 -0.01654341  0.03520752 -0.04109006 -0.00175107  0.02180129
   0.00161743 -0.00631779  0.02896159  0.0369959   0.0057729  -0.01201153
  -0.02821035 -0.01614712  0.02113118 -0.01372789  0.01864726 -0.03661038
   0.02584059 -0.0310266 ]]
2024-10-22 17:00:57,603 - DEBUG - Network Policy after Softmax: [[0.04922969 0.04922445 0.05183893 0.04803086 0.04995801 0.0511486
  0.05012657 0.04973038 0.05151615 0.05193172 0.0503353  0.04944803
  0.04865349 0.04924396 0.05111434 0.04936324 0.05098753 0.04824651
  0.05135562 0.04851666]]
2024-10-22 17:00:57,604 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3340329  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.32258934
  0.34337774 0.        ]]
2024-10-22 17:00:57,605 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Discard 4)) | P=0.33403289318084717
2024-10-22 17:00:57,606 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 3)) | P=0.32258933782577515
2024-10-22 17:00:57,606 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 4)) | P=0.3433777391910553
2024-10-22 17:00:57,606 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:00:57,606 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:57,606 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 17, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGW12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
Y4 || XX|RYGWB12345
W2 || XX|RYGWB12345
Deck size: 17
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 B1}
2024-10-22 17:00:57,606 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:57,607 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:00:57,607 - DEBUG - --- Rollout #7 ---
2024-10-22 17:00:57,607 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4218161702156067 | PUCT: 0.4218161702156067
2024-10-22 17:00:57,608 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.4764387607574463 | PUCT: 0.4764387607574463
2024-10-22 17:00:57,608 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.42362743616104126 | PUCT: 0.42362743616104126
2024-10-22 17:00:57,608 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.4764387607574463
2024-10-22 17:00:57,608 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:00:57,608 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Discard 3))
2024-10-22 17:00:57,608 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Discard 3))']
2024-10-22 17:00:57,609 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:57,610 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:57,806 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:57,806 - DEBUG - Network Policy Logits: [[-0.01936248 -0.01129935  0.04019177 -0.05168022 -0.02648166  0.03444468
   0.01052462 -0.00799591  0.0249475   0.03688448 -0.00113879 -0.01226185
  -0.04450981 -0.00627766  0.01129942 -0.02262164  0.02076381 -0.04069432
   0.0398748  -0.03728386]]
2024-10-22 17:00:57,807 - DEBUG - Network Policy after Softmax: [[0.0491748  0.0495729  0.05219233 0.04761099 0.04882596 0.05189324
  0.05066668 0.04973694 0.05140273 0.05202    0.05007916 0.04952521
  0.0479536  0.04982247 0.05070595 0.04901479 0.05118813 0.04813692
  0.05217579 0.04830137]]
2024-10-22 17:00:57,808 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.32956886 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.34551316 0.32491794
  0.         0.        ]]
2024-10-22 17:00:57,809 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 3), (Discard 4)) | P=0.32956886291503906
2024-10-22 17:00:57,810 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 3), (Reveal player +1 rank 2)) | P=0.34551316499710083
2024-10-22 17:00:57,810 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 3), (Reveal player +1 rank 3)) | P=0.3249179422855377
2024-10-22 17:00:57,810 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Discard 3)) | Value: 0.0
2024-10-22 17:00:57,810 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:57,811 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 17, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R1235
W2 || XX|RYGWB1235
B4 || XX|RYGWB12345
Deck size: 17
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W4}
2024-10-22 17:00:57,811 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:57,811 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:00:57,811 - DEBUG - --- Rollout #8 ---
2024-10-22 17:00:57,811 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4360488951206207 | PUCT: 0.4360488951206207
2024-10-22 17:00:57,812 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.328343003988266 | PUCT: 0.328343003988266
2024-10-22 17:00:57,812 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4379212558269501 | PUCT: 0.4379212558269501
2024-10-22 17:00:57,812 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.4379212558269501
2024-10-22 17:00:57,813 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:00:57,813 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Discard 3))
2024-10-22 17:00:57,813 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Discard 3))']
2024-10-22 17:00:57,814 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:00:57,814 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:00:58,016 - DEBUG - Network Value Output: 0.0
2024-10-22 17:00:58,016 - DEBUG - Network Policy Logits: [[-0.02409854 -0.00282568  0.0468417  -0.04091188 -0.02276389  0.04920416
   0.00850626 -0.0082921   0.03949036  0.04858035 -0.01307378  0.0106263
  -0.03712037 -0.00267741  0.00416935 -0.02912422  0.02736117 -0.02576016
   0.02893972 -0.03962298]]
2024-10-22 17:00:58,016 - DEBUG - Network Policy after Softmax: [[0.04874516 0.04979322 0.05232876 0.04793245 0.04881026 0.05245253
  0.05036068 0.04952177 0.05194549 0.05241982 0.04928554 0.05046756
  0.04811453 0.0498006  0.05014275 0.0485008  0.05131924 0.04866423
  0.05140031 0.04799426]]
2024-10-22 17:00:58,018 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.48747134 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.51252866 0.
  0.         0.        ]]
2024-10-22 17:00:58,019 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3), (Discard 4)) | P=0.487471342086792
2024-10-22 17:00:58,019 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3), (Reveal player +1 rank 2)) | P=0.512528657913208
2024-10-22 17:00:58,019 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Discard 3)) | Value: 0.0
2024-10-22 17:00:58,019 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:00:58,019 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 17, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
W2 || XX|RYGWB1245
B4 || XX|RYGWB12345
Deck size: 17
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 Y5}
2024-10-22 17:00:58,020 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:00:58,020 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:00:58,020 - DEBUG - --- Rollout #9 ---
2024-10-22 17:00:58,021 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4482280910015106 | PUCT: 0.4482280910015106
2024-10-22 17:00:58,021 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.33751389384269714 | PUCT: 0.33751389384269714
2024-10-22 17:00:58,022 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.3001018464565277 | PUCT: 0.3001018464565277
2024-10-22 17:00:58,022 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.4482280910015106
2024-10-22 17:00:58,022 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:58,022 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 1))
2024-10-22 17:00:58,022 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 1))']
2024-10-22 17:00:58,023 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:58,023 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:00:58,023 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:58,023 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:00:58,023 - DEBUG - --- Rollout #10 ---
2024-10-22 17:00:58,024 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 1.0 | U: 0.36707907915115356 | PUCT: 1.3670790195465088
2024-10-22 17:00:58,024 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.3455112874507904 | PUCT: 0.3455112874507904
2024-10-22 17:00:58,025 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.3072127401828766 | PUCT: 0.3072127401828766
2024-10-22 17:00:58,025 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 1.3670790195465088
2024-10-22 17:00:58,025 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:00:58,025 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 3)) | Q: 0.0 | U: 0.5098429322242737 | PUCT: 0.5098429322242737
2024-10-22 17:00:58,026 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 color B)) | Q: 0.0 | U: 0.544748067855835 | PUCT: 0.544748067855835
2024-10-22 17:00:58,026 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.531204342842102 | PUCT: 4.5312042236328125
2024-10-22 17:00:58,027 - DEBUG - Selected Child: ((Discard 4), (Reveal player +1 rank 1)) | PUCT: 4.5312042236328125
2024-10-22 17:00:58,027 - DEBUG - Selected child for exploration: ((Discard 4), (Reveal player +1 rank 1))
2024-10-22 17:00:58,027 - DEBUG - Node ((Discard 4), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:00:58,027 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 1))']
2024-10-22 17:00:58,027 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:00:58,028 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:00:58,028 - DEBUG - Backpropagating reward: 4
2024-10-22 17:00:58,028 - DEBUG - Rollout #10 completed with reward=4
2024-10-22 17:00:58,028 - INFO - === MCTS Search Completed ===
2024-10-22 17:00:58,028 - DEBUG - Best node chosen by MCTS: ((Discard 4),) | Visit Count: 5
2024-10-22 17:00:58,028 - INFO - Actual Game Score: 4
2024-10-22 17:00:58,028 - DEBUG - === Recording Training Data ===
2024-10-22 17:00:58,028 - DEBUG - State Vector Shape: 658
2024-10-22 17:00:58,028 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.55555556 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.22222222
 0.22222222 0.        ]
2024-10-22 17:00:58,028 - DEBUG - === End of Training Data ===
2024-10-22 17:00:58,028 - INFO - Chosen Action: (Discard 4) | Visit Count: 5
2024-10-22 17:00:58,030 - DEBUG - Not the current player's turn.
2024-10-22 17:01:00,125 - INFO - Agent state has been reset.
2024-10-22 17:01:00,125 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:00,125 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W2 || XX|RYGWB12345
W4 || XX|RYGWB12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4}
2024-10-22 17:01:00,125 - INFO - Max Rollouts: 10
2024-10-22 17:01:00,125 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:00,126 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:00,126 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:00,319 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:00,319 - DEBUG - Network Policy Logits: [[-0.01697796 -0.01179216  0.0405109  -0.05144733 -0.00852285  0.01801955
   0.03257367 -0.00524274  0.03927903  0.01523772  0.01101344 -0.01236066
  -0.01880993 -0.01904488  0.02413517 -0.03446896  0.0315177  -0.04537247
   0.02938284 -0.0341506 ]]
2024-10-22 17:01:00,320 - DEBUG - Network Policy after Softmax: [[0.04917948 0.04943517 0.0520896  0.04751318 0.04959706 0.05093111
  0.05167779 0.04976001 0.05202547 0.05078962 0.05057553 0.04940708
  0.04908947 0.04907794 0.05124354 0.04832676 0.05162324 0.04780269
  0.05151315 0.04834215]]
2024-10-22 17:01:00,321 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33859804 0.
  0.         0.         0.         0.         0.         0.
  0.         0.335054   0.         0.         0.         0.32634795
  0.         0.        ]]
2024-10-22 17:01:00,322 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.25394854 0.
 0.         0.         0.         0.         0.         0.
 0.         0.50128347 0.         0.         0.         0.244768
 0.         0.        ]
2024-10-22 17:01:00,322 - DEBUG - Added Child Node: ((Reveal player +1 color W),) | P=0.5012834668159485
2024-10-22 17:01:00,323 - DEBUG - Added Child Node: ((Discard 4),) | P=0.25394853949546814
2024-10-22 17:01:00,324 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.24476799368858337
2024-10-22 17:01:00,324 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:00,324 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:00,324 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W2 || XX|RYGWB12345
W4 || XX|RYGWB12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4}
2024-10-22 17:01:00,324 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:00,324 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:00,324 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:00,325 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W),)
2024-10-22 17:01:00,325 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)']
2024-10-22 17:01:00,325 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:00,565 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:00,566 - DEBUG - Network Policy Logits: [[ 0.03806194 -0.01940343  0.01974444 -0.02937647  0.05083229  0.0231499
   0.01137745  0.01660106 -0.02296291 -0.01473734 -0.05378005 -0.01892146
  -0.00217614  0.0055995   0.04580526 -0.02011073  0.00579078 -0.03457816
  -0.02573351 -0.01368251]]
2024-10-22 17:01:00,566 - DEBUG - Network Policy after Softmax: [[0.05202012 0.04911503 0.05107591 0.04862764 0.05268869 0.05125014
  0.05065034 0.05091561 0.04894052 0.04934474 0.04745531 0.04913871
  0.04996848 0.05035853 0.05242449 0.0490803  0.05036817 0.04837535
  0.04880511 0.04939682]]
2024-10-22 17:01:00,568 - DEBUG - Normalized Policy: [[0.         0.         0.         0.49120906 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.5087909  0.
  0.         0.        ]]
2024-10-22 17:01:00,569 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 3)) | P=0.4912090599536896
2024-10-22 17:01:00,569 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 2)) | P=0.508790910243988
2024-10-22 17:01:00,569 - DEBUG - Simulating Node: ((Reveal player +1 color W),) | Value: 0.0
2024-10-22 17:01:00,569 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:00,570 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': 'W', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || WX|W12345
XX || WX|W12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W2 || XX|RYGWB12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4}
2024-10-22 17:01:00,570 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:00,570 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:00,570 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:00,570 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:00,570 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:00,571 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:00,798 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:00,798 - DEBUG - Network Policy Logits: [[ 0.03259555 -0.01572244  0.0320605  -0.05761145  0.00491874  0.05612845
   0.02983448  0.03540166 -0.01572359  0.01477325 -0.03792114 -0.00365572
  -0.02780359 -0.01822691  0.02460823 -0.0121748   0.01902923 -0.04191911
  -0.02403893 -0.01707741]]
2024-10-22 17:01:00,799 - DEBUG - Network Policy after Softmax: [[0.05169193 0.04925366 0.05166429 0.04723309 0.05028088 0.05292282
  0.0515494  0.05183719 0.04925361 0.05077883 0.04817235 0.04985159
  0.0486622  0.04913047 0.0512807  0.04942871 0.0509954  0.04798014
  0.04884575 0.04918697]]
2024-10-22 17:01:00,800 - DEBUG - Normalized Policy: [[0.         0.         0.         0.48986784 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.51013213]]
2024-10-22 17:01:00,801 - DEBUG - Added Child Node: ((Discard 4), (Discard 3)) | P=0.48986783623695374
2024-10-22 17:01:00,801 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 5)) | P=0.5101321339607239
2024-10-22 17:01:00,801 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:00,801 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:00,801 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 15, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y5 || XX|RYGWB12345
Deck size: 15
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 B4}
2024-10-22 17:01:00,801 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:00,802 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:00,802 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:00,802 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:01:00,802 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:01:00,803 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:01,011 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:01,011 - DEBUG - Network Policy Logits: [[ 0.03312838 -0.01695469  0.02720691 -0.04597124  0.02612128  0.04669618
   0.0324947   0.02301475 -0.01490336  0.02298656 -0.0142951   0.00790964
  -0.02602732 -0.00128707  0.02763033 -0.01770456  0.01210528 -0.0513835
  -0.00437874 -0.02017292]]
2024-10-22 17:01:01,012 - DEBUG - Network Policy after Softmax: [[0.05154615 0.04902814 0.05124182 0.04762596 0.05118622 0.05225028
  0.0515135  0.05102745 0.04912882 0.05102602 0.04915871 0.05026247
  0.04858534 0.04980234 0.05126352 0.04899139 0.0504738  0.04736889
  0.04964861 0.04887061]]
2024-10-22 17:01:01,013 - DEBUG - Normalized Policy: [[0.         0.         0.         0.49355078 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.50644916]]
2024-10-22 17:01:01,014 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3)) | P=0.49355077743530273
2024-10-22 17:01:01,015 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 5)) | P=0.5064491629600525
2024-10-22 17:01:01,015 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:01:01,015 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:01,015 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || XX|RYGWB1245
XX || XX|RYGWB1245
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || XX|RYGWB12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4}
2024-10-22 17:01:01,015 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:01,015 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:01,015 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:01,016 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.7949329614639282 | PUCT: 0.7949329614639282
2024-10-22 17:01:01,016 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4027104079723358 | PUCT: 0.4027104079723358
2024-10-22 17:01:01,017 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.38815194368362427 | PUCT: 0.38815194368362427
2024-10-22 17:01:01,017 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.7949329614639282
2024-10-22 17:01:01,017 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:01:01,017 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Discard 3))
2024-10-22 17:01:01,017 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Discard 3))']
2024-10-22 17:01:01,018 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:01,019 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:01,225 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:01,225 - DEBUG - Network Policy Logits: [[-0.00050114 -0.02119324  0.0522029  -0.039215    0.001382    0.01993413
   0.04819928  0.00729619  0.02639634  0.01360398  0.00611428  0.00747461
  -0.03401322 -0.01144257  0.02018025 -0.0209222   0.01923471 -0.04848198
   0.02695934 -0.02603958]]
2024-10-22 17:01:01,225 - DEBUG - Network Policy after Softmax: [[0.04983903 0.04881836 0.0525362  0.04794644 0.04993298 0.05086799
  0.05232629 0.05022916 0.05119777 0.050547   0.05016983 0.05023813
  0.0481965  0.0492967  0.05088051 0.04883159 0.05083242 0.04750418
  0.0512266  0.04858234]]
2024-10-22 17:01:01,227 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33587864 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.3195411
  0.34458032 0.        ]]
2024-10-22 17:01:01,228 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 3), (Discard 4)) | P=0.3358786404132843
2024-10-22 17:01:01,228 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 3), (Reveal player +1 rank 3)) | P=0.3195410966873169
2024-10-22 17:01:01,229 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 3), (Reveal player +1 rank 4)) | P=0.3445803225040436
2024-10-22 17:01:01,229 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Discard 3)) | Value: 0.0
2024-10-22 17:01:01,229 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:01,229 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 15, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W4 || WX|W12345
W5 || XX|RYGWB12345
Deck size: 15
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2}
2024-10-22 17:01:01,229 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:01,229 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:01,230 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:01,230 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.5591675639152527 | PUCT: 0.5591675639152527
2024-10-22 17:01:01,231 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.42490866780281067 | PUCT: 0.42490866780281067
2024-10-22 17:01:01,231 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.40954771637916565 | PUCT: 0.40954771637916565
2024-10-22 17:01:01,231 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.5591675639152527
2024-10-22 17:01:01,231 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:01:01,231 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Reveal player +1 rank 2))
2024-10-22 17:01:01,231 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Reveal player +1 rank 2))']
2024-10-22 17:01:01,232 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:01,233 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 2
2024-10-22 17:01:01,431 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:01,431 - DEBUG - Network Policy Logits: [[-0.00969457 -0.00142201  0.03831937 -0.02743689 -0.01338625  0.03065576
   0.03289482 -0.01744368  0.04132873  0.00209759  0.00407501  0.00614651
  -0.02140436  0.00841184  0.0294995  -0.01960119  0.0012892  -0.06935563
   0.02462244 -0.01669474]]
2024-10-22 17:01:01,431 - DEBUG - Network Policy after Softmax: [[0.04944367 0.04985439 0.05187557 0.04857416 0.04926147 0.05147953
  0.05159493 0.049062   0.05203192 0.05003017 0.05012919 0.05023314
  0.04886807 0.05034707 0.05142004 0.04895627 0.04998974 0.04658008
  0.05116988 0.04909876]]
2024-10-22 17:01:01,433 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.25005677 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.25375354 0.23644571
  0.25974405 0.        ]]
2024-10-22 17:01:01,433 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 2), (Discard 4)) | P=0.25005677342414856
2024-10-22 17:01:01,434 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 2), (Reveal player +1 rank 2)) | P=0.25375354290008545
2024-10-22 17:01:01,434 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 2), (Reveal player +1 rank 3)) | P=0.23644571006298065
2024-10-22 17:01:01,435 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 2), (Reveal player +1 rank 4)) | P=0.2597440481185913
2024-10-22 17:01:01,435 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Reveal player +1 rank 2)) | Value: 0.0
2024-10-22 17:01:01,435 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:01,435 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 16, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': 'W', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB1345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W2 || WX|W12345
W4 || WX|W12345
Deck size: 16
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4}
2024-10-22 17:01:01,435 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:01,435 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:01,435 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:01,436 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.43704360723495483 | PUCT: 0.43704360723495483
2024-10-22 17:01:01,436 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.44280970096588135 | PUCT: 0.44280970096588135
2024-10-22 17:01:01,437 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4268016219139099 | PUCT: 0.4268016219139099
2024-10-22 17:01:01,437 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.44280970096588135
2024-10-22 17:01:01,437 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:01,437 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 3))
2024-10-22 17:01:01,437 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 3))']
2024-10-22 17:01:01,438 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:01,438 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:01,630 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:01,630 - DEBUG - Network Policy Logits: [[-0.01631542 -0.00785888  0.03297184 -0.03807419 -0.02926075  0.03196007
   0.03259704  0.01756388  0.03271868  0.02782341  0.01929843  0.00702569
  -0.03175283 -0.03563727  0.0188343  -0.03692288  0.0339836  -0.02803869
   0.02335846 -0.04615019]]
2024-10-22 17:01:01,631 - DEBUG - Network Policy after Softmax: [[0.04915005 0.04956745 0.05163321 0.04809215 0.04851788 0.05158099
  0.05161385 0.05084374 0.05162013 0.05136806 0.05093201 0.05031075
  0.04839712 0.04820949 0.05090838 0.04814755 0.05168547 0.04857721
  0.05113921 0.04770532]]
2024-10-22 17:01:01,632 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.32562056 0.         0.32852635
  0.34585312 0.        ]]
2024-10-22 17:01:01,633 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Reveal player +1 rank 1)) | P=0.32562056183815
2024-10-22 17:01:01,634 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Reveal player +1 rank 3)) | P=0.3285263478755951
2024-10-22 17:01:01,634 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Reveal player +1 rank 4)) | P=0.34585312008857727
2024-10-22 17:01:01,634 - DEBUG - Simulating Node: ((Discard 4), (Discard 3)) | Value: 0.0
2024-10-22 17:01:01,634 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:01,635 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 8, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 8
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W4 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 R4 G3}
2024-10-22 17:01:01,635 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:01,635 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:01,635 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:01,636 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.45179012417793274 | PUCT: 0.45179012417793274
2024-10-22 17:01:01,636 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.30516716837882996 | PUCT: 0.30516716837882996
2024-10-22 17:01:01,637 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4412025213241577 | PUCT: 0.4412025213241577
2024-10-22 17:01:01,637 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.45179012417793274
2024-10-22 17:01:01,637 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:01:01,637 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Discard 3)) | Q: 0.0 | U: 0.722943127155304 | PUCT: 0.722943127155304
2024-10-22 17:01:01,638 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Reveal player +1 rank 2)) | Q: 0.0 | U: 0.7488194108009338 | PUCT: 0.7488194108009338
2024-10-22 17:01:01,638 - DEBUG - Selected Child: ((Reveal player +1 color W), (Reveal player +1 rank 2)) | PUCT: 0.7488194108009338
2024-10-22 17:01:01,638 - DEBUG - Selected child for exploration: ((Reveal player +1 color W), (Reveal player +1 rank 2))
2024-10-22 17:01:01,638 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Reveal player +1 rank 2), (Discard 4))
2024-10-22 17:01:01,638 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Reveal player +1 rank 2))', '((Reveal player +1 color W), (Reveal player +1 rank 2), (Discard 4))']
2024-10-22 17:01:01,639 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:01,640 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 2
2024-10-22 17:01:01,641 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:01:01,846 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:01,846 - DEBUG - Network Policy Logits: [[ 0.04570333 -0.01817945  0.01503603 -0.02213878  0.04115697  0.02484341
   0.01824349  0.01699327 -0.01646728 -0.01303463 -0.06141478 -0.02053898
   0.0016983   0.00228773  0.03904891 -0.00557142  0.00177509 -0.01681498
  -0.0191166  -0.00841025]]
2024-10-22 17:01:01,846 - DEBUG - Network Policy after Softmax: [[0.05230787 0.0490708  0.05072808 0.0488769  0.0520706  0.05122804
  0.05089105 0.05082747 0.04915489 0.04932391 0.04699442 0.04895515
  0.05005597 0.05008548 0.05196095 0.0496934  0.05005982 0.0491378
  0.04902484 0.04955253]]
2024-10-22 17:01:01,848 - DEBUG - Normalized Policy: [[0.3510697  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.31540787 0.
  0.         0.         0.         0.33352238 0.         0.
  0.         0.        ]]
2024-10-22 17:01:01,848 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 2), (Discard 4), (Reveal player +1 color R)) | P=0.3154078722000122
2024-10-22 17:01:01,849 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 2), (Discard 4), (Discard 0)) | P=0.35106968879699707
2024-10-22 17:01:01,850 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 rank 2), (Discard 4), (Reveal player +1 rank 1)) | P=0.33352237939834595
2024-10-22 17:01:01,850 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Reveal player +1 rank 2), (Discard 4)) | Value: 0.0
2024-10-22 17:01:01,850 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:01,850 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 15, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': 'W', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || WX|W12345
XX || WX|W12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
R1 || XX|RYGWB12345
Deck size: 15
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 B2}
2024-10-22 17:01:01,850 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:01,850 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:01,850 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:01,851 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.37152719497680664 | PUCT: 0.37152719497680664
2024-10-22 17:01:01,851 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.31369075179100037 | PUCT: 0.31369075179100037
2024-10-22 17:01:01,852 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.45352569222450256 | PUCT: 0.45352569222450256
2024-10-22 17:01:01,852 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.45352569222450256
2024-10-22 17:01:01,852 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:01:01,852 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Discard 3))
2024-10-22 17:01:01,852 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Discard 3))']
2024-10-22 17:01:01,853 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:01,854 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:02,061 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:02,061 - DEBUG - Network Policy Logits: [[-0.0148847  -0.0110028   0.04212147 -0.02711704 -0.02089019  0.04035074
   0.02460591  0.02529014  0.02907101  0.03636013 -0.0024049   0.01255813
  -0.02593821 -0.00900271  0.01149876 -0.04340086  0.02901834 -0.02947384
   0.01774267 -0.04096912]]
2024-10-22 17:01:02,062 - DEBUG - Network Policy after Softmax: [[0.04913592 0.04932703 0.05201834 0.04853853 0.04884171 0.05192631
  0.05111515 0.05115013 0.05134389 0.05171951 0.04975297 0.05050302
  0.04859578 0.04942578 0.05044955 0.04775454 0.05134119 0.04842427
  0.05076553 0.0478708 ]]
2024-10-22 17:01:02,063 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.49702817 0.
  0.         0.         0.         0.         0.         0.
  0.         0.5029718  0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:02,063 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3), (Reveal player +1 color W)) | P=0.5029718279838562
2024-10-22 17:01:02,064 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3), (Discard 4)) | P=0.4970281720161438
2024-10-22 17:01:02,064 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Discard 3)) | Value: 0.0
2024-10-22 17:01:02,064 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:02,064 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 15, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'R', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
W4 || XX|RYGWB1245
W2 || XX|RYGWB12345
Deck size: 15
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 R4}
2024-10-22 17:01:02,064 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:02,064 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:02,064 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:02,065 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.38033053278923035 | PUCT: 0.38033053278923035
2024-10-22 17:01:02,065 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3211236596107483 | PUCT: 0.3211236596107483
2024-10-22 17:01:02,066 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.3095146715641022 | PUCT: 0.3095146715641022
2024-10-22 17:01:02,066 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.38033053278923035
2024-10-22 17:01:02,066 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:01:02,066 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Discard 3)) | Q: 0.0 | U: 0.7789570093154907 | PUCT: 0.7789570093154907
2024-10-22 17:01:02,067 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Reveal player +1 rank 2)) | Q: 0.0 | U: 0.5378921627998352 | PUCT: 0.5378921627998352
2024-10-22 17:01:02,067 - DEBUG - Selected Child: ((Reveal player +1 color W), (Discard 3)) | PUCT: 0.7789570093154907
2024-10-22 17:01:02,067 - DEBUG - Selected child for exploration: ((Reveal player +1 color W), (Discard 3))
2024-10-22 17:01:02,067 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Discard 3), (Discard 4))
2024-10-22 17:01:02,067 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Discard 3))', '((Reveal player +1 color W), (Discard 3), (Discard 4))']
2024-10-22 17:01:02,068 - DEBUG - Move: (Reveal player +1 color W) | Reward: 4 | Depth: 1
2024-10-22 17:01:02,068 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:02,069 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:01:02,270 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:02,271 - DEBUG - Network Policy Logits: [[ 0.04814353 -0.00531569  0.01688886 -0.04662266  0.01261912  0.0288673
   0.03289058  0.01659849 -0.01348815  0.00507229 -0.03524422  0.01524366
  -0.0293025  -0.03170587  0.0416862  -0.01912113  0.02056204 -0.03119136
  -0.0235534  -0.03576716]]
2024-10-22 17:01:02,271 - DEBUG - Network Policy after Softmax: [[0.05253101 0.04979649 0.05091457 0.04778145 0.05069764 0.05152811
  0.05173584 0.05089978 0.04939119 0.05031647 0.04832824 0.05083087
  0.04861624 0.04849954 0.05219289 0.04911375 0.05110193 0.0485245
  0.04889655 0.04830297]]
2024-10-22 17:01:02,273 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32970417 0.         0.
  0.         0.         0.         0.         0.         0.
  0.33546442 0.         0.         0.         0.         0.33483136
  0.         0.        ]]
2024-10-22 17:01:02,274 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 3), (Discard 4), (Discard 3)) | P=0.3297041654586792
2024-10-22 17:01:02,274 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 3), (Discard 4), (Reveal player +1 rank 3)) | P=0.3348313570022583
2024-10-22 17:01:02,275 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 3), (Discard 4), (Reveal player +1 color G)) | P=0.3354644179344177
2024-10-22 17:01:02,275 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Discard 3), (Discard 4)) | Value: 0.0
2024-10-22 17:01:02,275 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:02,275 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || WX|W12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G3 || XX|RYGWB12345
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W5 Y2}
2024-10-22 17:01:02,275 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:02,276 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:02,276 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:02,276 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color W),) | Visit Count: 5
2024-10-22 17:01:02,276 - INFO - Actual Game Score: 4
2024-10-22 17:01:02,276 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:02,276 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:02,276 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.22222222 0.
 0.         0.         0.         0.         0.         0.
 0.         0.55555556 0.         0.         0.         0.22222222
 0.         0.        ]
2024-10-22 17:01:02,276 - DEBUG - === End of Training Data ===
2024-10-22 17:01:02,276 - INFO - Chosen Action: (Reveal player +1 color W) | Visit Count: 5
2024-10-22 17:01:02,278 - DEBUG - Not the current player's turn.
2024-10-22 17:01:03,736 - INFO - Agent state has been reset.
2024-10-22 17:01:03,736 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:03,736 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 15, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W4 || WX|W12345
W2 || XX|RYGWB12345
Deck size: 15
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2}
2024-10-22 17:01:03,736 - INFO - Max Rollouts: 10
2024-10-22 17:01:03,736 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:03,736 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:03,736 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:03,945 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:03,946 - DEBUG - Network Policy Logits: [[ 0.00433424 -0.02378158  0.05048668 -0.04160989  0.01001206  0.01200355
   0.0472485   0.01052782  0.03106407  0.00178758  0.01055708  0.01304672
  -0.02891624 -0.00741677  0.02130412 -0.02282047  0.02989634 -0.05138593
   0.02664477 -0.03077476]]
2024-10-22 17:01:03,946 - DEBUG - Network Policy after Softmax: [[0.0500418  0.04865442 0.05240547 0.04779468 0.05032673 0.05042706
  0.05223605 0.0503527  0.05139744 0.04991452 0.05035417 0.05047969
  0.04840524 0.0494572  0.05089825 0.04870121 0.05133746 0.04732972
  0.0511708  0.04831536]]
2024-10-22 17:01:03,947 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33815536 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.31801784
  0.34382683 0.        ]]
2024-10-22 17:01:03,948 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.5036165  0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.23851338
 0.25787014 0.        ]
2024-10-22 17:01:03,948 - DEBUG - Added Child Node: ((Discard 4),) | P=0.5036165118217468
2024-10-22 17:01:03,949 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.23851338028907776
2024-10-22 17:01:03,950 - DEBUG - Added Child Node: ((Reveal player +1 rank 4),) | P=0.2578701376914978
2024-10-22 17:01:03,950 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:03,950 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:03,950 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 15, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W4 || WX|W12345
W2 || XX|RYGWB12345
Deck size: 15
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2}
2024-10-22 17:01:03,950 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:03,950 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:03,950 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:03,950 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:03,950 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:03,951 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:04,164 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:04,165 - DEBUG - Network Policy Logits: [[ 0.04959676 -0.01071519  0.02000064 -0.04913843  0.01981068  0.03200433
   0.03840194  0.01435441 -0.01728481  0.00514706 -0.03594242  0.02063418
  -0.02036617 -0.03572439  0.04008004 -0.01995771  0.01889874 -0.03319289
  -0.0208314  -0.04817877]]
2024-10-22 17:01:04,165 - DEBUG - Network Policy after Softmax: [[0.05260337 0.04952453 0.05106932 0.04765773 0.05105962 0.05168604
  0.05201776 0.05078179 0.04920024 0.05031637 0.0482908  0.05110169
  0.04904887 0.04830132 0.05210513 0.04906891 0.05101308 0.04842375
  0.04902606 0.04770349]]
2024-10-22 17:01:04,166 - DEBUG - Normalized Policy: [[0.        0.        0.        0.4777102 0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.5222899 0.        0.        0.        0.        0.       ]]
2024-10-22 17:01:04,167 - DEBUG - Added Child Node: ((Discard 4), (Discard 3)) | P=0.47771018743515015
2024-10-22 17:01:04,167 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B)) | P=0.5222898721694946
2024-10-22 17:01:04,167 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:04,168 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:04,168 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || WX|W12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B3 || XX|RYGWB12345
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 G3}
2024-10-22 17:01:04,168 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:04,168 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:04,168 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:04,168 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4),)
2024-10-22 17:01:04,168 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)']
2024-10-22 17:01:04,169 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:04,372 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:04,372 - DEBUG - Network Policy Logits: [[ 0.05931876 -0.01465042  0.036807   -0.04934556  0.03482941  0.02656536
   0.02169142  0.00759365 -0.01295436 -0.00123675 -0.04994791  0.01288457
  -0.0138096  -0.01084254  0.03208759 -0.01079552  0.0052605  -0.03125244
  -0.00944013 -0.01305204]]
2024-10-22 17:01:04,373 - DEBUG - Network Policy after Softmax: [[0.05298286 0.0492052  0.05180345 0.04752729 0.05170111 0.05127561
  0.0510263  0.05031199 0.04928873 0.04986967 0.04749868 0.05057889
  0.04924659 0.04939293 0.05155955 0.04939525 0.05019474 0.04839504
  0.04946224 0.04928391]]
2024-10-22 17:01:04,374 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32739303 0.         0.
  0.         0.         0.         0.         0.         0.
  0.33923644 0.         0.         0.         0.         0.33337048
  0.         0.        ]]
2024-10-22 17:01:04,375 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 3)) | P=0.3273930251598358
2024-10-22 17:01:04,376 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 3)) | P=0.33337047696113586
2024-10-22 17:01:04,376 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color G)) | P=0.33923643827438354
2024-10-22 17:01:04,376 - DEBUG - Simulating Node: ((Reveal player +1 rank 4),) | Value: 0.0
2024-10-22 17:01:04,376 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:04,376 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 15, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R1235
XX || W4|W4
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G3 || XX|RYGWB12345
Deck size: 15
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2}
2024-10-22 17:01:04,377 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:04,377 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:04,377 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:04,377 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:01:04,377 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:01:04,378 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:04,590 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:04,591 - DEBUG - Network Policy Logits: [[ 0.04019013 -0.00527706  0.01204001 -0.02672483  0.02913037  0.01637973
   0.03570059  0.00822005 -0.02006173  0.01544121 -0.04473453  0.01804638
  -0.01558964 -0.00804792  0.04864888 -0.01774247  0.01947189 -0.0431737
   0.00579983 -0.0272963 ]]
2024-10-22 17:01:04,591 - DEBUG - Network Policy after Softmax: [[0.05192737 0.04961925 0.05048599 0.04856636 0.05135623 0.05070556
  0.05169476 0.05029351 0.04889104 0.050658   0.04769952 0.05079014
  0.04911017 0.04948195 0.05236847 0.04900456 0.0508626  0.04777403
  0.05017193 0.04853861]]
2024-10-22 17:01:04,592 - DEBUG - Normalized Policy: [[0.         0.         0.         0.5001429  0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.49985713]]
2024-10-22 17:01:04,593 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3)) | P=0.5001428723335266
2024-10-22 17:01:04,594 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 5)) | P=0.4998571276664734
2024-10-22 17:01:04,594 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:01:04,594 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:04,594 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 15, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || WX|W1245
XX || XX|RYGWB1245
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y5 || XX|RYGWB12345
Deck size: 15
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2}
2024-10-22 17:01:04,594 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:04,594 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:04,594 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:04,595 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.7986326813697815 | PUCT: 0.7986326813697815
2024-10-22 17:01:04,595 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.4089292585849762 | PUCT: 0.4089292585849762
2024-10-22 17:01:04,596 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.3782333731651306 | PUCT: 0.3782333731651306
2024-10-22 17:01:04,596 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.7986326813697815
2024-10-22 17:01:04,596 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:04,596 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 3))
2024-10-22 17:01:04,596 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 3))']
2024-10-22 17:01:04,597 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:04,598 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:04,789 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:04,789 - DEBUG - Network Policy Logits: [[-0.02088348 -0.00394305  0.04338427 -0.03180543 -0.02177044  0.02448572
   0.03570886 -0.00400601  0.03115345  0.00876892  0.01321452  0.0034877
  -0.04891377 -0.03466458  0.02323124 -0.02211103  0.02852433 -0.02622662
   0.01627393 -0.04448382]]
2024-10-22 17:01:04,789 - DEBUG - Network Policy after Softmax: [[0.04902287 0.04986041 0.05227691 0.04849036 0.04897941 0.05129823
  0.0518772  0.04985728 0.05164142 0.05049829 0.05072328 0.0502323
  0.04766783 0.04835192 0.05123391 0.04896273 0.05150582 0.04876164
  0.0508787  0.04787946]]
2024-10-22 17:01:04,790 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.32810202 0.34514344 0.3267545
  0.         0.        ]]
2024-10-22 17:01:04,791 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Reveal player +1 rank 1)) | P=0.3281020224094391
2024-10-22 17:01:04,792 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Reveal player +1 rank 2)) | P=0.3451434373855591
2024-10-22 17:01:04,792 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Reveal player +1 rank 3)) | P=0.32675451040267944
2024-10-22 17:01:04,792 - DEBUG - Simulating Node: ((Discard 4), (Discard 3)) | Value: 0.0
2024-10-22 17:01:04,792 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:04,792 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 8, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 8
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W2 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 W5 W4}
2024-10-22 17:01:04,792 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:04,792 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:04,792 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:04,793 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5617700219154358 | PUCT: 0.5617700219154358
2024-10-22 17:01:04,793 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.4314703345298767 | PUCT: 0.4314703345298767
2024-10-22 17:01:04,794 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.3990824222564697 | PUCT: 0.3990824222564697
2024-10-22 17:01:04,794 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.5617700219154358
2024-10-22 17:01:04,794 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:04,794 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 color B))
2024-10-22 17:01:04,794 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 color B))']
2024-10-22 17:01:04,795 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:04,795 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:04,985 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:04,985 - DEBUG - Network Policy Logits: [[-0.00460209 -0.02074258  0.0477015  -0.02293815  0.006337    0.00187449
   0.02977249  0.0083433   0.01725825 -0.0043258   0.00453208 -0.02538957
  -0.02739147 -0.00279048  0.02265408 -0.0301488   0.01415984 -0.04112824
   0.02199199 -0.01630449]]
2024-10-22 17:01:04,986 - DEBUG - Network Policy after Softmax: [[0.04981054 0.04901302 0.05248514 0.04890553 0.05035841 0.05013418
  0.05155252 0.05045955 0.0509114  0.0498243  0.0502676  0.04878579
  0.04868822 0.04990086 0.05118685 0.04855416 0.0507539  0.04802398
  0.05115297 0.04923103]]
2024-10-22 17:01:04,987 - DEBUG - Normalized Policy: [[0.334327   0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.32233566
  0.3433374  0.        ]]
2024-10-22 17:01:04,988 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Discard 0)) | P=0.33432701230049133
2024-10-22 17:01:04,988 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 3)) | P=0.3223356604576111
2024-10-22 17:01:04,989 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 4)) | P=0.34333738684654236
2024-10-22 17:01:04,989 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:04,989 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:04,989 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W4 || WX|W12345
W2 || XX|RYGWB12345
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 G5}
2024-10-22 17:01:04,989 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:04,989 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:04,989 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:04,990 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4390777051448822 | PUCT: 0.4390777051448822
2024-10-22 17:01:04,990 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.44964781403541565 | PUCT: 0.44964781403541565
2024-10-22 17:01:04,991 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4158954322338104 | PUCT: 0.4158954322338104
2024-10-22 17:01:04,991 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.44964781403541565
2024-10-22 17:01:04,991 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:01:04,991 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Discard 3))
2024-10-22 17:01:04,991 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Discard 3))']
2024-10-22 17:01:04,992 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:04,992 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:05,205 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:05,205 - DEBUG - Network Policy Logits: [[-0.00640632 -0.01871572  0.04125059 -0.04211588 -0.0232446   0.01821716
   0.03122205  0.00750499  0.01671211  0.02378255  0.00837018 -0.00431279
  -0.04859569 -0.01140601  0.02155104 -0.01762899  0.02333531 -0.03667547
   0.03185613 -0.03528852]]
2024-10-22 17:01:05,206 - DEBUG - Network Policy after Softmax: [[0.04971439 0.04910618 0.05214098 0.04797043 0.04888429 0.05095372
  0.0516207  0.05041081 0.05087709 0.05123809 0.05045445 0.04981857
  0.0476606  0.04946645 0.05112388 0.04915958 0.05121518 0.04823212
  0.05165344 0.04829906]]
2024-10-22 17:01:05,207 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33349255 0.
  0.         0.         0.         0.         0.         0.
  0.         0.3374641  0.         0.         0.         0.3290434
  0.         0.        ]]
2024-10-22 17:01:05,208 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 3), (Reveal player +1 color W)) | P=0.3374640941619873
2024-10-22 17:01:05,208 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 3), (Discard 4)) | P=0.33349254727363586
2024-10-22 17:01:05,209 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 3), (Reveal player +1 rank 3)) | P=0.3290433883666992
2024-10-22 17:01:05,209 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Discard 3)) | Value: 0.0
2024-10-22 17:01:05,209 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:05,209 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R1235
W2 || XX|RYGWB1235
W5 || XX|RYGWB12345
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 W4}
2024-10-22 17:01:05,209 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:05,209 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:05,209 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:05,210 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.45389285683631897 | PUCT: 0.45389285683631897
2024-10-22 17:01:05,210 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.30987975001335144 | PUCT: 0.30987975001335144
2024-10-22 17:01:05,211 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.42992836236953735 | PUCT: 0.42992836236953735
2024-10-22 17:01:05,211 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.45389285683631897
2024-10-22 17:01:05,211 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:05,211 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 3)) | Q: 0.0 | U: 0.7030759453773499 | PUCT: 0.7030759453773499
2024-10-22 17:01:05,212 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 color B)) | Q: 0.0 | U: 0.7686865925788879 | PUCT: 0.7686865925788879
2024-10-22 17:01:05,212 - DEBUG - Selected Child: ((Discard 4), (Reveal player +1 color B)) | PUCT: 0.7686865925788879
2024-10-22 17:01:05,212 - DEBUG - Selected child for exploration: ((Discard 4), (Reveal player +1 color B))
2024-10-22 17:01:05,212 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 4))
2024-10-22 17:01:05,212 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 color B))', '((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 4))']
2024-10-22 17:01:05,213 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:05,213 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:05,214 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 3
2024-10-22 17:01:05,407 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:05,407 - DEBUG - Network Policy Logits: [[ 0.05602294 -0.00688043  0.0424831  -0.04789426  0.02281374  0.02722952
   0.02770939  0.00696964 -0.01210377 -0.00422865 -0.04352368  0.01021347
  -0.02364709 -0.01076534  0.02817395 -0.00497163  0.01059731 -0.02405722
  -0.01392683 -0.01974748]]
2024-10-22 17:01:05,407 - DEBUG - Network Policy after Softmax: [[0.05280814 0.04958865 0.05209795 0.04759598 0.05108323 0.0513093
  0.05133393 0.05028024 0.04933031 0.04972032 0.04780445 0.0504436
  0.04876415 0.04939638 0.05135778 0.0496834  0.05046297 0.04874415
  0.04924046 0.04895468]]
2024-10-22 17:01:05,408 - DEBUG - Normalized Policy: [[0.         0.         0.         0.3280122  0.         0.
  0.         0.         0.         0.         0.         0.
  0.3360628  0.         0.         0.         0.         0.33592495
  0.         0.        ]]
2024-10-22 17:01:05,409 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 4), (Discard 3)) | P=0.3280121982097626
2024-10-22 17:01:05,410 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 4), (Reveal player +1 rank 3)) | P=0.3359249532222748
2024-10-22 17:01:05,411 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 4), (Reveal player +1 color G)) | P=0.33606278896331787
2024-10-22 17:01:05,411 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:05,411 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:05,411 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R1235
XX || W4|W4
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G3 || XX|RYGW12345
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 W5}
2024-10-22 17:01:05,411 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:05,411 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:05,411 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:05,412 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3732563555240631 | PUCT: 0.3732563555240631
2024-10-22 17:01:05,412 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.3185349404811859 | PUCT: 0.3185349404811859
2024-10-22 17:01:05,413 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4419366121292114 | PUCT: 0.4419366121292114
2024-10-22 17:01:05,413 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.4419366121292114
2024-10-22 17:01:05,413 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:01:05,413 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Discard 3))
2024-10-22 17:01:05,413 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Discard 3))']
2024-10-22 17:01:05,414 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:05,415 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:05,623 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:05,624 - DEBUG - Network Policy Logits: [[-0.01334013 -0.00373956  0.05058708 -0.02300767 -0.02711394  0.0291069
   0.02638623  0.00342337  0.02209095  0.03512425  0.00327352  0.01546091
  -0.03987752 -0.01367679  0.0097733  -0.032629    0.03016458 -0.03179106
   0.0164852  -0.0457049 ]]
2024-10-22 17:01:05,624 - DEBUG - Network Policy after Softmax: [[0.04929213 0.04976764 0.05254614 0.04881789 0.04861784 0.05142947
  0.05128974 0.0501254  0.05106991 0.05173988 0.05011789 0.05073244
  0.04800125 0.04927554 0.05044471 0.04835045 0.0514839  0.04839098
  0.05078443 0.04772234]]
2024-10-22 17:01:05,626 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.49240372 0.
  0.         0.         0.         0.         0.50759625 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:05,627 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3), (Reveal player +1 color R)) | P=0.5075962543487549
2024-10-22 17:01:05,628 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3), (Discard 4)) | P=0.49240371584892273
2024-10-22 17:01:05,628 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Discard 3)) | Value: 0.0
2024-10-22 17:01:05,628 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:05,628 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
W2 || XX|RYGWB1245
R4 || XX|RYGWB12345
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 W5}
2024-10-22 17:01:05,628 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:05,628 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:05,628 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:05,629 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3821006715297699 | PUCT: 0.3821006715297699
2024-10-22 17:01:05,630 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.32608261704444885 | PUCT: 0.32608261704444885
2024-10-22 17:01:05,631 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.30160555243492126 | PUCT: 0.30160555243492126
2024-10-22 17:01:05,631 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.3821006715297699
2024-10-22 17:01:05,631 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:05,631 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 3)) | Q: 0.0 | U: 0.7575505971908569 | PUCT: 0.7575505971908569
2024-10-22 17:01:05,632 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 color B)) | Q: 0.0 | U: 0.5521631836891174 | PUCT: 0.5521631836891174
2024-10-22 17:01:05,632 - DEBUG - Selected Child: ((Discard 4), (Discard 3)) | PUCT: 0.7575505971908569
2024-10-22 17:01:05,632 - DEBUG - Selected child for exploration: ((Discard 4), (Discard 3))
2024-10-22 17:01:05,632 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 3), (Reveal player +1 rank 1))
2024-10-22 17:01:05,632 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 3))', '((Discard 4), (Discard 3), (Reveal player +1 rank 1))']
2024-10-22 17:01:05,633 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:05,634 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:05,634 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:01:05,634 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:05,634 - DEBUG - Rollout #10 completed with reward=4
2024-10-22 17:01:05,634 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:05,634 - DEBUG - Best node chosen by MCTS: ((Discard 4),) | Visit Count: 5
2024-10-22 17:01:05,634 - INFO - Actual Game Score: 4
2024-10-22 17:01:05,635 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:05,635 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:05,635 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.55555556 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.22222222
 0.22222222 0.        ]
2024-10-22 17:01:05,635 - DEBUG - === End of Training Data ===
2024-10-22 17:01:05,636 - INFO - Chosen Action: (Discard 4) | Visit Count: 5
2024-10-22 17:01:05,637 - DEBUG - Not the current player's turn.
2024-10-22 17:01:07,720 - INFO - Agent state has been reset.
2024-10-22 17:01:07,720 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:07,721 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W4 || WX|W12345
W2 || XX|RYGWB12345
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:07,721 - INFO - Max Rollouts: 10
2024-10-22 17:01:07,721 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:07,721 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:07,721 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:07,939 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:07,939 - DEBUG - Network Policy Logits: [[ 0.02705542 -0.0230967   0.05937617 -0.03311009  0.02140891 -0.00582133
   0.03289146  0.00386554  0.02662603 -0.00899411  0.00151453 -0.00622815
  -0.01873953  0.01169298  0.03282101 -0.01617825  0.00947014 -0.0500439
   0.03264572 -0.00168996]]
2024-10-22 17:01:07,939 - DEBUG - Network Policy after Softmax: [[0.05110957 0.04860954 0.05278846 0.04812522 0.0508218  0.04945658
  0.05140872 0.04993799 0.05108763 0.04929991 0.04982072 0.04943646
  0.0488218  0.0503304  0.0514051  0.04894701 0.05021865 0.04731714
  0.05139609 0.04966132]]
2024-10-22 17:01:07,941 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33986548 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.31642845
  0.343706   0.        ]]
2024-10-22 17:01:07,941 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.2548991  0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.48732135
 0.2577795  0.        ]
2024-10-22 17:01:07,942 - DEBUG - Added Child Node: ((Discard 4),) | P=0.25489911437034607
2024-10-22 17:01:07,942 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.4873213469982147
2024-10-22 17:01:07,943 - DEBUG - Added Child Node: ((Reveal player +1 rank 4),) | P=0.2577795088291168
2024-10-22 17:01:07,943 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:07,943 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:07,943 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || RX|R12345
W4 || WX|W12345
W2 || XX|RYGWB12345
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:07,943 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:07,943 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:07,943 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:07,944 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:07,944 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:07,944 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:08,143 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:08,143 - DEBUG - Network Policy Logits: [[ 0.04909897  0.00084883  0.02624419 -0.03718951  0.03676678  0.03323521
   0.03750949  0.01939128 -0.0165174  -0.00350951 -0.03443062  0.01882074
  -0.04018498 -0.03819606  0.04564437 -0.00894517  0.02554991 -0.01703316
  -0.02747309 -0.0505391 ]]
2024-10-22 17:01:08,143 - DEBUG - Network Policy after Softmax: [[0.05243988 0.04996972 0.05125497 0.04810465 0.05179715 0.05161455
  0.05183563 0.05090492 0.04910942 0.04975241 0.04823755 0.05087589
  0.04796077 0.04805625 0.05225903 0.0494827  0.05121939 0.0490841
  0.04857433 0.04746674]]
2024-10-22 17:01:08,145 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32102647 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.3487507  0.33022287 0.         0.
  0.         0.        ]]
2024-10-22 17:01:08,146 - DEBUG - Added Child Node: ((Discard 4), (Discard 3)) | P=0.321026474237442
2024-10-22 17:01:08,147 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1)) | P=0.33022287487983704
2024-10-22 17:01:08,148 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B)) | P=0.3487507104873657
2024-10-22 17:01:08,148 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:08,148 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:08,148 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R12345
XX || WX|W12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 G5}
2024-10-22 17:01:08,148 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:08,148 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:08,148 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:08,149 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4),)
2024-10-22 17:01:08,149 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)']
2024-10-22 17:01:08,150 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:08,384 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:08,384 - DEBUG - Network Policy Logits: [[ 0.07324572 -0.00386662  0.03505376 -0.02651762  0.04068751  0.00403764
   0.01031428 -0.00786127 -0.00351764 -0.00222451 -0.02332358  0.03816431
  -0.02561968 -0.00797753  0.04265852 -0.00804975  0.01456707 -0.02161313
  -0.01806912 -0.03145262]]
2024-10-22 17:01:08,385 - DEBUG - Network Policy after Softmax: [[0.05356776 0.04959228 0.05156048 0.04848159 0.05185178 0.04998582
  0.05030055 0.04939457 0.04960959 0.04967378 0.04863669 0.05172111
  0.04852514 0.04938883 0.05195408 0.04938526 0.05051492 0.04871995
  0.04889292 0.04824292]]
2024-10-22 17:01:08,386 - DEBUG - Normalized Policy: [[0.         0.         0.         0.4953651  0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.50463486 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:08,387 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color W)) | P=0.5046348571777344
2024-10-22 17:01:08,388 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 3)) | P=0.49536511301994324
2024-10-22 17:01:08,388 - DEBUG - Simulating Node: ((Reveal player +1 rank 4),) | Value: 0.0
2024-10-22 17:01:08,389 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:08,389 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': None}, {'color': 'W', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || RX|R1235
XX || W4|W4
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:08,389 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:08,389 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:08,389 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:08,389 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:01:08,389 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:01:08,390 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:08,613 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:08,614 - DEBUG - Network Policy Logits: [[ 0.05293595  0.00953205  0.00626304 -0.00540745  0.02879731 -0.00438443
   0.02204519 -0.00289955 -0.01298892  0.01162726 -0.02247102  0.03685195
  -0.03139003 -0.0101481   0.06275771 -0.01583534  0.02378837 -0.03946669
  -0.00555965 -0.04492043]]
2024-10-22 17:01:08,614 - DEBUG - Network Policy after Softmax: [[0.05254173 0.05031    0.0501458  0.04956397 0.05128863 0.04961471
  0.05094349 0.04968844 0.04918963 0.05041552 0.04872541 0.05170341
  0.04829276 0.04932957 0.05306032 0.04904981 0.05103237 0.04790429
  0.04955643 0.04764374]]
2024-10-22 17:01:08,615 - DEBUG - Normalized Policy: [[0.         0.         0.         0.48943672 0.         0.
  0.         0.         0.         0.         0.         0.5105633
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:08,616 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3)) | P=0.48943671584129333
2024-10-22 17:01:08,616 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color Y)) | P=0.510563313961029
2024-10-22 17:01:08,616 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:01:08,616 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:08,617 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || WX|W1245
XX || XX|RYGWB1245
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y5 || X5|RYGWB5
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:08,617 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:08,617 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:08,617 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:08,617 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.40421780943870544 | PUCT: 0.40421780943870544
2024-10-22 17:01:08,618 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.40878552198410034 | PUCT: 0.40878552198410034
2024-10-22 17:01:08,618 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.772791862487793 | PUCT: 0.772791862487793
2024-10-22 17:01:08,618 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.772791862487793
2024-10-22 17:01:08,618 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:01:08,618 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Discard 3))
2024-10-22 17:01:08,618 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Discard 3))']
2024-10-22 17:01:08,619 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:08,620 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:08,830 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:08,831 - DEBUG - Network Policy Logits: [[ 0.00253173 -0.00834271  0.04403125 -0.00217036 -0.0041623   0.0231496
   0.01771359  0.01027343  0.02828519  0.01847916 -0.00590304  0.00590871
  -0.03952355  0.00346114  0.01118395 -0.0162638   0.01325042 -0.01780055
   0.02350854 -0.00982281]]
2024-10-22 17:01:08,831 - DEBUG - Network Policy after Softmax: [[0.04987375 0.04933434 0.05198703 0.04963979 0.049541   0.05091271
  0.0506367  0.05026135 0.05117485 0.05067548 0.04945485 0.05004245
  0.04781979 0.04992012 0.05030714 0.0489451  0.0504112  0.04886994
  0.05093099 0.04926137]]
2024-10-22 17:01:08,832 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33271927 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.32871717 0.33856356 0.
  0.         0.        ]]
2024-10-22 17:01:08,833 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3), (Discard 4)) | P=0.33271926641464233
2024-10-22 17:01:08,834 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3), (Reveal player +1 rank 1)) | P=0.3287171721458435
2024-10-22 17:01:08,834 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3), (Reveal player +1 rank 2)) | P=0.33856356143951416
2024-10-22 17:01:08,834 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Discard 3)) | Value: 0.0
2024-10-22 17:01:08,834 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:08,834 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
W2 || XX|RYGWB1245
B1 || XX|RYGWB12345
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W1}
2024-10-22 17:01:08,834 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:08,835 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:08,835 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:08,835 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4264991879463196 | PUCT: 0.4264991879463196
2024-10-22 17:01:08,836 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.4313186705112457 | PUCT: 0.4313186705112457
2024-10-22 17:01:08,836 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.5435932278633118 | PUCT: 0.5435932278633118
2024-10-22 17:01:08,836 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.5435932278633118
2024-10-22 17:01:08,836 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:01:08,836 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Reveal player +1 color Y))
2024-10-22 17:01:08,836 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 color Y))']
2024-10-22 17:01:08,837 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:08,837 - DEBUG - Illegal move encountered: (Reveal player +1 color Y)
2024-10-22 17:01:08,837 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:08,837 - DEBUG - Rollout #6 completed with reward=4
2024-10-22 17:01:08,837 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:08,838 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4444672167301178 | PUCT: 0.4444672167301178
2024-10-22 17:01:08,838 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.4494897425174713 | PUCT: 0.4494897425174713
2024-10-22 17:01:08,839 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 1.3333333333333333 | U: 0.4248707592487335 | PUCT: 1.7582041025161743
2024-10-22 17:01:08,839 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 1.7582041025161743
2024-10-22 17:01:08,839 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:01:08,839 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Discard 3)) | Q: 0.0 | U: 0.7203345894813538 | PUCT: 0.7203345894813538
2024-10-22 17:01:08,840 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Reveal player +1 color Y)) | Q: 4.0 | U: 0.751427948474884 | PUCT: 4.751428127288818
2024-10-22 17:01:08,840 - DEBUG - Selected Child: ((Reveal player +1 rank 3), (Reveal player +1 color Y)) | PUCT: 4.751428127288818
2024-10-22 17:01:08,840 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3), (Reveal player +1 color Y))
2024-10-22 17:01:08,840 - DEBUG - Node ((Reveal player +1 rank 3), (Reveal player +1 color Y)) is a leaf node.
2024-10-22 17:01:08,840 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 color Y))']
2024-10-22 17:01:08,840 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:08,841 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 2
2024-10-22 17:01:09,046 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:09,046 - DEBUG - Network Policy Logits: [[ 0.0147702  -0.01776182  0.05235341  0.00147799  0.01459299  0.00337511
  -0.01136874  0.0085654   0.01391031  0.01032059 -0.00902559 -0.00715029
  -0.03232693  0.03403988  0.00947438 -0.02961887  0.01475363 -0.03571958
   0.0325932  -0.01244689]]
2024-10-22 17:01:09,046 - DEBUG - Network Policy after Softmax: [[0.05059262 0.04897323 0.05253024 0.04992459 0.05058366 0.05001939
  0.04928732 0.05027968 0.05054914 0.05036801 0.04940294 0.04949568
  0.0482651  0.05157698 0.0503254  0.04839598 0.05059179 0.04810163
  0.05150242 0.04923421]]
2024-10-22 17:01:09,048 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.49550006 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.5044999  0.        ]]
2024-10-22 17:01:09,048 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color Y), (Discard 4)) | P=0.4955000579357147
2024-10-22 17:01:09,049 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color Y), (Reveal player +1 rank 4)) | P=0.5044999122619629
2024-10-22 17:01:09,049 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 17:01:09,049 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:09,049 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || Y5|Y5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
W4 || WX|W1245
W2 || XX|RYGWB1245
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:09,049 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:09,049 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:09,049 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:09,050 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4594642221927643 | PUCT: 0.4594642221927643
2024-10-22 17:01:09,050 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.46465620398521423 | PUCT: 0.46465620398521423
2024-10-22 17:01:09,051 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 1.0 | U: 0.35136523842811584 | PUCT: 1.3513652086257935
2024-10-22 17:01:09,051 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 1.3513652086257935
2024-10-22 17:01:09,051 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:01:09,051 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Discard 3)) | Q: 0.0 | U: 0.7761464715003967 | PUCT: 0.7761464715003967
2024-10-22 17:01:09,052 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Reveal player +1 color Y)) | Q: 2.0 | U: 0.5397659540176392 | PUCT: 2.5397658348083496
2024-10-22 17:01:09,052 - DEBUG - Selected Child: ((Reveal player +1 rank 3), (Reveal player +1 color Y)) | PUCT: 2.5397658348083496
2024-10-22 17:01:09,052 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3), (Reveal player +1 color Y))
2024-10-22 17:01:09,052 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Reveal player +1 color Y), (Discard 4))
2024-10-22 17:01:09,052 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 color Y))', '((Reveal player +1 rank 3), (Reveal player +1 color Y), (Discard 4))']
2024-10-22 17:01:09,053 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:09,053 - DEBUG - Illegal move encountered: (Reveal player +1 color Y)
2024-10-22 17:01:09,053 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:09,053 - DEBUG - Rollout #8 completed with reward=4
2024-10-22 17:01:09,053 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:09,054 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.47229743003845215 | PUCT: 0.47229743003845215
2024-10-22 17:01:09,054 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.4776344299316406 | PUCT: 0.4776344299316406
2024-10-22 17:01:09,054 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 1.6 | U: 0.30098262429237366 | PUCT: 1.9009826183319092
2024-10-22 17:01:09,055 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 1.9009826183319092
2024-10-22 17:01:09,055 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:01:09,055 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Discard 3)) | Q: 0.0 | U: 0.8189293146133423 | PUCT: 0.8189293146133423
2024-10-22 17:01:09,055 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Reveal player +1 color Y)) | Q: 2.6666666666666665 | U: 0.4271392524242401 | PUCT: 3.093806028366089
2024-10-22 17:01:09,056 - DEBUG - Selected Child: ((Reveal player +1 rank 3), (Reveal player +1 color Y)) | PUCT: 3.093806028366089
2024-10-22 17:01:09,056 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3), (Reveal player +1 color Y))
2024-10-22 17:01:09,056 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Reveal player +1 color Y), (Reveal player +1 rank 4))
2024-10-22 17:01:09,056 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 color Y))', '((Reveal player +1 rank 3), (Reveal player +1 color Y), (Reveal player +1 rank 4))']
2024-10-22 17:01:09,056 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:09,056 - DEBUG - Illegal move encountered: (Reveal player +1 color Y)
2024-10-22 17:01:09,056 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:09,057 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:01:09,057 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:09,057 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.483488529920578 | PUCT: 0.483488529920578
2024-10-22 17:01:09,058 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.48895201086997986 | PUCT: 0.48895201086997986
2024-10-22 17:01:09,058 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 2.0 | U: 0.26409807801246643 | PUCT: 2.2640981674194336
2024-10-22 17:01:09,058 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 2.2640981674194336
2024-10-22 17:01:09,058 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:01:09,059 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Discard 3)) | Q: 0.0 | U: 0.8534300923347473 | PUCT: 0.8534300923347473
2024-10-22 17:01:09,060 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Reveal player +1 color Y)) | Q: 3.0 | U: 0.3561074137687683 | PUCT: 3.356107473373413
2024-10-22 17:01:09,060 - DEBUG - Selected Child: ((Reveal player +1 rank 3), (Reveal player +1 color Y)) | PUCT: 3.356107473373413
2024-10-22 17:01:09,060 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3), (Reveal player +1 color Y))
2024-10-22 17:01:09,060 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Reveal player +1 color Y), (Discard 4)) | Q: 4.0 | U: 0.7857616543769836 | PUCT: 4.785761833190918
2024-10-22 17:01:09,061 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3), (Reveal player +1 color Y), (Reveal player +1 rank 4)) | Q: 4.0 | U: 0.8000335693359375 | PUCT: 4.8000335693359375
2024-10-22 17:01:09,061 - DEBUG - Selected Child: ((Reveal player +1 rank 3), (Reveal player +1 color Y), (Reveal player +1 rank 4)) | PUCT: 4.8000335693359375
2024-10-22 17:01:09,061 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3), (Reveal player +1 color Y), (Reveal player +1 rank 4))
2024-10-22 17:01:09,061 - DEBUG - Node ((Reveal player +1 rank 3), (Reveal player +1 color Y), (Reveal player +1 rank 4)) is a leaf node.
2024-10-22 17:01:09,061 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 color Y))', '((Reveal player +1 rank 3), (Reveal player +1 color Y), (Reveal player +1 rank 4))']
2024-10-22 17:01:09,062 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:09,062 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 2
2024-10-22 17:01:09,063 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 3
2024-10-22 17:01:09,272 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:09,272 - DEBUG - Network Policy Logits: [[ 5.4907136e-02  8.4679844e-03  2.0631341e-02 -9.5534334e-03
   1.7908512e-02 -1.1811627e-02  1.1634039e-02 -1.0906471e-02
   5.0559919e-03 -1.0568416e-05 -2.4697386e-02  3.0475318e-02
  -3.0871144e-02  1.4730238e-03  4.0037427e-02 -7.7609522e-03
   1.2011182e-02 -2.0570561e-02  5.2822437e-03 -1.9646466e-02]]
2024-10-22 17:01:09,272 - DEBUG - Network Policy after Softmax: [[0.05261998 0.05023222 0.05084695 0.04933507 0.05070869 0.04922379
  0.05039151 0.04926837 0.05006113 0.04980813 0.04859358 0.05134996
  0.0482945  0.04988208 0.05184333 0.04942359 0.05041052 0.04879453
  0.05007245 0.04883964]]
2024-10-22 17:01:09,273 - DEBUG - Normalized Policy: [[0.         0.         0.         0.5053292  0.         0.
  0.         0.         0.         0.         0.         0.
  0.49467078 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:09,274 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color Y), (Reveal player +1 rank 4), (Discard 3)) | P=0.5053291916847229
2024-10-22 17:01:09,274 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color Y), (Reveal player +1 rank 4), (Reveal player +1 color G)) | P=0.4946707785129547
2024-10-22 17:01:09,275 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Reveal player +1 color Y), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:09,275 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:09,275 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 14, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || W4|W4
XX || XX|RYGWB125
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y5 || Y5|Y5
Deck size: 14
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1}
2024-10-22 17:01:09,275 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:09,275 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:09,275 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:09,275 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 3),) | Visit Count: 7
2024-10-22 17:01:09,275 - INFO - Actual Game Score: 4
2024-10-22 17:01:09,275 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:09,275 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:09,275 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.11111111 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.77777778
 0.11111111 0.        ]
2024-10-22 17:01:09,276 - DEBUG - === End of Training Data ===
2024-10-22 17:01:09,276 - INFO - Chosen Action: (Reveal player +1 rank 3) | Visit Count: 7
2024-10-22 17:01:09,277 - DEBUG - Not the current player's turn.
2024-10-22 17:01:11,533 - INFO - Agent state has been reset.
2024-10-22 17:01:11,533 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:11,533 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
W2 || XX|RYGWB1245
Y2 || XX|RYGWB12345
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4}
2024-10-22 17:01:11,533 - INFO - Max Rollouts: 10
2024-10-22 17:01:11,533 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:11,534 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:11,535 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:11,822 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:11,822 - DEBUG - Network Policy Logits: [[ 0.01043493 -0.00305934  0.04195836 -0.00557333  0.00627516  0.00373825
   0.02685324  0.01225859  0.03797524  0.01743524 -0.00237045  0.00786395
  -0.02711959  0.00754449  0.01415136 -0.01724735  0.01578451 -0.02752721
   0.0199399  -0.00938162]]
2024-10-22 17:01:11,822 - DEBUG - Network Policy after Softmax: [[0.05018904 0.04951632 0.05179637 0.049392   0.0499807  0.04985406
  0.05101986 0.05028065 0.05159047 0.05054161 0.04955045 0.05006017
  0.04833917 0.05004418 0.05037591 0.04881875 0.05045825 0.04831947
  0.05066836 0.04920426]]
2024-10-22 17:01:11,824 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.49762267 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.50237733 0.
  0.         0.        ]]
2024-10-22 17:01:11,825 - DEBUG - Dirichlet Noise Added: [0.       0.       0.       0.       0.623217 0.       0.       0.
 0.       0.       0.       0.       0.       0.       0.       0.
 0.376783 0.       0.       0.      ]
2024-10-22 17:01:11,826 - DEBUG - Added Child Node: ((Discard 4),) | P=0.623216986656189
2024-10-22 17:01:11,828 - DEBUG - Added Child Node: ((Reveal player +1 rank 2),) | P=0.37678301334381104
2024-10-22 17:01:11,828 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:11,828 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:11,828 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
W2 || XX|RYGWB1245
Y2 || XX|RYGWB12345
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4}
2024-10-22 17:01:11,828 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:11,828 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:11,828 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:11,829 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2),)
2024-10-22 17:01:11,829 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)']
2024-10-22 17:01:11,830 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:01:12,028 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:12,029 - DEBUG - Network Policy Logits: [[ 0.0496808  -0.0116615   0.02109311 -0.02022208  0.04375372 -0.01265471
   0.02196653 -0.01477683  0.00614594 -0.00346004 -0.018805    0.02209433
  -0.03754717  0.01407836  0.02082032 -0.0034215   0.02014477 -0.00243587
  -0.03226412 -0.04059453]]
2024-10-22 17:01:12,029 - DEBUG - Network Policy after Softmax: [[0.05247309 0.04935101 0.05099424 0.04893034 0.05216299 0.04930202
  0.0510388  0.0491975  0.05023769 0.04975742 0.04899972 0.05104532
  0.04808991 0.05063778 0.05098033 0.04975934 0.0509459  0.04980841
  0.04834465 0.04794359]]
2024-10-22 17:01:12,030 - DEBUG - Normalized Policy: [[0.         0.         0.         0.49142575 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.5085743  0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:12,031 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Reveal player +1 color W)) | P=0.5085743069648743
2024-10-22 17:01:12,031 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 3)) | P=0.4914257526397705
2024-10-22 17:01:12,031 - DEBUG - Simulating Node: ((Reveal player +1 rank 2),) | Value: 0.0
2024-10-22 17:01:12,031 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:12,032 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 13, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || X2|RYGWB2
XX || X2|RYGWB2
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || X5|RYGWB5
Deck size: 13
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4}
2024-10-22 17:01:12,032 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:12,032 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:12,032 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:12,032 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:12,032 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:12,033 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:12,227 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:12,228 - DEBUG - Network Policy Logits: [[ 0.03513766 -0.01018061  0.02805872 -0.06210472  0.03311413  0.04369104
   0.04229484  0.03853978 -0.01958601  0.0052262  -0.00973981  0.00903297
  -0.03527116 -0.02388016  0.03881221 -0.00684779  0.02319234 -0.02783253
  -0.02206098 -0.0359463 ]]
2024-10-22 17:01:12,228 - DEBUG - Network Policy after Softmax: [[0.05165045 0.04936199 0.05128611 0.04686432 0.05154604 0.05209413
  0.05202145 0.05182647 0.04889989 0.05012839 0.04938375 0.05031958
  0.04813888 0.04869036 0.05184059 0.04952678 0.05103714 0.0484983
  0.04877902 0.04810639]]
2024-10-22 17:01:12,230 - DEBUG - Normalized Policy: [[0.         0.         0.         0.47479218 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.5252079  0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:12,231 - DEBUG - Added Child Node: ((Discard 4), (Discard 3)) | P=0.4747921824455261
2024-10-22 17:01:12,231 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B)) | P=0.5252078771591187
2024-10-22 17:01:12,232 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:12,232 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:12,232 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || XX|RYGWB1245
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || XX|RYGWB12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 Y5}
2024-10-22 17:01:12,232 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:12,232 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:12,232 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:12,233 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.5545350909233093 | PUCT: 0.5545350909233093
2024-10-22 17:01:12,234 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.9172274470329285 | PUCT: 0.9172274470329285
2024-10-22 17:01:12,234 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.9172274470329285
2024-10-22 17:01:12,234 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:12,234 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 3))
2024-10-22 17:01:12,234 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 3))']
2024-10-22 17:01:12,235 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:12,235 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:12,436 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:12,437 - DEBUG - Network Policy Logits: [[-0.02345597  0.00715577  0.04513689 -0.02785023 -0.0152903   0.03906763
   0.01679495  0.02284237  0.02156956  0.00734143  0.00849714  0.00845964
  -0.05808173 -0.0203594   0.02667307 -0.03501475  0.02731873 -0.01248114
   0.02934811 -0.05616121]]
2024-10-22 17:01:12,437 - DEBUG - Network Policy after Softmax: [[0.04879178 0.05030847 0.052256   0.04857784 0.04919183 0.0519398
  0.05079575 0.05110386 0.05103886 0.05031782 0.050376   0.05037411
  0.04713124 0.0489431  0.0513     0.04823105 0.05133313 0.04933021
  0.05143742 0.04722184]]
2024-10-22 17:01:12,438 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:01:12,438 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Reveal player +1 color R)) | P=1.0
2024-10-22 17:01:12,438 - DEBUG - Simulating Node: ((Discard 4), (Discard 3)) | Value: 0.0
2024-10-22 17:01:12,439 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:12,439 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 8, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 8
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
Y2 || XX|RYGWB12345
R4 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 G5 B4}
2024-10-22 17:01:12,439 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:12,439 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:12,439 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:12,439 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.597500741481781 | PUCT: 0.597500741481781
2024-10-22 17:01:12,440 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6588630676269531 | PUCT: 0.6588630676269531
2024-10-22 17:01:12,440 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.6588630676269531
2024-10-22 17:01:12,440 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:12,440 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 color B))
2024-10-22 17:01:12,440 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 color B))']
2024-10-22 17:01:12,441 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:12,441 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:12,625 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:12,625 - DEBUG - Network Policy Logits: [[ 0.00186045 -0.00652932  0.04789078 -0.01936794 -0.00343082  0.01925167
   0.02206204  0.02415073  0.03758563  0.03378649 -0.00999054  0.00729495
  -0.04696974 -0.0110389   0.0189101  -0.01271551  0.02379538 -0.01776192
   0.01250554 -0.03311261]]
2024-10-22 17:01:12,625 - DEBUG - Network Policy after Softmax: [[0.04985847 0.04944192 0.05220711 0.04881121 0.04959535 0.05073316
  0.05087593 0.05098231 0.05167187 0.05147593 0.04927108 0.05013016
  0.04748236 0.04921946 0.05071583 0.049137   0.0509642  0.04888966
  0.05039205 0.04814491]]
2024-10-22 17:01:12,626 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.49319386 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.50680614 0.
  0.         0.        ]]
2024-10-22 17:01:12,627 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Discard 4)) | P=0.4931938648223877
2024-10-22 17:01:12,628 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 2)) | P=0.5068061351776123
2024-10-22 17:01:12,628 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:12,628 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:12,628 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGW12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
W2 || XX|RYGWB1245
Y2 || XX|RYGWB12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 Y5}
2024-10-22 17:01:12,628 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:12,628 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:12,628 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:12,629 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.6304362416267395 | PUCT: 0.6304362416267395
2024-10-22 17:01:12,629 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5213857889175415 | PUCT: 0.5213857889175415
2024-10-22 17:01:12,629 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.6304362416267395
2024-10-22 17:01:12,629 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:01:12,629 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Discard 3))
2024-10-22 17:01:12,629 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Discard 3))']
2024-10-22 17:01:12,630 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:01:12,631 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:12,812 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:12,813 - DEBUG - Network Policy Logits: [[ 0.0235875  -0.01645669  0.05627317 -0.01047427  0.02203764  0.02124819
   0.02169034  0.01192414  0.02159262  0.00729196  0.00147069  0.00377912
  -0.04109778  0.0174183   0.01568576 -0.00826333  0.01998811 -0.02055967
   0.02685221 -0.0007108 ]]
2024-10-22 17:01:12,813 - DEBUG - Network Policy after Softmax: [[0.05074096 0.04874923 0.05242687 0.04904174 0.05066239 0.05062241
  0.05064479 0.0501526  0.05063985 0.04992082 0.04963106 0.04974576
  0.04756267 0.0504289  0.0503416  0.04915029 0.05055866 0.04854962
  0.05090689 0.04952291]]
2024-10-22 17:01:12,814 - DEBUG - Normalized Policy: [[0.       0.       0.       0.       0.501588 0.       0.       0.
  0.       0.       0.       0.       0.       0.       0.498412 0.
  0.       0.       0.       0.      ]]
2024-10-22 17:01:12,815 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 3), (Discard 4)) | P=0.501587986946106
2024-10-22 17:01:12,816 - DEBUG - Added Child Node: ((Reveal player +1 rank 2), (Discard 3), (Reveal player +1 color B)) | P=0.49841201305389404
2024-10-22 17:01:12,816 - DEBUG - Simulating Node: ((Reveal player +1 rank 2), (Discard 3)) | Value: 0.0
2024-10-22 17:01:12,816 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:12,816 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
B2 || X2|RYGWB2
W5 || XX|RYGWB12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 Y2}
2024-10-22 17:01:12,816 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:12,816 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:12,816 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:12,817 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.43799734115600586 | PUCT: 0.43799734115600586
2024-10-22 17:01:12,817 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5433512926101685 | PUCT: 0.5433512926101685
2024-10-22 17:01:12,817 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.5433512926101685
2024-10-22 17:01:12,817 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:12,818 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 3)) | Q: 0.0 | U: 0.6987813711166382 | PUCT: 0.6987813711166382
2024-10-22 17:01:12,818 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 color B)) | Q: 0.0 | U: 0.7729812860488892 | PUCT: 0.7729812860488892
2024-10-22 17:01:12,818 - DEBUG - Selected Child: ((Discard 4), (Reveal player +1 color B)) | PUCT: 0.7729812860488892
2024-10-22 17:01:12,818 - DEBUG - Selected child for exploration: ((Discard 4), (Reveal player +1 color B))
2024-10-22 17:01:12,818 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 2))
2024-10-22 17:01:12,819 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 color B))', '((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 2))']
2024-10-22 17:01:12,819 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:12,820 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:12,820 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 3
2024-10-22 17:01:13,016 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:13,017 - DEBUG - Network Policy Logits: [[ 0.05221903 -0.01768069  0.01683368 -0.02053089  0.03654276 -0.01865337
   0.01351872 -0.01508674 -0.00295164 -0.01926323 -0.00980018  0.01771838
  -0.04018     0.00468621  0.03309146 -0.01220756  0.00564972  0.00820575
  -0.02289541 -0.02756274]]
2024-10-22 17:01:13,017 - DEBUG - Network Policy after Softmax: [[0.05271428 0.0491554  0.05088158 0.0490155  0.05189436 0.04910761
  0.05071319 0.04928307 0.04988477 0.04907767 0.0495443  0.05092662
  0.04806179 0.05026724 0.05171557 0.04942517 0.0503157  0.05044447
  0.04889974 0.04867203]]
2024-10-22 17:01:13,019 - DEBUG - Normalized Policy: [[0.         0.         0.         0.49345523 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.50654477 0.
  0.         0.        ]]
2024-10-22 17:01:13,020 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 2), (Discard 3)) | P=0.4934552311897278
2024-10-22 17:01:13,020 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 2), (Reveal player +1 rank 2)) | P=0.5065447688102722
2024-10-22 17:01:13,020 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 2)) | Value: 0.0
2024-10-22 17:01:13,020 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:13,021 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': None, 'rank': 1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || X2|RYGWB2
XX || X2|RYGWB2
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || BX|B12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 G5}
2024-10-22 17:01:13,021 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:13,021 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:13,021 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:13,021 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 0.0 | U: 0.4527760446071625 | PUCT: 0.4527760446071625
2024-10-22 17:01:13,022 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4493478238582611 | PUCT: 0.4493478238582611
2024-10-22 17:01:13,022 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 0.4527760446071625
2024-10-22 17:01:13,022 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:01:13,022 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 2), (Reveal player +1 color W))
2024-10-22 17:01:13,022 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 color W))']
2024-10-22 17:01:13,023 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:01:13,023 - DEBUG - Illegal move encountered: (Reveal player +1 color W)
2024-10-22 17:01:13,023 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:13,023 - DEBUG - Rollout #8 completed with reward=4
2024-10-22 17:01:13,023 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:13,024 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 1.3333333333333333 | U: 0.349066823720932 | PUCT: 1.6824002265930176
2024-10-22 17:01:13,025 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.46189847588539124 | PUCT: 0.46189847588539124
2024-10-22 17:01:13,025 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 1.6824002265930176
2024-10-22 17:01:13,025 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:01:13,025 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Discard 3)) | Q: 0.0 | U: 0.7232620120048523 | PUCT: 0.7232620120048523
2024-10-22 17:01:13,026 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 color W)) | Q: 4.0 | U: 0.7485005855560303 | PUCT: 4.748500823974609
2024-10-22 17:01:13,026 - DEBUG - Selected Child: ((Reveal player +1 rank 2), (Reveal player +1 color W)) | PUCT: 4.748500823974609
2024-10-22 17:01:13,026 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2), (Reveal player +1 color W))
2024-10-22 17:01:13,026 - DEBUG - Node ((Reveal player +1 rank 2), (Reveal player +1 color W)) is a leaf node.
2024-10-22 17:01:13,026 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 color W))']
2024-10-22 17:01:13,026 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:01:13,027 - DEBUG - Illegal move encountered: (Reveal player +1 color W)
2024-10-22 17:01:13,027 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:13,027 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:01:13,027 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:13,028 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2),) | Q: 2.0 | U: 0.28587037324905396 | PUCT: 2.285870313644409
2024-10-22 17:01:13,028 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4728431701660156 | PUCT: 0.4728431701660156
2024-10-22 17:01:13,028 - DEBUG - Selected Child: ((Reveal player +1 rank 2),) | PUCT: 2.285870313644409
2024-10-22 17:01:13,028 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2),)
2024-10-22 17:01:13,029 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Discard 3)) | Q: 0.0 | U: 0.7793006300926208 | PUCT: 0.7793006300926208
2024-10-22 17:01:13,029 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 2), (Reveal player +1 color W)) | Q: 4.0 | U: 0.5376631617546082 | PUCT: 4.537662982940674
2024-10-22 17:01:13,029 - DEBUG - Selected Child: ((Reveal player +1 rank 2), (Reveal player +1 color W)) | PUCT: 4.537662982940674
2024-10-22 17:01:13,029 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 2), (Reveal player +1 color W))
2024-10-22 17:01:13,029 - DEBUG - Node ((Reveal player +1 rank 2), (Reveal player +1 color W)) is a leaf node.
2024-10-22 17:01:13,030 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 2),)', '((Reveal player +1 rank 2), (Reveal player +1 color W))']
2024-10-22 17:01:13,030 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 1
2024-10-22 17:01:13,030 - DEBUG - Illegal move encountered: (Reveal player +1 color W)
2024-10-22 17:01:13,030 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:13,030 - DEBUG - Rollout #10 completed with reward=4
2024-10-22 17:01:13,030 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:13,031 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 2),) | Visit Count: 5
2024-10-22 17:01:13,031 - INFO - Actual Game Score: 4
2024-10-22 17:01:13,031 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:13,031 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:13,031 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.44444444 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.55555556 0.
 0.         0.        ]
2024-10-22 17:01:13,031 - DEBUG - === End of Training Data ===
2024-10-22 17:01:13,031 - INFO - Chosen Action: (Reveal player +1 rank 2) | Visit Count: 5
2024-10-22 17:01:13,032 - DEBUG - Not the current player's turn.
2024-10-22 17:01:15,084 - INFO - Agent state has been reset.
2024-10-22 17:01:15,084 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:15,084 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
Y2 || X2|RYGWB2
R4 || XX|RYGWB12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:15,084 - INFO - Max Rollouts: 10
2024-10-22 17:01:15,084 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:15,085 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:15,085 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:15,309 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:15,310 - DEBUG - Network Policy Logits: [[ 0.01510272 -0.01452387  0.05702178 -0.01385422  0.02781202  0.01797058
   0.02200957  0.01857064  0.02470339 -0.00091397  0.01251679  0.00812977
  -0.04211337  0.01918964  0.00767361 -0.02278714  0.0309764  -0.02759336
   0.02884255 -0.01291453]]
2024-10-22 17:01:15,310 - DEBUG - Network Policy after Softmax: [[0.05035328 0.04888336 0.0525089  0.04891611 0.05099731 0.05049789
  0.05070226 0.0505282  0.05083903 0.0495532  0.05022324 0.05000339
  0.04755313 0.05055948 0.04998058 0.04848108 0.05115894 0.04824864
  0.0510499  0.04896209]]
2024-10-22 17:01:15,312 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33723044 0.
  0.         0.         0.         0.         0.3321117  0.3306579
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:15,313 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.25292283 0.
 0.         0.         0.         0.         0.33133602 0.41574115
 0.         0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:15,314 - DEBUG - Added Child Node: ((Reveal player +1 color R),) | P=0.33133602142333984
2024-10-22 17:01:15,314 - DEBUG - Added Child Node: ((Discard 4),) | P=0.25292283296585083
2024-10-22 17:01:15,315 - DEBUG - Added Child Node: ((Reveal player +1 color Y),) | P=0.4157411456108093
2024-10-22 17:01:15,315 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:15,315 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:15,316 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
Y2 || X2|RYGWB2
R4 || XX|RYGWB12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:15,316 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:15,316 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:15,316 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:15,316 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R),)
2024-10-22 17:01:15,316 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)']
2024-10-22 17:01:15,318 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:01:15,517 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:15,517 - DEBUG - Network Policy Logits: [[ 0.04960086 -0.00089     0.01093278 -0.00846863  0.05539504 -0.00042484
   0.01675066 -0.01411308 -0.00301193  0.01766782 -0.00986961  0.00678121
  -0.02927631 -0.00418997  0.01749917 -0.00599966  0.00434801 -0.01267999
  -0.03078298 -0.02100423]]
2024-10-22 17:01:15,517 - DEBUG - Network Policy after Softmax: [[0.05242977 0.04984827 0.05044111 0.04947192 0.05273444 0.04987146
  0.05073543 0.04919346 0.04974261 0.05078198 0.04940265 0.05023213
  0.04845315 0.04968404 0.05077342 0.04959421 0.05011006 0.04926401
  0.04838021 0.04885563]]
2024-10-22 17:01:15,519 - DEBUG - Normalized Policy: [[0.         0.         0.         0.49618766 0.         0.
  0.         0.         0.         0.         0.         0.5038124
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:15,519 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 3)) | P=0.49618765711784363
2024-10-22 17:01:15,520 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color Y)) | P=0.5038123726844788
2024-10-22 17:01:15,520 - DEBUG - Simulating Node: ((Reveal player +1 color R),) | Value: 0.0
2024-10-22 17:01:15,520 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:15,520 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': 'R', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || X2|YGWB2
XX || RX|R12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y5 || X5|RYGWB5
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:15,520 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:15,520 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:15,520 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:15,520 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:15,520 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:15,521 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:15,719 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:15,719 - DEBUG - Network Policy Logits: [[ 0.02909496  0.00225851  0.01752451 -0.05391539  0.03352759  0.04109411
   0.0579415   0.01732313 -0.00603671  0.00257554 -0.01936919  0.013936
  -0.04369232 -0.01702665  0.03221403 -0.00612344  0.01239167 -0.02190385
  -0.01878995 -0.06049144]]
2024-10-22 17:01:15,720 - DEBUG - Network Policy after Softmax: [[0.05141943 0.05005787 0.05082792 0.04732345 0.05164786 0.05204014
  0.05292431 0.05081768 0.04964435 0.05007374 0.04898686 0.05064584
  0.04780972 0.04910174 0.05158006 0.04964004 0.05056769 0.04886285
  0.04901524 0.04701326]]
2024-10-22 17:01:15,722 - DEBUG - Normalized Policy: [[0.         0.         0.         0.32864413 0.         0.
  0.         0.         0.         0.         0.         0.
  0.33202112 0.         0.         0.         0.         0.33933473
  0.         0.        ]]
2024-10-22 17:01:15,722 - DEBUG - Added Child Node: ((Discard 4), (Discard 3)) | P=0.32864412665367126
2024-10-22 17:01:15,723 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3)) | P=0.33933472633361816
2024-10-22 17:01:15,723 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color G)) | P=0.3320211172103882
2024-10-22 17:01:15,724 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:15,724 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:15,724 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || X2|RYGWB2
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G3 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 G5}
2024-10-22 17:01:15,724 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:15,724 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:15,724 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:15,724 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y),)
2024-10-22 17:01:15,724 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)']
2024-10-22 17:01:15,725 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:01:15,978 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:15,979 - DEBUG - Network Policy Logits: [[ 0.0337517   0.00919582  0.00302545 -0.02036198  0.04739961  0.02467554
   0.03090028 -0.01216538 -0.02109783  0.00564686 -0.00475014  0.01812277
  -0.03008656 -0.017582    0.04300909 -0.01232062  0.01381972 -0.03151484
  -0.01568091 -0.04258358]]
2024-10-22 17:01:15,979 - DEBUG - Network Policy after Softmax: [[0.05164442 0.05039169 0.05008171 0.04892402 0.05235409 0.05117781
  0.05149737 0.04932668 0.04888803 0.05021317 0.0496938  0.05084354
  0.04845056 0.04906022 0.05212473 0.04931902 0.05062523 0.04838141
  0.04915357 0.04784884]]
2024-10-22 17:01:15,981 - DEBUG - Normalized Policy: [[0.         0.         0.         0.49038    0.         0.
  0.         0.         0.         0.         0.         0.50961995
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:15,982 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 3)) | P=0.4903799891471863
2024-10-22 17:01:15,983 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | P=0.509619951248169
2024-10-22 17:01:15,983 - DEBUG - Simulating Node: ((Reveal player +1 color Y),) | Value: 0.0
2024-10-22 17:01:15,983 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:15,983 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || Y2|Y2
XX || XX|RGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y5 || X5|RYGWB5
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:15,983 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:15,983 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:15,983 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:15,984 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5254310965538025 | PUCT: 0.5254310965538025
2024-10-22 17:01:15,985 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4010838270187378 | PUCT: 0.4010838270187378
2024-10-22 17:01:15,986 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 0.0 | U: 0.6592803597450256 | PUCT: 0.6592803597450256
2024-10-22 17:01:15,986 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 0.6592803597450256
2024-10-22 17:01:15,986 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:01:15,986 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Reveal player +1 color Y))
2024-10-22 17:01:15,986 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 color Y))']
2024-10-22 17:01:15,987 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:01:15,987 - DEBUG - Illegal move encountered: (Reveal player +1 color Y)
2024-10-22 17:01:15,987 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:15,988 - DEBUG - Rollout #5 completed with reward=4
2024-10-22 17:01:15,988 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:15,989 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.554394006729126 | PUCT: 0.554394006729126
2024-10-22 17:01:15,989 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.42319241166114807 | PUCT: 0.42319241166114807
2024-10-22 17:01:15,990 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 2.0 | U: 0.4637475311756134 | PUCT: 2.463747501373291
2024-10-22 17:01:15,990 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 2.463747501373291
2024-10-22 17:01:15,990 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:01:15,990 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Discard 3))
2024-10-22 17:01:15,990 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Discard 3))']
2024-10-22 17:01:15,992 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:01:15,992 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:16,248 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:16,248 - DEBUG - Network Policy Logits: [[-0.00171897 -0.00823421  0.0338646  -0.02035736  0.02305666  0.0270167
   0.02381307  0.00939781  0.0233735   0.0085617  -0.00484503 -0.01174024
  -0.03623702  0.00952264  0.03255147 -0.02452909 -0.00948766 -0.02252341
   0.01934971 -0.00659565]]
2024-10-22 17:01:16,248 - DEBUG - Network Policy after Softmax: [[0.04974387 0.04942083 0.0515458  0.0488253  0.0509917  0.05119402
  0.05103028 0.05029994 0.05100785 0.05025791 0.04958861 0.04924786
  0.0480561  0.05030622 0.05147815 0.04862204 0.04935892 0.04871966
  0.05080302 0.04950187]]
2024-10-22 17:01:16,249 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50697494 0.
  0.         0.         0.         0.         0.493025   0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:16,250 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 3), (Reveal player +1 color R)) | P=0.493025004863739
2024-10-22 17:01:16,251 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Discard 3), (Discard 4)) | P=0.5069749355316162
2024-10-22 17:01:16,251 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Discard 3)) | Value: 0.0
2024-10-22 17:01:16,251 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:16,251 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || XX|RGWB12345
W4 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2}
2024-10-22 17:01:16,251 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:16,251 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:16,251 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:16,252 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5777501463890076 | PUCT: 0.5777501463890076
2024-10-22 17:01:16,252 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4410211741924286 | PUCT: 0.4410211741924286
2024-10-22 17:01:16,252 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 1.3333333333333333 | U: 0.3624636232852936 | PUCT: 1.6957969665527344
2024-10-22 17:01:16,253 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 1.6957969665527344
2024-10-22 17:01:16,253 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:01:16,253 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | Q: 4.0 | U: 0.7500395178794861 | PUCT: 4.750039577484131
2024-10-22 17:01:16,253 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Discard 3)) | Q: 0.0 | U: 0.7217229008674622 | PUCT: 0.7217229008674622
2024-10-22 17:01:16,254 - DEBUG - Selected Child: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | PUCT: 4.750039577484131
2024-10-22 17:01:16,254 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y), (Reveal player +1 color Y))
2024-10-22 17:01:16,254 - DEBUG - Node ((Reveal player +1 color Y), (Reveal player +1 color Y)) is a leaf node.
2024-10-22 17:01:16,254 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 color Y))']
2024-10-22 17:01:16,254 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:01:16,255 - DEBUG - Illegal move encountered: (Reveal player +1 color Y)
2024-10-22 17:01:16,255 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:16,255 - DEBUG - Rollout #7 completed with reward=4
2024-10-22 17:01:16,255 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:16,255 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5972443222999573 | PUCT: 0.5972443222999573
2024-10-22 17:01:16,256 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4559018611907959 | PUCT: 0.4559018611907959
2024-10-22 17:01:16,256 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 2.0 | U: 0.29975494742393494 | PUCT: 2.2997548580169678
2024-10-22 17:01:16,256 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 2.2997548580169678
2024-10-22 17:01:16,256 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:01:16,257 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | Q: 4.0 | U: 0.5387685894966125 | PUCT: 4.538768768310547
2024-10-22 17:01:16,257 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Discard 3)) | Q: 0.0 | U: 0.7776423096656799 | PUCT: 0.7776423096656799
2024-10-22 17:01:16,257 - DEBUG - Selected Child: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | PUCT: 4.538768768310547
2024-10-22 17:01:16,257 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y), (Reveal player +1 color Y))
2024-10-22 17:01:16,257 - DEBUG - Node ((Reveal player +1 color Y), (Reveal player +1 color Y)) is a leaf node.
2024-10-22 17:01:16,257 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 color Y))']
2024-10-22 17:01:16,258 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:01:16,258 - DEBUG - Illegal move encountered: (Reveal player +1 color Y)
2024-10-22 17:01:16,258 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:16,258 - DEBUG - Rollout #8 completed with reward=4
2024-10-22 17:01:16,258 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:16,259 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.6139258146286011 | PUCT: 0.6139258146286011
2024-10-22 17:01:16,259 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.46863558888435364 | PUCT: 0.46863558888435364
2024-10-22 17:01:16,260 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 2.4 | U: 0.2567727863788605 | PUCT: 2.6567728519439697
2024-10-22 17:01:16,260 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 2.6567728519439697
2024-10-22 17:01:16,260 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:01:16,260 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | Q: 4.0 | U: 0.42635002732276917 | PUCT: 4.426350116729736
2024-10-22 17:01:16,261 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Discard 3)) | Q: 0.0 | U: 0.8205075860023499 | PUCT: 0.8205075860023499
2024-10-22 17:01:16,261 - DEBUG - Selected Child: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | PUCT: 4.426350116729736
2024-10-22 17:01:16,261 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y), (Reveal player +1 color Y))
2024-10-22 17:01:16,261 - DEBUG - Node ((Reveal player +1 color Y), (Reveal player +1 color Y)) is a leaf node.
2024-10-22 17:01:16,261 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 color Y))']
2024-10-22 17:01:16,262 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:01:16,262 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 2
2024-10-22 17:01:16,475 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:16,476 - DEBUG - Network Policy Logits: [[ 0.01717009 -0.00428224  0.05713358  0.01837953  0.0349195   0.00610948
   0.00834863  0.01266613 -0.00829755  0.00461672  0.01074147 -0.00409944
  -0.03692961  0.01387107  0.02033722 -0.02454287  0.01504477 -0.02964041
   0.0197016  -0.00254609]]
2024-10-22 17:01:16,476 - DEBUG - Network Policy after Softmax: [[0.05052844 0.04945603 0.05258863 0.05058959 0.0514333  0.04997265
  0.05008467 0.05030138 0.04925785 0.0498981  0.05020466 0.04946508
  0.0478675  0.05036202 0.05068873 0.04846411 0.05042117 0.04821769
  0.05065652 0.04954197]]
2024-10-22 17:01:16,477 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.5060442  0.
  0.         0.         0.         0.         0.49395576 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:16,478 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color Y), (Reveal player +1 color R)) | P=0.4939557611942291
2024-10-22 17:01:16,478 - DEBUG - Added Child Node: ((Reveal player +1 color Y), (Reveal player +1 color Y), (Discard 4)) | P=0.5060442090034485
2024-10-22 17:01:16,478 - DEBUG - Simulating Node: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 17:01:16,478 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:16,479 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || Y5|Y5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
Y2 || Y2|Y2
R4 || XX|RGWB12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:16,479 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:16,479 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:16,479 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:16,479 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.6284728050231934 | PUCT: 0.6284728050231934
2024-10-22 17:01:16,480 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4797399342060089 | PUCT: 0.4797399342060089
2024-10-22 17:01:16,480 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y),) | Q: 2.0 | U: 0.22530603408813477 | PUCT: 2.2253060340881348
2024-10-22 17:01:16,480 - DEBUG - Selected Child: ((Reveal player +1 color Y),) | PUCT: 2.2253060340881348
2024-10-22 17:01:16,480 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y),)
2024-10-22 17:01:16,481 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | Q: 3.0 | U: 0.3554494380950928 | PUCT: 3.3554494380950928
2024-10-22 17:01:16,481 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color Y), (Discard 3)) | Q: 0.0 | U: 0.8550748825073242 | PUCT: 0.8550748825073242
2024-10-22 17:01:16,481 - DEBUG - Selected Child: ((Reveal player +1 color Y), (Reveal player +1 color Y)) | PUCT: 3.3554494380950928
2024-10-22 17:01:16,481 - DEBUG - Selected child for exploration: ((Reveal player +1 color Y), (Reveal player +1 color Y))
2024-10-22 17:01:16,481 - DEBUG - Expanding unexplored child: ((Reveal player +1 color Y), (Reveal player +1 color Y), (Reveal player +1 color R))
2024-10-22 17:01:16,482 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color Y),)', '((Reveal player +1 color Y), (Reveal player +1 color Y))', '((Reveal player +1 color Y), (Reveal player +1 color Y), (Reveal player +1 color R))']
2024-10-22 17:01:16,482 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 1
2024-10-22 17:01:16,482 - DEBUG - Illegal move encountered: (Reveal player +1 color Y)
2024-10-22 17:01:16,482 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:16,482 - DEBUG - Rollout #10 completed with reward=4
2024-10-22 17:01:16,482 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:16,483 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color Y),) | Visit Count: 7
2024-10-22 17:01:16,483 - INFO - Actual Game Score: 4
2024-10-22 17:01:16,483 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:16,483 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:16,483 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.11111111 0.
 0.         0.         0.         0.         0.11111111 0.77777778
 0.         0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:16,483 - DEBUG - === End of Training Data ===
2024-10-22 17:01:16,483 - INFO - Chosen Action: (Reveal player +1 color Y) | Visit Count: 7
2024-10-22 17:01:16,484 - DEBUG - Not the current player's turn.
2024-10-22 17:01:18,915 - INFO - Agent state has been reset.
2024-10-22 17:01:18,915 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:18,915 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
Y2 || Y2|Y2
R4 || XX|RGWB12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:18,915 - INFO - Max Rollouts: 10
2024-10-22 17:01:18,915 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:18,916 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:18,916 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:19,146 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:19,146 - DEBUG - Network Policy Logits: [[ 0.02089315 -0.0062865   0.06701433  0.01423931  0.03913265  0.01055632
   0.00952034  0.01839983 -0.00565073 -0.00881023  0.01823723  0.00467066
  -0.01204471  0.01470473  0.02965188 -0.0083276   0.01595601 -0.02965388
   0.0207276  -0.00670961]]
2024-10-22 17:01:19,146 - DEBUG - Network Policy after Softmax: [[0.05052113 0.04916648 0.05290579 0.05018609 0.05145106 0.0500016
  0.04994982 0.05039532 0.04919775 0.04904255 0.05038713 0.04970817
  0.04888418 0.05020945 0.05096558 0.04906622 0.05027232 0.04803091
  0.05051277 0.04914568]]
2024-10-22 17:01:19,147 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50522363 0.
  0.         0.         0.         0.         0.49477634 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:19,148 - DEBUG - Dirichlet Noise Added: [0.        0.        0.        0.        0.3863197 0.        0.
 0.        0.        0.        0.6136803 0.        0.        0.
 0.        0.        0.        0.        0.        0.       ]
2024-10-22 17:01:19,149 - DEBUG - Added Child Node: ((Reveal player +1 color R),) | P=0.6136803030967712
2024-10-22 17:01:19,149 - DEBUG - Added Child Node: ((Discard 4),) | P=0.38631969690322876
2024-10-22 17:01:19,149 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:19,149 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:19,150 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
Y2 || Y2|Y2
R4 || XX|RGWB12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:19,150 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:19,150 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:19,150 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:19,150 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R),)
2024-10-22 17:01:19,150 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)']
2024-10-22 17:01:19,151 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:01:19,386 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:19,386 - DEBUG - Network Policy Logits: [[ 0.04453565 -0.00136775  0.01675212  0.00051353  0.04442628 -0.00315982
   0.02729008 -0.01301671 -0.00175761  0.00421725  0.00106521  0.01272798
  -0.03195478 -0.01024847  0.01636911 -0.01542426 -0.00344422 -0.00689631
  -0.02152696 -0.00970978]]
2024-10-22 17:01:19,386 - DEBUG - Network Policy after Softmax: [[0.05213838 0.04979916 0.05070974 0.04989293 0.05213268 0.04970999
  0.05124694 0.04922241 0.04977974 0.05007806 0.04992046 0.05050608
  0.04829901 0.04935886 0.05069032 0.04910405 0.04969586 0.0495246
  0.0488053  0.04938545]]
2024-10-22 17:01:19,387 - DEBUG - Normalized Policy: [[0.         0.         0.         0.50811636 0.         0.
  0.         0.         0.         0.         0.         0.
  0.49188367 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:19,388 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 3)) | P=0.5081163644790649
2024-10-22 17:01:19,389 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color G)) | P=0.49188366532325745
2024-10-22 17:01:19,389 - DEBUG - Simulating Node: ((Reveal player +1 color R),) | Value: 0.0
2024-10-22 17:01:19,389 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:19,389 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || Y2|Y2
XX || RX|R12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || W5|W5
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:19,389 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:19,389 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:19,390 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:19,390 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:19,390 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:19,391 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:19,624 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:19,625 - DEBUG - Network Policy Logits: [[ 0.02886077  0.00554846  0.01157422 -0.03691521  0.03820825  0.03670153
   0.05483329  0.00255495 -0.03018324  0.00205907 -0.0148078   0.00406447
  -0.02169164 -0.02901656  0.03227308 -0.01332177  0.00548768 -0.02650756
  -0.00510831 -0.03653711]]
2024-10-22 17:01:19,625 - DEBUG - Network Policy after Softmax: [[0.05142529 0.05024031 0.05054396 0.04815159 0.05190824 0.05183008
  0.05277843 0.05009014 0.04847683 0.05006531 0.04922795 0.05016581
  0.04889023 0.04853342 0.05160106 0.04930115 0.05023726 0.04865535
  0.04970776 0.0481698 ]]
2024-10-22 17:01:19,626 - DEBUG - Normalized Policy: [[0.         0.         0.         0.3304909  0.         0.
  0.         0.         0.         0.         0.         0.
  0.33556065 0.         0.         0.         0.         0.3339485
  0.         0.        ]]
2024-10-22 17:01:19,627 - DEBUG - Added Child Node: ((Discard 4), (Discard 3)) | P=0.3304908871650696
2024-10-22 17:01:19,627 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3)) | P=0.3339484930038452
2024-10-22 17:01:19,628 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color G)) | P=0.3355606496334076
2024-10-22 17:01:19,628 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:19,628 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:19,628 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || Y2|Y2
XX || XX|RGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G3 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 W5}
2024-10-22 17:01:19,628 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:19,628 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:19,628 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:19,629 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.9031916856765747 | PUCT: 0.9031916856765747
2024-10-22 17:01:19,629 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5685708522796631 | PUCT: 0.5685708522796631
2024-10-22 17:01:19,629 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.9031916856765747
2024-10-22 17:01:19,630 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:01:19,630 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Reveal player +1 color G))
2024-10-22 17:01:19,630 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Reveal player +1 color G))']
2024-10-22 17:01:19,630 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:01:19,631 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 2
2024-10-22 17:01:19,854 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:19,854 - DEBUG - Network Policy Logits: [[ 0.00543756 -0.01032542  0.04749563  0.02379287  0.04558886  0.00607976
  -0.00852077  0.00894768  0.00842501 -0.0184296   0.02048265  0.00181737
  -0.04006767  0.00836777  0.02022442 -0.01221831  0.0107998  -0.00376727
   0.00843666 -0.00378093]]
2024-10-22 17:01:19,854 - DEBUG - Network Policy after Softmax: [[0.04996517 0.04918374 0.05211142 0.05089076 0.05201215 0.04999726
  0.04927257 0.05014085 0.05011465 0.04878675 0.05072257 0.0497846
  0.04774244 0.05011179 0.05070948 0.04909072 0.05023381 0.04950735
  0.05011524 0.04950668]]
2024-10-22 17:01:19,856 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50928694 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.49071303 0.        ]]
2024-10-22 17:01:19,856 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color G), (Discard 4)) | P=0.5092869400978088
2024-10-22 17:01:19,857 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color G), (Reveal player +1 rank 4)) | P=0.4907130300998688
2024-10-22 17:01:19,857 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Reveal player +1 color G)) | Value: 0.0
2024-10-22 17:01:19,857 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:19,857 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 12, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
Y2 || Y2|Y2
R4 || RX|R12345
Deck size: 12
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2}
2024-10-22 17:01:19,857 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:19,857 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:19,857 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:19,858 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.648780882358551 | PUCT: 0.648780882358551
2024-10-22 17:01:19,858 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.612623929977417 | PUCT: 0.612623929977417
2024-10-22 17:01:19,858 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.648780882358551
2024-10-22 17:01:19,858 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:01:19,858 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 3))
2024-10-22 17:01:19,858 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 3))']
2024-10-22 17:01:19,859 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:01:19,860 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:20,075 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:20,075 - DEBUG - Network Policy Logits: [[-0.00263208 -0.00712149  0.06648061  0.01466438  0.04252819  0.02077626
   0.02837476  0.00463045  0.00977138  0.00352799 -0.00446868 -0.00325375
  -0.03048641  0.00837537  0.01844448  0.00675467  0.00931697 -0.01817358
   0.00890728  0.00909279]]
2024-10-22 17:01:20,076 - DEBUG - Network Policy after Softmax: [[0.04939804 0.04917677 0.05293281 0.05025988 0.05168001 0.050568
  0.0509537  0.0497581  0.05001456 0.04970327 0.04930739 0.04936734
  0.04804107 0.04994479 0.05045023 0.04986391 0.04999184 0.04863625
  0.04997136 0.04998063]]
2024-10-22 17:01:20,077 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.2573415  0.
  0.         0.         0.         0.         0.24552704 0.
  0.         0.         0.         0.24829821 0.         0.
  0.24883327 0.        ]]
2024-10-22 17:01:20,077 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 3), (Reveal player +1 color R)) | P=0.24552704393863678
2024-10-22 17:01:20,078 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 3), (Discard 4)) | P=0.25734150409698486
2024-10-22 17:01:20,078 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 3), (Reveal player +1 rank 1)) | P=0.24829821288585663
2024-10-22 17:01:20,079 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 3), (Reveal player +1 rank 4)) | P=0.24883326888084412
2024-10-22 17:01:20,079 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 3)) | Value: 0.0
2024-10-22 17:01:20,079 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:20,079 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
R1 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2}
2024-10-22 17:01:20,079 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:20,079 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:20,079 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:20,080 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5134073495864868 | PUCT: 0.5134073495864868
2024-10-22 17:01:20,080 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6463930606842041 | PUCT: 0.6463930606842041
2024-10-22 17:01:20,081 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.6463930606842041
2024-10-22 17:01:20,081 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:20,081 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 3))
2024-10-22 17:01:20,081 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 3))']
2024-10-22 17:01:20,081 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:20,082 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:20,289 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:20,290 - DEBUG - Network Policy Logits: [[-0.00203461  0.00063478  0.04966638 -0.03276153 -0.00444445  0.042555
   0.04276279  0.01627471  0.01225695  0.01343797  0.01262805  0.01129018
  -0.06266197 -0.02802155  0.03492574 -0.02718567  0.00457882 -0.03262095
   0.01378396 -0.04148929]]
2024-10-22 17:01:20,290 - DEBUG - Network Policy after Softmax: [[0.04981757 0.04995073 0.05246093 0.04831011 0.04969766 0.05208918
  0.05210001 0.0507381  0.05053465 0.05059437 0.05055341 0.05048582
  0.046887   0.04853964 0.05169329 0.04858023 0.05014813 0.0483169
  0.05061188 0.04789031]]
2024-10-22 17:01:20,291 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33451128 0.
  0.         0.         0.         0.         0.34027126 0.
  0.         0.         0.         0.         0.         0.32521746
  0.         0.        ]]
2024-10-22 17:01:20,292 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Reveal player +1 color R)) | P=0.3402712643146515
2024-10-22 17:01:20,293 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Discard 4)) | P=0.33451128005981445
2024-10-22 17:01:20,293 - DEBUG - Added Child Node: ((Discard 4), (Discard 3), (Reveal player +1 rank 3)) | P=0.32521745562553406
2024-10-22 17:01:20,293 - DEBUG - Simulating Node: ((Discard 4), (Discard 3)) | Value: 0.0
2024-10-22 17:01:20,293 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:20,294 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || XX|RGWB12345
G3 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 W5 Y2}
2024-10-22 17:01:20,294 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:20,294 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:20,294 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:20,294 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5350367426872253 | PUCT: 0.5350367426872253
2024-10-22 17:01:20,295 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4490833580493927 | PUCT: 0.4490833580493927
2024-10-22 17:01:20,295 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.5350367426872253
2024-10-22 17:01:20,295 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:01:20,295 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Reveal player +1 color G)) | Q: 0.0 | U: 0.7239359021186829 | PUCT: 0.7239359021186829
2024-10-22 17:01:20,296 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 3)) | Q: 0.0 | U: 0.7478265762329102 | PUCT: 0.7478265762329102
2024-10-22 17:01:20,296 - DEBUG - Selected Child: ((Reveal player +1 color R), (Discard 3)) | PUCT: 0.7478265762329102
2024-10-22 17:01:20,296 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Discard 3))
2024-10-22 17:01:20,296 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 3), (Reveal player +1 color R))
2024-10-22 17:01:20,296 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 3))', '((Reveal player +1 color R), (Discard 3), (Reveal player +1 color R))']
2024-10-22 17:01:20,297 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:01:20,297 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:20,298 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 3
2024-10-22 17:01:20,509 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:20,509 - DEBUG - Network Policy Logits: [[ 0.01870055  0.00057009  0.02230632 -0.00699941  0.02047712  0.01212455
   0.05068283  0.00681699 -0.00251283 -0.01630496 -0.00475869  0.02253112
  -0.05157033  0.00704386  0.07086238 -0.02740554  0.00574915 -0.01420035
  -0.01737753 -0.04456082]]
2024-10-22 17:01:20,509 - DEBUG - Network Policy after Softmax: [[0.05079104 0.04987847 0.05097451 0.04950234 0.05088136 0.05045813
  0.05244171 0.05019103 0.04972494 0.04904383 0.04961339 0.05098597
  0.04734442 0.05020242 0.05351071 0.04850243 0.05013746 0.04914716
  0.04899126 0.04767745]]
2024-10-22 17:01:20,511 - DEBUG - Normalized Policy: [[0.        0.        0.        0.        0.5180041 0.        0.
  0.        0.        0.        0.        0.        0.4819959 0.
  0.        0.        0.        0.        0.        0.       ]]
2024-10-22 17:01:20,511 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 3), (Reveal player +1 color R), (Discard 4)) | P=0.5180041193962097
2024-10-22 17:01:20,512 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 3), (Reveal player +1 color R), (Reveal player +1 color G)) | P=0.48199591040611267
2024-10-22 17:01:20,512 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 3), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:01:20,512 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:20,512 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|YGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || W5|W5
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2}
2024-10-22 17:01:20,512 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:20,512 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:20,512 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:20,513 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.4424717426300049 | PUCT: 0.4424717426300049
2024-10-22 17:01:20,513 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.46423614025115967 | PUCT: 0.46423614025115967
2024-10-22 17:01:20,514 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.46423614025115967
2024-10-22 17:01:20,514 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:20,514 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 3))
2024-10-22 17:01:20,514 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 3))']
2024-10-22 17:01:20,514 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:20,515 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:20,737 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:20,737 - DEBUG - Network Policy Logits: [[ 0.00863536 -0.00103233  0.06889988  0.01115829  0.0364329   0.01243538
   0.01493352  0.01606732  0.00228381  0.01037849  0.0096299   0.00368613
  -0.01895046 -0.0043211   0.02777989 -0.02131489  0.01926965 -0.01656803
   0.00764745 -0.02010677]]
2024-10-22 17:01:20,738 - DEBUG - Network Policy after Softmax: [[0.05000377 0.04952268 0.05310988 0.05013009 0.05141325 0.05019415
  0.0503197  0.05037678 0.04968718 0.05009101 0.05005353 0.0497569
  0.04864323 0.04936008 0.05097029 0.04852835 0.05053836 0.04875926
  0.0499544  0.04858702]]
2024-10-22 17:01:20,739 - DEBUG - Normalized Policy: [[0.49975136 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.5002486  0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:20,740 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3), (Reveal player +1 color R)) | P=0.5002486109733582
2024-10-22 17:01:20,741 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 3), (Discard 0)) | P=0.49975135922431946
2024-10-22 17:01:20,741 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 3)) | Value: 0.0
2024-10-22 17:01:20,741 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:20,741 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 2}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X3|RYGWB3
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
Y2 || Y2|Y2
R4 || XX|RGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 W5}
2024-10-22 17:01:20,741 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:20,741 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:20,741 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:20,742 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.4548303484916687 | PUCT: 0.4548303484916687
2024-10-22 17:01:20,742 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3579019606113434 | PUCT: 0.3579019606113434
2024-10-22 17:01:20,742 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.4548303484916687
2024-10-22 17:01:20,742 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:01:20,743 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Reveal player +1 color G)) | Q: 0.0 | U: 0.7800267934799194 | PUCT: 0.7800267934799194
2024-10-22 17:01:20,743 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 3)) | Q: 0.0 | U: 0.5371789932250977 | PUCT: 0.5371789932250977
2024-10-22 17:01:20,743 - DEBUG - Selected Child: ((Reveal player +1 color R), (Reveal player +1 color G)) | PUCT: 0.7800267934799194
2024-10-22 17:01:20,743 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Reveal player +1 color G))
2024-10-22 17:01:20,743 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Reveal player +1 color G), (Discard 4))
2024-10-22 17:01:20,743 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Reveal player +1 color G))', '((Reveal player +1 color R), (Reveal player +1 color G), (Discard 4))']
2024-10-22 17:01:20,744 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:01:20,745 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 2
2024-10-22 17:01:20,745 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:01:20,957 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:20,957 - DEBUG - Network Policy Logits: [[ 3.61796655e-02  9.26649664e-04  2.18463577e-02 -1.05179129e-02
   5.63625097e-02  9.49256308e-03  3.63262966e-02 -6.64373627e-04
  -1.24690142e-02  8.08305666e-03 -7.24829920e-03  1.66074280e-03
  -2.19434015e-02 -2.34020595e-02  8.52472708e-03 -1.57621112e-02
  -8.92831013e-05 -2.11900007e-03 -1.39201535e-02 -1.10238083e-02]]
2024-10-22 17:01:20,958 - DEBUG - Network Policy after Softmax: [[0.05167545 0.04988547 0.05094005 0.04931781 0.052729   0.05031462
  0.05168303 0.04980617 0.04922168 0.05024375 0.04947932 0.04992211
  0.04875753 0.04868647 0.05026595 0.04905985 0.04983482 0.04973377
  0.0491503  0.04929287]]
2024-10-22 17:01:20,959 - DEBUG - Normalized Policy: [[0.         0.         0.         0.3317856  0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.33816418 0.3300502  0.         0.
  0.         0.        ]]
2024-10-22 17:01:20,959 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color G), (Discard 4), (Discard 3)) | P=0.3317855894565582
2024-10-22 17:01:20,960 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color G), (Discard 4), (Reveal player +1 rank 1)) | P=0.33005020022392273
2024-10-22 17:01:20,961 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color G), (Discard 4), (Reveal player +1 color B)) | P=0.33816418051719666
2024-10-22 17:01:20,961 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Reveal player +1 color G), (Discard 4)) | Value: 0.0
2024-10-22 17:01:20,961 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:20,961 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'Y', 'rank': 1}, {'color': 'R', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || Y2|Y2
XX || RX|R12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 W5}
2024-10-22 17:01:20,961 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:20,961 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:20,961 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:20,962 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.3880062997341156 | PUCT: 0.3880062997341156
2024-10-22 17:01:20,962 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3663824796676636 | PUCT: 0.3663824796676636
2024-10-22 17:01:20,962 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.3880062997341156
2024-10-22 17:01:20,962 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:01:20,963 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Reveal player +1 color G)) | Q: 0.0 | U: 0.5486823916435242 | PUCT: 0.5486823916435242
2024-10-22 17:01:20,963 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 3)) | Q: 0.0 | U: 0.566789448261261 | PUCT: 0.566789448261261
2024-10-22 17:01:20,963 - DEBUG - Selected Child: ((Reveal player +1 color R), (Discard 3)) | PUCT: 0.566789448261261
2024-10-22 17:01:20,963 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Discard 3))
2024-10-22 17:01:20,963 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 3), (Discard 4))
2024-10-22 17:01:20,963 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 3))', '((Reveal player +1 color R), (Discard 3), (Discard 4))']
2024-10-22 17:01:20,964 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:01:20,965 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:20,965 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:01:21,171 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:21,172 - DEBUG - Network Policy Logits: [[ 0.02105404 -0.00321551  0.03436578 -0.0316812   0.02886391  0.03225315
   0.05517629  0.01356683 -0.02023361  0.00133343  0.00028468  0.0238699
  -0.04862358 -0.02404077  0.04133501 -0.01710281  0.01173541 -0.02354982
  -0.01235288 -0.03685135]]
2024-10-22 17:01:21,172 - DEBUG - Network Policy after Softmax: [[0.050926   0.04970492 0.05160845 0.04830999 0.05132528 0.05149953
  0.05269369 0.05054613 0.0488662  0.04993154 0.0498792  0.0510696
  0.0474984  0.04868051 0.05196937 0.04901943 0.05045364 0.04870442
  0.04925282 0.04806086]]
2024-10-22 17:01:21,173 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33697003 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34119874 0.32183123 0.         0.
  0.         0.        ]]
2024-10-22 17:01:21,174 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 3), (Discard 4), (Discard 4)) | P=0.3369700312614441
2024-10-22 17:01:21,174 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 3), (Discard 4), (Reveal player +1 rank 1)) | P=0.32183122634887695
2024-10-22 17:01:21,175 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 3), (Discard 4), (Reveal player +1 color B)) | P=0.34119874238967896
2024-10-22 17:01:21,175 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 3), (Discard 4)) | Value: 0.0
2024-10-22 17:01:21,175 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:21,175 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:21,175 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:21,175 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:21,175 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:21,176 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color R),) | Visit Count: 6
2024-10-22 17:01:21,176 - INFO - Actual Game Score: 4
2024-10-22 17:01:21,176 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:21,176 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:21,176 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.33333333 0.
 0.         0.         0.         0.         0.66666667 0.
 0.         0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:01:21,176 - DEBUG - === End of Training Data ===
2024-10-22 17:01:21,176 - INFO - Chosen Action: (Reveal player +1 color R) | Visit Count: 6
2024-10-22 17:01:21,177 - DEBUG - Not the current player's turn.
2024-10-22 17:01:23,672 - INFO - Agent state has been reset.
2024-10-22 17:01:23,673 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:23,673 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2}
2024-10-22 17:01:23,673 - INFO - Max Rollouts: 10
2024-10-22 17:01:23,673 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:23,673 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:23,673 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:23,889 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:23,890 - DEBUG - Network Policy Logits: [[ 0.00865213 -0.00538465  0.06967562  0.01078918  0.04106335  0.00514607
   0.02980705  0.00990923  0.01574627 -0.00102627  0.01027449  0.00246407
  -0.02756101  0.00740546  0.0209243  -0.00425335  0.02013001 -0.02266335
   0.00950379  0.00947097]]
2024-10-22 17:01:23,890 - DEBUG - Network Policy after Softmax: [[0.0498971  0.0492016  0.05303682 0.05000385 0.05154082 0.04972246
  0.05096391 0.04995986 0.05025234 0.04941651 0.04997812 0.04958929
  0.0481225  0.04983494 0.05051322 0.04925729 0.05047311 0.04835876
  0.04993961 0.04993797]]
2024-10-22 17:01:23,891 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.5078892  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.49211076 0.        ]]
2024-10-22 17:01:23,891 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.6309169  0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.36908308 0.        ]
2024-10-22 17:01:23,892 - DEBUG - Added Child Node: ((Discard 4),) | P=0.6309168934822083
2024-10-22 17:01:23,893 - DEBUG - Added Child Node: ((Reveal player +1 rank 4),) | P=0.36908307671546936
2024-10-22 17:01:23,893 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:23,893 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:23,893 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || W5|W5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2}
2024-10-22 17:01:23,893 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:23,893 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:23,893 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:23,893 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:23,893 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:23,894 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:24,115 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:24,116 - DEBUG - Network Policy Logits: [[ 0.02105404 -0.00321551  0.03436578 -0.0316812   0.02886391  0.03225315
   0.05517629  0.01356683 -0.02023361  0.00133343  0.00028468  0.0238699
  -0.04862358 -0.02404077  0.04133501 -0.01710281  0.01173541 -0.02354982
  -0.01235288 -0.03685135]]
2024-10-22 17:01:24,116 - DEBUG - Network Policy after Softmax: [[0.050926   0.04970492 0.05160845 0.04830999 0.05132528 0.05149953
  0.05269369 0.05054613 0.0488662  0.04993154 0.0498792  0.0510696
  0.0474984  0.04868051 0.05196937 0.04901943 0.05045364 0.04870442
  0.04925282 0.04806086]]
2024-10-22 17:01:24,117 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33697003 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34119874 0.32183123 0.         0.
  0.         0.        ]]
2024-10-22 17:01:24,118 - DEBUG - Added Child Node: ((Discard 4), (Discard 4)) | P=0.3369700312614441
2024-10-22 17:01:24,118 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1)) | P=0.32183122634887695
2024-10-22 17:01:24,119 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B)) | P=0.34119874238967896
2024-10-22 17:01:24,119 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:24,119 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:24,119 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:24,119 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:24,119 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:24,119 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:24,120 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4),)
2024-10-22 17:01:24,120 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)']
2024-10-22 17:01:24,120 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:24,350 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:24,350 - DEBUG - Network Policy Logits: [[ 0.04615421  0.00892388  0.02527776 -0.00790443  0.03894605  0.00655014
   0.04637921 -0.00539642  0.00221938 -0.0125853  -0.01028961  0.03480577
  -0.03678209 -0.00214027  0.04895727 -0.01629051  0.00413809 -0.00831285
  -0.00435907 -0.02671554]]
2024-10-22 17:01:24,350 - DEBUG - Network Policy after Softmax: [[0.05200266 0.05010218 0.05092829 0.0492661  0.05162917 0.04998339
  0.05201436 0.04938982 0.04976739 0.04903603 0.04914873 0.05141585
  0.04786376 0.0495509  0.05214863 0.04885468 0.04986298 0.04924598
  0.04944108 0.04834801]]
2024-10-22 17:01:24,352 - DEBUG - Normalized Policy: [[0.       0.       0.       0.       0.518923 0.       0.       0.
  0.       0.       0.       0.       0.481077 0.       0.       0.
  0.       0.       0.       0.      ]]
2024-10-22 17:01:24,352 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 4)) | P=0.5189229846000671
2024-10-22 17:01:24,353 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color G)) | P=0.4810769855976105
2024-10-22 17:01:24,353 - DEBUG - Simulating Node: ((Reveal player +1 rank 4),) | Value: 0.0
2024-10-22 17:01:24,353 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:24,353 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 11, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W5 || W5|W5
Deck size: 11
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2}
2024-10-22 17:01:24,353 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:24,353 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:24,353 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:24,354 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.9285598397254944 | PUCT: 0.9285598397254944
2024-10-22 17:01:24,354 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.5432026386260986 | PUCT: 0.5432026386260986
2024-10-22 17:01:24,355 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.9285598397254944
2024-10-22 17:01:24,355 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:24,355 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 1))
2024-10-22 17:01:24,355 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 1))']
2024-10-22 17:01:24,355 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:24,356 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:01:24,356 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:24,356 - DEBUG - Rollout #4 completed with reward=4
2024-10-22 17:01:24,356 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:24,356 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 2.0 | U: 0.667003333568573 | PUCT: 2.6670033931732178
2024-10-22 17:01:24,357 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.5852901935577393 | PUCT: 0.5852901935577393
2024-10-22 17:01:24,357 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 2.6670033931732178
2024-10-22 17:01:24,357 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:24,357 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 color B))
2024-10-22 17:01:24,357 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 color B))']
2024-10-22 17:01:24,358 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:24,358 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:24,595 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:24,595 - DEBUG - Network Policy Logits: [[-0.00453786  0.00396121  0.07489046  0.00505242  0.02153497  0.02113658
   0.03434369  0.00089494  0.00636155 -0.00097125  0.00636899 -0.00149915
  -0.03818022 -0.00270547  0.01486067 -0.0179247   0.01469381 -0.02072155
   0.01497974 -0.00455865]]
2024-10-22 17:01:24,596 - DEBUG - Network Policy after Softmax: [[0.04944377 0.04986579 0.05353119 0.04992023 0.05074987 0.05072965
  0.05140409 0.04971312 0.04998563 0.04962043 0.049986   0.04959425
  0.04780804 0.04953445 0.05041227 0.04878629 0.05040386 0.04865003
  0.05041828 0.04944275]]
2024-10-22 17:01:24,597 - DEBUG - Normalized Policy: [[0.49512073 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.50487924 0.        ]]
2024-10-22 17:01:24,598 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Discard 0)) | P=0.49512073397636414
2024-10-22 17:01:24,599 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 4)) | P=0.5048792362213135
2024-10-22 17:01:24,599 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:24,599 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:24,599 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:24,599 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:24,599 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:24,599 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:24,600 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 1.3333333333333333 | U: 0.5278275012969971 | PUCT: 1.8611608743667603
2024-10-22 17:01:24,601 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.617552638053894 | PUCT: 0.617552638053894
2024-10-22 17:01:24,601 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 1.8611608743667603
2024-10-22 17:01:24,601 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:24,601 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 4))
2024-10-22 17:01:24,601 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 4))']
2024-10-22 17:01:24,602 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:24,602 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:24,816 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:24,817 - DEBUG - Network Policy Logits: [[-0.00909378  0.00748287  0.0650908  -0.0218782   0.00705505  0.03985067
   0.05535635  0.00579005  0.01466732  0.00497909  0.01081073  0.02307074
  -0.06851731 -0.01775069  0.02815081 -0.0085543   0.01759644 -0.03927991
   0.00223941 -0.02789026]]
2024-10-22 17:01:24,817 - DEBUG - Network Policy after Softmax: [[0.04930407 0.05012818 0.05310076 0.04867776 0.05010673 0.05177726
  0.05258636 0.05004339 0.05048962 0.05000282 0.05029527 0.05091569
  0.0464596  0.04887909 0.051175   0.04933067 0.05063772 0.04783801
  0.04986602 0.04838598]]
2024-10-22 17:01:24,818 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33899248 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.3236436
  0.33736396 0.        ]]
2024-10-22 17:01:24,819 - DEBUG - Added Child Node: ((Discard 4), (Discard 4), (Discard 4)) | P=0.33899247646331787
2024-10-22 17:01:24,820 - DEBUG - Added Child Node: ((Discard 4), (Discard 4), (Reveal player +1 rank 3)) | P=0.32364359498023987
2024-10-22 17:01:24,820 - DEBUG - Added Child Node: ((Discard 4), (Discard 4), (Reveal player +1 rank 4)) | P=0.33736395835876465
2024-10-22 17:01:24,820 - DEBUG - Simulating Node: ((Discard 4), (Discard 4)) | Value: 0.0
2024-10-22 17:01:24,820 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:24,821 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G3 || XX|RYGWB12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 G5}
2024-10-22 17:01:24,821 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:24,821 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:24,821 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:24,821 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 1.0 | U: 0.4400515556335449 | PUCT: 1.440051555633545
2024-10-22 17:01:24,822 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.6435696482658386 | PUCT: 0.6435696482658386
2024-10-22 17:01:24,822 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 1.440051555633545
2024-10-22 17:01:24,822 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:24,822 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.510358452796936 | PUCT: 4.5103583335876465
2024-10-22 17:01:24,823 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 color B)) | Q: 0.0 | U: 0.541071355342865 | PUCT: 0.541071355342865
2024-10-22 17:01:24,823 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 4)) | Q: 0.0 | U: 0.5343655347824097 | PUCT: 0.5343655347824097
2024-10-22 17:01:24,823 - DEBUG - Selected Child: ((Discard 4), (Reveal player +1 rank 1)) | PUCT: 4.5103583335876465
2024-10-22 17:01:24,823 - DEBUG - Selected child for exploration: ((Discard 4), (Reveal player +1 rank 1))
2024-10-22 17:01:24,823 - DEBUG - Node ((Discard 4), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:01:24,824 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 1))']
2024-10-22 17:01:24,824 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:24,825 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:25,025 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:25,025 - DEBUG - Network Policy Logits: [[-0.00249625 -0.00292605  0.07699933  0.00914459  0.03189791  0.01835262
   0.02598887  0.01298832  0.01898129  0.008783    0.00132805  0.00218481
  -0.03385837 -0.01220269  0.02495145 -0.0168045   0.01290702 -0.02681591
   0.00799729 -0.00223173]]
2024-10-22 17:01:25,026 - DEBUG - Network Policy after Softmax: [[0.04947665 0.04945539 0.05357039 0.05005597 0.05120796 0.05051902
  0.05090626 0.05024874 0.05055078 0.05003787 0.04966623 0.0497088
  0.04794904 0.04899873 0.05085348 0.04877377 0.05024466 0.04828791
  0.04999857 0.04948974]]
2024-10-22 17:01:25,027 - DEBUG - Normalized Policy: [[0.33091852 0.         0.         0.         0.         0.
  0.         0.         0.         0.33467218 0.         0.
  0.         0.         0.         0.         0.         0.
  0.3344093  0.        ]]
2024-10-22 17:01:25,028 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1), (Play 4)) | P=0.3346721827983856
2024-10-22 17:01:25,029 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1), (Discard 0)) | P=0.3309185206890106
2024-10-22 17:01:25,029 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1), (Reveal player +1 rank 4)) | P=0.33440929651260376
2024-10-22 17:01:25,029 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:25,029 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:25,030 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X1|RYGWB1
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:25,030 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:25,030 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:25,030 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:25,031 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.8 | U: 0.37908294796943665 | PUCT: 1.179082989692688
2024-10-22 17:01:25,031 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.6652846336364746 | PUCT: 0.6652846336364746
2024-10-22 17:01:25,031 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 1.179082989692688
2024-10-22 17:01:25,031 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:25,032 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 1)) | Q: 2.0 | U: 0.35899364948272705 | PUCT: 2.3589935302734375
2024-10-22 17:01:25,032 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 color B)) | Q: 0.0 | U: 0.570896327495575 | PUCT: 0.570896327495575
2024-10-22 17:01:25,033 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 4)) | Q: 0.0 | U: 0.5638208985328674 | PUCT: 0.5638208985328674
2024-10-22 17:01:25,033 - DEBUG - Selected Child: ((Discard 4), (Reveal player +1 rank 1)) | PUCT: 2.3589935302734375
2024-10-22 17:01:25,033 - DEBUG - Selected child for exploration: ((Discard 4), (Reveal player +1 rank 1))
2024-10-22 17:01:25,033 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 1), (Play 4))
2024-10-22 17:01:25,033 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 1))', '((Discard 4), (Reveal player +1 rank 1), (Play 4))']
2024-10-22 17:01:25,034 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:25,034 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:01:25,034 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:25,034 - DEBUG - Rollout #8 completed with reward=4
2024-10-22 17:01:25,034 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:25,035 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 1.3333333333333333 | U: 0.334003746509552 | PUCT: 1.66733717918396
2024-10-22 17:01:25,036 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.683866560459137 | PUCT: 0.683866560459137
2024-10-22 17:01:25,036 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 1.66733717918396
2024-10-22 17:01:25,036 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:25,037 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 1)) | Q: 2.6666666666666665 | U: 0.2805883288383484 | PUCT: 2.9472551345825195
2024-10-22 17:01:25,037 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 color B)) | Q: 0.0 | U: 0.5949477553367615 | PUCT: 0.5949477553367615
2024-10-22 17:01:25,037 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 4)) | Q: 0.0 | U: 0.5875741839408875 | PUCT: 0.5875741839408875
2024-10-22 17:01:25,038 - DEBUG - Selected Child: ((Discard 4), (Reveal player +1 rank 1)) | PUCT: 2.9472551345825195
2024-10-22 17:01:25,038 - DEBUG - Selected child for exploration: ((Discard 4), (Reveal player +1 rank 1))
2024-10-22 17:01:25,038 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 1), (Discard 0))
2024-10-22 17:01:25,038 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 1))', '((Discard 4), (Reveal player +1 rank 1), (Discard 0))']
2024-10-22 17:01:25,038 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:25,039 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:01:25,039 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:25,039 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:01:25,039 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:25,040 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 1.7142857142857142 | U: 0.29917824268341064 | PUCT: 2.0134639739990234
2024-10-22 17:01:25,040 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.7000707983970642 | PUCT: 0.7000707983970642
2024-10-22 17:01:25,040 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 2.0134639739990234
2024-10-22 17:01:25,041 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:25,041 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 1)) | Q: 3.0 | U: 0.23204462230205536 | PUCT: 3.2320446968078613
2024-10-22 17:01:25,041 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 color B)) | Q: 0.0 | U: 0.6150221824645996 | PUCT: 0.6150221824645996
2024-10-22 17:01:25,042 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 4)) | Q: 0.0 | U: 0.6073998212814331 | PUCT: 0.6073998212814331
2024-10-22 17:01:25,042 - DEBUG - Selected Child: ((Discard 4), (Reveal player +1 rank 1)) | PUCT: 3.2320446968078613
2024-10-22 17:01:25,042 - DEBUG - Selected child for exploration: ((Discard 4), (Reveal player +1 rank 1))
2024-10-22 17:01:25,042 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 1), (Reveal player +1 rank 4))
2024-10-22 17:01:25,042 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 1))', '((Discard 4), (Reveal player +1 rank 1), (Reveal player +1 rank 4))']
2024-10-22 17:01:25,043 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:25,044 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:25,045 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 3
2024-10-22 17:01:25,282 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:25,283 - DEBUG - Network Policy Logits: [[ 4.6254974e-02 -2.0620781e-03  3.8491759e-02 -1.2916770e-02
   2.8620910e-02  2.2305032e-02  4.5267761e-02 -1.0836740e-02
   4.4074841e-06 -2.3582827e-02  2.0817867e-03  2.6045393e-02
  -4.9211230e-02 -2.6561899e-02  3.9545350e-02 -2.6642406e-02
   9.7822007e-03 -3.5124477e-03  1.5167756e-03 -1.1619120e-02]]
2024-10-22 17:01:25,283 - DEBUG - Network Policy after Softmax: [[0.05210632 0.04964855 0.05170338 0.04911255 0.05119553 0.05087321
  0.05205491 0.04921481 0.04975126 0.04859149 0.04985472 0.05106385
  0.047362   0.04844696 0.05175788 0.04844306 0.0502401  0.0495766
  0.04982656 0.04917632]]
2024-10-22 17:01:25,285 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.49726892 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.5027311  0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:25,286 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1), (Reveal player +1 rank 4), (Discard 4)) | P=0.4972689151763916
2024-10-22 17:01:25,286 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1), (Reveal player +1 rank 4), (Reveal player +1 color B)) | P=0.5027310848236084
2024-10-22 17:01:25,286 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 1), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:25,286 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:25,287 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || X1|RYGWB1
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:25,287 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:25,287 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:25,287 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:25,287 - DEBUG - Best node chosen by MCTS: ((Discard 4),) | Visit Count: 8
2024-10-22 17:01:25,287 - INFO - Actual Game Score: 4
2024-10-22 17:01:25,287 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:25,287 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:25,288 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.88888889 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.11111111 0.        ]
2024-10-22 17:01:25,288 - DEBUG - === End of Training Data ===
2024-10-22 17:01:25,288 - INFO - Chosen Action: (Discard 4) | Visit Count: 8
2024-10-22 17:01:25,289 - DEBUG - Not the current player's turn.
2024-10-22 17:01:27,344 - INFO - Agent state has been reset.
2024-10-22 17:01:27,344 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:27,344 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:27,344 - INFO - Max Rollouts: 10
2024-10-22 17:01:27,344 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:27,345 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:27,345 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:27,629 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:27,629 - DEBUG - Network Policy Logits: [[ 0.01784694  0.00121352  0.08171679 -0.00784323  0.03370549  0.02093498
   0.03614379 -0.00229045  0.01717307 -0.00598531 -0.00054166  0.01308281
  -0.03300896  0.01200006  0.02313339 -0.00421407  0.01368851 -0.02818064
   0.02101909  0.00968856]]
2024-10-22 17:01:27,630 - DEBUG - Network Policy after Softmax: [[0.05033096 0.0495007  0.05365046 0.04905441 0.0511355  0.05048662
  0.05126033 0.04932756 0.05029705 0.04914564 0.04941389 0.05009174
  0.04783532 0.05003753 0.05059773 0.04923276 0.05012209 0.04806685
  0.05049086 0.049922  ]]
2024-10-22 17:01:27,631 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50317156 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.49682844 0.        ]]
2024-10-22 17:01:27,632 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.6273787  0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.37262133 0.        ]
2024-10-22 17:01:27,633 - DEBUG - Added Child Node: ((Discard 4),) | P=0.6273787021636963
2024-10-22 17:01:27,633 - DEBUG - Added Child Node: ((Reveal player +1 rank 4),) | P=0.3726213276386261
2024-10-22 17:01:27,633 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:27,633 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:27,634 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:27,634 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:27,634 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:27,634 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:27,634 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:27,634 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:27,635 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:27,849 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:27,850 - DEBUG - Network Policy Logits: [[ 0.01450545 -0.01127711  0.01811127 -0.05045388  0.03489615  0.02852613
   0.0573055   0.00391424 -0.01195781 -0.00066943 -0.00777631  0.02008592
  -0.04334206 -0.01416482  0.04425746 -0.01997151  0.01209595 -0.0258778
  -0.0132378  -0.03035501]]
2024-10-22 17:01:27,850 - DEBUG - Network Policy after Softmax: [[0.05069918 0.04940873 0.05088232 0.04751048 0.05174358 0.05141502
  0.05291621 0.05016505 0.04937511 0.04993563 0.049582   0.05098289
  0.04784957 0.04926626 0.05223024 0.04898101 0.05057716 0.04869257
  0.04931195 0.04847505]]
2024-10-22 17:01:27,852 - DEBUG - Normalized Policy: [[0.50693536 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.4930646  0.        ]]
2024-10-22 17:01:27,852 - DEBUG - Added Child Node: ((Discard 4), (Discard 0)) | P=0.5069353580474854
2024-10-22 17:01:27,853 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4)) | P=0.49306461215019226
2024-10-22 17:01:27,853 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:27,853 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:27,853 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
W4 || XX|RYGWB12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5}
2024-10-22 17:01:27,853 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:27,854 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:27,854 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:27,855 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4),)
2024-10-22 17:01:27,855 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)']
2024-10-22 17:01:27,855 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:28,094 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:28,095 - DEBUG - Network Policy Logits: [[ 0.04182348  0.01373054  0.01902783 -0.0096976   0.04909876  0.00429794
   0.03592501 -0.00460743 -0.0027719  -0.00317122 -0.0074498   0.03636659
  -0.03726166 -0.01189215  0.05155508 -0.01834235  0.015918   -0.02382926
  -0.00880039 -0.03293981]]
2024-10-22 17:01:28,095 - DEBUG - Network Policy after Softmax: [[0.05183989 0.05040383 0.05067154 0.04923668 0.05221842 0.04993062
  0.05153502 0.04948794 0.04957886 0.04955907 0.04934748 0.05155778
  0.04789805 0.04912875 0.05234684 0.04881288 0.0505142  0.04854578
  0.04928087 0.04810551]]
2024-10-22 17:01:28,097 - DEBUG - Normalized Policy: [[0.50136423 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.49863577
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:28,098 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0)) | P=0.5013642311096191
2024-10-22 17:01:28,099 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color Y)) | P=0.49863576889038086
2024-10-22 17:01:28,099 - DEBUG - Simulating Node: ((Reveal player +1 rank 4),) | Value: 0.0
2024-10-22 17:01:28,099 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:28,099 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'Y'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
Y5 || X5|RYGWB5
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:28,099 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:28,099 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:28,099 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:28,100 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.9233524799346924 | PUCT: 0.9233524799346924
2024-10-22 17:01:28,101 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.5484101176261902 | PUCT: 0.5484101176261902
2024-10-22 17:01:28,101 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.9233524799346924
2024-10-22 17:01:28,101 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:28,101 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 4))
2024-10-22 17:01:28,101 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 4))']
2024-10-22 17:01:28,102 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:28,102 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:28,356 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:28,356 - DEBUG - Network Policy Logits: [[ 3.48938024e-03  6.22621737e-05  7.48250484e-02 -2.33865548e-02
   3.33770737e-02  3.23360451e-02  4.26075645e-02 -3.25792935e-05
   1.94392707e-02  9.40109976e-03 -4.99312673e-03  3.51602770e-02
  -4.78427261e-02 -1.09556913e-02  1.98327117e-02 -1.01298075e-02
   2.61677764e-02 -2.68161558e-02  1.20642427e-02 -7.87207857e-03]]
2024-10-22 17:01:28,356 - DEBUG - Network Policy after Softmax: [[0.04971489 0.04954481 0.05339089 0.04839655 0.05122318 0.05116989
  0.05169819 0.04954011 0.0505142  0.05000966 0.04929497 0.05131461
  0.04722732 0.04900192 0.05053408 0.04904241 0.05085523 0.04823086
  0.05014303 0.04915325]]
2024-10-22 17:01:28,359 - DEBUG - Normalized Policy: [[0.4978563 0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.5021437 0.       ]]
2024-10-22 17:01:28,360 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4), (Discard 0)) | P=0.4978562891483307
2024-10-22 17:01:28,361 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4), (Reveal player +1 rank 4)) | P=0.5021436810493469
2024-10-22 17:01:28,361 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:28,361 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:28,361 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB1235
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5}
2024-10-22 17:01:28,361 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:28,361 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:28,361 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:28,362 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6632627844810486 | PUCT: 0.6632627844810486
2024-10-22 17:01:28,362 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.5909011363983154 | PUCT: 0.5909011363983154
2024-10-22 17:01:28,363 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.6632627844810486
2024-10-22 17:01:28,363 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:28,363 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 0))
2024-10-22 17:01:28,363 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 0))']
2024-10-22 17:01:28,364 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:28,365 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:01:28,584 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:28,584 - DEBUG - Network Policy Logits: [[-0.02654481  0.00770198  0.03468779 -0.03077332  0.00329868  0.01098338
   0.06353215 -0.01496939  0.01708779  0.02849252  0.0051576   0.00908955
  -0.07965827 -0.06356064  0.0487894  -0.03224271  0.01177962 -0.01463145
   0.01603377 -0.0011171 ]]
2024-10-22 17:01:28,584 - DEBUG - Network Policy after Softmax: [[0.04867916 0.05037514 0.05175307 0.04847376 0.05015381 0.05054072
  0.05326759 0.04924592 0.05085018 0.05143343 0.05024713 0.05044509
  0.04616111 0.0469102  0.05248804 0.04840258 0.05058097 0.04926256
  0.05079661 0.04993283]]
2024-10-22 17:01:28,586 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3358072  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.32408172 0.         0.
  0.3401111  0.        ]]
2024-10-22 17:01:28,587 - DEBUG - Added Child Node: ((Discard 4), (Discard 0), (Discard 4)) | P=0.335807204246521
2024-10-22 17:01:28,587 - DEBUG - Added Child Node: ((Discard 4), (Discard 0), (Reveal player +1 rank 1)) | P=0.3240817189216614
2024-10-22 17:01:28,588 - DEBUG - Added Child Node: ((Discard 4), (Discard 0), (Reveal player +1 rank 4)) | P=0.34011110663414
2024-10-22 17:01:28,588 - DEBUG - Simulating Node: ((Discard 4), (Discard 0)) | Value: 0.0
2024-10-22 17:01:28,588 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:28,588 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 B4}
2024-10-22 17:01:28,588 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:28,588 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:28,588 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:28,589 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5248674750328064 | PUCT: 0.5248674750328064
2024-10-22 17:01:28,590 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.6234728693962097 | PUCT: 0.6234728693962097
2024-10-22 17:01:28,590 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.6234728693962097
2024-10-22 17:01:28,590 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:01:28,590 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Discard 0))
2024-10-22 17:01:28,590 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Discard 0))']
2024-10-22 17:01:28,591 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:28,591 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:01:28,787 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:28,788 - DEBUG - Network Policy Logits: [[-0.01205327 -0.01132743  0.02469482 -0.00705933  0.01548443 -0.00187966
   0.03263303 -0.01694401  0.01345192  0.02517085 -0.01364742  0.00162794
  -0.04956876 -0.01816195  0.03918755 -0.02733831 -0.00971625 -0.03201083
   0.03325775  0.01643349]]
2024-10-22 17:01:28,788 - DEBUG - Network Policy after Softmax: [[0.04938174 0.0494176  0.05123018 0.04962897 0.0507605  0.0498867
  0.05163848 0.04914082 0.05065744 0.05125458 0.04930308 0.05006199
  0.04756348 0.04908101 0.05197806 0.04863268 0.04949728 0.04840597
  0.05167075 0.0508087 ]]
2024-10-22 17:01:28,789 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.34137034 0.
  0.         0.         0.         0.         0.33156908 0.
  0.         0.         0.         0.32706052 0.         0.
  0.         0.        ]]
2024-10-22 17:01:28,790 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 color R)) | P=0.3315690755844116
2024-10-22 17:01:28,791 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Discard 4)) | P=0.3413703441619873
2024-10-22 17:01:28,791 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 rank 1)) | P=0.3270605206489563
2024-10-22 17:01:28,791 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Discard 0)) | Value: 0.0
2024-10-22 17:01:28,791 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:28,791 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 15, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': 4}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || X5|RYGWB5
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || XX|RYGWB1235
R1 || XX|RYGWB12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 B4}
2024-10-22 17:01:28,791 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:28,791 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:28,792 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:28,792 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5469796657562256 | PUCT: 0.5469796657562256
2024-10-22 17:01:28,793 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.4331595003604889 | PUCT: 0.4331595003604889
2024-10-22 17:01:28,793 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.5469796657562256
2024-10-22 17:01:28,793 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:28,793 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.7256739735603333 | PUCT: 0.7256739735603333
2024-10-22 17:01:28,793 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 0)) | Q: 0.0 | U: 0.746088445186615 | PUCT: 0.746088445186615
2024-10-22 17:01:28,794 - DEBUG - Selected Child: ((Discard 4), (Discard 0)) | PUCT: 0.746088445186615
2024-10-22 17:01:28,794 - DEBUG - Selected child for exploration: ((Discard 4), (Discard 0))
2024-10-22 17:01:28,794 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 0), (Discard 4))
2024-10-22 17:01:28,794 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 0))', '((Discard 4), (Discard 0), (Discard 4))']
2024-10-22 17:01:28,794 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:28,795 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:01:28,796 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 3
2024-10-22 17:01:28,986 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:28,986 - DEBUG - Network Policy Logits: [[ 0.04350832  0.00937156  0.05068487 -0.04884243  0.02618663  0.0666792
   0.04721931  0.03827114 -0.02994354  0.02074055 -0.01935416  0.01356663
  -0.06984118 -0.03421915  0.0269268  -0.01721295  0.03600842 -0.00707028
  -0.0439011  -0.01057068]]
2024-10-22 17:01:28,986 - DEBUG - Network Policy after Softmax: [[0.05193187 0.05018901 0.05230591 0.04735072 0.05104007 0.05314923
  0.05212495 0.05166061 0.04825411 0.05076286 0.0487678  0.05039999
  0.04636678 0.04804823 0.05107786 0.04887233 0.05154385 0.04937055
  0.04758528 0.04919804]]
2024-10-22 17:01:28,988 - DEBUG - Normalized Policy: [[0.         0.         0.         0.3214557  0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.3467586  0.33178568 0.         0.
  0.         0.        ]]
2024-10-22 17:01:28,988 - DEBUG - Added Child Node: ((Discard 4), (Discard 0), (Discard 4), (Discard 3)) | P=0.3214556872844696
2024-10-22 17:01:28,989 - DEBUG - Added Child Node: ((Discard 4), (Discard 0), (Discard 4), (Reveal player +1 rank 1)) | P=0.3317856788635254
2024-10-22 17:01:28,989 - DEBUG - Added Child Node: ((Discard 4), (Discard 0), (Discard 4), (Reveal player +1 color B)) | P=0.3467586040496826
2024-10-22 17:01:28,990 - DEBUG - Simulating Node: ((Discard 4), (Discard 0), (Discard 4)) | Value: 0.0
2024-10-22 17:01:28,990 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:28,990 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'B', 'rank': 3}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B1 || XX|RYGWB12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 B4 B1}
2024-10-22 17:01:28,990 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:28,990 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:28,990 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:28,990 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4523484706878662 | PUCT: 0.4523484706878662
2024-10-22 17:01:28,991 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.4477749764919281 | PUCT: 0.4477749764919281
2024-10-22 17:01:28,991 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.4523484706878662
2024-10-22 17:01:28,991 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:28,991 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.7818995118141174 | PUCT: 0.7818995118141174
2024-10-22 17:01:28,992 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 0)) | Q: 0.0 | U: 0.5359304547309875 | PUCT: 0.5359304547309875
2024-10-22 17:01:28,992 - DEBUG - Selected Child: ((Discard 4), (Reveal player +1 rank 4)) | PUCT: 0.7818995118141174
2024-10-22 17:01:28,992 - DEBUG - Selected child for exploration: ((Discard 4), (Reveal player +1 rank 4))
2024-10-22 17:01:28,992 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 4), (Reveal player +1 rank 4))
2024-10-22 17:01:28,992 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 4))', '((Discard 4), (Reveal player +1 rank 4), (Reveal player +1 rank 4))']
2024-10-22 17:01:28,993 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:28,993 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:28,994 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 3
2024-10-22 17:01:29,181 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:29,181 - DEBUG - Network Policy Logits: [[ 0.03956188  0.00381467  0.02612993 -0.02953959  0.05413319  0.01910343
   0.05592881  0.00248059  0.0075973  -0.01265991 -0.00290855  0.03205254
  -0.03426263 -0.02409197  0.02652726 -0.00816077  0.02820586 -0.02428332
   0.00175229 -0.01874942]]
2024-10-22 17:01:29,181 - DEBUG - Network Policy after Softmax: [[0.0516299  0.04981688 0.05094105 0.04818267 0.05238773 0.05058436
  0.05248188 0.04975046 0.05000567 0.04900289 0.04948307 0.05124365
  0.04795564 0.04844587 0.05096129 0.04922386 0.05104691 0.0484366
  0.04971424 0.04870539]]
2024-10-22 17:01:29,183 - DEBUG - Normalized Policy: [[0.34342816 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.32914802 0.
  0.         0.         0.         0.32742378 0.         0.
  0.         0.        ]]
2024-10-22 17:01:29,183 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4), (Reveal player +1 rank 4), (Reveal player +1 color R)) | P=0.3291480243206024
2024-10-22 17:01:29,184 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4), (Reveal player +1 rank 4), (Discard 0)) | P=0.3434281647205353
2024-10-22 17:01:29,184 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4), (Reveal player +1 rank 4), (Reveal player +1 rank 1)) | P=0.3274237811565399
2024-10-22 17:01:29,185 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 4), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:29,185 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:29,185 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
R1 || XX|RYGWB1235
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5}
2024-10-22 17:01:29,185 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:29,185 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:29,185 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:29,185 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3874857723712921 | PUCT: 0.3874857723712921
2024-10-22 17:01:29,186 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.46028169989585876 | PUCT: 0.46028169989585876
2024-10-22 17:01:29,186 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.46028169989585876
2024-10-22 17:01:29,186 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:01:29,186 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Reveal player +1 color Y))
2024-10-22 17:01:29,186 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 color Y))']
2024-10-22 17:01:29,187 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:29,187 - DEBUG - Move: (Reveal player +1 color Y) | Reward: 4 | Depth: 2
2024-10-22 17:01:29,382 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:29,382 - DEBUG - Network Policy Logits: [[ 0.00847776  0.00327232  0.06532577  0.02629874  0.0269268   0.00601084
   0.02934363  0.02382831  0.02254199 -0.00764927  0.02571065  0.00538542
  -0.04230851  0.00076298  0.00419422 -0.02438804  0.03341391 -0.04445605
   0.01946953 -0.00362059]]
2024-10-22 17:01:29,382 - DEBUG - Network Policy after Softmax: [[0.04996162 0.04970222 0.05288412 0.05085996 0.05089191 0.04983851
  0.05101506 0.05073447 0.05066925 0.04916235 0.05083006 0.04980736
  0.04748761 0.04957766 0.04974806 0.04834628 0.05122313 0.04738573
  0.05051381 0.0493608 ]]
2024-10-22 17:01:29,383 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.5173019  0.
  0.         0.         0.         0.         0.         0.
  0.48269805 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:29,384 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color Y), (Discard 4)) | P=0.5173019170761108
2024-10-22 17:01:29,385 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color Y), (Reveal player +1 color G)) | P=0.4826980531215668
2024-10-22 17:01:29,385 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Reveal player +1 color Y)) | Value: 0.0
2024-10-22 17:01:29,385 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:29,385 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 10, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'Y', 'rank': 4}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || Y5|Y5
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || XX|RYGWB1235
Deck size: 10
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5}
2024-10-22 17:01:29,385 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:29,385 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:29,385 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:29,386 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3966672718524933 | PUCT: 0.3966672718524933
2024-10-22 17:01:29,386 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.35339105129241943 | PUCT: 0.35339105129241943
2024-10-22 17:01:29,387 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.3966672718524933
2024-10-22 17:01:29,387 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:29,387 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 4)) | Q: 0.0 | U: 0.5499996542930603 | PUCT: 0.5499996542930603
2024-10-22 17:01:29,387 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 0)) | Q: 0.0 | U: 0.5654721260070801 | PUCT: 0.5654721260070801
2024-10-22 17:01:29,388 - DEBUG - Selected Child: ((Discard 4), (Discard 0)) | PUCT: 0.5654721260070801
2024-10-22 17:01:29,388 - DEBUG - Selected child for exploration: ((Discard 4), (Discard 0))
2024-10-22 17:01:29,388 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 0), (Reveal player +1 rank 4))
2024-10-22 17:01:29,388 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 0))', '((Discard 4), (Discard 0), (Reveal player +1 rank 4))']
2024-10-22 17:01:29,389 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:29,389 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:01:29,390 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 3
2024-10-22 17:01:29,591 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:29,592 - DEBUG - Network Policy Logits: [[ 5.2835111e-02  1.4040533e-02  4.4474948e-02 -3.5974365e-02
   2.6448209e-02  4.3637216e-02  4.7750995e-02  3.0057514e-02
  -1.7382238e-02  3.2726180e-02 -3.3579011e-02  1.5965153e-02
  -4.9252741e-02 -2.8805114e-02  1.4257215e-02 -4.8181927e-04
   3.2665338e-02 -1.9833140e-02 -2.1015719e-02  9.1012102e-05]]
2024-10-22 17:01:29,592 - DEBUG - Network Policy after Softmax: [[0.05229765 0.05030764 0.05186226 0.04785339 0.05093573 0.05181883
  0.05203244 0.0511199  0.04875141 0.0512565  0.04796816 0.05040456
  0.04722217 0.04819769 0.05031854 0.04958233 0.05125339 0.04863207
  0.04857459 0.04961074]]
2024-10-22 17:01:29,593 - DEBUG - Normalized Policy: [[0.        0.        0.        0.4962604 0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.5037396 0.       ]]
2024-10-22 17:01:29,594 - DEBUG - Added Child Node: ((Discard 4), (Discard 0), (Reveal player +1 rank 4), (Discard 3)) | P=0.496260404586792
2024-10-22 17:01:29,595 - DEBUG - Added Child Node: ((Discard 4), (Discard 0), (Reveal player +1 rank 4), (Reveal player +1 rank 4)) | P=0.503739595413208
2024-10-22 17:01:29,595 - DEBUG - Simulating Node: ((Discard 4), (Discard 0), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:29,595 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:29,595 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB1235
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B4 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 B4}
2024-10-22 17:01:29,595 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:29,595 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:29,595 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:29,595 - DEBUG - Best node chosen by MCTS: ((Discard 4),) | Visit Count: 6
2024-10-22 17:01:29,595 - INFO - Actual Game Score: 4
2024-10-22 17:01:29,595 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:29,595 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:29,596 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.66666667 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.33333333 0.        ]
2024-10-22 17:01:29,596 - DEBUG - === End of Training Data ===
2024-10-22 17:01:29,596 - INFO - Chosen Action: (Discard 4) | Visit Count: 6
2024-10-22 17:01:29,597 - DEBUG - Not the current player's turn.
2024-10-22 17:01:31,019 - INFO - Agent state has been reset.
2024-10-22 17:01:31,019 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:31,019 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5}
2024-10-22 17:01:31,019 - INFO - Max Rollouts: 10
2024-10-22 17:01:31,019 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:31,019 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:31,019 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:31,241 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:31,241 - DEBUG - Network Policy Logits: [[ 0.01280821 -0.0027219   0.07899596 -0.00712364  0.01896048  0.01933772
   0.04409418 -0.00758425  0.00607536 -0.02345364  0.00200041  0.00165202
  -0.03368276  0.00938598  0.02072299 -0.00827106  0.01655535 -0.02621141
   0.0158491   0.00343555]]
2024-10-22 17:01:31,242 - DEBUG - Network Policy after Softmax: [[0.0502743  0.04949956 0.05371443 0.04928216 0.05058455 0.05060364
  0.05187204 0.04925947 0.04993694 0.04848392 0.04973387 0.04971654
  0.0479905  0.05010254 0.05067379 0.04922564 0.05046304 0.04835039
  0.05042741 0.04980529]]
2024-10-22 17:01:31,243 - DEBUG - Normalized Policy: [[0.49923977 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.5007602  0.        ]]
2024-10-22 17:01:31,243 - DEBUG - Dirichlet Noise Added: [0.6244298  0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.37557015 0.        ]
2024-10-22 17:01:31,244 - DEBUG - Added Child Node: ((Discard 0),) | P=0.6244298219680786
2024-10-22 17:01:31,245 - DEBUG - Added Child Node: ((Reveal player +1 rank 4),) | P=0.375570148229599
2024-10-22 17:01:31,245 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:31,245 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:31,245 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5}
2024-10-22 17:01:31,245 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:31,245 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:31,245 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:31,246 - DEBUG - Expanding unexplored child: ((Discard 0),)
2024-10-22 17:01:31,246 - DEBUG - Traversing Path: ['()', '((Discard 0),)']
2024-10-22 17:01:31,247 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:01:31,447 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:31,448 - DEBUG - Network Policy Logits: [[ 0.02259597 -0.00632086  0.02385817 -0.02377452  0.0287988   0.01988477
   0.04823848  0.04077145  0.00408571  0.01673348  0.00560528 -0.00839318
  -0.02171304 -0.0070355   0.06571271 -0.02591046  0.04972012 -0.00300831
  -0.00405878 -0.0262136 ]]
2024-10-22 17:01:31,448 - DEBUG - Network Policy after Softmax: [[0.05061707 0.04917434 0.05068099 0.04832352 0.05093201 0.05048002
  0.0519318  0.05154547 0.04968875 0.05032119 0.04976431 0.04907255
  0.04842324 0.04913922 0.05284724 0.04822041 0.0520088  0.04933751
  0.0492857  0.0482058 ]]
2024-10-22 17:01:31,449 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.24965635 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.25904438 0.23636474 0.25493452 0.
  0.         0.        ]]
2024-10-22 17:01:31,450 - DEBUG - Added Child Node: ((Discard 0), (Discard 4)) | P=0.24965634942054749
2024-10-22 17:01:31,451 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1)) | P=0.23636473715305328
2024-10-22 17:01:31,452 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B)) | P=0.2590443789958954
2024-10-22 17:01:31,452 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 2)) | P=0.25493451952934265
2024-10-22 17:01:31,452 - DEBUG - Simulating Node: ((Discard 0),) | Value: 0.0
2024-10-22 17:01:31,452 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:31,453 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || BX|B12345
B1 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:31,453 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:31,453 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:31,453 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:31,453 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4),)
2024-10-22 17:01:31,453 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)']
2024-10-22 17:01:31,454 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:31,689 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:31,689 - DEBUG - Network Policy Logits: [[ 0.04004276  0.00392903  0.01440088 -0.02113573  0.03510704 -0.01184031
   0.03618351 -0.01648589  0.00478155 -0.01646747 -0.00335917  0.04908282
  -0.04362432 -0.01267372  0.04752252 -0.02157906 -0.00395001 -0.00918925
  -0.00220291 -0.01189043]]
2024-10-22 17:01:31,689 - DEBUG - Network Policy after Softmax: [[0.05187887 0.05003875 0.0505655  0.04880013 0.05162344 0.04925587
  0.05167904 0.04902757 0.05008143 0.04902848 0.04967539 0.05234998
  0.04771493 0.04921483 0.05226836 0.0487785  0.04964605 0.04938662
  0.04973286 0.0492534 ]]
2024-10-22 17:01:31,691 - DEBUG - Normalized Policy: [[0.        0.        0.        0.        0.5093264 0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.4906736 0.       ]]
2024-10-22 17:01:31,692 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 4)) | P=0.5093263983726501
2024-10-22 17:01:31,692 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 4)) | P=0.49067360162734985
2024-10-22 17:01:31,692 - DEBUG - Simulating Node: ((Reveal player +1 rank 4),) | Value: 0.0
2024-10-22 17:01:31,692 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:31,692 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB1235
-----
G4 || G4|G4
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B4 || BX|B12345
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5}
2024-10-22 17:01:31,692 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:31,693 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:31,693 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:31,693 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.9190123677253723 | PUCT: 0.9190123677253723
2024-10-22 17:01:31,694 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.5527500510215759 | PUCT: 0.5527500510215759
2024-10-22 17:01:31,694 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.9190123677253723
2024-10-22 17:01:31,694 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:01:31,694 - DEBUG - Expanding unexplored child: ((Discard 0), (Discard 4))
2024-10-22 17:01:31,694 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Discard 4))']
2024-10-22 17:01:31,695 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:01:31,695 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:31,896 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:31,896 - DEBUG - Network Policy Logits: [[ 0.00954583  0.02245192  0.08232691 -0.00387693  0.01465087  0.05369611
   0.05859903  0.02718694  0.01041308  0.04267792 -0.02094283  0.01242376
  -0.05117924 -0.00644131  0.01640386  0.00184243  0.0297301  -0.03899048
  -0.01504358 -0.02901209]]
2024-10-22 17:01:31,897 - DEBUG - Network Policy after Softmax: [[0.04990961 0.05055793 0.05367754 0.04924417 0.05016505 0.05216251
  0.05241888 0.05079789 0.04995292 0.05159092 0.0484109  0.05005346
  0.04696903 0.04911805 0.05025307 0.04952662 0.05092724 0.04754503
  0.04869733 0.04802183]]
2024-10-22 17:01:31,898 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.25490385 0.
  0.         0.         0.         0.         0.24599047 0.
  0.         0.         0.         0.25165975 0.         0.
  0.24744593 0.        ]]
2024-10-22 17:01:31,899 - DEBUG - Added Child Node: ((Discard 0), (Discard 4), (Reveal player +1 color R)) | P=0.24599047005176544
2024-10-22 17:01:31,899 - DEBUG - Added Child Node: ((Discard 0), (Discard 4), (Discard 4)) | P=0.2549038529396057
2024-10-22 17:01:31,900 - DEBUG - Added Child Node: ((Discard 0), (Discard 4), (Reveal player +1 rank 1)) | P=0.2516597509384155
2024-10-22 17:01:31,900 - DEBUG - Added Child Node: ((Discard 0), (Discard 4), (Reveal player +1 rank 4)) | P=0.24744592607021332
2024-10-22 17:01:31,900 - DEBUG - Simulating Node: ((Discard 0), (Discard 4)) | Value: 0.0
2024-10-22 17:01:31,901 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:31,901 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B12345
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
R1 || XX|RYGWB12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B1}
2024-10-22 17:01:31,901 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:31,901 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:31,901 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:31,902 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.6601452231407166 | PUCT: 0.6601452231407166
2024-10-22 17:01:31,902 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.5955773591995239 | PUCT: 0.5955773591995239
2024-10-22 17:01:31,902 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.6601452231407166
2024-10-22 17:01:31,902 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:01:31,902 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 rank 1))
2024-10-22 17:01:31,902 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 rank 1))']
2024-10-22 17:01:31,903 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:01:31,904 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:32,121 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:32,121 - DEBUG - Network Policy Logits: [[ 0.00921718  0.00705302  0.07979146  0.02208422  0.02653666  0.03456685
   0.03017038  0.03075531  0.01837252  0.03668421 -0.02422567 -0.00534102
  -0.03393845 -0.00339944  0.03216318 -0.00810193  0.0166433  -0.04249915
  -0.01137788  0.00309739]]
2024-10-22 17:01:32,122 - DEBUG - Network Policy after Softmax: [[0.04989637 0.04978851 0.05354501 0.05054254 0.05076808 0.0511774
  0.05095289 0.05098271 0.05035529 0.05128587 0.04825529 0.04917524
  0.04778887 0.0492708  0.05105453 0.04903965 0.05026829 0.04738151
  0.04887927 0.04959195]]
2024-10-22 17:01:32,124 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3363612  0.
  0.         0.         0.         0.3397918  0.         0.
  0.         0.         0.         0.         0.         0.
  0.32384697 0.        ]]
2024-10-22 17:01:32,124 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Play 4)) | P=0.33979180455207825
2024-10-22 17:01:32,125 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Discard 4)) | P=0.33636119961738586
2024-10-22 17:01:32,126 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 1), (Reveal player +1 rank 4)) | P=0.3238469660282135
2024-10-22 17:01:32,126 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:32,127 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:32,127 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': 0}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B2345
XX || X1|RYGWB1
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:32,127 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:32,127 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:32,127 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:32,128 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.5224003791809082 | PUCT: 0.5224003791809082
2024-10-22 17:01:32,129 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.6284068822860718 | PUCT: 0.6284068822860718
2024-10-22 17:01:32,129 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.6284068822860718
2024-10-22 17:01:32,129 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:01:32,129 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Discard 4))
2024-10-22 17:01:32,129 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Discard 4))']
2024-10-22 17:01:32,130 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:32,131 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:32,359 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:32,359 - DEBUG - Network Policy Logits: [[ 1.1480516e-03  6.1941352e-03  6.4317614e-02 -9.5667318e-05
   2.1244630e-02  1.9883383e-02  3.8902584e-02 -7.8787073e-04
   5.7492233e-03  1.5591737e-03 -5.6297751e-05  5.6912350e-03
  -4.0598080e-02  2.3726188e-03  1.6835812e-02 -1.9868001e-02
   2.0293031e-02 -2.0473633e-02  1.1655765e-02  7.2374847e-04]]
2024-10-22 17:01:32,360 - DEBUG - Network Policy after Softmax: [[0.04971023 0.0499617  0.05295171 0.04964845 0.05071934 0.05065035
  0.0516229  0.04961409 0.04993948 0.04973067 0.0496504  0.04993659
  0.04767774 0.04977114 0.05049622 0.04867642 0.0506711  0.04864695
  0.05023533 0.04968914]]
2024-10-22 17:01:32,361 - DEBUG - Normalized Policy: [[0.         0.         0.5262049  0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.47379515 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:32,362 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 4), (Discard 2)) | P=0.5262048840522766
2024-10-22 17:01:32,364 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 4), (Reveal player +1 color G)) | P=0.4737951457500458
2024-10-22 17:01:32,364 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Discard 4)) | Value: 0.0
2024-10-22 17:01:32,364 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:32,364 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'B', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 B2}
2024-10-22 17:01:32,364 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:32,364 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:32,364 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:32,365 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.5444086790084839 | PUCT: 0.5444086790084839
2024-10-22 17:01:32,366 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.4365874230861664 | PUCT: 0.4365874230861664
2024-10-22 17:01:32,366 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.5444086790084839
2024-10-22 17:01:32,366 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:01:32,366 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 color B))
2024-10-22 17:01:32,366 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 color B))']
2024-10-22 17:01:32,368 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:01:32,368 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:32,613 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:32,614 - DEBUG - Network Policy Logits: [[ 0.00861133  0.01366644  0.08198353  0.01969949  0.0166952   0.03784039
   0.03797338  0.02063812  0.00522893  0.0275784  -0.01726688 -0.0107426
  -0.03961398  0.00612056  0.01904293 -0.00460703  0.02107623 -0.03635428
  -0.00583791 -0.00350647]]
2024-10-22 17:01:32,614 - DEBUG - Network Policy after Softmax: [[0.04991751 0.05017049 0.05371778 0.05047408 0.05032267 0.05139808
  0.05140492 0.05052149 0.04974896 0.05087334 0.0486423  0.0489607
  0.04756735 0.04979333 0.05044096 0.04926202 0.05054362 0.04772266
  0.04920143 0.04931627]]
2024-10-22 17:01:32,615 - DEBUG - Normalized Policy: [[0.       0.       0.       0.506384 0.       0.       0.       0.
  0.       0.       0.       0.       0.       0.       0.       0.
  0.       0.       0.493616 0.      ]]
2024-10-22 17:01:32,616 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Discard 3)) | P=0.506384015083313
2024-10-22 17:01:32,617 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Reveal player +1 rank 4)) | P=0.4936160147190094
2024-10-22 17:01:32,617 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:32,617 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:32,617 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B12345
XX || BX|B12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:32,617 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:32,617 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:32,617 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:32,618 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4502222537994385 | PUCT: 0.4502222537994385
2024-10-22 17:01:32,619 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.45131853222846985 | PUCT: 0.45131853222846985
2024-10-22 17:01:32,619 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.45131853222846985
2024-10-22 17:01:32,619 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:01:32,619 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Reveal player +1 rank 4))
2024-10-22 17:01:32,619 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 rank 4))']
2024-10-22 17:01:32,620 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:32,621 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:32,846 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:32,846 - DEBUG - Network Policy Logits: [[-0.00026001  0.00619273  0.06262798  0.00818045  0.02611165  0.01356321
   0.03583081  0.01147564  0.02767365 -0.01177284  0.02920697  0.01261418
  -0.04166939 -0.0145762   0.01525391 -0.0281709   0.03573831 -0.03579428
   0.01875226 -0.01297494]]
2024-10-22 17:01:32,847 - DEBUG - Network Policy after Softmax: [[0.04957752 0.04989846 0.05279547 0.04999775 0.05090235 0.0502676
  0.05139949 0.05016277 0.05098192 0.04901001 0.05106016 0.05021992
  0.04756647 0.04887281 0.05035266 0.0482129  0.05139474 0.04784675
  0.05052912 0.04895113]]
2024-10-22 17:01:32,848 - DEBUG - Normalized Policy: [[0.5103509  0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.48964912 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:32,849 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 4), (Discard 0)) | P=0.5103508830070496
2024-10-22 17:01:32,850 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 4), (Reveal player +1 color G)) | P=0.48964911699295044
2024-10-22 17:01:32,850 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:32,850 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:32,850 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 9, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B1235
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || XX|RYGWB1235
Deck size: 9
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5}
2024-10-22 17:01:32,850 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:32,850 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:32,851 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:32,851 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.4627973437309265 | PUCT: 0.4627973437309265
2024-10-22 17:01:32,852 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.34794318675994873 | PUCT: 0.34794318675994873
2024-10-22 17:01:32,852 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.4627973437309265
2024-10-22 17:01:32,852 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:01:32,852 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 rank 2))
2024-10-22 17:01:32,852 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 rank 2))']
2024-10-22 17:01:32,853 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:01:32,853 - DEBUG - Move: (Reveal player +1 rank 2) | Reward: 4 | Depth: 2
2024-10-22 17:01:33,073 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:33,073 - DEBUG - Network Policy Logits: [[ 0.00534697  0.02272723  0.06498496  0.01136666  0.01122488  0.05056719
   0.0494068   0.03042995  0.00841045  0.04005101 -0.01484323  0.00882406
  -0.03327655 -0.00789412  0.02760043 -0.0011934   0.02280007 -0.04588086
  -0.01588032 -0.01817094]]
2024-10-22 17:01:33,074 - DEBUG - Network Policy after Softmax: [[0.04970707 0.05057854 0.05276168 0.05000719 0.05000011 0.05200643
  0.05194611 0.05096964 0.04985958 0.05146239 0.04871354 0.0498802
  0.04782381 0.04905323 0.05082562 0.04938303 0.05058222 0.04722481
  0.04866304 0.0485517 ]]
2024-10-22 17:01:33,076 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50677586 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.49322408 0.        ]]
2024-10-22 17:01:33,077 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 2), (Discard 4)) | P=0.5067758560180664
2024-10-22 17:01:33,077 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 rank 2), (Reveal player +1 rank 4)) | P=0.4932240843772888
2024-10-22 17:01:33,077 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 rank 2)) | Value: 0.0
2024-10-22 17:01:33,077 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:33,078 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || BX|B1345
XX || XX|RYGWB1345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:33,078 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:33,078 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:33,078 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:33,079 - DEBUG - PUCT Calculation | Child: ((Discard 0),) | Q: 0.0 | U: 0.3948027789592743 | PUCT: 0.3948027789592743
2024-10-22 17:01:33,079 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.35618770122528076 | PUCT: 0.35618770122528076
2024-10-22 17:01:33,080 - DEBUG - Selected Child: ((Discard 0),) | PUCT: 0.3948027789592743
2024-10-22 17:01:33,080 - DEBUG - Selected child for exploration: ((Discard 0),)
2024-10-22 17:01:33,080 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Discard 4)) | Q: 0.0 | U: 0.41772693395614624 | PUCT: 0.41772693395614624
2024-10-22 17:01:33,081 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.39548730850219727 | PUCT: 0.39548730850219727
2024-10-22 17:01:33,081 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 color B)) | Q: 0.0 | U: 0.4334350526332855 | PUCT: 0.4334350526332855
2024-10-22 17:01:33,082 - DEBUG - PUCT Calculation | Child: ((Discard 0), (Reveal player +1 rank 2)) | Q: 0.0 | U: 0.42655840516090393 | PUCT: 0.42655840516090393
2024-10-22 17:01:33,082 - DEBUG - Selected Child: ((Discard 0), (Reveal player +1 color B)) | PUCT: 0.4334350526332855
2024-10-22 17:01:33,082 - DEBUG - Selected child for exploration: ((Discard 0), (Reveal player +1 color B))
2024-10-22 17:01:33,082 - DEBUG - Expanding unexplored child: ((Discard 0), (Reveal player +1 color B), (Discard 3))
2024-10-22 17:01:33,082 - DEBUG - Traversing Path: ['()', '((Discard 0),)', '((Discard 0), (Reveal player +1 color B))', '((Discard 0), (Reveal player +1 color B), (Discard 3))']
2024-10-22 17:01:33,084 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 1
2024-10-22 17:01:33,085 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:33,085 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 3
2024-10-22 17:01:33,297 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:33,298 - DEBUG - Network Policy Logits: [[-0.01655154 -0.00679976  0.02321842 -0.03717696  0.00854004  0.03386919
   0.03733284  0.034467    0.00818613  0.03687586 -0.00148982 -0.00613925
  -0.03276219 -0.02023382  0.07444756 -0.02996095  0.03877004 -0.02152878
  -0.01831201 -0.02776035]]
2024-10-22 17:01:33,298 - DEBUG - Network Policy after Softmax: [[0.04896786 0.04944772 0.05095456 0.04796822 0.05021209 0.05150016
  0.05167885 0.05153096 0.05019432 0.05165524 0.04971099 0.04948039
  0.04818046 0.04878788 0.05363293 0.04831561 0.05175317 0.04872474
  0.04888173 0.04842205]]
2024-10-22 17:01:33,300 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3413065  0.
  0.         0.         0.         0.         0.         0.
  0.32749695 0.         0.         0.         0.         0.3311966
  0.         0.        ]]
2024-10-22 17:01:33,301 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Discard 3), (Discard 4)) | P=0.34130650758743286
2024-10-22 17:01:33,302 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Discard 3), (Reveal player +1 rank 3)) | P=0.3311966061592102
2024-10-22 17:01:33,303 - DEBUG - Added Child Node: ((Discard 0), (Reveal player +1 color B), (Discard 3), (Reveal player +1 color G)) | P=0.3274969458580017
2024-10-22 17:01:33,303 - DEBUG - Simulating Node: ((Discard 0), (Reveal player +1 color B), (Discard 3)) | Value: 0.0
2024-10-22 17:01:33,303 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:33,304 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
G3 || XX|RYGW12345
B3 || XX|RYGWB12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B1}
2024-10-22 17:01:33,304 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:33,304 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:33,304 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:33,304 - DEBUG - Best node chosen by MCTS: ((Discard 0),) | Visit Count: 6
2024-10-22 17:01:33,304 - INFO - Actual Game Score: 4
2024-10-22 17:01:33,304 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:33,304 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:33,304 - DEBUG - Policy Targets: [0.66666667 0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.33333333 0.        ]
2024-10-22 17:01:33,305 - DEBUG - === End of Training Data ===
2024-10-22 17:01:33,305 - INFO - Chosen Action: (Discard 0) | Visit Count: 6
2024-10-22 17:01:33,306 - DEBUG - Not the current player's turn.
2024-10-22 17:01:35,623 - INFO - Agent state has been reset.
2024-10-22 17:01:35,623 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:35,623 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB1345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:35,623 - INFO - Max Rollouts: 10
2024-10-22 17:01:35,623 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:35,624 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:35,624 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:35,841 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:35,841 - DEBUG - Network Policy Logits: [[ 1.1852505e-02  1.8290639e-02  7.6961271e-02  8.1142411e-05
   1.5388543e-02  4.7569938e-02  4.6267159e-02  2.4023904e-02
   1.8367833e-02  2.7451713e-02 -1.4257237e-02  7.6699555e-03
  -2.8568443e-02 -1.1906328e-02  3.3722732e-02 -5.4059275e-03
   2.7446900e-02 -3.8354963e-02 -2.5922317e-02 -1.6833657e-02]]
2024-10-22 17:01:35,842 - DEBUG - Network Policy after Softmax: [[0.05003799 0.05036118 0.0534043  0.04945243 0.05021524 0.05185752
  0.05179    0.05065074 0.05036506 0.05082466 0.04874841 0.04982914
  0.04805574 0.04886315 0.05114438 0.04918182 0.05082441 0.04758773
  0.04818306 0.04862298]]
2024-10-22 17:01:35,843 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.51032627 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.48967376 0.        ]]
2024-10-22 17:01:35,844 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.6247988  0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.37520126 0.        ]
2024-10-22 17:01:35,844 - DEBUG - Added Child Node: ((Discard 4),) | P=0.6247987747192383
2024-10-22 17:01:35,845 - DEBUG - Added Child Node: ((Reveal player +1 rank 4),) | P=0.3752012550830841
2024-10-22 17:01:35,845 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:35,845 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:35,845 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB1345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:35,845 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:35,845 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:35,845 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:35,845 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:35,846 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:35,846 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:36,116 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:36,117 - DEBUG - Network Policy Logits: [[ 0.01874602 -0.00718569  0.03218272 -0.03753529  0.02892012  0.03038597
   0.05286454  0.03487055  0.0022662   0.02072755  0.0100866  -0.00249055
  -0.01504289 -0.00954044  0.06584533 -0.02339272  0.04305071 -0.0207212
  -0.0092577  -0.03924949]]
2024-10-22 17:01:36,117 - DEBUG - Network Policy after Softmax: [[0.05047983 0.04918763 0.05116269 0.04771722 0.05099604 0.05107084
  0.05223184 0.05130039 0.04965474 0.05057995 0.05004459 0.04941911
  0.04880266 0.04907194 0.05291427 0.04839687 0.05172176 0.04852633
  0.04908581 0.0476355 ]]
2024-10-22 17:01:36,118 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.4907697  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.50923026 0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:36,120 - DEBUG - Added Child Node: ((Discard 4), (Discard 4)) | P=0.49076971411705017
2024-10-22 17:01:36,120 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B)) | P=0.5092302560806274
2024-10-22 17:01:36,120 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:36,120 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:36,120 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || RX|R12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B3 || XX|RYGWB12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 G3}
2024-10-22 17:01:36,121 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:36,121 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:36,121 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:36,121 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4),)
2024-10-22 17:01:36,121 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)']
2024-10-22 17:01:36,122 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:36,329 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:36,329 - DEBUG - Network Policy Logits: [[ 0.04429545 -0.00533519  0.03101075 -0.0087092   0.05458049  0.02227332
   0.04804669  0.01769329  0.00944239 -0.00048934 -0.00989942  0.00077976
  -0.01950955 -0.01333982  0.07520871 -0.02572004  0.04069931  0.00823007
  -0.00407172 -0.00040874]]
2024-10-22 17:01:36,330 - DEBUG - Network Policy after Softmax: [[0.05155849 0.04906207 0.05087808 0.04889682 0.05209151 0.05043548
  0.05175226 0.050205   0.04979247 0.0493004  0.04883865 0.049363
  0.04837155 0.04867092 0.05317722 0.04807207 0.05137341 0.04973214
  0.0491241  0.04930437]]
2024-10-22 17:01:36,332 - DEBUG - Normalized Policy: [[0.33740747 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.34800074 0.31459177 0.         0.
  0.         0.        ]]
2024-10-22 17:01:36,333 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0)) | P=0.3374074697494507
2024-10-22 17:01:36,334 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1)) | P=0.31459176540374756
2024-10-22 17:01:36,335 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color B)) | P=0.34800073504447937
2024-10-22 17:01:36,335 - DEBUG - Simulating Node: ((Reveal player +1 rank 4),) | Value: 0.0
2024-10-22 17:01:36,335 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:36,336 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || B4|B4
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB1235
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB1345
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:36,336 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:36,336 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:36,336 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:36,337 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.9195554256439209 | PUCT: 0.9195554256439209
2024-10-22 17:01:36,337 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.5522071123123169 | PUCT: 0.5522071123123169
2024-10-22 17:01:36,337 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.9195554256439209
2024-10-22 17:01:36,337 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:36,337 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 color B))
2024-10-22 17:01:36,337 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 color B))']
2024-10-22 17:01:36,338 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:36,339 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:36,525 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:36,525 - DEBUG - Network Policy Logits: [[ 0.00445031  0.01116773  0.07351138  0.00349983  0.01818729  0.03694959
   0.03465626  0.0148538   0.00642391  0.02238927 -0.01644067 -0.006333
  -0.03897284 -0.00013657  0.00727947 -0.01278009  0.01656047 -0.01569278
  -0.00891853 -0.00463086]]
2024-10-22 17:01:36,526 - DEBUG - Network Policy after Softmax: [[0.04984409 0.05018004 0.05340802 0.04979673 0.05053351 0.05149059
  0.05137264 0.05036534 0.04994256 0.05074631 0.04881359 0.04930949
  0.04772602 0.04961598 0.0499853  0.04899261 0.05045138 0.04885012
  0.04918216 0.04939349]]
2024-10-22 17:01:36,527 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.50677603 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.49322397 0.        ]]
2024-10-22 17:01:36,528 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Discard 4)) | P=0.5067760348320007
2024-10-22 17:01:36,529 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color B), (Reveal player +1 rank 4)) | P=0.49322396516799927
2024-10-22 17:01:36,529 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:36,529 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:36,529 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
G5 || XX|RYGWB12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 W1}
2024-10-22 17:01:36,529 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:36,529 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:36,529 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:36,530 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.6605352759361267 | PUCT: 0.6605352759361267
2024-10-22 17:01:36,530 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.5949923992156982 | PUCT: 0.5949923992156982
2024-10-22 17:01:36,531 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.6605352759361267
2024-10-22 17:01:36,531 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:36,531 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 4))
2024-10-22 17:01:36,531 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 4))']
2024-10-22 17:01:36,532 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:36,533 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:36,739 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:36,739 - DEBUG - Network Policy Logits: [[-0.00113926  0.01926174  0.06217147 -0.02048751  0.02145028  0.04928811
   0.05055903  0.01870026  0.01875427  0.03942866 -0.02350748  0.00761
  -0.05160142 -0.01227816  0.01726621 -0.01080397  0.03485977 -0.0308909
  -0.02427161 -0.03378502]]
2024-10-22 17:01:36,739 - DEBUG - Network Policy after Softmax: [[0.04959418 0.05061634 0.05283554 0.04864383 0.05072723 0.05215921
  0.05222555 0.05058793 0.05059066 0.05164747 0.04849716 0.05002999
  0.04715364 0.04904481 0.05051543 0.04911717 0.05141204 0.0481404
  0.04846011 0.04800128]]
2024-10-22 17:01:36,741 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.5114285  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.48857152 0.        ]]
2024-10-22 17:01:36,741 - DEBUG - Added Child Node: ((Discard 4), (Discard 4), (Discard 4)) | P=0.5114284753799438
2024-10-22 17:01:36,742 - DEBUG - Added Child Node: ((Discard 4), (Discard 4), (Reveal player +1 rank 4)) | P=0.48857152462005615
2024-10-22 17:01:36,742 - DEBUG - Simulating Node: ((Discard 4), (Discard 4)) | Value: 0.0
2024-10-22 17:01:36,742 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:36,742 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 6, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 0}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || RX|R12345
W4 || XX|RYGWB12345
Deck size: 6
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B1 G5}
2024-10-22 17:01:36,742 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:36,742 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:36,743 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:36,743 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5227090716362 | PUCT: 0.5227090716362
2024-10-22 17:01:36,744 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 0.0 | U: 0.6277896165847778 | PUCT: 0.6277896165847778
2024-10-22 17:01:36,744 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 0.6277896165847778
2024-10-22 17:01:36,744 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:01:36,744 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Reveal player +1 rank 1))
2024-10-22 17:01:36,744 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 rank 1))']
2024-10-22 17:01:36,745 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:36,745 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:01:36,745 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:36,745 - DEBUG - Rollout #6 completed with reward=4
2024-10-22 17:01:36,745 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:36,745 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5447303652763367 | PUCT: 0.5447303652763367
2024-10-22 17:01:36,746 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 2.0 | U: 0.43615856766700745 | PUCT: 2.4361586570739746
2024-10-22 17:01:36,746 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 2.4361586570739746
2024-10-22 17:01:36,746 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:01:36,746 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Reveal player +1 color B))
2024-10-22 17:01:36,746 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 color B))']
2024-10-22 17:01:36,747 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:36,747 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:36,934 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:36,934 - DEBUG - Network Policy Logits: [[ 0.00969189  0.01734292  0.05902746  0.0158624   0.01981316  0.02741287
   0.03799149  0.04576384  0.03809655  0.03267251  0.0015135   0.01771564
  -0.03520008 -0.02284456  0.00791438 -0.00809672  0.04833322 -0.04731908
  -0.01656203 -0.03165123]]
2024-10-22 17:01:36,934 - DEBUG - Network Policy after Softmax: [[0.04991976 0.05030317 0.05244435 0.05022874 0.05042758 0.05081227
  0.05135265 0.05175334 0.05135805 0.05108023 0.04951316 0.05032192
  0.04772832 0.04832169 0.04983111 0.04903961 0.05188648 0.04715339
  0.04862623 0.04789801]]
2024-10-22 17:01:36,936 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.51374984 0.
  0.         0.         0.         0.         0.         0.
  0.48625016 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:36,937 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color B), (Discard 4)) | P=0.5137498378753662
2024-10-22 17:01:36,938 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 color B), (Reveal player +1 color G)) | P=0.4862501621246338
2024-10-22 17:01:36,938 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:36,938 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:36,938 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGW1345
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || XX|RYGWB1235
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:36,938 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:36,938 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:36,938 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:36,939 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5631104111671448 | PUCT: 0.5631104111671448
2024-10-22 17:01:36,939 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 1.3333333333333333 | U: 0.33815643191337585 | PUCT: 1.6714898347854614
2024-10-22 17:01:36,939 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 1.6714898347854614
2024-10-22 17:01:36,939 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:01:36,939 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 4), (Discard 0))
2024-10-22 17:01:36,939 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Discard 0))']
2024-10-22 17:01:36,940 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:36,941 - DEBUG - Move: (Discard 0) | Reward: 4 | Depth: 2
2024-10-22 17:01:37,160 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:37,161 - DEBUG - Network Policy Logits: [[-0.01909056  0.00885174  0.02900322 -0.01536399  0.00039611  0.02901853
   0.04808423  0.0081478   0.01411892  0.06295444 -0.01889017 -0.0009612
  -0.05320874 -0.03507812  0.04515226 -0.03311592  0.00057045 -0.04162271
   0.00060627 -0.02727355]]
2024-10-22 17:01:37,161 - DEBUG - Network Policy after Softmax: [[0.04902561 0.05041481 0.05144105 0.04920864 0.04999032 0.05144184
  0.05243203 0.05037934 0.05068106 0.05321753 0.04903543 0.04992252
  0.04738116 0.04824805 0.05227852 0.04834281 0.04999904 0.04793331
  0.05000083 0.04862607]]
2024-10-22 17:01:37,162 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.5105032  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.48949683
  0.         0.        ]]
2024-10-22 17:01:37,163 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Discard 4)) | P=0.5105031728744507
2024-10-22 17:01:37,164 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Discard 0), (Reveal player +1 rank 3)) | P=0.4894968271255493
2024-10-22 17:01:37,164 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Discard 0)) | Value: 0.0
2024-10-22 17:01:37,164 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:37,164 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB1345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || XX|RYGWB1235
B3 || XX|RYGWB12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:37,164 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:37,164 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:37,164 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:37,165 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5788385272026062 | PUCT: 0.5788385272026062
2024-10-22 17:01:37,165 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 1.0 | U: 0.27808111906051636 | PUCT: 1.2780811786651611
2024-10-22 17:01:37,165 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 1.2780811786651611
2024-10-22 17:01:37,165 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:01:37,166 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.49887815117836 | PUCT: 4.498878002166748
2024-10-22 17:01:37,166 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 color B)) | Q: 0.0 | U: 0.5518579483032227 | PUCT: 0.5518579483032227
2024-10-22 17:01:37,167 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Discard 0)) | Q: 0.0 | U: 0.5350591540336609 | PUCT: 0.5350591540336609
2024-10-22 17:01:37,167 - DEBUG - Selected Child: ((Reveal player +1 rank 4), (Reveal player +1 rank 1)) | PUCT: 4.498878002166748
2024-10-22 17:01:37,167 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4), (Reveal player +1 rank 1))
2024-10-22 17:01:37,167 - DEBUG - Node ((Reveal player +1 rank 4), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:01:37,167 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 rank 1))']
2024-10-22 17:01:37,168 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:37,168 - DEBUG - Illegal move encountered: (Reveal player +1 rank 1)
2024-10-22 17:01:37,168 - DEBUG - Backpropagating reward: 4
2024-10-22 17:01:37,168 - DEBUG - Rollout #9 completed with reward=4
2024-10-22 17:01:37,168 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:37,169 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5925540924072266 | PUCT: 0.5925540924072266
2024-10-22 17:01:37,169 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4),) | Q: 1.6 | U: 0.2372252196073532 | PUCT: 1.8372251987457275
2024-10-22 17:01:37,169 - DEBUG - Selected Child: ((Reveal player +1 rank 4),) | PUCT: 1.8372251987457275
2024-10-22 17:01:37,169 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4),)
2024-10-22 17:01:37,170 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 rank 1)) | Q: 4.0 | U: 0.3509182631969452 | PUCT: 4.350918292999268
2024-10-22 17:01:37,170 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Reveal player +1 color B)) | Q: 0.0 | U: 0.5822775363922119 | PUCT: 0.5822775363922119
2024-10-22 17:01:37,171 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 4), (Discard 0)) | Q: 0.0 | U: 0.5645527839660645 | PUCT: 0.5645527839660645
2024-10-22 17:01:37,171 - DEBUG - Selected Child: ((Reveal player +1 rank 4), (Reveal player +1 rank 1)) | PUCT: 4.350918292999268
2024-10-22 17:01:37,171 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 4), (Reveal player +1 rank 1))
2024-10-22 17:01:37,171 - DEBUG - Node ((Reveal player +1 rank 4), (Reveal player +1 rank 1)) is a leaf node.
2024-10-22 17:01:37,171 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 4),)', '((Reveal player +1 rank 4), (Reveal player +1 rank 1))']
2024-10-22 17:01:37,172 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:37,172 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:37,357 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:37,357 - DEBUG - Network Policy Logits: [[ 0.01127095  0.00962356  0.06773944  0.02308526  0.0260286   0.02241729
   0.02235149  0.04413041  0.03909978  0.02050932 -0.00017821  0.00367356
  -0.03061134 -0.02001464  0.0160004  -0.02132493  0.04171691 -0.04430937
  -0.0135756  -0.01671625]]
2024-10-22 17:01:37,357 - DEBUG - Network Policy after Softmax: [[0.05004237 0.04996    0.0529495  0.0506371  0.05078636 0.05060328
  0.05059996 0.05171405 0.05145455 0.05050683 0.0494727  0.04966363
  0.04798977 0.04850101 0.05027961 0.0484375  0.05158939 0.04733689
  0.04881431 0.04866124]]
2024-10-22 17:01:37,359 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.34020197 0.
  0.         0.         0.         0.33832946 0.         0.
  0.3214685  0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:37,359 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1), (Play 4)) | P=0.3383294641971588
2024-10-22 17:01:37,360 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1), (Discard 4)) | P=0.3402019739151001
2024-10-22 17:01:37,361 - DEBUG - Added Child Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1), (Reveal player +1 color G)) | P=0.3214685022830963
2024-10-22 17:01:37,361 - DEBUG - Simulating Node: ((Reveal player +1 rank 4), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:37,361 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:37,361 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 8, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'B', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || X1|RYGWB1
-----
B4 || B4|B4
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || XX|RYGWB1235
Deck size: 8
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4}
2024-10-22 17:01:37,361 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:37,361 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:37,361 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:37,361 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 4),) | Visit Count: 6
2024-10-22 17:01:37,361 - INFO - Actual Game Score: 4
2024-10-22 17:01:37,361 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:37,361 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:37,362 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.33333333 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.66666667 0.        ]
2024-10-22 17:01:37,362 - DEBUG - === End of Training Data ===
2024-10-22 17:01:37,362 - INFO - Chosen Action: (Reveal player +1 rank 4) | Visit Count: 6
2024-10-22 17:01:37,362 - DEBUG - Not the current player's turn.
2024-10-22 17:01:39,435 - INFO - Agent state has been reset.
2024-10-22 17:01:39,435 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:39,435 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB1345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || XX|RYGWB1235
G3 || XX|RYGWB12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:39,435 - INFO - Max Rollouts: 10
2024-10-22 17:01:39,435 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:39,436 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:39,436 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:39,634 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:39,634 - DEBUG - Network Policy Logits: [[-0.0059907   0.01012642  0.0255949  -0.02064789 -0.00276183  0.02116402
   0.05428031  0.01957313  0.01513999  0.06637381 -0.01850002 -0.00479791
  -0.0480129  -0.03789713  0.04688264 -0.03518287 -0.00666819 -0.04144918
  -0.00834847 -0.02870737]]
2024-10-22 17:01:39,635 - DEBUG - Network Policy after Softmax: [[0.04967618 0.05048331 0.05127028 0.04895338 0.04983684 0.05104361
  0.05276228 0.05096247 0.05073704 0.05340424 0.04905864 0.04973547
  0.04763193 0.04811621 0.0523734  0.04824699 0.04964254 0.0479456
  0.04955919 0.04856043]]
2024-10-22 17:01:39,636 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.34272292 0.
  0.         0.         0.         0.         0.         0.
  0.32756    0.         0.         0.         0.         0.3297171
  0.         0.        ]]
2024-10-22 17:01:39,637 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.2570422  0.
 0.         0.         0.         0.         0.         0.
 0.49567    0.         0.         0.         0.         0.24728782
 0.         0.        ]
2024-10-22 17:01:39,637 - DEBUG - Added Child Node: ((Discard 4),) | P=0.25704219937324524
2024-10-22 17:01:39,639 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.2472878247499466
2024-10-22 17:01:39,639 - DEBUG - Added Child Node: ((Reveal player +1 color G),) | P=0.49566999077796936
2024-10-22 17:01:39,639 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:39,640 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:39,640 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB1345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || XX|RYGWB1235
G3 || XX|RYGWB12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:39,640 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:39,640 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:39,640 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:39,640 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G),)
2024-10-22 17:01:39,640 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)']
2024-10-22 17:01:39,641 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:01:39,846 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:39,846 - DEBUG - Network Policy Logits: [[ 0.04045366  0.00211942  0.00731968  0.01706464  0.04451242  0.01752614
   0.0369204   0.02451016  0.00697801  0.02083865 -0.03886028 -0.02793561
  -0.00478782 -0.016447    0.05369235 -0.02358139  0.02692244  0.03577233
  -0.00978974  0.01730713]]
2024-10-22 17:01:39,846 - DEBUG - Network Policy after Softmax: [[0.05145145 0.04951642 0.04977459 0.05026201 0.0516607  0.05028521
  0.05126998 0.05063764 0.04975758 0.05045206 0.04752827 0.04805034
  0.04917558 0.04860556 0.05213713 0.04826003 0.05075994 0.05121115
  0.04893022 0.0502742 ]]
2024-10-22 17:01:39,848 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33361405 0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.3460601  0.32032588 0.         0.
  0.         0.        ]]
2024-10-22 17:01:39,848 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 3)) | P=0.3336140513420105
2024-10-22 17:01:39,849 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 1)) | P=0.3203258812427521
2024-10-22 17:01:39,850 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color B)) | P=0.3460600972175598
2024-10-22 17:01:39,850 - DEBUG - Simulating Node: ((Reveal player +1 color G),) | Value: 0.0
2024-10-22 17:01:39,850 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:39,850 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G1235
XX || GX|G12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB1345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:39,850 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:39,850 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:39,850 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:39,850 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:39,850 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:39,851 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:40,034 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:40,034 - DEBUG - Network Policy Logits: [[ 0.03804215  0.01715737  0.03343254 -0.02282503  0.03001576  0.04583303
   0.0459482   0.05188238 -0.00595932  0.04841855 -0.00815633 -0.02437069
  -0.0231633  -0.01838231  0.03705042 -0.00294927  0.06726823 -0.01527912
  -0.01821349 -0.0083077 ]]
2024-10-22 17:01:40,034 - DEBUG - Network Policy after Softmax: [[0.05122567 0.05016692 0.05099008 0.0482007  0.05081615 0.05162632
  0.05163226 0.05193957 0.04902053 0.05175997 0.04891295 0.04812625
  0.0481844  0.04841532 0.05117489 0.04916831 0.05274488 0.04856579
  0.04842349 0.04890555]]
2024-10-22 17:01:40,036 - DEBUG - Normalized Policy: [[0.        0.        0.        0.4988471 0.        0.        0.
  0.        0.        0.        0.        0.        0.        0.
  0.        0.        0.        0.        0.5011529 0.       ]]
2024-10-22 17:01:40,036 - DEBUG - Added Child Node: ((Discard 4), (Discard 3)) | P=0.498847097158432
2024-10-22 17:01:40,037 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4)) | P=0.5011528730392456
2024-10-22 17:01:40,037 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:40,037 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:40,037 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 6, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB1235
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
W4 || XX|RYGWB12345
Deck size: 6
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 B4}
2024-10-22 17:01:40,037 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:40,037 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:40,038 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:40,038 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:01:40,038 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:01:40,039 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:40,224 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:40,224 - DEBUG - Network Policy Logits: [[ 0.04930898 -0.00605303  0.03946438  0.01088998  0.05517581  0.03075169
   0.02003516  0.05047153  0.0002497   0.03682221 -0.01087943 -0.04080257
  -0.00844895 -0.0088333   0.05549083 -0.01287088  0.04216766  0.01470949
  -0.02903473  0.01850357]]
2024-10-22 17:01:40,225 - DEBUG - Network Policy after Softmax: [[0.05170605 0.0489213  0.05119953 0.04975723 0.05201029 0.05075538
  0.05021436 0.0517662  0.04923061 0.05106442 0.04868576 0.0472505
  0.04880423 0.04878547 0.05202668 0.04858889 0.05133812 0.04994765
  0.04780982 0.05013751]]
2024-10-22 17:01:40,226 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.34816355 0.
  0.         0.         0.         0.         0.         0.
  0.         0.32657617 0.         0.32526025 0.         0.
  0.         0.        ]]
2024-10-22 17:01:40,227 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color W)) | P=0.3265761733055115
2024-10-22 17:01:40,227 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 4)) | P=0.34816354513168335
2024-10-22 17:01:40,228 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1)) | P=0.3252602517604828
2024-10-22 17:01:40,228 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:01:40,228 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:40,228 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB125
XX || X3|RYGWB3
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
W1 || XX|RYGWB1345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:40,228 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:40,228 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:40,228 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:40,229 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.7860311269760132 | PUCT: 0.7860311269760132
2024-10-22 17:01:40,230 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4076162874698639 | PUCT: 0.4076162874698639
2024-10-22 17:01:40,230 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.39214786887168884 | PUCT: 0.39214786887168884
2024-10-22 17:01:40,230 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.7860311269760132
2024-10-22 17:01:40,230 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:01:40,230 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Reveal player +1 rank 1))
2024-10-22 17:01:40,230 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 rank 1))']
2024-10-22 17:01:40,231 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:01:40,232 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:40,512 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:40,512 - DEBUG - Network Policy Logits: [[ 0.01432822  0.01884872  0.03803138  0.01519921  0.00656917 -0.01630346
   0.02276784  0.01846237  0.01922012  0.02669297 -0.02975648 -0.00499924
  -0.04227372 -0.0414766   0.05298159 -0.04593563 -0.01774892 -0.01151283
  -0.03719819 -0.00167962]]
2024-10-22 17:01:40,513 - DEBUG - Network Policy after Softmax: [[0.05074178 0.05097167 0.05195889 0.05078599 0.05034959 0.04921104
  0.05117183 0.05095199 0.05099061 0.05137308 0.04855343 0.04977048
  0.04794946 0.0479877  0.05274152 0.0477742  0.04913995 0.04944735
  0.04819345 0.04993597]]
2024-10-22 17:01:40,515 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.25036347 0.
  0.         0.         0.         0.25545275 0.         0.
  0.         0.         0.         0.         0.         0.24587707
  0.         0.24830674]]
2024-10-22 17:01:40,516 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 1), (Reveal player +1 rank 5)) | P=0.2483067363500595
2024-10-22 17:01:40,516 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 1), (Play 4)) | P=0.2554527521133423
2024-10-22 17:01:40,517 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 1), (Discard 4)) | P=0.25036346912384033
2024-10-22 17:01:40,518 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 rank 1), (Reveal player +1 rank 3)) | P=0.24587707221508026
2024-10-22 17:01:40,518 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:40,518 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:40,518 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || GX|G1235
G3 || GX|G12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:40,518 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:40,518 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:40,518 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:40,519 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.5529059171676636 | PUCT: 0.5529059171676636
2024-10-22 17:01:40,520 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4300849735736847 | PUCT: 0.4300849735736847
2024-10-22 17:01:40,520 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4137638807296753 | PUCT: 0.4137638807296753
2024-10-22 17:01:40,520 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.5529059171676636
2024-10-22 17:01:40,521 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:01:40,521 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Discard 3))
2024-10-22 17:01:40,521 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Discard 3))']
2024-10-22 17:01:40,521 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:01:40,522 - DEBUG - Move: (Discard 3) | Reward: 4 | Depth: 2
2024-10-22 17:01:40,726 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:40,727 - DEBUG - Network Policy Logits: [[ 0.01159659  0.0182131   0.02902246 -0.02990976  0.01819467  0.01917711
   0.05688274  0.00812509 -0.00218484  0.05603274 -0.03360738  0.00743595
  -0.02877253 -0.04686635  0.04165443 -0.02971421  0.01142616 -0.0398162
  -0.02748935 -0.0253197 ]]
2024-10-22 17:01:40,727 - DEBUG - Network Policy after Softmax: [[0.0505232  0.05085859 0.05141133 0.04846909 0.05085766 0.05090765
  0.0528638  0.05034811 0.04983169 0.05281889 0.0482902  0.05031343
  0.04852424 0.04765415 0.05206487 0.04847857 0.05051459 0.04799131
  0.04858655 0.04869208]]
2024-10-22 17:01:40,729 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.51449865 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.48550138
  0.         0.        ]]
2024-10-22 17:01:40,729 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 3), (Discard 4)) | P=0.5144986510276794
2024-10-22 17:01:40,730 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Discard 3), (Reveal player +1 rank 3)) | P=0.48550137877464294
2024-10-22 17:01:40,730 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Discard 3)) | Value: 0.0
2024-10-22 17:01:40,730 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:40,730 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 6, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB1345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
B3 || XX|RYGWB12345
Deck size: 6
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G3}
2024-10-22 17:01:40,731 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:40,731 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:40,731 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:40,731 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.4321495294570923 | PUCT: 0.4321495294570923
2024-10-22 17:01:40,732 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.4482041001319885 | PUCT: 0.4482041001319885
2024-10-22 17:01:40,732 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4311954081058502 | PUCT: 0.4311954081058502
2024-10-22 17:01:40,732 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.4482041001319885
2024-10-22 17:01:40,732 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:40,732 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 4))
2024-10-22 17:01:40,732 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 4))']
2024-10-22 17:01:40,734 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:40,734 - DEBUG - Move: (Reveal player +1 rank 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:40,940 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:40,941 - DEBUG - Network Policy Logits: [[ 0.00573047  0.0046522   0.03786639 -0.02649194  0.01170095  0.02283799
   0.03758314  0.00888448  0.00939709  0.06569588 -0.04203111  0.00506107
  -0.05376275 -0.04438042  0.04240748 -0.03402993  0.01082689 -0.03731189
  -0.00323518 -0.01490313]]
2024-10-22 17:01:40,941 - DEBUG - Network Policy after Softmax: [[0.05024575 0.0501916  0.05188667 0.04865252 0.05054664 0.05111273
  0.05187198 0.05040448 0.05043032 0.05335093 0.04790235 0.05021213
  0.04734366 0.04778994 0.05212283 0.04828716 0.05050248 0.04812894
  0.04979728 0.04921963]]
2024-10-22 17:01:40,942 - DEBUG - Normalized Policy: [[0.34481418 0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.3248984  0.         0.         0.         0.         0.33028743
  0.         0.        ]]
2024-10-22 17:01:40,943 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4), (Discard 0)) | P=0.3448141813278198
2024-10-22 17:01:40,944 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4), (Reveal player +1 rank 3)) | P=0.3302874267101288
2024-10-22 17:01:40,945 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 4), (Reveal player +1 color G)) | P=0.3248983919620514
2024-10-22 17:01:40,945 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 4)) | Value: 0.0
2024-10-22 17:01:40,945 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:40,945 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 6, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB1235
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || XX|RYGWB1235
G3 || XX|RYGWB12345
Deck size: 6
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 B1}
2024-10-22 17:01:40,945 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:40,946 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:40,946 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:40,946 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.4467308819293976 | PUCT: 0.4467308819293976
2024-10-22 17:01:40,947 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.30888476967811584 | PUCT: 0.30888476967811584
2024-10-22 17:01:40,947 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4457446038722992 | PUCT: 0.4457446038722992
2024-10-22 17:01:40,948 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.4467308819293976
2024-10-22 17:01:40,948 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:01:40,948 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Reveal player +1 color B))
2024-10-22 17:01:40,948 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 color B))']
2024-10-22 17:01:40,948 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:01:40,949 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:41,167 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:41,167 - DEBUG - Network Policy Logits: [[ 0.01231899  0.02854508  0.03366017  0.01322741 -0.00194726 -0.01502026
   0.02908715  0.00728571  0.00945996  0.02030902 -0.02536841 -0.01039858
  -0.04372887 -0.02762556  0.04227732 -0.04633142 -0.02040282 -0.00551986
  -0.03554869  0.00161956]]
2024-10-22 17:01:41,168 - DEBUG - Network Policy after Softmax: [[0.05068979 0.051519   0.05178319 0.05073585 0.04997177 0.04932274
  0.05154693 0.05043529 0.05054507 0.05109642 0.04881497 0.04955122
  0.04792689 0.04870491 0.05223135 0.04780231 0.04905797 0.04979356
  0.04832054 0.05015033]]
2024-10-22 17:01:41,170 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33333257 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.3321438
  0.         0.33452362]]
2024-10-22 17:01:41,171 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color B), (Reveal player +1 rank 5)) | P=0.33452361822128296
2024-10-22 17:01:41,171 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color B), (Discard 4)) | P=0.3333325684070587
2024-10-22 17:01:41,172 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color B), (Reveal player +1 rank 3)) | P=0.3321438133716583
2024-10-22 17:01:41,172 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:41,172 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:41,172 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': 'G', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B1345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || GX|G1235
G3 || GX|G12345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:41,172 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:41,172 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:41,172 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:41,173 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.367366760969162 | PUCT: 0.367366760969162
2024-10-22 17:01:41,174 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.317512184381485 | PUCT: 0.317512184381485
2024-10-22 17:01:41,174 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4581946134567261 | PUCT: 0.4581946134567261
2024-10-22 17:01:41,175 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.4581946134567261
2024-10-22 17:01:41,175 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:01:41,175 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Reveal player +1 rank 1))
2024-10-22 17:01:41,175 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 rank 1))']
2024-10-22 17:01:41,175 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:41,176 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:41,394 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:41,394 - DEBUG - Network Policy Logits: [[-0.00443482 -0.00767826  0.04678975  0.02241461 -0.00356804 -0.0024785
   0.03211809  0.0159554   0.03838309  0.04144517 -0.02054586 -0.00138795
  -0.05508178 -0.03589207  0.04616496 -0.04117033 -0.02336089 -0.0210307
  -0.02220897  0.00318374]]
2024-10-22 17:01:41,395 - DEBUG - Network Policy after Softmax: [[0.04973823 0.04957717 0.05235244 0.05109177 0.04978136 0.04983564
  0.05158995 0.05076282 0.05191417 0.05207339 0.04894332 0.04989001
  0.04728187 0.04819796 0.05231974 0.04794423 0.04880574 0.0489196
  0.04886199 0.05011862]]
2024-10-22 17:01:41,397 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33379707 0.
  0.         0.         0.         0.34916565 0.         0.
  0.3170373  0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:41,398 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1), (Play 4)) | P=0.3491656482219696
2024-10-22 17:01:41,398 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1), (Discard 4)) | P=0.33379706740379333
2024-10-22 17:01:41,399 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1), (Reveal player +1 color G)) | P=0.31703731417655945
2024-10-22 17:01:41,399 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:41,399 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:41,399 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 16, 17, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': 2}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G5 || XX|RYGWB125
G3 || X3|RYGWB3
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:41,400 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:41,400 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:41,400 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:41,401 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G),) | Q: 0.0 | U: 0.3760715126991272 | PUCT: 0.3760715126991272
2024-10-22 17:01:41,402 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3250356614589691 | PUCT: 0.3250356614589691
2024-10-22 17:01:41,402 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.312701016664505 | PUCT: 0.312701016664505
2024-10-22 17:01:41,402 - DEBUG - Selected Child: ((Reveal player +1 color G),) | PUCT: 0.3760715126991272
2024-10-22 17:01:41,402 - DEBUG - Selected child for exploration: ((Reveal player +1 color G),)
2024-10-22 17:01:41,403 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5079712867736816 | PUCT: 0.5079712867736816
2024-10-22 17:01:41,403 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Discard 3)) | Q: 0.0 | U: 0.5290436148643494 | PUCT: 0.5290436148643494
2024-10-22 17:01:41,404 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color G), (Reveal player +1 color B)) | Q: 0.0 | U: 0.5487804412841797 | PUCT: 0.5487804412841797
2024-10-22 17:01:41,404 - DEBUG - Selected Child: ((Reveal player +1 color G), (Reveal player +1 color B)) | PUCT: 0.5487804412841797
2024-10-22 17:01:41,404 - DEBUG - Selected child for exploration: ((Reveal player +1 color G), (Reveal player +1 color B))
2024-10-22 17:01:41,404 - DEBUG - Expanding unexplored child: ((Reveal player +1 color G), (Reveal player +1 color B), (Reveal player +1 rank 5))
2024-10-22 17:01:41,404 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color G),)', '((Reveal player +1 color G), (Reveal player +1 color B))', '((Reveal player +1 color G), (Reveal player +1 color B), (Reveal player +1 rank 5))']
2024-10-22 17:01:41,406 - DEBUG - Move: (Reveal player +1 color G) | Reward: 4 | Depth: 1
2024-10-22 17:01:41,406 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:41,407 - DEBUG - Move: (Reveal player +1 rank 5) | Reward: 4 | Depth: 3
2024-10-22 17:01:41,624 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:41,625 - DEBUG - Network Policy Logits: [[ 0.03313033  0.01038901  0.01478436  0.01866756  0.04272219  0.031052
   0.02646315  0.03456236  0.01253971  0.01282221 -0.0436544  -0.03442968
  -0.00123649 -0.01712678  0.05075828 -0.01592958  0.03937273  0.03282312
  -0.01507792  0.01463178]]
2024-10-22 17:01:41,625 - DEBUG - Network Policy after Softmax: [[0.0510327  0.04988525 0.050105   0.05029994 0.05152456 0.05092675
  0.05069359 0.05110584 0.04999265 0.05000678 0.04726084 0.04769883
  0.04930867 0.04853133 0.05194028 0.04858947 0.05135227 0.05101703
  0.04863087 0.05009735]]
2024-10-22 17:01:41,627 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.26104027 0.
  0.         0.         0.         0.2533507  0.23943886 0.
  0.         0.         0.         0.24617015 0.         0.
  0.         0.        ]]
2024-10-22 17:01:41,628 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color B), (Reveal player +1 rank 5), (Reveal player +1 color R)) | P=0.23943886160850525
2024-10-22 17:01:41,628 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color B), (Reveal player +1 rank 5), (Play 4)) | P=0.25335070490837097
2024-10-22 17:01:41,629 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color B), (Reveal player +1 rank 5), (Discard 4)) | P=0.26104027032852173
2024-10-22 17:01:41,630 - DEBUG - Added Child Node: ((Reveal player +1 color G), (Reveal player +1 color B), (Reveal player +1 rank 5), (Reveal player +1 rank 1)) | P=0.24617014825344086
2024-10-22 17:01:41,630 - DEBUG - Simulating Node: ((Reveal player +1 color G), (Reveal player +1 color B), (Reveal player +1 rank 5)) | Value: 0.0
2024-10-22 17:01:41,630 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:41,630 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 1, 'num_players': 2, 'deck_size': 7, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'G', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 1
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || G5|G5
XX || GX|G1234
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
R1 || XX|RYGW1345
Deck size: 7
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4}
2024-10-22 17:01:41,630 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:41,630 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:41,630 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:41,630 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color G),) | Visit Count: 5
2024-10-22 17:01:41,630 - INFO - Actual Game Score: 4
2024-10-22 17:01:41,630 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:41,630 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:41,631 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.22222222 0.
 0.         0.         0.         0.         0.         0.
 0.55555556 0.         0.         0.         0.         0.22222222
 0.         0.        ]
2024-10-22 17:01:41,631 - DEBUG - === End of Training Data ===
2024-10-22 17:01:41,631 - INFO - Chosen Action: (Reveal player +1 color G) | Visit Count: 5
2024-10-22 17:01:41,633 - DEBUG - Not the current player's turn.
2024-10-22 17:01:43,671 - INFO - Agent state has been reset.
2024-10-22 17:01:43,672 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:43,672 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 6, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB1345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
W4 || XX|RYGWB12345
Deck size: 6
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5}
2024-10-22 17:01:43,672 - INFO - Max Rollouts: 10
2024-10-22 17:01:43,672 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:43,672 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:43,672 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:43,882 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:43,882 - DEBUG - Network Policy Logits: [[ 0.01002877  0.02070517  0.02460773 -0.03392769  0.03265655  0.0109058
   0.05549103  0.01044205  0.00407384  0.04243282 -0.03626298  0.00337916
  -0.02838963 -0.03614104  0.04605604 -0.02963852  0.01904576 -0.03547259
  -0.02639055 -0.02090215]]
2024-10-22 17:01:43,882 - DEBUG - Network Policy after Softmax: [[0.05039923 0.05094019 0.05113938 0.04823184 0.05155265 0.05044345
  0.05274337 0.05042006 0.05009999 0.05205911 0.04811934 0.0500652
  0.04849969 0.0481252  0.05224808 0.04843916 0.05085573 0.04815739
  0.04859674 0.04886419]]
2024-10-22 17:01:43,884 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.5170257  0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.48297432
  0.         0.        ]]
2024-10-22 17:01:43,884 - DEBUG - Dirichlet Noise Added: [0.         0.         0.         0.         0.6377693  0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.36223075
 0.         0.        ]
2024-10-22 17:01:43,885 - DEBUG - Added Child Node: ((Discard 4),) | P=0.6377692818641663
2024-10-22 17:01:43,886 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.36223074793815613
2024-10-22 17:01:43,886 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:43,886 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:43,886 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 6, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB1345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
W4 || XX|RYGWB12345
Deck size: 6
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5}
2024-10-22 17:01:43,886 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:43,886 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:43,886 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:43,887 - DEBUG - Expanding unexplored child: ((Discard 4),)
2024-10-22 17:01:43,887 - DEBUG - Traversing Path: ['()', '((Discard 4),)']
2024-10-22 17:01:43,888 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:44,093 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:44,093 - DEBUG - Network Policy Logits: [[ 0.04429546  0.01955682  0.01170591 -0.02470689  0.02324949  0.03464169
   0.04849673  0.03478971 -0.00402848  0.02055996 -0.0190294  -0.03160615
  -0.0131069  -0.02643386  0.04237673 -0.00806834  0.04961294  0.01906749
  -0.01209837 -0.02315776]]
2024-10-22 17:01:44,094 - DEBUG - Network Policy after Softmax: [[0.05176143 0.05049663 0.05010173 0.0483102  0.05068344 0.05126413
  0.05197934 0.05127172 0.04931958 0.05054731 0.04858527 0.04797805
  0.04887386 0.04822684 0.0516622  0.04912074 0.0520374  0.05047192
  0.04892318 0.0483851 ]]
2024-10-22 17:01:44,096 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.25635368 0.
  0.         0.         0.24945538 0.         0.24574126 0.
  0.         0.         0.         0.24844965 0.         0.
  0.         0.        ]]
2024-10-22 17:01:44,096 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color R)) | P=0.24574126303195953
2024-10-22 17:01:44,097 - DEBUG - Added Child Node: ((Discard 4), (Play 3)) | P=0.24945537745952606
2024-10-22 17:01:44,098 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1)) | P=0.2484496533870697
2024-10-22 17:01:44,098 - DEBUG - Added Child Node: ((Discard 4), (Discard 4)) | P=0.2563536763191223
2024-10-22 17:01:44,099 - DEBUG - Simulating Node: ((Discard 4),) | Value: 0.0
2024-10-22 17:01:44,099 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:44,099 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
R1 || XX|RYGWB12345
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B1}
2024-10-22 17:01:44,099 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:44,099 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:44,099 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:44,099 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:01:44,099 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:01:44,100 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:44,303 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:44,303 - DEBUG - Network Policy Logits: [[ 0.04065561  0.00317497  0.0128543  -0.00158062  0.03080423  0.0196859
   0.03833319  0.01159726 -0.00256704  0.01917623 -0.01417355 -0.01823454
  -0.04523016 -0.03011534  0.06724374 -0.02515393  0.0370964   0.02087836
   0.00557624 -0.00685377]]
2024-10-22 17:01:44,303 - DEBUG - Network Policy after Softmax: [[0.05163302 0.0497336  0.05021733 0.04949765 0.05112686 0.05056157
  0.05151325 0.05015424 0.04944885 0.05053581 0.04887824 0.04868015
  0.04738358 0.04810521 0.05302426 0.04834447 0.05144958 0.0506219
  0.04985317 0.04923733]]
2024-10-22 17:01:44,305 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.33285722 0.
  0.         0.         0.32193264 0.         0.         0.
  0.         0.         0.3452101  0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:44,305 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Play 3)) | P=0.3219326436519623
2024-10-22 17:01:44,306 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color B)) | P=0.34521010518074036
2024-10-22 17:01:44,307 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 4)) | P=0.332857221364975
2024-10-22 17:01:44,307 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:01:44,307 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:44,307 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 6, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || G3|G3
XX || XX|RYGWB1245
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B4 || XX|RYGWB1345
Deck size: 6
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5}
2024-10-22 17:01:44,307 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:44,307 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:44,307 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:44,308 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.9386448860168457 | PUCT: 0.9386448860168457
2024-10-22 17:01:44,309 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.5331176519393921 | PUCT: 0.5331176519393921
2024-10-22 17:01:44,309 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.9386448860168457
2024-10-22 17:01:44,309 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:44,309 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 rank 1))
2024-10-22 17:01:44,309 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 rank 1))']
2024-10-22 17:01:44,310 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:44,311 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:44,517 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:44,518 - DEBUG - Network Policy Logits: [[-0.00050215  0.00460801  0.04263959 -0.02271843  0.03928412  0.00184068
   0.03352444  0.00457616  0.01512528  0.04418977 -0.04531631 -0.02803123
  -0.03172055 -0.03661738  0.04779585 -0.0283199   0.0109177  -0.0266651
  -0.02603917  0.00164883]]
2024-10-22 17:01:44,518 - DEBUG - Network Policy after Softmax: [[0.04995305 0.05020898 0.05215528 0.04885552 0.05198057 0.05007022
  0.05168203 0.05020738 0.05073982 0.05223619 0.04776387 0.04859665
  0.04841769 0.04818118 0.0524249  0.04858262 0.05052678 0.04866308
  0.04869355 0.05006062]]
2024-10-22 17:01:44,520 - DEBUG - Normalized Policy: [[0.         0.33227158 0.         0.         0.         0.
  0.         0.         0.         0.34568724 0.         0.
  0.         0.         0.         0.         0.         0.3220412
  0.         0.        ]]
2024-10-22 17:01:44,521 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1), (Play 4)) | P=0.34568724036216736
2024-10-22 17:01:44,522 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1), (Discard 1)) | P=0.3322715759277344
2024-10-22 17:01:44,522 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 rank 1), (Reveal player +1 rank 3)) | P=0.32204121351242065
2024-10-22 17:01:44,523 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:44,523 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:44,523 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
W4 || XX|RYGWB12345
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B4}
2024-10-22 17:01:44,523 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:44,523 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:44,523 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:44,524 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.674247682094574 | PUCT: 0.674247682094574
2024-10-22 17:01:44,525 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.5744238495826721 | PUCT: 0.5744238495826721
2024-10-22 17:01:44,525 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.674247682094574
2024-10-22 17:01:44,525 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:44,525 - DEBUG - Expanding unexplored child: ((Discard 4), (Reveal player +1 color R))
2024-10-22 17:01:44,525 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Reveal player +1 color R))']
2024-10-22 17:01:44,526 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:44,526 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 2
2024-10-22 17:01:44,735 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:44,736 - DEBUG - Network Policy Logits: [[-0.00789177  0.00838938  0.03676405 -0.03943026  0.01722098  0.01685321
   0.05659325  0.01073818  0.00291827  0.04719662 -0.05487887 -0.01307454
  -0.04680079 -0.02513013  0.06077919 -0.03343886  0.02626283 -0.02636028
  -0.02504336 -0.0266432 ]]
2024-10-22 17:01:44,737 - DEBUG - Network Policy after Softmax: [[0.04961587 0.05043029 0.05188173 0.04807548 0.05087764 0.05085893
  0.05292077 0.05054888 0.05015513 0.05242582 0.04733849 0.04935939
  0.04772244 0.04876791 0.05314276 0.04836439 0.05133976 0.04870795
  0.04877214 0.04869417]]
2024-10-22 17:01:44,739 - DEBUG - Normalized Policy: [[0.         0.3327325  0.         0.         0.         0.
  0.         0.         0.         0.34589875 0.         0.
  0.         0.         0.         0.         0.         0.32136875
  0.         0.        ]]
2024-10-22 17:01:44,739 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color R), (Play 4)) | P=0.34589874744415283
2024-10-22 17:01:44,740 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color R), (Discard 1)) | P=0.33273249864578247
2024-10-22 17:01:44,741 - DEBUG - Added Child Node: ((Discard 4), (Reveal player +1 color R), (Reveal player +1 rank 3)) | P=0.3213687539100647
2024-10-22 17:01:44,741 - DEBUG - Simulating Node: ((Discard 4), (Reveal player +1 color R)) | Value: 0.0
2024-10-22 17:01:44,741 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:44,741 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|YGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
W4 || XX|RYGWB12345
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:44,741 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:44,741 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:44,741 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:44,743 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5335602164268494 | PUCT: 0.5335602164268494
2024-10-22 17:01:44,743 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.606087327003479 | PUCT: 0.606087327003479
2024-10-22 17:01:44,743 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.606087327003479
2024-10-22 17:01:44,743 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:01:44,743 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Reveal player +1 color B))
2024-10-22 17:01:44,743 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 color B))']
2024-10-22 17:01:44,744 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:44,745 - DEBUG - Move: (Reveal player +1 color B) | Reward: 4 | Depth: 2
2024-10-22 17:01:44,961 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:44,961 - DEBUG - Network Policy Logits: [[ 0.01078853  0.01439141  0.01858857 -0.0047968   0.03661054 -0.00904015
   0.0185985  -0.0036891   0.00649284  0.02926559 -0.03578183 -0.02299245
  -0.03571688 -0.00813226  0.02263223 -0.03550613  0.01835656 -0.01996757
  -0.0151269  -0.01397999]]
2024-10-22 17:01:44,961 - DEBUG - Network Policy after Softmax: [[0.05060379 0.05078644 0.05100005 0.04982123 0.0519275  0.04961027
  0.05100055 0.04987645 0.05038688 0.05154749 0.04830119 0.0489229
  0.04830433 0.04965533 0.05120669 0.04831451 0.05098822 0.04907111
  0.04930922 0.04936581]]
2024-10-22 17:01:44,963 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.51293147 0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.4870685  0.        ]]
2024-10-22 17:01:44,964 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color B), (Discard 4)) | P=0.5129314661026001
2024-10-22 17:01:44,964 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color B), (Reveal player +1 rank 4)) | P=0.4870685040950775
2024-10-22 17:01:44,964 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:44,964 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:44,965 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 6, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B1345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || G3|G3
W4 || XX|RYGWB1245
Deck size: 6
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5}
2024-10-22 17:01:44,965 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:44,965 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:44,965 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:44,965 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.5560386776924133 | PUCT: 0.5560386776924133
2024-10-22 17:01:44,966 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.4210808277130127 | PUCT: 0.4210808277130127
2024-10-22 17:01:44,966 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.5560386776924133
2024-10-22 17:01:44,966 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:44,967 - DEBUG - Expanding unexplored child: ((Discard 4), (Play 3))
2024-10-22 17:01:44,967 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Play 3))']
2024-10-22 17:01:44,967 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:44,968 - DEBUG - Move: (Play 3) | Reward: 5 | Depth: 2
2024-10-22 17:01:45,181 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:45,182 - DEBUG - Network Policy Logits: [[-0.0228915   0.0174647   0.01596397 -0.02254805 -0.00502646  0.02334632
   0.05157309 -0.00917888  0.01662361  0.07000996 -0.00108038  0.00032444
  -0.06965962 -0.04485622  0.02780943 -0.03455016  0.00940471 -0.01683825
  -0.0055616  -0.03978401]]
2024-10-22 17:01:45,182 - DEBUG - Network Policy after Softmax: [[0.0489394  0.05095481 0.05087839 0.04895621 0.04982156 0.05125538
  0.05272277 0.04961511 0.05091197 0.05370383 0.05001855 0.05008887
  0.04670329 0.04787618 0.05148466 0.04837215 0.05054576 0.04923654
  0.04979491 0.04811964]]
2024-10-22 17:01:45,183 - DEBUG - Normalized Policy: [[0.         0.         0.3348834  0.         0.         0.33736476
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.32775187 0.        ]]
2024-10-22 17:01:45,184 - DEBUG - Added Child Node: ((Discard 4), (Play 3), (Discard 2)) | P=0.3348833918571472
2024-10-22 17:01:45,185 - DEBUG - Added Child Node: ((Discard 4), (Play 3), (Play 0)) | P=0.3373647630214691
2024-10-22 17:01:45,186 - DEBUG - Added Child Node: ((Discard 4), (Play 3), (Reveal player +1 rank 4)) | P=0.32775187492370605
2024-10-22 17:01:45,186 - DEBUG - Simulating Node: ((Discard 4), (Play 3)) | Value: 0.0
2024-10-22 17:01:45,186 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:45,186 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'B', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
W4 || XX|RYGWB12345
B3 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 R1}
2024-10-22 17:01:45,187 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:45,187 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:45,187 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:45,187 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.45984020829200745 | PUCT: 0.45984020829200745
2024-10-22 17:01:45,188 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.43528875708580017 | PUCT: 0.43528875708580017
2024-10-22 17:01:45,188 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.45984020829200745
2024-10-22 17:01:45,188 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:45,188 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 4))
2024-10-22 17:01:45,188 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 4))']
2024-10-22 17:01:45,189 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:45,190 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:45,394 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:45,395 - DEBUG - Network Policy Logits: [[-0.00085171  0.01462218  0.04292212 -0.03655912  0.00359166  0.01703302
   0.05383774  0.01152404  0.00358764  0.06018413 -0.03575927  0.00904666
  -0.05688552 -0.04863161  0.03712914 -0.02036795  0.01794892 -0.02574543
  -0.03169705 -0.02911119]]
2024-10-22 17:01:45,395 - DEBUG - Network Policy after Softmax: [[0.04996541 0.05074459 0.05220117 0.04821276 0.05018793 0.05086707
  0.0527741  0.05058762 0.05018772 0.05311009 0.04825134 0.05046245
  0.04724266 0.04763421 0.05189964 0.04899973 0.05091368 0.04873694
  0.04844774 0.04857318]]
2024-10-22 17:01:45,397 - DEBUG - Normalized Policy: [[0.         0.51009053 0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.48990947
  0.         0.        ]]
2024-10-22 17:01:45,398 - DEBUG - Added Child Node: ((Discard 4), (Discard 4), (Discard 1)) | P=0.5100905299186707
2024-10-22 17:01:45,398 - DEBUG - Added Child Node: ((Discard 4), (Discard 4), (Reveal player +1 rank 3)) | P=0.48990947008132935
2024-10-22 17:01:45,399 - DEBUG - Simulating Node: ((Discard 4), (Discard 4)) | Value: 0.0
2024-10-22 17:01:45,399 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:45,399 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
B1 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 G3 B3}
2024-10-22 17:01:45,399 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:45,399 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:45,399 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:45,400 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.3939032554626465 | PUCT: 0.3939032554626465
2024-10-22 17:01:45,401 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.44744670391082764 | PUCT: 0.44744670391082764
2024-10-22 17:01:45,401 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.44744670391082764
2024-10-22 17:01:45,401 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:01:45,403 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Play 3))
2024-10-22 17:01:45,403 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Play 3))']
2024-10-22 17:01:45,404 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:45,405 - DEBUG - Move: (Play 3) | Reward: 5 | Depth: 2
2024-10-22 17:01:45,634 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:45,635 - DEBUG - Network Policy Logits: [[-0.01777344  0.02193441  0.00987537 -0.00720519  0.00478896  0.0240622
   0.05307484  0.00200714  0.02101899  0.0715335  -0.01494072 -0.00508322
  -0.04353108 -0.03769878  0.02619908 -0.03009153  0.00680217 -0.01283859
  -0.01544748 -0.0216911 ]]
2024-10-22 17:01:45,635 - DEBUG - Network Policy after Softmax: [[0.04901364 0.05099903 0.05038773 0.04953438 0.05013208 0.05110766
  0.05261215 0.04999282 0.05095236 0.05359232 0.04915269 0.0496396
  0.04776729 0.0480467  0.05121699 0.0484136  0.05023311 0.04925612
  0.04912778 0.048822  ]]
2024-10-22 17:01:45,637 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.25216582 0.25707301
  0.         0.         0.         0.         0.24723944 0.
  0.         0.         0.         0.2435218  0.         0.
  0.         0.        ]]
2024-10-22 17:01:45,639 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Play 3), (Reveal player +1 color R)) | P=0.24723944067955017
2024-10-22 17:01:45,639 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Play 3), (Discard 4)) | P=0.252165824174881
2024-10-22 17:01:45,640 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Play 3), (Reveal player +1 rank 1)) | P=0.2435217946767807
2024-10-22 17:01:45,641 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Play 3), (Play 0)) | P=0.2570730149745941
2024-10-22 17:01:45,641 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Play 3)) | Value: 0.0
2024-10-22 17:01:45,641 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:45,641 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB1345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
W4 || XX|RYGWB1245
R1 || XX|RYGWB12345
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5}
2024-10-22 17:01:45,641 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:45,641 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:45,641 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:45,642 - DEBUG - PUCT Calculation | Child: ((Discard 4),) | Q: 0.0 | U: 0.40323683619499207 | PUCT: 0.40323683619499207
2024-10-22 17:01:45,643 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.34353673458099365 | PUCT: 0.34353673458099365
2024-10-22 17:01:45,643 - DEBUG - Selected Child: ((Discard 4),) | PUCT: 0.40323683619499207
2024-10-22 17:01:45,643 - DEBUG - Selected child for exploration: ((Discard 4),)
2024-10-22 17:01:45,644 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.41570788621902466 | PUCT: 0.41570788621902466
2024-10-22 17:01:45,644 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Reveal player +1 color R)) | Q: 0.0 | U: 0.4111762046813965 | PUCT: 0.4111762046813965
2024-10-22 17:01:45,645 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Play 3)) | Q: 0.0 | U: 0.4173906743526459 | PUCT: 0.4173906743526459
2024-10-22 17:01:45,645 - DEBUG - PUCT Calculation | Child: ((Discard 4), (Discard 4)) | Q: 0.0 | U: 0.42893293499946594 | PUCT: 0.42893293499946594
2024-10-22 17:01:45,645 - DEBUG - Selected Child: ((Discard 4), (Discard 4)) | PUCT: 0.42893293499946594
2024-10-22 17:01:45,645 - DEBUG - Selected child for exploration: ((Discard 4), (Discard 4))
2024-10-22 17:01:45,645 - DEBUG - Expanding unexplored child: ((Discard 4), (Discard 4), (Discard 1))
2024-10-22 17:01:45,645 - DEBUG - Traversing Path: ['()', '((Discard 4),)', '((Discard 4), (Discard 4))', '((Discard 4), (Discard 4), (Discard 1))']
2024-10-22 17:01:45,646 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:45,647 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:45,648 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 3
2024-10-22 17:01:45,858 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:45,858 - DEBUG - Network Policy Logits: [[-0.01254185  0.01103345 -0.01083476 -0.03259056 -0.01090513  0.04884529
   0.02192251  0.04424947  0.01441734  0.03761172 -0.0206127  -0.02147969
  -0.03113016 -0.04489703  0.03044456 -0.03507272  0.05246667  0.03192284
   0.00110726 -0.02877916]]
2024-10-22 17:01:45,858 - DEBUG - Network Policy after Softmax: [[0.04924253 0.05041723 0.04932666 0.04826511 0.04932319 0.0523601
  0.05096922 0.05212001 0.05058812 0.05177519 0.0488467  0.04880437
  0.04833565 0.04767478 0.05140544 0.04814546 0.05255006 0.05148149
  0.04991926 0.04844942]]
2024-10-22 17:01:45,861 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24326664 0.         0.
  0.         0.         0.25497514 0.         0.         0.
  0.         0.         0.2590946  0.24266358 0.         0.
  0.         0.        ]]
2024-10-22 17:01:45,861 - DEBUG - Added Child Node: ((Discard 4), (Discard 4), (Discard 1), (Discard 3)) | P=0.24326664209365845
2024-10-22 17:01:45,862 - DEBUG - Added Child Node: ((Discard 4), (Discard 4), (Discard 1), (Play 3)) | P=0.2549751400947571
2024-10-22 17:01:45,863 - DEBUG - Added Child Node: ((Discard 4), (Discard 4), (Discard 1), (Reveal player +1 rank 1)) | P=0.24266357719898224
2024-10-22 17:01:45,863 - DEBUG - Added Child Node: ((Discard 4), (Discard 4), (Discard 1), (Reveal player +1 color B)) | P=0.25909459590911865
2024-10-22 17:01:45,863 - DEBUG - Simulating Node: ((Discard 4), (Discard 4), (Discard 1)) | Value: 0.0
2024-10-22 17:01:45,863 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:45,863 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 7, 'num_players': 2, 'deck_size': 3, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 7
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
W1 || XX|RYGWB12345
B4 || XX|RYGWB12345
Deck size: 3
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B1 W4 B5}
2024-10-22 17:01:45,863 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:45,864 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:45,864 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:45,864 - DEBUG - Best node chosen by MCTS: ((Discard 4),) | Visit Count: 6
2024-10-22 17:01:45,864 - INFO - Actual Game Score: 4
2024-10-22 17:01:45,864 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:45,864 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:45,865 - DEBUG - Policy Targets: [0.         0.         0.         0.         0.66666667 0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.33333333
 0.         0.        ]
2024-10-22 17:01:45,865 - DEBUG - === End of Training Data ===
2024-10-22 17:01:45,865 - INFO - Chosen Action: (Discard 4) | Visit Count: 6
2024-10-22 17:01:45,866 - DEBUG - Not the current player's turn.
2024-10-22 17:01:48,101 - INFO - Agent state has been reset.
2024-10-22 17:01:48,101 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:48,101 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
W4 || XX|RYGWB12345
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:48,101 - INFO - Max Rollouts: 10
2024-10-22 17:01:48,101 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:48,101 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:48,101 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:48,343 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:48,343 - DEBUG - Network Policy Logits: [[ 0.00738151  0.0068441   0.04664657 -0.02564062  0.01735677  0.0128031
   0.03834528  0.00662421 -0.00076141  0.02136419 -0.0534565  -0.02973253
  -0.0138933  -0.01559679  0.0469489  -0.0167623   0.01966652 -0.02034953
  -0.0161097  -0.01232933]]
2024-10-22 17:01:48,344 - DEBUG - Network Policy after Softmax: [[0.05030509 0.05027806 0.05231961 0.04867103 0.0508094  0.05057856
  0.05188709 0.050267   0.04989712 0.05101342 0.04733586 0.04847228
  0.04924616 0.04916234 0.05233543 0.04910507 0.0509269  0.04892924
  0.04913713 0.04932324]]
2024-10-22 17:01:48,346 - DEBUG - Normalized Policy: [[0.         0.33469456 0.         0.         0.         0.
  0.         0.         0.         0.3395898  0.         0.
  0.         0.         0.         0.         0.         0.32571563
  0.         0.        ]]
2024-10-22 17:01:48,346 - DEBUG - Dirichlet Noise Added: [0.         0.25102094 0.         0.         0.         0.
 0.         0.         0.         0.4659476  0.         0.
 0.         0.         0.         0.         0.         0.28303143
 0.         0.        ]
2024-10-22 17:01:48,347 - DEBUG - Added Child Node: ((Play 4),) | P=0.46594759821891785
2024-10-22 17:01:48,348 - DEBUG - Added Child Node: ((Discard 1),) | P=0.2510209381580353
2024-10-22 17:01:48,348 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.2830314338207245
2024-10-22 17:01:48,348 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:48,349 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:48,349 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 4, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
W4 || XX|RYGWB12345
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:48,349 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:48,349 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:48,349 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:48,350 - DEBUG - Expanding unexplored child: ((Play 4),)
2024-10-22 17:01:48,350 - DEBUG - Traversing Path: ['()', '((Play 4),)']
2024-10-22 17:01:48,350 - DEBUG - Move: (Play 4) | Reward: 4 | Depth: 1
2024-10-22 17:01:48,564 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:48,564 - DEBUG - Network Policy Logits: [[ 0.02493101  0.02780701  0.01657365 -0.01655342  0.0206564   0.03590608
   0.03860448  0.027542   -0.00691095  0.03289865 -0.00804336 -0.01583644
  -0.03189792 -0.02960359  0.03936694  0.00062056  0.05542058  0.02221149
  -0.01145531 -0.01430715]]
2024-10-22 17:01:48,564 - DEBUG - Network Policy after Softmax: [[0.05071615 0.05086222 0.05029406 0.04865526 0.05049982 0.05127583
  0.05141438 0.05084874 0.04912669 0.05112185 0.04907109 0.04869016
  0.04791437 0.04802443 0.05145359 0.04949808 0.05228628 0.05057842
  0.04890395 0.04876468]]
2024-10-22 17:01:48,566 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.25177127 0.
  0.         0.         0.24492538 0.         0.         0.
  0.         0.         0.25652638 0.246777   0.         0.
  0.         0.        ]]
2024-10-22 17:01:48,567 - DEBUG - Added Child Node: ((Play 4), (Play 3)) | P=0.2449253797531128
2024-10-22 17:01:48,567 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 rank 1)) | P=0.2467769980430603
2024-10-22 17:01:48,568 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 color B)) | P=0.256526380777359
2024-10-22 17:01:48,568 - DEBUG - Added Child Node: ((Play 4), (Discard 4)) | P=0.2517712712287903
2024-10-22 17:01:48,569 - DEBUG - Simulating Node: ((Play 4),) | Value: 0.0
2024-10-22 17:01:48,569 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:48,569 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4}
2024-10-22 17:01:48,569 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:48,569 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:48,569 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:48,569 - DEBUG - Expanding unexplored child: ((Discard 1),)
2024-10-22 17:01:48,569 - DEBUG - Traversing Path: ['()', '((Discard 1),)']
2024-10-22 17:01:48,570 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:01:48,766 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:48,766 - DEBUG - Network Policy Logits: [[ 0.01602029  0.00924294 -0.00389323 -0.02597206  0.00742527  0.0349659
   0.02666472  0.04757323 -0.00060481  0.03856445 -0.02028806 -0.01249771
  -0.0183136  -0.0171346   0.02836173 -0.02672072  0.06012935  0.03095437
   0.00397416 -0.03056372]]
2024-10-22 17:01:48,767 - DEBUG - Network Policy after Softmax: [[0.05041558 0.05007505 0.04942155 0.04834234 0.0499841  0.05137983
  0.05095509 0.0520317  0.04958434 0.05156506 0.0486179  0.04899813
  0.04871399 0.04877146 0.05104163 0.04830616 0.05268913 0.05117413
  0.04981191 0.04812088]]
2024-10-22 17:01:48,769 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.2512822  0.
  0.         0.         0.24927245 0.         0.         0.
  0.         0.         0.25659862 0.24284676 0.         0.
  0.         0.        ]]
2024-10-22 17:01:48,770 - DEBUG - Added Child Node: ((Discard 1), (Play 3)) | P=0.2492724508047104
2024-10-22 17:01:48,770 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1)) | P=0.2428467571735382
2024-10-22 17:01:48,771 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color B)) | P=0.2565986216068268
2024-10-22 17:01:48,771 - DEBUG - Added Child Node: ((Discard 1), (Discard 4)) | P=0.2512821853160858
2024-10-22 17:01:48,772 - DEBUG - Simulating Node: ((Discard 1),) | Value: 0.0
2024-10-22 17:01:48,772 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:48,772 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B1 || BX|B12345
B4 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B5}
2024-10-22 17:01:48,772 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:48,772 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:48,772 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:48,772 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:01:48,772 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:01:48,773 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:48,968 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:48,968 - DEBUG - Network Policy Logits: [[ 0.03643083  0.0056663   0.00552614  0.01283798  0.01910577  0.00227098
   0.02296555  0.01098802  0.00428135  0.01890658  0.00670306 -0.00024034
  -0.05349028 -0.01480117  0.06909355 -0.01799925  0.0260147   0.02096112
   0.00364259 -0.01060007]]
2024-10-22 17:01:48,968 - DEBUG - Network Policy after Softmax: [[0.05140657 0.04984915 0.04984216 0.05020793 0.05052361 0.04968018
  0.050719   0.05011513 0.04978015 0.05051355 0.04990085 0.04955557
  0.04698576 0.04883923 0.05311336 0.04868329 0.05087388 0.05061744
  0.04974836 0.04904484]]
2024-10-22 17:01:48,970 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.3391141  0.
  0.         0.         0.334124   0.         0.         0.
  0.         0.         0.         0.32676184 0.         0.
  0.         0.        ]]
2024-10-22 17:01:48,971 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Play 3)) | P=0.33412399888038635
2024-10-22 17:01:48,971 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1)) | P=0.3267618417739868
2024-10-22 17:01:48,972 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 4)) | P=0.33911409974098206
2024-10-22 17:01:48,972 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:01:48,972 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:48,972 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || G3|G3
XX || XX|RYGWB1245
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || BX|B12345
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:48,972 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:48,972 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:48,972 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:48,973 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 0.0 | U: 0.7388975024223328 | PUCT: 0.7388975024223328
2024-10-22 17:01:48,973 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.39806780219078064 | PUCT: 0.39806780219078064
2024-10-22 17:01:48,974 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.44882991909980774 | PUCT: 0.44882991909980774
2024-10-22 17:01:48,974 - DEBUG - Selected Child: ((Play 4),) | PUCT: 0.7388975024223328
2024-10-22 17:01:48,974 - DEBUG - Selected child for exploration: ((Play 4),)
2024-10-22 17:01:48,974 - DEBUG - Expanding unexplored child: ((Play 4), (Discard 4))
2024-10-22 17:01:48,974 - DEBUG - Traversing Path: ['()', '((Play 4),)', '((Play 4), (Discard 4))']
2024-10-22 17:01:48,975 - DEBUG - Move: (Play 4) | Reward: 5 | Depth: 1
2024-10-22 17:01:48,975 - DEBUG - Move: (Discard 4) | Reward: 5 | Depth: 2
2024-10-22 17:01:49,158 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:49,158 - DEBUG - Network Policy Logits: [[ 0.00056914  0.01730672  0.04162434 -0.04164449  0.00211316 -0.00303838
   0.05324475 -0.00085405  0.00528709  0.06287959 -0.04564941 -0.00097393
  -0.06221962 -0.04691025  0.0379441  -0.01927425  0.027335   -0.01975485
  -0.02194055 -0.02542436]]
2024-10-22 17:01:49,159 - DEBUG - Network Policy after Softmax: [[0.0500985  0.05094409 0.05219812 0.04802769 0.05017592 0.0499181
  0.05280822 0.05002726 0.05033543 0.05331948 0.04783572 0.05002126
  0.04704961 0.04777545 0.05200637 0.04911418 0.05145755 0.04909059
  0.0489834  0.04881305]]
2024-10-22 17:01:49,160 - DEBUG - Normalized Policy: [[0.         0.33879134 0.         0.         0.         0.
  0.         0.         0.33474356 0.         0.         0.
  0.         0.         0.         0.         0.         0.32646504
  0.         0.        ]]
2024-10-22 17:01:49,161 - DEBUG - Added Child Node: ((Play 4), (Discard 4), (Play 3)) | P=0.33474355936050415
2024-10-22 17:01:49,162 - DEBUG - Added Child Node: ((Play 4), (Discard 4), (Discard 1)) | P=0.3387913405895233
2024-10-22 17:01:49,162 - DEBUG - Added Child Node: ((Play 4), (Discard 4), (Reveal player +1 rank 3)) | P=0.32646504044532776
2024-10-22 17:01:49,162 - DEBUG - Simulating Node: ((Play 4), (Discard 4)) | Value: 0.0
2024-10-22 17:01:49,162 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:49,163 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 5, 'num_players': 2, 'deck_size': 3, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B1 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
B4 || XX|RYGWB12345
Deck size: 3
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 R1}
2024-10-22 17:01:49,163 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:49,163 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:49,163 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:49,163 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 0.0 | U: 0.5197513699531555 | PUCT: 0.5197513699531555
2024-10-22 17:01:49,164 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.42001014947891235 | PUCT: 0.42001014947891235
2024-10-22 17:01:49,164 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.47357040643692017 | PUCT: 0.47357040643692017
2024-10-22 17:01:49,164 - DEBUG - Selected Child: ((Play 4),) | PUCT: 0.5197513699531555
2024-10-22 17:01:49,164 - DEBUG - Selected child for exploration: ((Play 4),)
2024-10-22 17:01:49,165 - DEBUG - Expanding unexplored child: ((Play 4), (Reveal player +1 rank 1))
2024-10-22 17:01:49,165 - DEBUG - Traversing Path: ['()', '((Play 4),)', '((Play 4), (Reveal player +1 rank 1))']
2024-10-22 17:01:49,165 - DEBUG - Move: (Play 4) | Reward: 5 | Depth: 1
2024-10-22 17:01:49,166 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 2
2024-10-22 17:01:49,360 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:49,360 - DEBUG - Network Policy Logits: [[-0.00068413  0.00128034  0.03464775 -0.02313023  0.03148742 -0.01190213
   0.02205453  0.01219337  0.0184908   0.05435074 -0.04847332 -0.02893689
  -0.03226946 -0.03572129  0.05000158 -0.03151448  0.01147729 -0.01862538
  -0.02517626 -0.00061891]]
2024-10-22 17:01:49,361 - DEBUG - Network Policy after Softmax: [[0.04999729 0.05009561 0.05179537 0.04888755 0.05163194 0.04943956
  0.05114719 0.0506453  0.05096524 0.05282601 0.04766416 0.0486045
  0.04844279 0.04827586 0.05259676 0.04847938 0.05060904 0.04910828
  0.04878763 0.05000056]]
2024-10-22 17:01:49,363 - DEBUG - Normalized Policy: [[0.        0.3335946 0.        0.        0.        0.        0.
  0.        0.3393856 0.        0.        0.        0.        0.
  0.        0.        0.        0.3270198 0.        0.       ]]
2024-10-22 17:01:49,363 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 rank 1), (Play 3)) | P=0.33938559889793396
2024-10-22 17:01:49,364 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 rank 1), (Discard 1)) | P=0.33359459042549133
2024-10-22 17:01:49,365 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 rank 1), (Reveal player +1 rank 3)) | P=0.3270198106765747
2024-10-22 17:01:49,365 - DEBUG - Simulating Node: ((Play 4), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:49,365 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:49,365 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B1 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
W4 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:49,365 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:49,365 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:49,365 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:49,366 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 0.0 | U: 0.40623605251312256 | PUCT: 0.40623605251312256
2024-10-22 17:01:49,367 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.43770483136177063 | PUCT: 0.43770483136177063
2024-10-22 17:01:49,368 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.493521511554718 | PUCT: 0.493521511554718
2024-10-22 17:01:49,368 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.493521511554718
2024-10-22 17:01:49,368 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:01:49,368 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Reveal player +1 rank 1))
2024-10-22 17:01:49,368 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Reveal player +1 rank 1))']
2024-10-22 17:01:49,369 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:49,370 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 4 | Depth: 2
2024-10-22 17:01:49,556 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:49,556 - DEBUG - Network Policy Logits: [[ 0.00569886  0.0028063   0.02133135 -0.00781752  0.0305438  -0.01753399
   0.01531889  0.00562664  0.01528881  0.04360032 -0.04641716 -0.03260172
  -0.0402834  -0.00798421  0.02930467 -0.02838708  0.01654812 -0.02467341
  -0.01622773 -0.009332  ]]
2024-10-22 17:01:49,556 - DEBUG - Network Policy after Softmax: [[0.05038453 0.05023899 0.05117835 0.04970809 0.05165201 0.04922744
  0.05087156 0.05038089 0.05087003 0.05233082 0.04782593 0.04849126
  0.04812019 0.04969981 0.05158804 0.04869606 0.05093413 0.04887724
  0.04929179 0.04963286]]
2024-10-22 17:01:49,558 - DEBUG - Normalized Policy: [[0.         0.3308209  0.         0.         0.         0.
  0.         0.         0.         0.34459546 0.         0.
  0.         0.         0.         0.         0.         0.
  0.3245836  0.        ]]
2024-10-22 17:01:49,559 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1), (Play 4)) | P=0.34459546208381653
2024-10-22 17:01:49,559 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1), (Discard 1)) | P=0.33082088828086853
2024-10-22 17:01:49,560 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1), (Reveal player +1 rank 4)) | P=0.32458359003067017
2024-10-22 17:01:49,560 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:49,560 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:49,560 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 2, 'num_players': 2, 'deck_size': 5, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 2
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || G3|G3
W4 || XX|RYGWB1245
Deck size: 5
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:49,560 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:49,560 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:49,560 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:49,561 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 0.0 | U: 0.41994306445121765 | PUCT: 0.41994306445121765
2024-10-22 17:01:49,562 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.4524736702442169 | PUCT: 0.4524736702442169
2024-10-22 17:01:49,562 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.3401157855987549 | PUCT: 0.3401157855987549
2024-10-22 17:01:49,562 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.4524736702442169
2024-10-22 17:01:49,563 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:01:49,563 - DEBUG - Expanding unexplored child: ((Discard 1), (Discard 4))
2024-10-22 17:01:49,563 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Discard 4))']
2024-10-22 17:01:49,564 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:01:49,564 - DEBUG - Move: (Discard 4) | Reward: 4 | Depth: 2
2024-10-22 17:01:49,767 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:49,768 - DEBUG - Network Policy Logits: [[ 0.00823819  0.00256276  0.0263213  -0.03435102  0.02237861  0.01440358
   0.06837819  0.00930804 -0.00352718  0.04969716 -0.04336959 -0.01453981
  -0.05888373 -0.04227605  0.02569394 -0.01292535  0.0349456  -0.03691668
  -0.00382263 -0.01739576]]
2024-10-22 17:01:49,768 - DEBUG - Network Policy after Softmax: [[0.05040247 0.05011722 0.0513222  0.04830094 0.05112025 0.05071418
  0.05352668 0.05045642 0.04981294 0.05253603 0.04786729 0.04926738
  0.0471304  0.04791967 0.05129001 0.04934699 0.05176673 0.04817718
  0.04979823 0.04912688]]
2024-10-22 17:01:49,770 - DEBUG - Normalized Policy: [[0.         0.         0.         0.33017018 0.         0.
  0.         0.         0.34050575 0.         0.         0.
  0.         0.         0.         0.         0.         0.32932416
  0.         0.        ]]
2024-10-22 17:01:49,770 - DEBUG - Added Child Node: ((Discard 1), (Discard 4), (Discard 3)) | P=0.3301701843738556
2024-10-22 17:01:49,771 - DEBUG - Added Child Node: ((Discard 1), (Discard 4), (Play 3)) | P=0.3405057489871979
2024-10-22 17:01:49,771 - DEBUG - Added Child Node: ((Discard 1), (Discard 4), (Reveal player +1 rank 3)) | P=0.3293241560459137
2024-10-22 17:01:49,772 - DEBUG - Simulating Node: ((Discard 1), (Discard 4)) | Value: 0.0
2024-10-22 17:01:49,772 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:49,772 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 6, 'num_players': 2, 'deck_size': 3, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 4}, {'color': 'W', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || R2|R2
XX || B2|B2
XX || BX|B12345
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
W4 || XX|RYGWB12345
Deck size: 3
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B5 W1}
2024-10-22 17:01:49,772 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:49,772 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:49,772 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:49,773 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 0.0 | U: 0.43167242407798767 | PUCT: 0.43167242407798767
2024-10-22 17:01:49,773 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.31007441878318787 | PUCT: 0.31007441878318787
2024-10-22 17:01:49,773 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.3496154844760895 | PUCT: 0.3496154844760895
2024-10-22 17:01:49,774 - DEBUG - Selected Child: ((Play 4),) | PUCT: 0.43167242407798767
2024-10-22 17:01:49,774 - DEBUG - Selected child for exploration: ((Play 4),)
2024-10-22 17:01:49,774 - DEBUG - Expanding unexplored child: ((Play 4), (Reveal player +1 color B))
2024-10-22 17:01:49,774 - DEBUG - Traversing Path: ['()', '((Play 4),)', '((Play 4), (Reveal player +1 color B))']
2024-10-22 17:01:49,774 - DEBUG - Move: (Play 4) | Reward: 5 | Depth: 1
2024-10-22 17:01:49,775 - DEBUG - Move: (Reveal player +1 color B) | Reward: 5 | Depth: 2
2024-10-22 17:01:49,959 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:49,959 - DEBUG - Network Policy Logits: [[-2.7257428e-03  8.1675947e-03  3.2538876e-02 -2.7222402e-02
   2.1124478e-02 -9.1181695e-03  3.0409355e-02  9.9990750e-05
   5.8710664e-03  4.4596490e-02 -4.3432381e-02 -3.2620855e-02
  -3.6591306e-02 -2.6224073e-02  3.9910808e-02 -3.2634683e-02
   1.3264078e-02 -1.2531024e-02 -1.8193804e-02 -2.9458236e-03]]
2024-10-22 17:01:49,959 - DEBUG - Network Policy after Softmax: [[0.04996741 0.05051469 0.05176093 0.04875825 0.05117347 0.04964902
  0.05165081 0.0501088  0.05039882 0.05238882 0.04797425 0.04849573
  0.04830357 0.04880694 0.05214391 0.04849507 0.0507728  0.04947986
  0.04920045 0.04995641]]
2024-10-22 17:01:49,961 - DEBUG - Normalized Policy: [[0.         0.3358838  0.         0.         0.         0.
  0.         0.         0.3351133  0.         0.         0.
  0.         0.         0.         0.         0.         0.32900292
  0.         0.        ]]
2024-10-22 17:01:49,962 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 color B), (Play 3)) | P=0.3351132869720459
2024-10-22 17:01:49,962 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 color B), (Discard 1)) | P=0.3358837962150574
2024-10-22 17:01:49,963 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 color B), (Reveal player +1 rank 3)) | P=0.32900291681289673
2024-10-22 17:01:49,963 - DEBUG - Simulating Node: ((Play 4), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:49,963 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:49,963 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 3}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G2 W0 B1 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
W4 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:49,963 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:49,963 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:49,963 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:49,964 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 0.0 | U: 0.3535207509994507 | PUCT: 0.3535207509994507
2024-10-22 17:01:49,964 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.31742164492607117 | PUCT: 0.31742164492607117
2024-10-22 17:01:49,965 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.35789963603019714 | PUCT: 0.35789963603019714
2024-10-22 17:01:49,965 - DEBUG - Selected Child: ((Reveal player +1 rank 3),) | PUCT: 0.35789963603019714
2024-10-22 17:01:49,965 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 3),)
2024-10-22 17:01:49,965 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3), (Play 3))
2024-10-22 17:01:49,965 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)', '((Reveal player +1 rank 3), (Play 3))']
2024-10-22 17:01:49,966 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:49,966 - DEBUG - Move: (Play 3) | Reward: 5 | Depth: 2
2024-10-22 17:01:50,163 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:50,163 - DEBUG - Network Policy Logits: [[-0.02559093  0.01084967  0.01745094  0.00756975 -0.00264303  0.00585127
   0.02573968  0.001153    0.01362158  0.07264374 -0.01978059 -0.02227266
  -0.04949898 -0.02519196  0.01648756 -0.035187    0.00505775 -0.00746372
  -0.00930774 -0.00473451]]
2024-10-22 17:01:50,163 - DEBUG - Network Policy after Softmax: [[0.04878236 0.0505928  0.05092788 0.05042714 0.04991476 0.05034055
  0.05135177 0.0501046  0.05073324 0.05381776 0.04906663 0.0489445
  0.0476299  0.04880183 0.05087885 0.04831648 0.05030062 0.04967471
  0.0495832  0.04981047]]
2024-10-22 17:01:50,165 - DEBUG - Normalized Policy: [[0.         0.25545254 0.         0.         0.         0.25417888
  0.         0.         0.         0.         0.         0.
  0.         0.2464096  0.         0.24395896 0.         0.
  0.         0.        ]]
2024-10-22 17:01:50,166 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Play 3), (Reveal player +1 color W)) | P=0.2464095950126648
2024-10-22 17:01:50,166 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Play 3), (Discard 1)) | P=0.25545254349708557
2024-10-22 17:01:50,167 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Play 3), (Reveal player +1 rank 1)) | P=0.2439589649438858
2024-10-22 17:01:50,167 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Play 3), (Play 0)) | P=0.25417888164520264
2024-10-22 17:01:50,168 - DEBUG - Simulating Node: ((Reveal player +1 rank 3), (Play 3)) | Value: 0.0
2024-10-22 17:01:50,168 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:50,168 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 2, 'information_tokens': 3, 'num_players': 2, 'deck_size': 4, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 2
Info tokens: 3
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
W4 || XX|RYGWB1245
W1 || XX|RYGWB12345
Deck size: 4
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3}
2024-10-22 17:01:50,168 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:50,168 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:50,168 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:50,168 - DEBUG - Best node chosen by MCTS: ((Play 4),) | Visit Count: 4
2024-10-22 17:01:50,168 - INFO - Actual Game Score: 5
2024-10-22 17:01:50,168 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:50,168 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:50,169 - DEBUG - Policy Targets: [0.         0.22222222 0.         0.         0.         0.
 0.         0.         0.         0.44444444 0.         0.
 0.         0.         0.         0.         0.         0.33333333
 0.         0.        ]
2024-10-22 17:01:50,169 - DEBUG - === End of Training Data ===
2024-10-22 17:01:50,169 - INFO - Chosen Action: (Play 4) | Visit Count: 4
2024-10-22 17:01:50,169 - DEBUG - Not the current player's turn.
2024-10-22 17:01:52,204 - INFO - Agent state has been reset.
2024-10-22 17:01:52,205 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:52,205 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 3, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
R1 || XX|RYGWB12345
Deck size: 3
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:52,205 - INFO - Max Rollouts: 10
2024-10-22 17:01:52,205 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:52,205 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:52,205 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:52,419 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:52,419 - DEBUG - Network Policy Logits: [[-0.00031907  0.01569565  0.0453844  -0.02734736  0.01739683  0.00344008
   0.06133194  0.00419619  0.01474735  0.04608994 -0.03379463  0.0074005
  -0.04339077 -0.04703519  0.03717443 -0.0133406   0.03825924 -0.01522698
  -0.01210856 -0.01930799]]
2024-10-22 17:01:52,419 - DEBUG - Network Policy after Softmax: [[0.04976366 0.05056703 0.05209081 0.04843665 0.05065313 0.04995108
  0.05292819 0.04998886 0.0505191  0.05212757 0.04812537 0.0501493
  0.04766576 0.04749236 0.05166489 0.04911986 0.05172097 0.04902729
  0.04918042 0.04882762]]
2024-10-22 17:01:52,421 - DEBUG - Normalized Policy: [[0.         0.25302836 0.         0.         0.         0.
  0.         0.         0.         0.26083705 0.24081074 0.
  0.         0.         0.         0.         0.         0.24532379
  0.         0.        ]]
2024-10-22 17:01:52,421 - DEBUG - Dirichlet Noise Added: [0.         0.19044061 0.         0.         0.         0.
 0.         0.         0.         0.43995216 0.18060806 0.
 0.         0.         0.         0.         0.         0.18899918
 0.         0.        ]
2024-10-22 17:01:52,422 - DEBUG - Added Child Node: ((Reveal player +1 color R),) | P=0.18060806393623352
2024-10-22 17:01:52,422 - DEBUG - Added Child Node: ((Play 4),) | P=0.43995216488838196
2024-10-22 17:01:52,423 - DEBUG - Added Child Node: ((Discard 1),) | P=0.1904406100511551
2024-10-22 17:01:52,424 - DEBUG - Added Child Node: ((Reveal player +1 rank 3),) | P=0.18899917602539062
2024-10-22 17:01:52,424 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:52,424 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:52,424 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 3, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
R1 || XX|RYGWB12345
Deck size: 3
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:52,424 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:52,424 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:52,424 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:52,424 - DEBUG - Expanding unexplored child: ((Play 4),)
2024-10-22 17:01:52,424 - DEBUG - Traversing Path: ['()', '((Play 4),)']
2024-10-22 17:01:52,425 - DEBUG - Move: (Play 4) | Reward: 5 | Depth: 1
2024-10-22 17:01:52,622 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:52,622 - DEBUG - Network Policy Logits: [[ 0.02247129  0.02421736  0.0194523  -0.02012017  0.01520496  0.02027723
   0.03422955  0.03165257 -0.01175793  0.03007918 -0.01038533 -0.02395259
  -0.03387962 -0.02825326  0.04190141 -0.00193223  0.05850563  0.01348883
  -0.00053283 -0.01998588]]
2024-10-22 17:01:52,622 - DEBUG - Network Policy after Softmax: [[0.05071083 0.05079945 0.05055796 0.04859633 0.05034368 0.05059968
  0.05131062 0.05117856 0.04900441 0.0510981  0.04907171 0.04841044
  0.04793225 0.04820269 0.05170578 0.04948828 0.05257148 0.05025736
  0.04955759 0.04860285]]
2024-10-22 17:01:52,624 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.25550103 0.
  0.         0.         0.24870403 0.         0.         0.
  0.         0.24463521 0.         0.25115976 0.         0.
  0.         0.        ]]
2024-10-22 17:01:52,625 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 color W)) | P=0.244635209441185
2024-10-22 17:01:52,626 - DEBUG - Added Child Node: ((Play 4), (Play 3)) | P=0.24870403110980988
2024-10-22 17:01:52,626 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 rank 1)) | P=0.25115975737571716
2024-10-22 17:01:52,627 - DEBUG - Added Child Node: ((Play 4), (Discard 4)) | P=0.25550103187561035
2024-10-22 17:01:52,627 - DEBUG - Simulating Node: ((Play 4),) | Value: 0.0
2024-10-22 17:01:52,627 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:52,628 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 2, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G2 W0 B1 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
W1 || XX|RYGWB12345
Deck size: 2
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:52,628 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:52,628 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:52,628 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:52,628 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R),)
2024-10-22 17:01:52,629 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)']
2024-10-22 17:01:52,629 - DEBUG - Move: (Reveal player +1 color R) | Reward: 4 | Depth: 1
2024-10-22 17:01:52,841 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:52,841 - DEBUG - Network Policy Logits: [[ 0.02497889  0.02115227  0.01680824  0.00158103  0.03138576  0.01625795
   0.02037886  0.01901371  0.0037148   0.03053786 -0.00661755 -0.03051144
  -0.02351305 -0.03022988  0.02218096  0.00961185  0.04784907  0.03412487
  -0.01336447  0.02167604]]
2024-10-22 17:01:52,842 - DEBUG - Network Policy after Softmax: [[0.05069993 0.05050629 0.05028736 0.04952743 0.0510258  0.0502597
  0.05046724 0.05039839 0.04963322 0.05098255 0.04912303 0.04796321
  0.04830005 0.04797671 0.05055827 0.04992678 0.0518728  0.05116576
  0.04879272 0.05053275]]
2024-10-22 17:01:52,843 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24807662 0.         0.
  0.         0.         0.24860653 0.         0.         0.
  0.         0.         0.25323996 0.2500769  0.         0.
  0.         0.        ]]
2024-10-22 17:01:52,844 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 3)) | P=0.24807661771774292
2024-10-22 17:01:52,845 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Play 3)) | P=0.24860653281211853
2024-10-22 17:01:52,845 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1)) | P=0.25007688999176025
2024-10-22 17:01:52,846 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color B)) | P=0.2532399594783783
2024-10-22 17:01:52,846 - DEBUG - Simulating Node: ((Reveal player +1 color R),) | Value: 0.0
2024-10-22 17:01:52,846 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:52,846 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 3, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': 'R', 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || RX|R12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
Deck size: 3
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:52,846 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:52,846 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:52,846 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:52,847 - DEBUG - Expanding unexplored child: ((Discard 1),)
2024-10-22 17:01:52,847 - DEBUG - Traversing Path: ['()', '((Discard 1),)']
2024-10-22 17:01:52,848 - DEBUG - Move: (Discard 1) | Reward: 4 | Depth: 1
2024-10-22 17:01:53,053 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:53,053 - DEBUG - Network Policy Logits: [[-0.02337258  0.00808359 -0.00792235 -0.02152734 -0.00783705  0.04537595
   0.01004512  0.03899133 -0.00343945  0.05144421 -0.01969945 -0.01182155
  -0.04202593 -0.0361075   0.0318528  -0.02387968  0.05680485  0.02665111
   0.00447038 -0.03044642]]
2024-10-22 17:01:53,054 - DEBUG - Network Policy after Softmax: [[0.04871219 0.05026884 0.04947064 0.04880215 0.04947486 0.05217887
  0.05036754 0.05184679 0.04969291 0.05249647 0.04889144 0.04927812
  0.04781196 0.04809577 0.051478   0.04868749 0.05277864 0.05121092
  0.05008753 0.04836882]]
2024-10-22 17:01:53,055 - DEBUG - Normalized Policy: [[0.         0.         0.         0.         0.24963266 0.
  0.         0.         0.25073287 0.         0.         0.
  0.24124226 0.         0.         0.         0.         0.2583922
  0.         0.        ]]
2024-10-22 17:01:53,056 - DEBUG - Added Child Node: ((Discard 1), (Play 3)) | P=0.2507328689098358
2024-10-22 17:01:53,057 - DEBUG - Added Child Node: ((Discard 1), (Discard 4)) | P=0.24963265657424927
2024-10-22 17:01:53,058 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 3)) | P=0.25839221477508545
2024-10-22 17:01:53,059 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color G)) | P=0.24124225974082947
2024-10-22 17:01:53,059 - DEBUG - Simulating Node: ((Discard 1),) | Value: 0.0
2024-10-22 17:01:53,059 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:53,059 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 6, 'num_players': 2, 'deck_size': 2, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'G', 'rank': 2}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || GX|G12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
G3 || XX|RYGWB12345
W1 || XX|RYGWB12345
Deck size: 2
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 B5}
2024-10-22 17:01:53,059 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:53,059 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:53,059 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:53,059 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 3),)
2024-10-22 17:01:53,060 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 3),)']
2024-10-22 17:01:53,060 - DEBUG - Move: (Reveal player +1 rank 3) | Reward: 4 | Depth: 1
2024-10-22 17:01:53,265 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:53,265 - DEBUG - Network Policy Logits: [[ 0.02116555  0.01783623  0.02070428 -0.00442958  0.02981118  0.02545105
   0.03798971  0.02166712 -0.00558472  0.0290802  -0.00572098 -0.01363758
  -0.05581015 -0.02612529  0.05370269 -0.00418831  0.05499988  0.01553857
   0.00858123 -0.00662525]]
2024-10-22 17:01:53,266 - DEBUG - Network Policy after Softmax: [[0.05050797 0.05034009 0.05048468 0.04923161 0.05094654 0.05072489
  0.05136492 0.05053331 0.04917478 0.05090931 0.04916808 0.04878037
  0.04676595 0.048175   0.05217838 0.04924349 0.05224611 0.05022456
  0.04987635 0.04912364]]
2024-10-22 17:01:53,267 - DEBUG - Normalized Policy: [[0.         0.         0.         0.24636963 0.         0.
  0.         0.         0.2460852  0.         0.         0.
  0.         0.         0.26111612 0.24642907 0.         0.
  0.         0.        ]]
2024-10-22 17:01:53,268 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Discard 3)) | P=0.2463696300983429
2024-10-22 17:01:53,269 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Play 3)) | P=0.24608519673347473
2024-10-22 17:01:53,270 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 rank 1)) | P=0.24642907083034515
2024-10-22 17:01:53,270 - DEBUG - Added Child Node: ((Reveal player +1 rank 3), (Reveal player +1 color B)) | P=0.2611161172389984
2024-10-22 17:01:53,270 - DEBUG - Simulating Node: ((Reveal player +1 rank 3),) | Value: 0.0
2024-10-22 17:01:53,271 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:53,271 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 3, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G2 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || G3|G3
XX || XX|RYGWB1245
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
Deck size: 3
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:53,271 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:53,271 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:53,271 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:53,272 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 0.0 | U: 0.7361313700675964 | PUCT: 0.7361313700675964
2024-10-22 17:01:53,272 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.3021948039531708 | PUCT: 0.3021948039531708
2024-10-22 17:01:53,273 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.31864669919013977 | PUCT: 0.31864669919013977
2024-10-22 17:01:53,273 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.31623488664627075 | PUCT: 0.31623488664627075
2024-10-22 17:01:53,273 - DEBUG - Selected Child: ((Play 4),) | PUCT: 0.7361313700675964
2024-10-22 17:01:53,273 - DEBUG - Selected child for exploration: ((Play 4),)
2024-10-22 17:01:53,273 - DEBUG - Expanding unexplored child: ((Play 4), (Discard 4))
2024-10-22 17:01:53,273 - DEBUG - Traversing Path: ['()', '((Play 4),)', '((Play 4), (Discard 4))']
2024-10-22 17:01:53,274 - DEBUG - Move: (Play 4) | Reward: 5 | Depth: 1
2024-10-22 17:01:53,275 - DEBUG - Move: (Discard 4) | Reward: 5 | Depth: 2
2024-10-22 17:01:53,486 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:53,487 - DEBUG - Network Policy Logits: [[-0.00803287  0.02724264  0.04731799 -0.03720694  0.01083765  0.00460932
   0.04889587  0.00583975 -0.00620099  0.04642859 -0.03986396 -0.00286066
  -0.06040825 -0.05271379  0.03294812 -0.01529707  0.03362286 -0.02457648
  -0.01549614 -0.02230285]]
2024-10-22 17:01:53,487 - DEBUG - Network Policy after Softmax: [[0.04964149 0.05142387 0.05246666 0.04821417 0.05058715 0.05027305
  0.05254951 0.05033495 0.04973251 0.05242001 0.04808623 0.04989891
  0.04710841 0.04747229 0.05171811 0.04928219 0.05175301 0.048827
  0.04927238 0.04893814]]
2024-10-22 17:01:53,489 - DEBUG - Normalized Policy: [[0.         0.25962526 0.         0.         0.         0.
  0.         0.         0.25108603 0.         0.2427744  0.
  0.         0.         0.         0.         0.         0.24651434
  0.         0.        ]]
2024-10-22 17:01:53,489 - DEBUG - Added Child Node: ((Play 4), (Discard 4), (Reveal player +1 color R)) | P=0.24277439713478088
2024-10-22 17:01:53,490 - DEBUG - Added Child Node: ((Play 4), (Discard 4), (Play 3)) | P=0.25108602643013
2024-10-22 17:01:53,491 - DEBUG - Added Child Node: ((Play 4), (Discard 4), (Discard 1)) | P=0.25962525606155396
2024-10-22 17:01:53,491 - DEBUG - Added Child Node: ((Play 4), (Discard 4), (Reveal player +1 rank 3)) | P=0.24651433527469635
2024-10-22 17:01:53,491 - DEBUG - Simulating Node: ((Play 4), (Discard 4)) | Value: 0.0
2024-10-22 17:01:53,491 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:53,492 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 6, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 2, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'B', 'rank': 0}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 6
Fireworks: R0 Y2 G2 W0 B1 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
R1 || XX|RYGWB12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 B1}
2024-10-22 17:01:53,492 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:53,492 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:53,492 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:53,492 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 0.0 | U: 0.5114293098449707 | PUCT: 0.5114293098449707
2024-10-22 17:01:53,493 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.31492599844932556 | PUCT: 0.31492599844932556
2024-10-22 17:01:53,493 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3320710062980652 | PUCT: 0.3320710062980652
2024-10-22 17:01:53,494 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.3295575976371765 | PUCT: 0.3295575976371765
2024-10-22 17:01:53,494 - DEBUG - Selected Child: ((Play 4),) | PUCT: 0.5114293098449707
2024-10-22 17:01:53,494 - DEBUG - Selected child for exploration: ((Play 4),)
2024-10-22 17:01:53,494 - DEBUG - Expanding unexplored child: ((Play 4), (Reveal player +1 rank 1))
2024-10-22 17:01:53,494 - DEBUG - Traversing Path: ['()', '((Play 4),)', '((Play 4), (Reveal player +1 rank 1))']
2024-10-22 17:01:53,495 - DEBUG - Move: (Play 4) | Reward: 5 | Depth: 1
2024-10-22 17:01:53,495 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 2
2024-10-22 17:01:53,702 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:53,703 - DEBUG - Network Policy Logits: [[-0.00987809  0.02105229  0.03900545 -0.00918288  0.03363872 -0.00410477
   0.02140885 -0.00079531  0.00238579  0.05486171 -0.03827907 -0.01401758
  -0.03992274 -0.0323339   0.03493623 -0.02108661  0.01510798 -0.0203256
  -0.02033557  0.00066396]]
2024-10-22 17:01:53,703 - DEBUG - Network Policy after Softmax: [[0.04945976 0.05101348 0.0519376  0.04949416 0.05165961 0.04974614
  0.05103167 0.04991104 0.05007007 0.0527677  0.04807482 0.04925545
  0.04799587 0.04836148 0.05172668 0.04890849 0.05071114 0.04894572
  0.04894524 0.04998393]]
2024-10-22 17:01:53,705 - DEBUG - Normalized Policy: [[0.         0.20679295 0.         0.         0.         0.20165557
  0.         0.         0.         0.         0.19488053 0.
  0.         0.         0.         0.19825998 0.         0.19841091
  0.         0.        ]]
2024-10-22 17:01:53,706 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.19825997948646545
2024-10-22 17:01:53,706 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 rank 1), (Play 0)) | P=0.2016555666923523
2024-10-22 17:01:53,707 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 rank 1), (Reveal player +1 rank 3)) | P=0.19841091334819794
2024-10-22 17:01:53,707 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 rank 1), (Reveal player +1 color R)) | P=0.19488053023815155
2024-10-22 17:01:53,708 - DEBUG - Added Child Node: ((Play 4), (Reveal player +1 rank 1), (Discard 1)) | P=0.206792950630188
2024-10-22 17:01:53,708 - DEBUG - Simulating Node: ((Play 4), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:53,708 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:53,708 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 2, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'G', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
G3 || GX|G12345
R1 || XX|RYGWB12345
Deck size: 2
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:53,708 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:53,708 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:53,709 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:53,709 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 0.0 | U: 0.39651429653167725 | PUCT: 0.39651429653167725
2024-10-22 17:01:53,710 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.3255520761013031 | PUCT: 0.3255520761013031
2024-10-22 17:01:53,710 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3432755768299103 | PUCT: 0.3432755768299103
2024-10-22 17:01:53,711 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.3406773507595062 | PUCT: 0.3406773507595062
2024-10-22 17:01:53,711 - DEBUG - Selected Child: ((Play 4),) | PUCT: 0.39651429653167725
2024-10-22 17:01:53,711 - DEBUG - Selected child for exploration: ((Play 4),)
2024-10-22 17:01:53,711 - DEBUG - Expanding unexplored child: ((Play 4), (Reveal player +1 color W))
2024-10-22 17:01:53,711 - DEBUG - Traversing Path: ['()', '((Play 4),)', '((Play 4), (Reveal player +1 color W))']
2024-10-22 17:01:53,712 - DEBUG - Move: (Play 4) | Reward: 5 | Depth: 1
2024-10-22 17:01:53,712 - DEBUG - Illegal move encountered: (Reveal player +1 color W)
2024-10-22 17:01:53,712 - DEBUG - Backpropagating reward: 5
2024-10-22 17:01:53,712 - DEBUG - Rollout #8 completed with reward=5
2024-10-22 17:01:53,712 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:53,713 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 1.25 | U: 0.3260714113712311 | PUCT: 1.5760713815689087
2024-10-22 17:01:53,713 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.33464503288269043 | PUCT: 0.33464503288269043
2024-10-22 17:01:53,714 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3528635501861572 | PUCT: 0.3528635501861572
2024-10-22 17:01:53,714 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.35019275546073914 | PUCT: 0.35019275546073914
2024-10-22 17:01:53,714 - DEBUG - Selected Child: ((Play 4),) | PUCT: 1.5760713815689087
2024-10-22 17:01:53,715 - DEBUG - Selected child for exploration: ((Play 4),)
2024-10-22 17:01:53,715 - DEBUG - Expanding unexplored child: ((Play 4), (Play 3))
2024-10-22 17:01:53,715 - DEBUG - Traversing Path: ['()', '((Play 4),)', '((Play 4), (Play 3))']
2024-10-22 17:01:53,715 - DEBUG - Move: (Play 4) | Reward: 5 | Depth: 1
2024-10-22 17:01:53,716 - DEBUG - Move: (Play 3) | Reward: 6 | Depth: 2
2024-10-22 17:01:53,923 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:53,923 - DEBUG - Network Policy Logits: [[-0.0368213   0.02888605  0.02552938 -0.02060498 -0.01210163  0.01512669
   0.04126227 -0.00667132  0.00123899  0.05915529  0.00019168 -0.00258888
  -0.07912306 -0.04314895  0.03155099 -0.02940875  0.01683464 -0.03415839
   0.00225617 -0.02186503]]
2024-10-22 17:01:53,923 - DEBUG - Network Policy after Softmax: [[0.04832316 0.05160498 0.05143205 0.04911317 0.04953258 0.0508998
  0.05224763 0.04980228 0.0501978  0.05319091 0.05014526 0.05000602
  0.04632163 0.04801835 0.0517427  0.04868269 0.0509868  0.04845201
  0.05024888 0.04905132]]
2024-10-22 17:01:53,925 - DEBUG - Normalized Policy: [[0.         0.25631693 0.         0.         0.         0.25281432
  0.         0.         0.         0.         0.2490666  0.
  0.         0.         0.         0.24180217 0.         0.
  0.         0.        ]]
2024-10-22 17:01:53,926 - DEBUG - Added Child Node: ((Play 4), (Play 3), (Reveal player +1 color R)) | P=0.24906660616397858
2024-10-22 17:01:53,927 - DEBUG - Added Child Node: ((Play 4), (Play 3), (Discard 1)) | P=0.2563169300556183
2024-10-22 17:01:53,928 - DEBUG - Added Child Node: ((Play 4), (Play 3), (Reveal player +1 rank 1)) | P=0.2418021708726883
2024-10-22 17:01:53,928 - DEBUG - Added Child Node: ((Play 4), (Play 3), (Play 0)) | P=0.25281432271003723
2024-10-22 17:01:53,928 - DEBUG - Simulating Node: ((Play 4), (Play 3)) | Value: 0.0
2024-10-22 17:01:53,928 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:53,929 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 2}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G3 W0 B1 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || XX|RYGWB12345
G3 || XX|RYGWB12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4}
2024-10-22 17:01:53,929 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:53,929 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:53,929 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:53,929 - DEBUG - PUCT Calculation | Child: ((Play 4),) | Q: 1.0 | U: 0.27816471457481384 | PUCT: 1.2781647443771362
2024-10-22 17:01:53,930 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.34257444739341736 | PUCT: 0.34257444739341736
2024-10-22 17:01:53,930 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3612246811389923 | PUCT: 0.3612246811389923
2024-10-22 17:01:53,931 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 3),) | Q: 0.0 | U: 0.35849058628082275 | PUCT: 0.35849058628082275
2024-10-22 17:01:53,931 - DEBUG - Selected Child: ((Play 4),) | PUCT: 1.2781647443771362
2024-10-22 17:01:53,931 - DEBUG - Selected child for exploration: ((Play 4),)
2024-10-22 17:01:53,931 - DEBUG - PUCT Calculation | Child: ((Play 4), (Discard 4)) | Q: 0.0 | U: 0.42750629782676697 | PUCT: 0.42750629782676697
2024-10-22 17:01:53,932 - DEBUG - PUCT Calculation | Child: ((Play 4), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.42024245858192444 | PUCT: 0.42024245858192444
2024-10-22 17:01:53,933 - DEBUG - PUCT Calculation | Child: ((Play 4), (Reveal player +1 color W)) | Q: 5.0 | U: 0.409325510263443 | PUCT: 5.40932559967041
2024-10-22 17:01:53,933 - DEBUG - PUCT Calculation | Child: ((Play 4), (Play 3)) | Q: 0.0 | U: 0.41613349318504333 | PUCT: 0.41613349318504333
2024-10-22 17:01:53,933 - DEBUG - Selected Child: ((Play 4), (Reveal player +1 color W)) | PUCT: 5.40932559967041
2024-10-22 17:01:53,933 - DEBUG - Selected child for exploration: ((Play 4), (Reveal player +1 color W))
2024-10-22 17:01:53,933 - DEBUG - Node ((Play 4), (Reveal player +1 color W)) is a leaf node.
2024-10-22 17:01:53,933 - DEBUG - Traversing Path: ['()', '((Play 4),)', '((Play 4), (Reveal player +1 color W))']
2024-10-22 17:01:53,934 - DEBUG - Move: (Play 4) | Reward: 5 | Depth: 1
2024-10-22 17:01:53,934 - DEBUG - Illegal move encountered: (Reveal player +1 color W)
2024-10-22 17:01:53,934 - DEBUG - Backpropagating reward: 5
2024-10-22 17:01:53,934 - DEBUG - Rollout #10 completed with reward=5
2024-10-22 17:01:53,934 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:53,935 - DEBUG - Best node chosen by MCTS: ((Play 4),) | Visit Count: 6
2024-10-22 17:01:53,935 - INFO - Actual Game Score: 5
2024-10-22 17:01:53,935 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:53,935 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:53,935 - DEBUG - Policy Targets: [0.         0.11111111 0.         0.         0.         0.
 0.         0.         0.         0.66666667 0.11111111 0.
 0.         0.         0.         0.         0.         0.11111111
 0.         0.        ]
2024-10-22 17:01:53,935 - DEBUG - === End of Training Data ===
2024-10-22 17:01:53,935 - INFO - Chosen Action: (Play 4) | Visit Count: 6
2024-10-22 17:01:53,937 - DEBUG - Not the current player's turn.
2024-10-22 17:01:56,170 - INFO - Agent state has been reset.
2024-10-22 17:01:56,170 - INFO - === Starting MCTS Search ===
2024-10-22 17:01:56,170 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 6, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 6
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || XX|RYGWB12345
W1 || XX|RYGWB12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:56,170 - INFO - Max Rollouts: 10
2024-10-22 17:01:56,170 - DEBUG - --- Rollout #1 ---
2024-10-22 17:01:56,170 - DEBUG - Node () is a leaf node.
2024-10-22 17:01:56,170 - DEBUG - Traversing Path: ['()']
2024-10-22 17:01:56,384 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:56,385 - DEBUG - Network Policy Logits: [[-0.03518498  0.02504746  0.02781561 -0.01577582 -0.011807    0.00643063
   0.04586548 -0.00125171  0.00882797  0.06273264  0.00886508  0.01708867
  -0.06530479 -0.03839458  0.02124401 -0.02494528  0.02394709 -0.03783787
  -0.00128189 -0.03099376]]
2024-10-22 17:01:56,385 - DEBUG - Network Policy after Softmax: [[0.04828402 0.05128166 0.05142381 0.04923033 0.0494261  0.05033579
  0.05236043 0.04995057 0.05045661 0.05325109 0.05045848 0.05087514
  0.0468514  0.0481293  0.05108698 0.04878098 0.05122526 0.0481561
  0.04994906 0.04848682]]
2024-10-22 17:01:56,386 - DEBUG - Normalized Policy: [[0.         0.2553144  0.         0.         0.         0.25060523
  0.         0.         0.         0.         0.25121605 0.
  0.         0.         0.         0.24286434 0.         0.
  0.         0.        ]]
2024-10-22 17:01:56,387 - DEBUG - Dirichlet Noise Added: [0.         0.1914858  0.         0.         0.         0.18795392
 0.         0.         0.         0.         0.18841204 0.
 0.         0.         0.         0.43214825 0.         0.
 0.         0.        ]
2024-10-22 17:01:56,421 - DEBUG - Added Child Node: ((Reveal player +1 color R),) | P=0.18841204047203064
2024-10-22 17:01:56,422 - DEBUG - Added Child Node: ((Discard 1),) | P=0.19148580729961395
2024-10-22 17:01:56,422 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.4321482479572296
2024-10-22 17:01:56,423 - DEBUG - Added Child Node: ((Play 0),) | P=0.187953919172287
2024-10-22 17:01:56,424 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:01:56,424 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:56,424 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 6, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 6
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || XX|RYGWB12345
W1 || XX|RYGWB12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:56,424 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:56,424 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:01:56,424 - DEBUG - --- Rollout #2 ---
2024-10-22 17:01:56,425 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R),)
2024-10-22 17:01:56,425 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)']
2024-10-22 17:01:56,426 - DEBUG - Move: (Reveal player +1 color R) | Reward: 5 | Depth: 1
2024-10-22 17:01:56,648 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:56,648 - DEBUG - Network Policy Logits: [[-0.00940825  0.03243706  0.03176533 -0.01126678  0.02066774  0.03126702
   0.04047525  0.03811418 -0.01305794  0.02891087  0.01528666 -0.02174706
  -0.05035524  0.00035804  0.06672711 -0.01977162  0.05108154  0.00958706
  -0.01315672 -0.01669523]]
2024-10-22 17:01:56,648 - DEBUG - Network Policy after Softmax: [[0.04899089 0.05108443 0.05105012 0.04889992 0.05048672 0.05102469
  0.05149671 0.05137527 0.04881242 0.05090461 0.05021577 0.04839012
  0.04702538 0.04947169 0.05286649 0.0484858  0.0520458  0.04993038
  0.04880759 0.04863519]]
2024-10-22 17:01:56,650 - DEBUG - Normalized Policy: [[0.24343568 0.         0.         0.         0.         0.
  0.         0.         0.         0.25294495 0.         0.
  0.         0.         0.26269355 0.2409259  0.         0.
  0.         0.        ]]
2024-10-22 17:01:56,651 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Play 4)) | P=0.2529449462890625
2024-10-22 17:01:56,651 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0)) | P=0.24343568086624146
2024-10-22 17:01:56,652 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1)) | P=0.2409258931875229
2024-10-22 17:01:56,652 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 color B)) | P=0.2626935541629791
2024-10-22 17:01:56,653 - DEBUG - Simulating Node: ((Reveal player +1 color R),) | Value: 0.0
2024-10-22 17:01:56,653 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:56,653 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || RX|R12345
XX || XX|YGWB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:56,653 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:56,653 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:01:56,653 - DEBUG - --- Rollout #3 ---
2024-10-22 17:01:56,653 - DEBUG - Expanding unexplored child: ((Discard 1),)
2024-10-22 17:01:56,654 - DEBUG - Traversing Path: ['()', '((Discard 1),)']
2024-10-22 17:01:56,654 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 1
2024-10-22 17:01:56,862 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:56,862 - DEBUG - Network Policy Logits: [[-0.03168905  0.02767727  0.0112918  -0.02292499 -0.00719058  0.08302985
   0.01070327  0.06406617 -0.01531499  0.06625257  0.013839   -0.00788157
  -0.0726971  -0.03630694  0.03906246 -0.01882599  0.06320883  0.00283887
  -0.00668892 -0.01828905]]
2024-10-22 17:01:56,862 - DEBUG - Network Policy after Softmax: [[0.04805595 0.05099524 0.05016647 0.04847897 0.04924779 0.05389754
  0.05013695 0.05288508 0.0488493  0.05300083 0.05029442 0.04921377
  0.04612514 0.04783455 0.05157915 0.04867809 0.05283976 0.0497442
  0.0492725  0.04870424]]
2024-10-22 17:01:56,864 - DEBUG - Normalized Policy: [[0.24373777 0.         0.         0.         0.         0.
  0.         0.         0.24776162 0.         0.         0.
  0.         0.         0.2616073  0.24689326 0.         0.
  0.         0.        ]]
2024-10-22 17:01:56,865 - DEBUG - Added Child Node: ((Discard 1), (Discard 0)) | P=0.24373777210712433
2024-10-22 17:01:56,865 - DEBUG - Added Child Node: ((Discard 1), (Play 3)) | P=0.24776162207126617
2024-10-22 17:01:56,866 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1)) | P=0.2468932569026947
2024-10-22 17:01:56,867 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color B)) | P=0.26160728931427
2024-10-22 17:01:56,867 - DEBUG - Simulating Node: ((Discard 1),) | Value: 0.0
2024-10-22 17:01:56,867 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:56,867 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 7, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 7
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 B5}
2024-10-22 17:01:56,867 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:56,867 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:01:56,867 - DEBUG - --- Rollout #4 ---
2024-10-22 17:01:56,867 - DEBUG - Expanding unexplored child: ((Play 0),)
2024-10-22 17:01:56,867 - DEBUG - Traversing Path: ['()', '((Play 0),)']
2024-10-22 17:01:56,868 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 1
2024-10-22 17:01:57,080 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:57,081 - DEBUG - Network Policy Logits: [[-0.02870215  0.02755059  0.01572468 -0.02756574  0.00327374  0.08986505
   0.00244833  0.04725573 -0.02155172  0.0636366   0.00424632 -0.0074161
  -0.100823   -0.04627937  0.03592817 -0.02447515  0.05334321 -0.01137354
  -0.01298187 -0.01428807]]
2024-10-22 17:01:57,081 - DEBUG - Network Policy after Softmax: [[0.04842702 0.05122925 0.05062699 0.04848208 0.05000054 0.05452313
  0.04995928 0.05224874 0.04877453 0.05311167 0.05004919 0.04946889
  0.04505739 0.04758324 0.05166022 0.04863215 0.05256777 0.0492735
  0.04919432 0.0491301 ]]
2024-10-22 17:01:57,083 - DEBUG - Normalized Policy: [[0.24520764 0.         0.         0.         0.         0.
  0.         0.         0.24696727 0.         0.         0.
  0.         0.         0.26157883 0.24624634 0.         0.
  0.         0.        ]]
2024-10-22 17:01:57,083 - DEBUG - Added Child Node: ((Play 0), (Discard 0)) | P=0.24520763754844666
2024-10-22 17:01:57,084 - DEBUG - Added Child Node: ((Play 0), (Play 3)) | P=0.24696727097034454
2024-10-22 17:01:57,085 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 1)) | P=0.246246337890625
2024-10-22 17:01:57,085 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color B)) | P=0.26157882809638977
2024-10-22 17:01:57,085 - DEBUG - Simulating Node: ((Play 0),) | Value: 0.0
2024-10-22 17:01:57,085 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:57,085 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 6, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 6
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || XX|RYGWB12345
XX || XX|RYGWB12345
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:57,086 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:57,086 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:01:57,086 - DEBUG - --- Rollout #5 ---
2024-10-22 17:01:57,086 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 17:01:57,086 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 17:01:57,087 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 1
2024-10-22 17:01:57,293 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:57,293 - DEBUG - Network Policy Logits: [[ 0.00948914  0.02258202  0.03627088  0.00546931  0.03801576  0.00473665
   0.01583632  0.04492049 -0.01014692  0.0329966   0.01715374 -0.05511945
  -0.01924577 -0.01928789  0.05098207 -0.01368838  0.04254647 -0.00831372
  -0.01193453  0.01036057]]
2024-10-22 17:01:57,293 - DEBUG - Network Policy after Softmax: [[0.04997298 0.05063157 0.05132943 0.0497725  0.05141907 0.04973605
  0.05029118 0.05177534 0.04900128 0.05116164 0.05035748 0.04684639
  0.04855745 0.0485554  0.05209013 0.04882805 0.05165256 0.04909119
  0.04891376 0.05001655]]
2024-10-22 17:01:57,295 - DEBUG - Normalized Policy: [[0.24999936 0.         0.         0.         0.         0.
  0.         0.         0.24513824 0.         0.         0.
  0.         0.         0.2605908  0.24427164 0.         0.
  0.         0.        ]]
2024-10-22 17:01:57,296 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0)) | P=0.24999935925006866
2024-10-22 17:01:57,296 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 3)) | P=0.2451382428407669
2024-10-22 17:01:57,297 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.2442716360092163
2024-10-22 17:01:57,298 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | P=0.2605907917022705
2024-10-22 17:01:57,298 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 17:01:57,298 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:57,298 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || X1|RYGWB1
XX || X1|RYGWB1
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || XX|RYGWB12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:57,298 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:57,298 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:01:57,298 - DEBUG - --- Rollout #6 ---
2024-10-22 17:01:57,299 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.31525248289108276 | PUCT: 0.31525248289108276
2024-10-22 17:01:57,299 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3203955292701721 | PUCT: 0.3203955292701721
2024-10-22 17:01:57,299 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.31448596715927124 | PUCT: 0.31448596715927124
2024-10-22 17:01:57,300 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.7230738401412964 | PUCT: 0.7230738401412964
2024-10-22 17:01:57,300 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.7230738401412964
2024-10-22 17:01:57,300 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:01:57,300 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Reveal player +1 color B))
2024-10-22 17:01:57,300 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Reveal player +1 color B))']
2024-10-22 17:01:57,301 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 1
2024-10-22 17:01:57,302 - DEBUG - Move: (Reveal player +1 color B) | Reward: 5 | Depth: 2
2024-10-22 17:01:57,518 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:57,519 - DEBUG - Network Policy Logits: [[-0.0210855   0.02146426  0.03595666  0.01288686 -0.01443611  0.00141188
   0.02703606 -0.02943757 -0.00670888  0.03282031  0.00952709 -0.00617384
  -0.05661516 -0.01670486  0.00989319 -0.03363134  0.00729579 -0.03054237
  -0.00296719  0.00200737]]
2024-10-22 17:01:57,519 - DEBUG - Network Policy after Softmax: [[0.04908552 0.05121917 0.05196687 0.05078172 0.049413   0.05020234
  0.05150535 0.04867727 0.04979631 0.05180414 0.0506114  0.04982296
  0.04737215 0.04930102 0.05062993 0.04847356 0.05049859 0.04862352
  0.04998298 0.05023224]]
2024-10-22 17:01:57,521 - DEBUG - Normalized Policy: [[0.         0.33689532 0.         0.         0.         0.33020705
  0.         0.         0.         0.         0.33289766 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:57,521 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Reveal player +1 color R)) | P=0.3328976631164551
2024-10-22 17:01:57,522 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Play 0)) | P=0.33020704984664917
2024-10-22 17:01:57,522 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color B), (Discard 1)) | P=0.33689531683921814
2024-10-22 17:01:57,523 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:01:57,523 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:57,523 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || X1|RYGWB1
W1 || X1|RYGWB1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:57,523 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:57,523 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:01:57,523 - DEBUG - --- Rollout #7 ---
2024-10-22 17:01:57,524 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.3285338282585144 | PUCT: 0.3285338282585144
2024-10-22 17:01:57,524 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3338935375213623 | PUCT: 0.3338935375213623
2024-10-22 17:01:57,524 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.32773497700691223 | PUCT: 0.32773497700691223
2024-10-22 17:01:57,525 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.502357542514801 | PUCT: 0.502357542514801
2024-10-22 17:01:57,525 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.502357542514801
2024-10-22 17:01:57,525 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:01:57,525 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Play 3))
2024-10-22 17:01:57,525 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Play 3))']
2024-10-22 17:01:57,526 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 1
2024-10-22 17:01:57,526 - DEBUG - Move: (Play 3) | Reward: 6 | Depth: 2
2024-10-22 17:01:57,736 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:57,737 - DEBUG - Network Policy Logits: [[-0.02172422  0.03080178  0.03199631 -0.02006285  0.00557285  0.00875943
   0.05433501 -0.01042909 -0.01920909  0.06277785 -0.00885776  0.00747025
  -0.05166276 -0.0327377   0.01430144 -0.0099152   0.01855948 -0.03975165
  -0.00273907 -0.02855008]]
2024-10-22 17:01:57,737 - DEBUG - Network Policy after Softmax: [[0.0489314  0.05157026 0.0516319  0.04901275 0.05028547 0.05044597
  0.05279827 0.04948721 0.04905462 0.05324592 0.04956504 0.05038098
  0.04748817 0.04839545 0.05072632 0.04951265 0.05094277 0.04805719
  0.04986924 0.04859853]]
2024-10-22 17:01:57,739 - DEBUG - Normalized Policy: [[0.         0.25788134 0.         0.         0.         0.2522592
  0.         0.         0.         0.         0.24785404 0.
  0.         0.24200542 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:57,740 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 3), (Reveal player +1 color R)) | P=0.24785403907299042
2024-10-22 17:01:57,741 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 3), (Reveal player +1 color W)) | P=0.24200542271137238
2024-10-22 17:01:57,741 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 3), (Play 0)) | P=0.25225919485092163
2024-10-22 17:01:57,742 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 3), (Discard 1)) | P=0.2578813433647156
2024-10-22 17:01:57,742 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Play 3)) | Value: 0.0
2024-10-22 17:01:57,742 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:57,742 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 1}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G3 W0 B1 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
W1 || X1|RYGWB1
R1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:57,742 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:57,742 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:01:57,742 - DEBUG - --- Rollout #8 ---
2024-10-22 17:01:57,743 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.3396190404891968 | PUCT: 0.3396190404891968
2024-10-22 17:01:57,743 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3451595902442932 | PUCT: 0.3451595902442932
2024-10-22 17:01:57,744 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.33879324793815613 | PUCT: 0.33879324793815613
2024-10-22 17:01:57,744 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3894808888435364 | PUCT: 0.3894808888435364
2024-10-22 17:01:57,744 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.3894808888435364
2024-10-22 17:01:57,745 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:01:57,745 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Discard 0))
2024-10-22 17:01:57,745 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Discard 0))']
2024-10-22 17:01:57,745 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 1
2024-10-22 17:01:57,746 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 2
2024-10-22 17:01:57,955 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:57,956 - DEBUG - Network Policy Logits: [[ 0.0014049   0.02649084  0.03492013 -0.00192714  0.01070995  0.05456635
   0.02419234 -0.01820483 -0.04476563  0.0530171   0.00505846  0.0138135
  -0.06708642 -0.02036452  0.00107066  0.00435173  0.01153498 -0.02758606
  -0.02805066 -0.01203554]]
2024-10-22 17:01:57,956 - DEBUG - Network Policy after Softmax: [[0.04999539 0.05126543 0.05169939 0.04982908 0.05046277 0.05272513
  0.05114774 0.04902454 0.04773955 0.05264351 0.05017839 0.05061963
  0.04668577 0.04891878 0.04997868 0.05014293 0.05050442 0.04856678
  0.04854422 0.04932792]]
2024-10-22 17:01:57,958 - DEBUG - Normalized Policy: [[0.         0.33252758 0.         0.         0.         0.34199578
  0.         0.         0.         0.         0.3254766  0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:01:57,959 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0), (Reveal player +1 color R)) | P=0.32547658681869507
2024-10-22 17:01:57,960 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0), (Play 0)) | P=0.3419957756996155
2024-10-22 17:01:57,960 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0), (Discard 1)) | P=0.3325275778770447
2024-10-22 17:01:57,961 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Discard 0)) | Value: 0.0
2024-10-22 17:01:57,961 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:57,961 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 6, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': None}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 6
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || XX|RYGWB12345
-----
R3 || R3|R3
R4 || R4|R4
R1 || X1|RYGWB1
W1 || X1|RYGWB1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:01:57,961 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:57,961 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:01:57,961 - DEBUG - --- Rollout #9 ---
2024-10-22 17:01:57,962 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.3491048812866211 | PUCT: 0.3491048812866211
2024-10-22 17:01:57,962 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.35480019450187683 | PUCT: 0.35480019450187683
2024-10-22 17:01:57,963 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.34825602173805237 | PUCT: 0.34825602173805237
2024-10-22 17:01:57,963 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3202875256538391 | PUCT: 0.3202875256538391
2024-10-22 17:01:57,963 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.35480019450187683
2024-10-22 17:01:57,963 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:01:57,963 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:01:57,963 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 1))']
2024-10-22 17:01:57,964 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 1
2024-10-22 17:01:57,965 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 2
2024-10-22 17:01:58,188 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:58,189 - DEBUG - Network Policy Logits: [[-0.04559511  0.00957218  0.01233796  0.00508919  0.01541691 -0.00896462
   0.02405027  0.01155667 -0.00782651  0.03971802 -0.00046416 -0.05166964
  -0.04629821 -0.05067196  0.01506683 -0.03526774  0.00870507 -0.06115395
   0.00757052  0.00653626]]
2024-10-22 17:01:58,189 - DEBUG - Network Policy after Softmax: [[0.04811669 0.05084574 0.05098657 0.05061831 0.05114379 0.04991191
  0.05158725 0.05094675 0.04996874 0.05240187 0.05033799 0.04782529
  0.04808287 0.04787303 0.05112589 0.04861619 0.05080167 0.04737385
  0.05074407 0.05069161]]
2024-10-22 17:01:58,192 - DEBUG - Normalized Policy: [[0.         0.         0.         0.25374573 0.         0.25020456
  0.         0.         0.         0.         0.2523405  0.
  0.         0.         0.         0.24370922 0.         0.
  0.         0.        ]]
2024-10-22 17:01:58,193 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Reveal player +1 color R)) | P=0.25234049558639526
2024-10-22 17:01:58,194 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.24370922148227692
2024-10-22 17:01:58,195 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Play 0)) | P=0.25020456314086914
2024-10-22 17:01:58,196 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Discard 3)) | P=0.2537457346916199
2024-10-22 17:01:58,196 - DEBUG - Simulating Node: ((Discard 1), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:58,196 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:58,196 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 6, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 6
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || R2|R2
XX || B2|B2
XX || X1|RYGWB1
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || XX|RYGWB12345
W1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 B5}
2024-10-22 17:01:58,196 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:58,196 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:01:58,196 - DEBUG - --- Rollout #10 ---
2024-10-22 17:01:58,197 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.35737693309783936 | PUCT: 0.35737693309783936
2024-10-22 17:01:58,198 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.24213813245296478 | PUCT: 0.24213813245296478
2024-10-22 17:01:58,199 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.35650795698165894 | PUCT: 0.35650795698165894
2024-10-22 17:01:58,199 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3278767466545105 | PUCT: 0.3278767466545105
2024-10-22 17:01:58,200 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.35737693309783936
2024-10-22 17:01:58,200 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:01:58,200 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Reveal player +1 rank 1))
2024-10-22 17:01:58,200 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Reveal player +1 rank 1))']
2024-10-22 17:01:58,201 - DEBUG - Move: (Reveal player +1 color R) | Reward: 5 | Depth: 1
2024-10-22 17:01:58,201 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 2
2024-10-22 17:01:58,410 - DEBUG - Network Value Output: 0.0
2024-10-22 17:01:58,410 - DEBUG - Network Policy Logits: [[-0.02189797  0.01838607  0.04834731  0.00978843  0.01478255 -0.01065821
   0.02771548 -0.00745255  0.00787414  0.06183868 -0.01661767  0.0037719
  -0.05710833 -0.03027795  0.01227053 -0.02410206  0.0097497  -0.03697392
  -0.01631163  0.00819453]]
2024-10-22 17:01:58,411 - DEBUG - Network Policy after Softmax: [[0.04889505 0.05090495 0.0524532  0.05046916 0.05072185 0.04944772
  0.05138209 0.04960649 0.05037265 0.05316567 0.04915391 0.05016643
  0.04720339 0.04848703 0.05059459 0.0487874  0.05046721 0.04816344
  0.04916896 0.05038879]]
2024-10-22 17:01:58,412 - DEBUG - Normalized Policy: [[0.         0.3413231  0.         0.         0.         0.3315522
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.32712469 0.         0.
  0.         0.        ]]
2024-10-22 17:01:58,413 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Play 0)) | P=0.3315522074699402
2024-10-22 17:01:58,414 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Reveal player +1 rank 1)) | P=0.327124685049057
2024-10-22 17:01:58,414 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Discard 1)) | P=0.3413231074810028
2024-10-22 17:01:58,415 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:01:58,415 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:01:58,415 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || RX|R12345
W1 || XX|YGWB12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:01:58,415 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:01:58,415 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:01:58,415 - INFO - === MCTS Search Completed ===
2024-10-22 17:01:58,415 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 rank 1),) | Visit Count: 4
2024-10-22 17:01:58,415 - INFO - Actual Game Score: 5
2024-10-22 17:01:58,415 - DEBUG - === Recording Training Data ===
2024-10-22 17:01:58,415 - DEBUG - State Vector Shape: 658
2024-10-22 17:01:58,415 - DEBUG - Policy Targets: [0.         0.22222222 0.         0.         0.         0.11111111
 0.         0.         0.         0.         0.22222222 0.
 0.         0.         0.         0.44444444 0.         0.
 0.         0.        ]
2024-10-22 17:01:58,416 - DEBUG - === End of Training Data ===
2024-10-22 17:01:58,416 - INFO - Chosen Action: (Reveal player +1 rank 1) | Visit Count: 4
2024-10-22 17:01:58,417 - DEBUG - Not the current player's turn.
2024-10-22 17:02:00,681 - INFO - Agent state has been reset.
2024-10-22 17:02:00,681 - INFO - === Starting MCTS Search ===
2024-10-22 17:02:00,682 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || X1|RYGWB1
W1 || X1|RYGWB1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:00,682 - INFO - Max Rollouts: 10
2024-10-22 17:02:00,682 - DEBUG - --- Rollout #1 ---
2024-10-22 17:02:00,682 - DEBUG - Node () is a leaf node.
2024-10-22 17:02:00,682 - DEBUG - Traversing Path: ['()']
2024-10-22 17:02:00,880 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:00,881 - DEBUG - Network Policy Logits: [[-0.01131301  0.02152823  0.045483    0.01592376 -0.01925739  0.00790791
   0.02575232 -0.02159978 -0.00807154  0.01157254  0.0039977  -0.00543925
  -0.03693376 -0.00708484  0.01693503 -0.02054704  0.01340154 -0.03118374
   0.00166363 -0.00800433]]
2024-10-22 17:02:00,881 - DEBUG - Network Policy after Softmax: [[0.04944059 0.05109123 0.05232989 0.05080569 0.04904937 0.05040007
  0.0513075  0.04893461 0.0496011  0.05058511 0.05020338 0.04973184
  0.04818997 0.04965007 0.0508571  0.04898615 0.05067771 0.04846786
  0.05008634 0.04960444]]
2024-10-22 17:02:00,883 - DEBUG - Normalized Policy: [[0.         0.33680305 0.         0.         0.         0.33224678
  0.         0.         0.         0.         0.33095014 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:00,883 - DEBUG - Dirichlet Noise Added: [0.         0.25260228 0.         0.         0.         0.24918509
 0.         0.         0.         0.         0.4982126  0.
 0.         0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:02:00,884 - DEBUG - Added Child Node: ((Reveal player +1 color R),) | P=0.498212605714798
2024-10-22 17:02:00,884 - DEBUG - Added Child Node: ((Play 0),) | P=0.24918508529663086
2024-10-22 17:02:00,885 - DEBUG - Added Child Node: ((Discard 1),) | P=0.2526022791862488
2024-10-22 17:02:00,885 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:02:00,885 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:00,885 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || X1|RYGWB1
W1 || X1|RYGWB1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:00,885 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:00,886 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:02:00,886 - DEBUG - --- Rollout #2 ---
2024-10-22 17:02:00,886 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R),)
2024-10-22 17:02:00,886 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)']
2024-10-22 17:02:00,887 - DEBUG - Move: (Reveal player +1 color R) | Reward: 5 | Depth: 1
2024-10-22 17:02:01,091 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:01,092 - DEBUG - Network Policy Logits: [[ 0.01607328  0.01626435  0.0109932   0.02593413  0.03474347 -0.01725845
  -0.00092395  0.0173585  -0.00145333  0.0126447   0.03058872 -0.0268968
  -0.03446596 -0.00915005  0.07111669 -0.02841446  0.02520712  0.02510625
  -0.01894343  0.02039939]]
2024-10-22 17:02:01,092 - DEBUG - Network Policy after Softmax: [[0.05036679 0.05037642 0.05011157 0.05086591 0.05131599 0.04871565
  0.04951793 0.05043156 0.04949172 0.0501944  0.05110322 0.04824837
  0.04788455 0.04911226 0.05321687 0.0481752  0.05082894 0.05082382
  0.04863364 0.05058515]]
2024-10-22 17:02:01,094 - DEBUG - Normalized Policy: [[0.34023866 0.         0.         0.         0.         0.
  0.         0.         0.33432737 0.         0.         0.
  0.         0.         0.         0.32543397 0.         0.
  0.         0.        ]]
2024-10-22 17:02:01,094 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0)) | P=0.34023866057395935
2024-10-22 17:02:01,095 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Play 3)) | P=0.33432736992836
2024-10-22 17:02:01,096 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1)) | P=0.32543396949768066
2024-10-22 17:02:01,096 - DEBUG - Simulating Node: ((Reveal player +1 color R),) | Value: 0.0
2024-10-22 17:02:01,096 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:01,096 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || X1|YGWB1
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || BX|B12345
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:01,096 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:01,096 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:02:01,096 - DEBUG - --- Rollout #3 ---
2024-10-22 17:02:01,096 - DEBUG - Expanding unexplored child: ((Discard 1),)
2024-10-22 17:02:01,096 - DEBUG - Traversing Path: ['()', '((Discard 1),)']
2024-10-22 17:02:01,097 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 1
2024-10-22 17:02:01,295 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:01,295 - DEBUG - Network Policy Logits: [[-0.00070608  0.01739871  0.01466979  0.00732363  0.04292577  0.01403575
   0.004618    0.05511413 -0.01758615  0.03491943  0.01383693 -0.04560048
  -0.01811115 -0.0135987   0.03971545 -0.03367666  0.05636164  0.00488268
   0.00387271  0.00172106]]
2024-10-22 17:02:01,295 - DEBUG - Network Policy after Softmax: [[0.04949417 0.05039841 0.05026107 0.04989319 0.0517015  0.0502292
  0.04975838 0.0523355  0.04866571 0.0512892  0.05021922 0.0473213
  0.04864017 0.04886015 0.05153578 0.04788892 0.05240083 0.04977155
  0.04972131 0.04961444]]
2024-10-22 17:02:01,298 - DEBUG - Normalized Policy: [[0.2504961  0.         0.         0.         0.         0.
  0.         0.         0.24630319 0.         0.         0.
  0.         0.         0.26082897 0.24237175 0.         0.
  0.         0.        ]]
2024-10-22 17:02:01,299 - DEBUG - Added Child Node: ((Discard 1), (Discard 0)) | P=0.2504960894584656
2024-10-22 17:02:01,299 - DEBUG - Added Child Node: ((Discard 1), (Play 3)) | P=0.24630318582057953
2024-10-22 17:02:01,300 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1)) | P=0.24237175285816193
2024-10-22 17:02:01,301 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color B)) | P=0.26082897186279297
2024-10-22 17:02:01,301 - DEBUG - Simulating Node: ((Discard 1),) | Value: 0.0
2024-10-22 17:02:01,301 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:01,301 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 5, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 5
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || X1|RYGWB1
XX || X1|RYGWB1
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B1 || BX|B12345
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 B5}
2024-10-22 17:02:01,301 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:01,301 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:02:01,301 - DEBUG - --- Rollout #4 ---
2024-10-22 17:02:01,302 - DEBUG - Expanding unexplored child: ((Play 0),)
2024-10-22 17:02:01,302 - DEBUG - Traversing Path: ['()', '((Play 0),)']
2024-10-22 17:02:01,303 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 1
2024-10-22 17:02:01,506 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:01,506 - DEBUG - Network Policy Logits: [[-0.00141938  0.01973085  0.01807198 -0.00288336  0.05515093  0.02636824
  -0.00744862  0.03847605 -0.02021805  0.03043297  0.00462258 -0.03989544
  -0.04167295 -0.02637316  0.03641158 -0.03970725  0.04991487 -0.00608394
  -0.00216018  0.00687021]]
2024-10-22 17:02:01,507 - DEBUG - Network Policy after Softmax: [[0.04966422 0.05072582 0.05064174 0.04959157 0.05255473 0.05106362
  0.04936568 0.05168565 0.04873932 0.05127161 0.0499652  0.04778963
  0.04770476 0.04844025 0.05157906 0.04779863 0.05228027 0.0494331
  0.04962745 0.05007763]]
2024-10-22 17:02:01,509 - DEBUG - Normalized Policy: [[0.25110686 0.         0.         0.         0.         0.
  0.         0.         0.24643044 0.         0.         0.
  0.         0.         0.26078844 0.24167423 0.         0.
  0.         0.        ]]
2024-10-22 17:02:01,510 - DEBUG - Added Child Node: ((Play 0), (Discard 0)) | P=0.251106858253479
2024-10-22 17:02:01,511 - DEBUG - Added Child Node: ((Play 0), (Play 3)) | P=0.246430441737175
2024-10-22 17:02:01,511 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 1)) | P=0.24167422950267792
2024-10-22 17:02:01,512 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color B)) | P=0.2607884407043457
2024-10-22 17:02:01,513 - DEBUG - Simulating Node: ((Play 0),) | Value: 0.0
2024-10-22 17:02:01,513 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:01,513 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || X1|RYGWB1
XX || X1|RYGWB1
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || BX|B12345
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:01,513 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:01,513 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:02:01,513 - DEBUG - --- Rollout #5 ---
2024-10-22 17:02:01,514 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.790063202381134 | PUCT: 0.790063202381134
2024-10-22 17:02:01,514 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.40057551860809326 | PUCT: 0.40057551860809326
2024-10-22 17:02:01,515 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.39515653252601624 | PUCT: 0.39515653252601624
2024-10-22 17:02:01,515 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.790063202381134
2024-10-22 17:02:01,515 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:02:01,515 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Reveal player +1 rank 1))
2024-10-22 17:02:01,515 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Reveal player +1 rank 1))']
2024-10-22 17:02:01,516 - DEBUG - Move: (Reveal player +1 color R) | Reward: 5 | Depth: 1
2024-10-22 17:02:01,517 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 2
2024-10-22 17:02:01,726 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:01,726 - DEBUG - Network Policy Logits: [[-0.00982851  0.01128832  0.03511564  0.0202876  -0.00386219 -0.0201287
   0.01774572 -0.01624108  0.0122433   0.03651126 -0.00304034 -0.00048571
  -0.06283076 -0.01791054  0.0119353  -0.03582444  0.00645822 -0.02422626
  -0.01160967  0.0104697 ]]
2024-10-22 17:02:01,727 - DEBUG - Network Policy after Softmax: [[0.04960648 0.05066516 0.05188686 0.05112316 0.04990334 0.04909815
  0.05099338 0.0492894  0.05071356 0.05195933 0.04994437 0.05007212
  0.04704569 0.04920718 0.05069795 0.04833354 0.05042103 0.04889738
  0.04951821 0.0506237 ]]
2024-10-22 17:02:01,728 - DEBUG - Normalized Policy: [[0.         0.34010196 0.         0.         0.         0.32958308
  0.         0.         0.         0.         0.         0.
  0.         0.33031496 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:01,729 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Reveal player +1 color W)) | P=0.330314964056015
2024-10-22 17:02:01,729 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Play 0)) | P=0.329583078622818
2024-10-22 17:02:01,730 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Reveal player +1 rank 1), (Discard 1)) | P=0.340101957321167
2024-10-22 17:02:01,730 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:02:01,730 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:01,730 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || X1|YGWB1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:01,731 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:01,731 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:02:01,731 - DEBUG - --- Rollout #6 ---
2024-10-22 17:02:01,731 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.5557421445846558 | PUCT: 0.5557421445846558
2024-10-22 17:02:01,732 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.4226561188697815 | PUCT: 0.4226561188697815
2024-10-22 17:02:01,732 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.4169384241104126 | PUCT: 0.4169384241104126
2024-10-22 17:02:01,732 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.5557421445846558
2024-10-22 17:02:01,732 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:02:01,733 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 0))
2024-10-22 17:02:01,733 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 0))']
2024-10-22 17:02:01,733 - DEBUG - Move: (Reveal player +1 color R) | Reward: 5 | Depth: 1
2024-10-22 17:02:01,734 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 2
2024-10-22 17:02:01,946 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:01,946 - DEBUG - Network Policy Logits: [[ 0.00621475  0.02955722  0.03325312  0.00701121  0.01520691  0.02684548
   0.02188643 -0.01461219 -0.04515487  0.04377348  0.0101296  -0.02313784
  -0.05367766 -0.00446724 -0.00298842 -0.00089916  0.0122269  -0.01825822
  -0.02883609  0.00809441]]
2024-10-22 17:02:01,946 - DEBUG - Network Policy after Softmax: [[0.05024024 0.05142677 0.05161719 0.05028027 0.05069405 0.0512875
  0.05103379 0.04920471 0.04772459 0.05216309 0.05043731 0.04878699
  0.04731957 0.04970644 0.04978    0.04988411 0.0505432  0.04902564
  0.04850978 0.05033477]]
2024-10-22 17:02:01,948 - DEBUG - Normalized Policy: [[0.         0.25420436 0.         0.         0.         0.25351596
  0.         0.         0.         0.         0.         0.
  0.         0.24570072 0.         0.24657895 0.         0.
  0.         0.        ]]
2024-10-22 17:02:01,949 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 color W)) | P=0.24570071697235107
2024-10-22 17:02:01,949 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Discard 1)) | P=0.2542043626308441
2024-10-22 17:02:01,950 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 rank 1)) | P=0.24657894670963287
2024-10-22 17:02:01,950 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Play 0)) | P=0.25351595878601074
2024-10-22 17:02:01,950 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 0)) | Value: 0.0
2024-10-22 17:02:01,950 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:01,951 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || X1|YGWB1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:01,951 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:01,951 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:02:01,951 - DEBUG - --- Rollout #7 ---
2024-10-22 17:02:01,951 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.4343663156032562 | PUCT: 0.4343663156032562
2024-10-22 17:02:01,952 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.44046226143836975 | PUCT: 0.44046226143836975
2024-10-22 17:02:01,952 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.4345036745071411 | PUCT: 0.4345036745071411
2024-10-22 17:02:01,952 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.44046226143836975
2024-10-22 17:02:01,952 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:02:01,953 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:02:01,953 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 1))']
2024-10-22 17:02:01,953 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 1
2024-10-22 17:02:01,954 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 2
2024-10-22 17:02:02,162 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:02,162 - DEBUG - Network Policy Logits: [[-0.01356476  0.00864628  0.02352803  0.02227055  0.01768076 -0.00100991
   0.02250111 -0.01874095 -0.00508908  0.01720685  0.00712141 -0.0229626
  -0.04741103 -0.03818493  0.00734921 -0.02787278  0.01346233 -0.04241696
   0.00426172  0.00948818]]
2024-10-22 17:02:02,163 - DEBUG - Network Policy after Softmax: [[0.04947171 0.05058283 0.05134122 0.05127669 0.05104189 0.05009674
  0.05128852 0.0492163  0.04989281 0.0510177  0.05050576 0.04900897
  0.0478253  0.04826858 0.05051726 0.04876892 0.05082703 0.04806474
  0.05036153 0.05062543]]
2024-10-22 17:02:02,165 - DEBUG - Normalized Policy: [[0.         0.         0.         0.337615   0.         0.329846
  0.         0.         0.         0.         0.33253902 0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:02,166 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Reveal player +1 color R)) | P=0.33253902196884155
2024-10-22 17:02:02,166 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Play 0)) | P=0.32984599471092224
2024-10-22 17:02:02,167 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Discard 3)) | P=0.3376150131225586
2024-10-22 17:02:02,167 - DEBUG - Simulating Node: ((Discard 1), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:02:02,167 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:02,167 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || R2|R2
XX || B2|B2
XX || B1|B1
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || X1|RYGWB1
W1 || X1|RYGWB1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 B5}
2024-10-22 17:02:02,168 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:02,168 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:02:02,168 - DEBUG - --- Rollout #8 ---
2024-10-22 17:02:02,169 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.449022501707077 | PUCT: 0.449022501707077
2024-10-22 17:02:02,169 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3035494089126587 | PUCT: 0.3035494089126587
2024-10-22 17:02:02,170 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.449164479970932 | PUCT: 0.449164479970932
2024-10-22 17:02:02,170 - DEBUG - Selected Child: ((Play 0),) | PUCT: 0.449164479970932
2024-10-22 17:02:02,170 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 17:02:02,170 - DEBUG - Expanding unexplored child: ((Play 0), (Reveal player +1 rank 1))
2024-10-22 17:02:02,170 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Reveal player +1 rank 1))']
2024-10-22 17:02:02,171 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 1
2024-10-22 17:02:02,172 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 6 | Depth: 2
2024-10-22 17:02:02,383 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:02,384 - DEBUG - Network Policy Logits: [[-0.01436163  0.00277618  0.01330822  0.02449873  0.02698354 -0.00179714
   0.01452997 -0.01478024 -0.00068963  0.01896645  0.0159967  -0.03363713
  -0.05343904 -0.03147393  0.01984942 -0.02252469  0.01856125 -0.04539359
   0.01473333 -0.00984166]]
2024-10-22 17:02:02,384 - DEBUG - Network Policy after Softmax: [[0.04941576 0.05026994 0.05080218 0.05137388 0.05150169 0.05004056
  0.05086429 0.04939508 0.05009601 0.05109045 0.05093895 0.04847237
  0.04752197 0.04857734 0.05113558 0.04901402 0.05106975 0.04790584
  0.05087463 0.04963963]]
2024-10-22 17:02:02,387 - DEBUG - Normalized Policy: [[0.32845148 0.         0.         0.         0.         0.
  0.         0.         0.33297288 0.         0.3385756  0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:02,388 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 1), (Reveal player +1 color R)) | P=0.3385756015777588
2024-10-22 17:02:02,389 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 1), (Discard 0)) | P=0.3284514844417572
2024-10-22 17:02:02,390 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 1), (Play 3)) | P=0.3329728841781616
2024-10-22 17:02:02,390 - DEBUG - Simulating Node: ((Play 0), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:02:02,390 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:02,390 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || X1|RYGWB1
W1 || X1|RYGWB1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:02,390 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:02,390 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:02:02,390 - DEBUG - --- Rollout #9 ---
2024-10-22 17:02:02,391 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.4615640640258789 | PUCT: 0.4615640640258789
2024-10-22 17:02:02,392 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.31202778220176697 | PUCT: 0.31202778220176697
2024-10-22 17:02:02,393 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.30780667066574097 | PUCT: 0.30780667066574097
2024-10-22 17:02:02,393 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.4615640640258789
2024-10-22 17:02:02,393 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:02:02,393 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Play 3))
2024-10-22 17:02:02,393 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Play 3))']
2024-10-22 17:02:02,394 - DEBUG - Move: (Reveal player +1 color R) | Reward: 5 | Depth: 1
2024-10-22 17:02:02,395 - DEBUG - Move: (Play 3) | Reward: 6 | Depth: 2
2024-10-22 17:02:02,611 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:02,611 - DEBUG - Network Policy Logits: [[-0.02827871  0.04051588  0.02894732  0.00125459  0.01648044  0.00367083
   0.03560273 -0.01122358 -0.02274475  0.05823783 -0.00417723 -0.00626553
  -0.04845993 -0.01052975  0.00677929 -0.02857817  0.00444371 -0.03551472
  -0.00472409 -0.01103271]]
2024-10-22 17:02:02,611 - DEBUG - Network Policy after Softmax: [[0.04862712 0.05209016 0.05149102 0.05008465 0.05085307 0.05020582
  0.05183486 0.04946357 0.04889697 0.05302152 0.04981335 0.04970943
  0.0476556  0.04949791 0.05036213 0.04861256 0.05024464 0.04827652
  0.04978611 0.04947302]]
2024-10-22 17:02:02,613 - DEBUG - Normalized Policy: [[0.         0.2599226  0.         0.         0.         0.25052
  0.         0.         0.         0.         0.         0.
  0.         0.24698763 0.         0.24256985 0.         0.
  0.         0.        ]]
2024-10-22 17:02:02,614 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Play 3), (Reveal player +1 color W)) | P=0.24698762595653534
2024-10-22 17:02:02,615 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Play 3), (Discard 1)) | P=0.259922593832016
2024-10-22 17:02:02,616 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Play 3), (Reveal player +1 rank 1)) | P=0.24256984889507294
2024-10-22 17:02:02,617 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Play 3), (Play 0)) | P=0.2505199909210205
2024-10-22 17:02:02,617 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Play 3)) | Value: 0.0
2024-10-22 17:02:02,617 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:02,617 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 1, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': None, 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R1 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || BX|B12345
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
W1 || X1|YGWB1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:02,617 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:02,617 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:02:02,617 - DEBUG - --- Rollout #10 ---
2024-10-22 17:02:02,618 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R),) | Q: 0.0 | U: 0.3780006766319275 | PUCT: 0.3780006766319275
2024-10-22 17:02:02,618 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.31942129135131836 | PUCT: 0.31942129135131836
2024-10-22 17:02:02,619 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.31510016322135925 | PUCT: 0.31510016322135925
2024-10-22 17:02:02,619 - DEBUG - Selected Child: ((Reveal player +1 color R),) | PUCT: 0.3780006766319275
2024-10-22 17:02:02,619 - DEBUG - Selected child for exploration: ((Reveal player +1 color R),)
2024-10-22 17:02:02,619 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Reveal player +1 rank 1)) | Q: 0.0 | U: 0.5160716772079468 | PUCT: 0.5160716772079468
2024-10-22 17:02:02,620 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Discard 0)) | Q: 0.0 | U: 0.5395488739013672 | PUCT: 0.5395488739013672
2024-10-22 17:02:02,621 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color R), (Play 3)) | Q: 0.0 | U: 0.530174732208252 | PUCT: 0.530174732208252
2024-10-22 17:02:02,621 - DEBUG - Selected Child: ((Reveal player +1 color R), (Discard 0)) | PUCT: 0.5395488739013672
2024-10-22 17:02:02,621 - DEBUG - Selected child for exploration: ((Reveal player +1 color R), (Discard 0))
2024-10-22 17:02:02,621 - DEBUG - Expanding unexplored child: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 color W))
2024-10-22 17:02:02,621 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color R),)', '((Reveal player +1 color R), (Discard 0))', '((Reveal player +1 color R), (Discard 0), (Reveal player +1 color W))']
2024-10-22 17:02:02,622 - DEBUG - Move: (Reveal player +1 color R) | Reward: 5 | Depth: 1
2024-10-22 17:02:02,622 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 2
2024-10-22 17:02:02,623 - DEBUG - Move: (Reveal player +1 color W) | Reward: 5 | Depth: 3
2024-10-22 17:02:02,816 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:02,817 - DEBUG - Network Policy Logits: [[ 0.01986559  0.03536533  0.03526656  0.01831424  0.01924397 -0.03416864
   0.00552979  0.00462704 -0.00853417  0.02156059  0.04976169  0.0292633
  -0.04414098 -0.03077096  0.04549994 -0.00931945  0.01324229  0.0062055
   0.00196136 -0.0027741 ]]
2024-10-22 17:02:02,817 - DEBUG - Network Policy after Softmax: [[0.05054072 0.05133019 0.05132512 0.05046238 0.05050932 0.04788227
  0.04982135 0.04977639 0.04912557 0.05062646 0.05207451 0.05101793
  0.04740714 0.04804523 0.05185305 0.04908701 0.05020708 0.04985503
  0.04964389 0.04940935]]
2024-10-22 17:02:02,819 - DEBUG - Normalized Policy: [[0.338282   0.         0.         0.         0.         0.
  0.         0.33316612 0.         0.         0.         0.
  0.         0.         0.         0.3285519  0.         0.
  0.         0.        ]]
2024-10-22 17:02:02,820 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 color W), (Discard 0)) | P=0.3382819890975952
2024-10-22 17:02:02,821 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 color W), (Reveal player +1 rank 1)) | P=0.32855188846588135
2024-10-22 17:02:02,822 - DEBUG - Added Child Node: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 color W), (Play 2)) | P=0.33316612243652344
2024-10-22 17:02:02,822 - DEBUG - Simulating Node: ((Reveal player +1 color R), (Discard 0), (Reveal player +1 color W)) | Value: 0.0
2024-10-22 17:02:02,822 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:02,822 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
XX || XX|RYGB12345
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || BX|B12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:02,822 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:02,822 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:02:02,822 - INFO - === MCTS Search Completed ===
2024-10-22 17:02:02,822 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color R),) | Visit Count: 5
2024-10-22 17:02:02,822 - INFO - Actual Game Score: 5
2024-10-22 17:02:02,823 - DEBUG - === Recording Training Data ===
2024-10-22 17:02:02,823 - DEBUG - State Vector Shape: 658
2024-10-22 17:02:02,823 - DEBUG - Policy Targets: [0.         0.22222222 0.         0.         0.         0.22222222
 0.         0.         0.         0.         0.55555556 0.
 0.         0.         0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:02:02,823 - DEBUG - === End of Training Data ===
2024-10-22 17:02:02,823 - INFO - Chosen Action: (Reveal player +1 color R) | Visit Count: 5
2024-10-22 17:02:02,823 - DEBUG - Not the current player's turn.
2024-10-22 17:02:04,960 - INFO - Agent state has been reset.
2024-10-22 17:02:04,960 - INFO - === Starting MCTS Search ===
2024-10-22 17:02:04,961 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || X1|YGWB1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:04,961 - INFO - Max Rollouts: 10
2024-10-22 17:02:04,961 - DEBUG - --- Rollout #1 ---
2024-10-22 17:02:04,961 - DEBUG - Node () is a leaf node.
2024-10-22 17:02:04,961 - DEBUG - Traversing Path: ['()']
2024-10-22 17:02:05,154 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:05,154 - DEBUG - Network Policy Logits: [[ 0.00963648  0.01321772  0.0467783   0.01622162 -0.00130913 -0.01903991
   0.021854   -0.01146738  0.01136046  0.01787069  0.00378277  0.00356132
  -0.04691068 -0.0096902   0.01636172 -0.04051475  0.01735978 -0.02285466
  -0.00330072  0.01352815]]
2024-10-22 17:02:05,155 - DEBUG - Network Policy after Softmax: [[0.05038054 0.05056129 0.05228695 0.0507134  0.0498321  0.04895633
  0.05099984 0.04932846 0.05046747 0.0507971  0.05008649 0.0500754
  0.04761072 0.0494162  0.0507205  0.04791621 0.05077115 0.04876992
  0.04973295 0.05057698]]
2024-10-22 17:02:05,156 - DEBUG - Normalized Policy: [[0.         0.3394883  0.         0.         0.         0.32871196
  0.         0.         0.         0.         0.         0.
  0.         0.33179975 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:05,156 - DEBUG - Dirichlet Noise Added: [0.         0.25461623 0.         0.         0.         0.24653396
 0.         0.         0.         0.         0.         0.
 0.         0.4988498  0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:02:05,157 - DEBUG - Added Child Node: ((Reveal player +1 color W),) | P=0.4988498091697693
2024-10-22 17:02:05,158 - DEBUG - Added Child Node: ((Play 0),) | P=0.24653396010398865
2024-10-22 17:02:05,158 - DEBUG - Added Child Node: ((Discard 1),) | P=0.25461623072624207
2024-10-22 17:02:05,158 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:02:05,158 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:05,159 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || X1|YGWB1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:05,159 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:05,159 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:02:05,159 - DEBUG - --- Rollout #2 ---
2024-10-22 17:02:05,159 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W),)
2024-10-22 17:02:05,159 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)']
2024-10-22 17:02:05,160 - DEBUG - Move: (Reveal player +1 color W) | Reward: 5 | Depth: 1
2024-10-22 17:02:05,381 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:05,381 - DEBUG - Network Policy Logits: [[ 9.0034753e-03  1.8238012e-02  1.5029185e-02  1.7001731e-02
   2.9552244e-02 -7.4809119e-03 -4.3664668e-03  2.0628834e-02
  -3.6275983e-03  1.8669507e-03  3.8763274e-02 -2.9681219e-02
  -3.4631643e-02 -1.2199394e-05  5.4927967e-02 -2.8237278e-02
   3.1136289e-02  3.9653555e-02 -2.1070316e-02  2.1384344e-02]]
2024-10-22 17:02:05,382 - DEBUG - Network Policy after Softmax: [[0.05001531 0.05047932 0.0503176  0.05041695 0.0510537  0.0491976
  0.04935106 0.05060015 0.04938754 0.04965965 0.05152613 0.04811743
  0.04787982 0.04956642 0.0523658  0.04818696 0.05113463 0.05157202
  0.04853355 0.05063839]]
2024-10-22 17:02:05,383 - DEBUG - Normalized Policy: [[0.33958724 0.         0.         0.         0.         0.
  0.         0.         0.33532485 0.         0.         0.
  0.32508796 0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:05,384 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 0)) | P=0.3395872414112091
2024-10-22 17:02:05,385 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Play 3)) | P=0.33532485365867615
2024-10-22 17:02:05,385 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color G)) | P=0.3250879645347595
2024-10-22 17:02:05,385 - DEBUG - Simulating Node: ((Reveal player +1 color W),) | Value: 0.0
2024-10-22 17:02:05,385 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:05,385 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:05,385 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:05,386 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:02:05,386 - DEBUG - --- Rollout #3 ---
2024-10-22 17:02:05,386 - DEBUG - Expanding unexplored child: ((Discard 1),)
2024-10-22 17:02:05,386 - DEBUG - Traversing Path: ['()', '((Discard 1),)']
2024-10-22 17:02:05,387 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 1
2024-10-22 17:02:05,586 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:05,587 - DEBUG - Network Policy Logits: [[-0.00894628  0.01661296  0.00540936  0.0083024   0.04967886  0.02398022
   0.00977183  0.04128604 -0.02309496  0.02853665  0.00916574 -0.03057482
  -0.02670704 -0.00124048  0.0467703  -0.04094557  0.0552816   0.0245695
  -0.0091434   0.0135452 ]]
2024-10-22 17:02:05,587 - DEBUG - Network Policy after Softmax: [[0.04906304 0.05033322 0.04977245 0.04991665 0.05202536 0.05070541
  0.04999006 0.05159054 0.04837376 0.05093697 0.04995977 0.04801327
  0.04819934 0.04944257 0.05187425 0.04751791 0.05231766 0.05073529
  0.04905337 0.05017905]]
2024-10-22 17:02:05,589 - DEBUG - Normalized Policy: [[0.24926738 0.         0.         0.         0.         0.
  0.         0.         0.24576543 0.         0.         0.
  0.         0.         0.2635499  0.24141729 0.         0.
  0.         0.        ]]
2024-10-22 17:02:05,590 - DEBUG - Added Child Node: ((Discard 1), (Discard 0)) | P=0.24926738440990448
2024-10-22 17:02:05,590 - DEBUG - Added Child Node: ((Discard 1), (Play 3)) | P=0.24576543271541595
2024-10-22 17:02:05,591 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1)) | P=0.2414172887802124
2024-10-22 17:02:05,592 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color B)) | P=0.26354989409446716
2024-10-22 17:02:05,592 - DEBUG - Simulating Node: ((Discard 1),) | Value: 0.0
2024-10-22 17:02:05,592 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:05,592 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || X1|YGWB1
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 B5}
2024-10-22 17:02:05,592 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:05,593 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:02:05,593 - DEBUG - --- Rollout #4 ---
2024-10-22 17:02:05,593 - DEBUG - Expanding unexplored child: ((Play 0),)
2024-10-22 17:02:05,593 - DEBUG - Traversing Path: ['()', '((Play 0),)']
2024-10-22 17:02:05,594 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 1
2024-10-22 17:02:05,798 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:05,798 - DEBUG - Network Policy Logits: [[-0.00718587  0.01370533  0.00563576 -0.0009058   0.06047577  0.03207725
  -0.00359524  0.03251896 -0.02605642  0.01727466  0.00193378 -0.02482847
  -0.05014822 -0.01440919  0.04232199 -0.05059693  0.04550515  0.01253377
  -0.01959721  0.01303514]]
2024-10-22 17:02:05,799 - DEBUG - Network Policy after Softmax: [[0.04942338 0.05046676 0.05006115 0.04973474 0.05288318 0.0514025
  0.04960116 0.05142521 0.04849948 0.05064721 0.04987616 0.04855907
  0.047345   0.04906767 0.05193181 0.04732376 0.05209738 0.05040767
  0.04881376 0.05043295]]
2024-10-22 17:02:05,800 - DEBUG - Normalized Policy: [[0.2506531  0.         0.         0.         0.         0.
  0.         0.         0.24596746 0.         0.         0.
  0.         0.         0.2633747  0.24000476 0.         0.
  0.         0.        ]]
2024-10-22 17:02:05,801 - DEBUG - Added Child Node: ((Play 0), (Discard 0)) | P=0.25065308809280396
2024-10-22 17:02:05,802 - DEBUG - Added Child Node: ((Play 0), (Play 3)) | P=0.24596746265888214
2024-10-22 17:02:05,802 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 1)) | P=0.240004763007164
2024-10-22 17:02:05,803 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color B)) | P=0.2633746862411499
2024-10-22 17:02:05,803 - DEBUG - Simulating Node: ((Play 0),) | Value: 0.0
2024-10-22 17:02:05,803 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:05,803 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || R2|R2
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || X1|YGWB1
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:05,804 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:05,804 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:02:05,804 - DEBUG - --- Rollout #5 ---
2024-10-22 17:02:05,805 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.7910736799240112 | PUCT: 0.7910736799240112
2024-10-22 17:02:05,805 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.40376922488212585 | PUCT: 0.40376922488212585
2024-10-22 17:02:05,805 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.3909524083137512 | PUCT: 0.3909524083137512
2024-10-22 17:02:05,806 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.7910736799240112
2024-10-22 17:02:05,806 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:02:05,806 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Reveal player +1 color G))
2024-10-22 17:02:05,806 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Reveal player +1 color G))']
2024-10-22 17:02:05,807 - DEBUG - Move: (Reveal player +1 color W) | Reward: 5 | Depth: 1
2024-10-22 17:02:05,807 - DEBUG - Move: (Reveal player +1 color G) | Reward: 5 | Depth: 2
2024-10-22 17:02:05,998 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:05,999 - DEBUG - Network Policy Logits: [[-0.0152316   0.02512955  0.03004487  0.02080488 -0.00503523 -0.01315934
   0.01386864 -0.02307474  0.00047825  0.03501245 -0.0035491   0.00221659
  -0.05782572 -0.0157379   0.01903578 -0.02853256  0.00720949 -0.02367827
  -0.01155868  0.01176657]]
2024-10-22 17:02:05,999 - DEBUG - Network Policy after Softmax: [[0.04931034 0.05134127 0.05159425 0.05111971 0.0498157  0.04941263
  0.05076636 0.04892511 0.05009111 0.05185119 0.04988978 0.05017827
  0.04725411 0.04928538 0.05102936 0.04865881 0.05042943 0.04889558
  0.04949179 0.05065976]]
2024-10-22 17:02:06,000 - DEBUG - Normalized Policy: [[0.         0.5095711  0.         0.         0.         0.49042895
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:06,001 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color G), (Play 0)) | P=0.49042895436286926
2024-10-22 17:02:06,002 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Reveal player +1 color G), (Discard 1)) | P=0.5095710754394531
2024-10-22 17:02:06,002 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Reveal player +1 color G)) | Value: 0.0
2024-10-22 17:02:06,002 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:06,002 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 0, 'num_players': 2, 'deck_size': 1, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 0
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
Deck size: 1
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:06,002 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:06,002 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:02:06,002 - DEBUG - --- Rollout #6 ---
2024-10-22 17:02:06,003 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.5564529299736023 | PUCT: 0.5564529299736023
2024-10-22 17:02:06,003 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.4260258674621582 | PUCT: 0.4260258674621582
2024-10-22 17:02:06,004 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.4125025272369385 | PUCT: 0.4125025272369385
2024-10-22 17:02:06,004 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.5564529299736023
2024-10-22 17:02:06,004 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:02:06,004 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Discard 0))
2024-10-22 17:02:06,004 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Discard 0))']
2024-10-22 17:02:06,005 - DEBUG - Move: (Reveal player +1 color W) | Reward: 5 | Depth: 1
2024-10-22 17:02:06,005 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 2
2024-10-22 17:02:06,195 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:06,196 - DEBUG - Network Policy Logits: [[ 0.01192025  0.01720461  0.03857924  0.0169951   0.02974245  0.00884158
   0.01142987 -0.0035108  -0.02340613  0.04676483  0.00100931 -0.02711889
  -0.05555656 -0.00278548 -0.00530318 -0.00233552  0.01062458 -0.01527754
  -0.03284118  0.01490067]]
2024-10-22 17:02:06,196 - DEBUG - Network Policy after Softmax: [[0.05048433 0.05075181 0.0518483  0.05074118 0.05139214 0.05032915
  0.05045958 0.04971128 0.04873204 0.05227444 0.04993649 0.04855144
  0.0471902  0.04974736 0.04962226 0.04976974 0.05041896 0.04912977
  0.04827441 0.05063502]]
2024-10-22 17:02:06,198 - DEBUG - Normalized Policy: [[0.         0.33643737 0.         0.         0.         0.33363548
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.32992718 0.         0.
  0.         0.        ]]
2024-10-22 17:02:06,199 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 0), (Play 0)) | P=0.33363547921180725
2024-10-22 17:02:06,199 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 0), (Reveal player +1 rank 1)) | P=0.3299271762371063
2024-10-22 17:02:06,200 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 0), (Discard 1)) | P=0.3364373743534088
2024-10-22 17:02:06,200 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Discard 0)) | Value: 0.0
2024-10-22 17:02:06,201 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:06,201 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:06,201 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:06,201 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:02:06,201 - DEBUG - --- Rollout #7 ---
2024-10-22 17:02:06,202 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.43492186069488525 | PUCT: 0.43492186069488525
2024-10-22 17:02:06,202 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.44397395849227905 | PUCT: 0.44397395849227905
2024-10-22 17:02:06,203 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.42988091707229614 | PUCT: 0.42988091707229614
2024-10-22 17:02:06,203 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.44397395849227905
2024-10-22 17:02:06,204 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:02:06,204 - DEBUG - Expanding unexplored child: ((Discard 1), (Reveal player +1 rank 1))
2024-10-22 17:02:06,204 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Reveal player +1 rank 1))']
2024-10-22 17:02:06,204 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 1
2024-10-22 17:02:06,205 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 2
2024-10-22 17:02:06,411 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:06,412 - DEBUG - Network Policy Logits: [[-0.00507014  0.00160471  0.02353336  0.0253928   0.02494867 -0.0114839
   0.02039778 -0.01546305  0.00260517  0.01017423  0.00271172 -0.01271956
  -0.05515998 -0.03754035  0.00383287 -0.03318591  0.01903186 -0.03195663
   0.00101381  0.01118324]]
2024-10-22 17:02:06,412 - DEBUG - Network Policy after Softmax: [[0.04987479 0.05020881 0.05132198 0.0514175  0.05139467 0.04955593
  0.05116131 0.04935913 0.05025906 0.05064092 0.05026442 0.04949473
  0.0474381  0.04828135 0.0503208  0.04849205 0.05109147 0.0485517
  0.05017915 0.05069205]]
2024-10-22 17:02:06,413 - DEBUG - Normalized Policy: [[0.         0.         0.         0.34449482 0.         0.3320224
  0.         0.         0.         0.         0.         0.
  0.         0.32348278 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:06,414 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Reveal player +1 color W)) | P=0.32348278164863586
2024-10-22 17:02:06,415 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Play 0)) | P=0.33202239871025085
2024-10-22 17:02:06,415 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 rank 1), (Discard 3)) | P=0.3444948196411133
2024-10-22 17:02:06,415 - DEBUG - Simulating Node: ((Discard 1), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:02:06,415 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:06,416 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || R2|R2
XX || B2|B2
XX || B1|B1
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || X1|YGWB1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 B5}
2024-10-22 17:02:06,416 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:06,416 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:02:06,416 - DEBUG - --- Rollout #8 ---
2024-10-22 17:02:06,416 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.4495967626571655 | PUCT: 0.4495967626571655
2024-10-22 17:02:06,417 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3059695363044739 | PUCT: 0.3059695363044739
2024-10-22 17:02:06,417 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.44438573718070984 | PUCT: 0.44438573718070984
2024-10-22 17:02:06,417 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.4495967626571655
2024-10-22 17:02:06,417 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:02:06,417 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Play 3))
2024-10-22 17:02:06,418 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Play 3))']
2024-10-22 17:02:06,418 - DEBUG - Move: (Reveal player +1 color W) | Reward: 5 | Depth: 1
2024-10-22 17:02:06,419 - DEBUG - Move: (Play 3) | Reward: 6 | Depth: 2
2024-10-22 17:02:06,630 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:06,630 - DEBUG - Network Policy Logits: [[-0.02431921  0.03253987  0.03971983  0.00509703  0.02589221 -0.00296196
   0.02295854 -0.00191368 -0.00722536  0.05951241 -0.01290472 -0.00823282
  -0.04952262 -0.01511607  0.00565817 -0.02940878  0.00885551 -0.03358707
  -0.01366241  0.00259358]]
2024-10-22 17:02:06,630 - DEBUG - Network Policy after Softmax: [[0.04877279 0.05162632 0.05199833 0.05022881 0.05128426 0.04982564
  0.05113403 0.0498779  0.04961367 0.05303776 0.04933269 0.04956371
  0.04755891 0.04922372 0.050257   0.04852518 0.05041795 0.04832285
  0.04929533 0.05010322]]
2024-10-22 17:02:06,632 - DEBUG - Normalized Policy: [[0.         0.34422788 0.         0.         0.         0.33222157
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.3235505  0.         0.
  0.         0.        ]]
2024-10-22 17:02:06,632 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Play 3), (Play 0)) | P=0.3322215676307678
2024-10-22 17:02:06,633 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Play 3), (Reveal player +1 rank 1)) | P=0.3235504925251007
2024-10-22 17:02:06,634 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Play 3), (Discard 1)) | P=0.3442278802394867
2024-10-22 17:02:06,634 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Play 3)) | Value: 0.0
2024-10-22 17:02:06,634 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:06,634 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 1, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R1 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:06,634 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:06,634 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:02:06,634 - DEBUG - --- Rollout #9 ---
2024-10-22 17:02:06,635 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.36972349882125854 | PUCT: 0.36972349882125854
2024-10-22 17:02:06,635 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.31451553106307983 | PUCT: 0.31451553106307983
2024-10-22 17:02:06,636 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.4567978084087372 | PUCT: 0.4567978084087372
2024-10-22 17:02:06,636 - DEBUG - Selected Child: ((Play 0),) | PUCT: 0.4567978084087372
2024-10-22 17:02:06,636 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 17:02:06,636 - DEBUG - Expanding unexplored child: ((Play 0), (Reveal player +1 rank 1))
2024-10-22 17:02:06,636 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Reveal player +1 rank 1))']
2024-10-22 17:02:06,637 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 1
2024-10-22 17:02:06,637 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 6 | Depth: 2
2024-10-22 17:02:06,851 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:06,851 - DEBUG - Network Policy Logits: [[-0.007613    0.00011122  0.01875995  0.02147955  0.02912767 -0.00090002
   0.010239   -0.01329382  0.00077528  0.01021705  0.01197981 -0.02138034
  -0.06037179 -0.03709743  0.01752671 -0.02723207  0.03014491 -0.03598628
   0.00655218 -0.00132657]]
2024-10-22 17:02:06,851 - DEBUG - Network Policy after Softmax: [[0.04972726 0.05011285 0.05105616 0.0511952  0.05158826 0.05006221
  0.05062296 0.04944557 0.05014614 0.05062185 0.05071116 0.04904734
  0.04717172 0.04828249 0.05099324 0.04876117 0.05164076 0.04833616
  0.05043667 0.05004085]]
2024-10-22 17:02:06,854 - DEBUG - Normalized Policy: [[0.33564147 0.         0.         0.         0.         0.
  0.         0.         0.33846876 0.         0.         0.
  0.         0.32588977 0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:06,855 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 1), (Reveal player +1 color W)) | P=0.3258897662162781
2024-10-22 17:02:06,856 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 1), (Discard 0)) | P=0.335641473531723
2024-10-22 17:02:06,857 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 rank 1), (Play 3)) | P=0.3384687602519989
2024-10-22 17:02:06,858 - DEBUG - Simulating Node: ((Play 0), (Reveal player +1 rank 1)) | Value: 0.0
2024-10-22 17:02:06,858 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:06,858 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 15, 16, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
XX || X1|RYGWB1
-----
R2 || R2|R2
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || X1|YGWB1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3}
2024-10-22 17:02:06,858 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:06,858 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:02:06,858 - DEBUG - --- Rollout #10 ---
2024-10-22 17:02:06,859 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W),) | Q: 0.0 | U: 0.3784841001033783 | PUCT: 0.3784841001033783
2024-10-22 17:02:06,860 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3219679892063141 | PUCT: 0.3219679892063141
2024-10-22 17:02:06,860 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.3117477595806122 | PUCT: 0.3117477595806122
2024-10-22 17:02:06,861 - DEBUG - Selected Child: ((Reveal player +1 color W),) | PUCT: 0.3784841001033783
2024-10-22 17:02:06,861 - DEBUG - Selected child for exploration: ((Reveal player +1 color W),)
2024-10-22 17:02:06,861 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Reveal player +1 color G)) | Q: 0.0 | U: 0.5155229568481445 | PUCT: 0.5155229568481445
2024-10-22 17:02:06,862 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Discard 0)) | Q: 0.0 | U: 0.5385158658027649 | PUCT: 0.5385158658027649
2024-10-22 17:02:06,863 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 color W), (Play 3)) | Q: 0.0 | U: 0.531756579875946 | PUCT: 0.531756579875946
2024-10-22 17:02:06,863 - DEBUG - Selected Child: ((Reveal player +1 color W), (Discard 0)) | PUCT: 0.5385158658027649
2024-10-22 17:02:06,863 - DEBUG - Selected child for exploration: ((Reveal player +1 color W), (Discard 0))
2024-10-22 17:02:06,863 - DEBUG - Expanding unexplored child: ((Reveal player +1 color W), (Discard 0), (Discard 1))
2024-10-22 17:02:06,863 - DEBUG - Traversing Path: ['()', '((Reveal player +1 color W),)', '((Reveal player +1 color W), (Discard 0))', '((Reveal player +1 color W), (Discard 0), (Discard 1))']
2024-10-22 17:02:06,864 - DEBUG - Move: (Reveal player +1 color W) | Reward: 5 | Depth: 1
2024-10-22 17:02:06,865 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 2
2024-10-22 17:02:06,866 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 3
2024-10-22 17:02:07,073 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:07,074 - DEBUG - Network Policy Logits: [[-0.00839269  0.03004879  0.02050118  0.00441339  0.00523676  0.00307611
   0.00717233  0.01762168 -0.01897012  0.0093234   0.04452135  0.02730069
  -0.04294964 -0.00720615  0.04460997 -0.0217644   0.03421863  0.01851437
   0.00238541 -0.02019536]]
2024-10-22 17:02:07,074 - DEBUG - Network Policy after Softmax: [[0.04920049 0.05112865 0.05064282 0.0498346  0.04987565 0.049768
  0.04997228 0.0504972  0.04868282 0.05007989 0.05187399 0.05098834
  0.04752931 0.0492589  0.05187859 0.04854697 0.05134229 0.0505423
  0.04973364 0.0486232 ]]
2024-10-22 17:02:07,076 - DEBUG - Normalized Policy: [[0.33418113 0.         0.         0.         0.         0.
  0.         0.3429887  0.         0.         0.         0.
  0.3228301  0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:07,076 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 0), (Discard 1), (Discard 0)) | P=0.33418112993240356
2024-10-22 17:02:07,077 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 0), (Discard 1), (Play 2)) | P=0.3429886996746063
2024-10-22 17:02:07,077 - DEBUG - Added Child Node: ((Reveal player +1 color W), (Discard 0), (Discard 1), (Reveal player +1 color G)) | P=0.32283011078834534
2024-10-22 17:02:07,078 - DEBUG - Simulating Node: ((Reveal player +1 color W), (Discard 0), (Discard 1)) | Value: 0.0
2024-10-22 17:02:07,078 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:07,078 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
XX || XX|RYGWB12345
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2 B5}
2024-10-22 17:02:07,078 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:07,078 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:02:07,078 - INFO - === MCTS Search Completed ===
2024-10-22 17:02:07,078 - DEBUG - Best node chosen by MCTS: ((Reveal player +1 color W),) | Visit Count: 5
2024-10-22 17:02:07,078 - INFO - Actual Game Score: 5
2024-10-22 17:02:07,078 - DEBUG - === Recording Training Data ===
2024-10-22 17:02:07,078 - DEBUG - State Vector Shape: 658
2024-10-22 17:02:07,079 - DEBUG - Policy Targets: [0.         0.22222222 0.         0.         0.         0.22222222
 0.         0.         0.         0.         0.         0.
 0.         0.55555556 0.         0.         0.         0.
 0.         0.        ]
2024-10-22 17:02:07,079 - DEBUG - === End of Training Data ===
2024-10-22 17:02:07,079 - INFO - Chosen Action: (Reveal player +1 color W) | Visit Count: 5
2024-10-22 17:02:07,080 - DEBUG - Not the current player's turn.
2024-10-22 17:02:09,177 - INFO - Agent state has been reset.
2024-10-22 17:02:09,177 - INFO - === Starting MCTS Search ===
2024-10-22 17:02:09,177 - INFO - Initial Observation: {'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:09,177 - INFO - Max Rollouts: 10
2024-10-22 17:02:09,177 - DEBUG - --- Rollout #1 ---
2024-10-22 17:02:09,177 - DEBUG - Node () is a leaf node.
2024-10-22 17:02:09,178 - DEBUG - Traversing Path: ['()']
2024-10-22 17:02:09,395 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:09,395 - DEBUG - Network Policy Logits: [[ 0.02882757  0.01554843  0.03540254  0.01504402  0.02939456 -0.00132492
   0.0155761   0.0015628  -0.01460588  0.04654472  0.00019513 -0.02942132
  -0.04892147 -0.00648802 -0.00127833 -0.00810681  0.01712989 -0.01014075
  -0.03729465  0.00994873]]
2024-10-22 17:02:09,396 - DEBUG - Network Policy after Softmax: [[0.05130014 0.05062341 0.05163854 0.05059789 0.05132923 0.04977639
  0.05062482 0.04992035 0.04911969 0.05221713 0.04985212 0.04839732
  0.04746271 0.04952006 0.04977871 0.04943996 0.05070354 0.0493395
  0.04801777 0.05034073]]
2024-10-22 17:02:09,397 - DEBUG - Normalized Policy: [[0.         0.33785033 0.         0.         0.         0.33219752
  0.         0.         0.         0.         0.         0.
  0.         0.         0.         0.3299522  0.         0.
  0.         0.        ]]
2024-10-22 17:02:09,397 - DEBUG - Dirichlet Noise Added: [0.         0.32770222 0.         0.         0.         0.42211884
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.25017893 0.         0.
 0.         0.        ]
2024-10-22 17:02:09,398 - DEBUG - Added Child Node: ((Play 0),) | P=0.4221188426017761
2024-10-22 17:02:09,399 - DEBUG - Added Child Node: ((Reveal player +1 rank 1),) | P=0.2501789331436157
2024-10-22 17:02:09,399 - DEBUG - Added Child Node: ((Discard 1),) | P=0.32770222425460815
2024-10-22 17:02:09,399 - DEBUG - Simulating Node: () | Value: 0.0
2024-10-22 17:02:09,399 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:09,399 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 2, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:09,400 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:09,400 - DEBUG - Rollout #1 completed with reward=0.0
2024-10-22 17:02:09,400 - DEBUG - --- Rollout #2 ---
2024-10-22 17:02:09,400 - DEBUG - Expanding unexplored child: ((Discard 1),)
2024-10-22 17:02:09,400 - DEBUG - Traversing Path: ['()', '((Discard 1),)']
2024-10-22 17:02:09,401 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 1
2024-10-22 17:02:09,620 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:09,620 - DEBUG - Network Policy Logits: [[-0.00839269  0.03004879  0.02050118  0.00441339  0.00523676  0.00307611
   0.00717233  0.01762168 -0.01897012  0.0093234   0.04452135  0.02730069
  -0.04294964 -0.00720615  0.04460997 -0.0217644   0.03421863  0.01851437
   0.00238541 -0.02019536]]
2024-10-22 17:02:09,620 - DEBUG - Network Policy after Softmax: [[0.04920049 0.05112865 0.05064282 0.0498346  0.04987565 0.049768
  0.04997228 0.0504972  0.04868282 0.05007989 0.05187399 0.05098834
  0.04752931 0.0492589  0.05187859 0.04854697 0.05134229 0.0505423
  0.04973364 0.0486232 ]]
2024-10-22 17:02:09,622 - DEBUG - Normalized Policy: [[0.33418113 0.         0.         0.         0.         0.
  0.         0.3429887  0.         0.         0.         0.
  0.3228301  0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:09,623 - DEBUG - Added Child Node: ((Discard 1), (Discard 0)) | P=0.33418112993240356
2024-10-22 17:02:09,623 - DEBUG - Added Child Node: ((Discard 1), (Play 2)) | P=0.3429886996746063
2024-10-22 17:02:09,624 - DEBUG - Added Child Node: ((Discard 1), (Reveal player +1 color G)) | P=0.32283011078834534
2024-10-22 17:02:09,624 - DEBUG - Simulating Node: ((Discard 1),) | Value: 0.0
2024-10-22 17:02:09,624 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:09,625 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
XX || XX|RYGWB12345
-----
G4 || G4|G4
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2 B5}
2024-10-22 17:02:09,625 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:09,625 - DEBUG - Rollout #2 completed with reward=0.0
2024-10-22 17:02:09,625 - DEBUG - --- Rollout #3 ---
2024-10-22 17:02:09,625 - DEBUG - Expanding unexplored child: ((Play 0),)
2024-10-22 17:02:09,625 - DEBUG - Traversing Path: ['()', '((Play 0),)']
2024-10-22 17:02:09,626 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 1
2024-10-22 17:02:09,813 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:09,813 - DEBUG - Network Policy Logits: [[-0.00663228  0.02714117  0.02072758 -0.0047948   0.01603367  0.01117314
  -0.00619474  0.0088546  -0.02193158 -0.00193858  0.03728938  0.03304704
  -0.06639083 -0.02037485  0.04016166 -0.03141577  0.02444218  0.00647865
  -0.0080684  -0.02070542]]
2024-10-22 17:02:09,814 - DEBUG - Network Policy after Softmax: [[0.04956167 0.05126413 0.05093639 0.04965282 0.05069786 0.05045204
  0.04958336 0.0503352  0.04880918 0.04979485 0.05178701 0.05156778
  0.04668669 0.04888522 0.05193597 0.04834845 0.05112595 0.05021575
  0.04949054 0.04886907]]
2024-10-22 17:02:09,815 - DEBUG - Normalized Policy: [[0.3264226  0.         0.         0.         0.         0.
  0.         0.33151722 0.         0.         0.         0.
  0.         0.         0.3420602  0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:09,816 - DEBUG - Added Child Node: ((Play 0), (Discard 0)) | P=0.3264226019382477
2024-10-22 17:02:09,816 - DEBUG - Added Child Node: ((Play 0), (Reveal player +1 color B)) | P=0.3420602083206177
2024-10-22 17:02:09,817 - DEBUG - Added Child Node: ((Play 0), (Play 2)) | P=0.33151721954345703
2024-10-22 17:02:09,817 - DEBUG - Simulating Node: ((Play 0),) | Value: 0.0
2024-10-22 17:02:09,817 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:09,817 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 14, 15, 16, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}], [{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
XX || XX|RYGWB12345
-----
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:09,817 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:09,817 - DEBUG - Rollout #3 completed with reward=0.0
2024-10-22 17:02:09,817 - DEBUG - --- Rollout #4 ---
2024-10-22 17:02:09,818 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1),)
2024-10-22 17:02:09,818 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)']
2024-10-22 17:02:09,819 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 1
2024-10-22 17:02:10,011 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:10,011 - DEBUG - Network Policy Logits: [[ 0.01537186  0.02862642  0.04133942  0.01941833  0.02217687 -0.01859244
  -0.01829663  0.02293655 -0.00520372  0.00240263  0.0421799  -0.00388331
  -0.02943592 -0.01954347  0.05904893 -0.01709001  0.01661135  0.01526539
  -0.00602688  0.01306661]]
2024-10-22 17:02:10,011 - DEBUG - Network Policy after Softmax: [[0.05030508 0.0509763  0.05162849 0.05050906 0.05064858 0.0486252
  0.04863958 0.05068707 0.04928061 0.04965688 0.05167191 0.04934572
  0.04810078 0.04857897 0.05255095 0.04869831 0.05036748 0.05029973
  0.04924005 0.05018925]]
2024-10-22 17:02:10,013 - DEBUG - Normalized Policy: [[0.3374076  0.         0.         0.         0.         0.
  0.         0.33996966 0.         0.         0.         0.
  0.3226228  0.         0.         0.         0.         0.
  0.         0.        ]]
2024-10-22 17:02:10,014 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Discard 0)) | P=0.33740758895874023
2024-10-22 17:02:10,014 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Play 2)) | P=0.339969664812088
2024-10-22 17:02:10,015 - DEBUG - Added Child Node: ((Reveal player +1 rank 1), (Reveal player +1 color G)) | P=0.32262280583381653
2024-10-22 17:02:10,015 - DEBUG - Simulating Node: ((Reveal player +1 rank 1),) | Value: 0.0
2024-10-22 17:02:10,015 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:10,015 - DEBUG - MCTS Search completed with final observation={'current_player': 1, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 1, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'G'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 1}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 4}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 12, 14, 15, 16, 18, 19], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': 0}], [{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || R3|R3
XX || R4|R4
XX || R1|R1
XX || W1|W1
XX || X1|RYGWB1
-----
G4 || G4|G4
B5 || B5|B5
R2 || R2|R2
B2 || B2|B2
B1 || B1|B1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:10,015 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:10,015 - DEBUG - Rollout #4 completed with reward=0.0
2024-10-22 17:02:10,015 - DEBUG - --- Rollout #5 ---
2024-10-22 17:02:10,016 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.5196686387062073 | PUCT: 0.5196686387062073
2024-10-22 17:02:10,016 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.6693940758705139 | PUCT: 0.6693940758705139
2024-10-22 17:02:10,017 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3967325687408447 | PUCT: 0.3967325687408447
2024-10-22 17:02:10,017 - DEBUG - Selected Child: ((Play 0),) | PUCT: 0.6693940758705139
2024-10-22 17:02:10,017 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 17:02:10,017 - DEBUG - Expanding unexplored child: ((Play 0), (Reveal player +1 color B))
2024-10-22 17:02:10,018 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Reveal player +1 color B))']
2024-10-22 17:02:10,018 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 1
2024-10-22 17:02:10,019 - DEBUG - Move: (Reveal player +1 color B) | Reward: 6 | Depth: 2
2024-10-22 17:02:10,201 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:10,202 - DEBUG - Network Policy Logits: [[ 0.01329716 -0.00121946  0.02406318  0.01799475  0.05908189  0.02419048
   0.00670465 -0.00381395 -0.03114557  0.01747898  0.01389863 -0.0533643
  -0.05069335 -0.0086404  -0.01156626  0.00667812  0.03345758 -0.01417444
  -0.01267635  0.00756452]]
2024-10-22 17:02:10,202 - DEBUG - Network Policy after Softmax: [[0.05055792 0.04982929 0.05110517 0.05079598 0.05292651 0.05111168
  0.05022572 0.04970018 0.04836018 0.05076979 0.05058834 0.04729753
  0.04742403 0.04946088 0.04931638 0.05022438 0.05158753 0.04918792
  0.04926166 0.05026892]]
2024-10-22 17:02:10,202 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:02:10,203 - DEBUG - Simulating Node: ((Play 0), (Reveal player +1 color B)) | Value: 0.0
2024-10-22 17:02:10,203 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:10,203 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:10,203 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:10,203 - DEBUG - Rollout #5 completed with reward=0.0
2024-10-22 17:02:10,203 - DEBUG - --- Rollout #6 ---
2024-10-22 17:02:10,204 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.5483139157295227 | PUCT: 0.5483139157295227
2024-10-22 17:02:10,204 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.47086167335510254 | PUCT: 0.47086167335510254
2024-10-22 17:02:10,204 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4186013340950012 | PUCT: 0.4186013340950012
2024-10-22 17:02:10,205 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.5483139157295227
2024-10-22 17:02:10,205 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:02:10,205 - DEBUG - Expanding unexplored child: ((Discard 1), (Play 2))
2024-10-22 17:02:10,205 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Play 2))']
2024-10-22 17:02:10,205 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 1
2024-10-22 17:02:10,206 - DEBUG - Move: (Play 2) | Reward: 6 | Depth: 2
2024-10-22 17:02:10,424 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:10,425 - DEBUG - Network Policy Logits: [[ 0.00252101  0.01290638 -0.00109605  0.03195628  0.01804759  0.01641902
  -0.0137712  -0.01748003 -0.01252759  0.00997722  0.02401167 -0.02741203
  -0.07932514 -0.02134334  0.01109761 -0.00296169 -0.00780666  0.00430554
  -0.01907266  0.01816648]]
2024-10-22 17:02:10,425 - DEBUG - Network Policy after Softmax: [[0.05024605 0.0507706  0.05006464 0.05174704 0.05103229 0.05094925
  0.04943407 0.04925106 0.04949558 0.0506221  0.05133756 0.04876432
  0.0462974  0.04906116 0.05067885 0.04997132 0.0497298  0.0503358
  0.04917269 0.05103836]]
2024-10-22 17:02:10,426 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:02:10,426 - DEBUG - Simulating Node: ((Discard 1), (Play 2)) | Value: 0.0
2024-10-22 17:02:10,427 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:10,427 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 1, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 4}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R1 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2 B5}
2024-10-22 17:02:10,427 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:10,428 - DEBUG - Rollout #6 completed with reward=0.0
2024-10-22 17:02:10,428 - DEBUG - --- Rollout #7 ---
2024-10-22 17:02:10,428 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.38094261288642883 | PUCT: 0.38094261288642883
2024-10-22 17:02:10,429 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.4906986951828003 | PUCT: 0.4906986951828003
2024-10-22 17:02:10,429 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.4362366497516632 | PUCT: 0.4362366497516632
2024-10-22 17:02:10,430 - DEBUG - Selected Child: ((Play 0),) | PUCT: 0.4906986951828003
2024-10-22 17:02:10,430 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 17:02:10,430 - DEBUG - Expanding unexplored child: ((Play 0), (Play 2))
2024-10-22 17:02:10,430 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Play 2))']
2024-10-22 17:02:10,430 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 1
2024-10-22 17:02:10,431 - DEBUG - Move: (Play 2) | Reward: 7 | Depth: 2
2024-10-22 17:02:10,628 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:10,628 - DEBUG - Network Policy Logits: [[ 0.00512111  0.00550019 -0.01374334  0.03008979  0.02843868  0.01855065
  -0.02586636 -0.01212814 -0.01201044  0.00696976  0.03282196 -0.03271842
  -0.08332918 -0.02324731  0.02240307  0.00172161 -0.0041417   0.0030692
  -0.01720273  0.00077962]]
2024-10-22 17:02:10,629 - DEBUG - Network Policy after Softmax: [[0.05041331 0.05043242 0.0494712  0.05168791 0.05160264 0.0510949
  0.04887508 0.04955117 0.049557   0.05050659 0.05182932 0.04854133
  0.04614575 0.04900326 0.05129212 0.05024222 0.04994849 0.05030997
  0.04930036 0.05019492]]
2024-10-22 17:02:10,629 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:02:10,629 - DEBUG - Simulating Node: ((Play 0), (Play 2)) | Value: 0.0
2024-10-22 17:02:10,629 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:10,629 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 2, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 1, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 2
Fireworks: R1 Y2 G4 W0 B0 
Hands:
Cur player
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:10,629 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:10,630 - DEBUG - Rollout #7 completed with reward=0.0
2024-10-22 17:02:10,630 - DEBUG - --- Rollout #8 ---
2024-10-22 17:02:10,630 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.3937962055206299 | PUCT: 0.3937962055206299
2024-10-22 17:02:10,631 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.38044169545173645 | PUCT: 0.38044169545173645
2024-10-22 17:02:10,631 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.45095592737197876 | PUCT: 0.45095592737197876
2024-10-22 17:02:10,631 - DEBUG - Selected Child: ((Reveal player +1 rank 1),) | PUCT: 0.45095592737197876
2024-10-22 17:02:10,631 - DEBUG - Selected child for exploration: ((Reveal player +1 rank 1),)
2024-10-22 17:02:10,631 - DEBUG - Expanding unexplored child: ((Reveal player +1 rank 1), (Play 2))
2024-10-22 17:02:10,631 - DEBUG - Traversing Path: ['()', '((Reveal player +1 rank 1),)', '((Reveal player +1 rank 1), (Play 2))']
2024-10-22 17:02:10,632 - DEBUG - Move: (Reveal player +1 rank 1) | Reward: 5 | Depth: 1
2024-10-22 17:02:10,633 - DEBUG - Move: (Play 2) | Reward: 6 | Depth: 2
2024-10-22 17:02:10,818 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:10,819 - DEBUG - Network Policy Logits: [[ 0.0128398   0.03505551  0.00970658  0.01925038  0.00253779  0.00822761
  -0.01720316 -0.00880236 -0.02549281  0.02789378  0.02132957  0.00834673
  -0.07349771 -0.00190448  0.02193295 -0.00141188 -0.01144013 -0.01180465
  -0.04689493  0.00814922]]
2024-10-22 17:02:10,819 - DEBUG - Network Policy after Softmax: [[0.05068899 0.05182768 0.05053042 0.05101497 0.05016947 0.05045574
  0.04918879 0.04960375 0.04878272 0.05145783 0.05112116 0.05046175
  0.04649623 0.04994709 0.05115201 0.04997171 0.04947308 0.04945505
  0.04774976 0.05045178]]
2024-10-22 17:02:10,820 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:02:10,820 - DEBUG - Simulating Node: ((Reveal player +1 rank 1), (Play 2)) | Value: 0.0
2024-10-22 17:02:10,820 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:10,820 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 1, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 1, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'DISCARD', 'card_index': 4}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 4}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 2}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 13, 14, 15, 17, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': 0}]], 'pyhanabi': Life tokens: 1
Info tokens: 1
Fireworks: R1 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R3 || R3|R3
R4 || R4|R4
W1 || W1|W1
B1 || X1|RYGWB1
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2}
2024-10-22 17:02:10,820 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:10,820 - DEBUG - Rollout #8 completed with reward=0.0
2024-10-22 17:02:10,820 - DEBUG - --- Rollout #9 ---
2024-10-22 17:02:10,821 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.40479525923728943 | PUCT: 0.40479525923728943
2024-10-22 17:02:10,821 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.3910677433013916 | PUCT: 0.3910677433013916
2024-10-22 17:02:10,822 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.3090343177318573 | PUCT: 0.3090343177318573
2024-10-22 17:02:10,822 - DEBUG - Selected Child: ((Discard 1),) | PUCT: 0.40479525923728943
2024-10-22 17:02:10,822 - DEBUG - Selected child for exploration: ((Discard 1),)
2024-10-22 17:02:10,822 - DEBUG - Expanding unexplored child: ((Discard 1), (Discard 0))
2024-10-22 17:02:10,822 - DEBUG - Traversing Path: ['()', '((Discard 1),)', '((Discard 1), (Discard 0))']
2024-10-22 17:02:10,823 - DEBUG - Move: (Discard 1) | Reward: 5 | Depth: 1
2024-10-22 17:02:10,823 - DEBUG - Move: (Discard 0) | Reward: 5 | Depth: 2
2024-10-22 17:02:11,007 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:11,008 - DEBUG - Network Policy Logits: [[-0.00837975  0.02070465  0.00763293  0.03906382 -0.00083501  0.01490807
  -0.01082769 -0.00513702  0.01390984  0.01237557  0.03460898 -0.02782479
  -0.07033124 -0.03211812  0.03016386 -0.01419235 -0.0001489  -0.00611276
  -0.01406026  0.01402036]]
2024-10-22 17:02:11,008 - DEBUG - Network Policy after Softmax: [[0.04957404 0.05103704 0.05037424 0.05198269 0.04994947 0.05074206
  0.04945283 0.04973505 0.05069143 0.05061371 0.05175163 0.04861937
  0.04659605 0.04841109 0.05152209 0.04928672 0.04998375 0.04968654
  0.04929323 0.05069703]]
2024-10-22 17:02:11,009 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:02:11,009 - DEBUG - Simulating Node: ((Discard 1), (Discard 0)) | Value: 0.0
2024-10-22 17:02:11,009 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:11,009 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 4, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 0, 'Y': 2, 'G': 3, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'G', 'rank': 3}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 4
Fireworks: R0 Y2 G3 W0 B0 
Hands:
Cur player
XX || G4|G4
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2 B5 R3}
2024-10-22 17:02:11,009 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:11,009 - DEBUG - Rollout #9 completed with reward=0.0
2024-10-22 17:02:11,009 - DEBUG - --- Rollout #10 ---
2024-10-22 17:02:11,010 - DEBUG - PUCT Calculation | Child: ((Discard 1),) | Q: 0.0 | U: 0.31079015135765076 | PUCT: 0.31079015135765076
2024-10-22 17:02:11,010 - DEBUG - PUCT Calculation | Child: ((Play 0),) | Q: 0.0 | U: 0.40033411979675293 | PUCT: 0.40033411979675293
2024-10-22 17:02:11,010 - DEBUG - PUCT Calculation | Child: ((Reveal player +1 rank 1),) | Q: 0.0 | U: 0.31635692715644836 | PUCT: 0.31635692715644836
2024-10-22 17:02:11,011 - DEBUG - Selected Child: ((Play 0),) | PUCT: 0.40033411979675293
2024-10-22 17:02:11,011 - DEBUG - Selected child for exploration: ((Play 0),)
2024-10-22 17:02:11,011 - DEBUG - Expanding unexplored child: ((Play 0), (Discard 0))
2024-10-22 17:02:11,011 - DEBUG - Traversing Path: ['()', '((Play 0),)', '((Play 0), (Discard 0))']
2024-10-22 17:02:11,012 - DEBUG - Move: (Play 0) | Reward: 6 | Depth: 1
2024-10-22 17:02:11,012 - DEBUG - Move: (Discard 0) | Reward: 6 | Depth: 2
2024-10-22 17:02:11,199 - DEBUG - Network Value Output: 0.0
2024-10-22 17:02:11,199 - DEBUG - Network Policy Logits: [[-0.00917662  0.01483453 -0.00258688  0.041292    0.00846778  0.01412085
  -0.01879883 -0.00117631  0.01830928  0.01413517  0.04348427 -0.03849933
  -0.07635925 -0.02540712  0.04266405 -0.00884427  0.00495001 -0.00908939
  -0.00358865 -0.00530949]]
2024-10-22 17:02:11,199 - DEBUG - Network Policy after Softmax: [[0.04951625 0.05071958 0.04984362 0.0520794  0.05039769 0.05068339
  0.04904208 0.04991398 0.05089612 0.05068412 0.0521937  0.04808538
  0.0462989  0.04871906 0.05215091 0.04953271 0.05022071 0.04952057
  0.04979372 0.04970811]]
2024-10-22 17:02:11,200 - DEBUG - Normalized Policy: [[0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
2024-10-22 17:02:11,200 - DEBUG - Simulating Node: ((Play 0), (Discard 0)) | Value: 0.0
2024-10-22 17:02:11,200 - DEBUG - Backpropagating reward: 0.0
2024-10-22 17:02:11,200 - DEBUG - MCTS Search completed with final observation={'current_player': 0, 'current_player_offset': 0, 'life_tokens': 1, 'information_tokens': 3, 'num_players': 2, 'deck_size': 0, 'turns_to_play': 0, 'fireworks': {'R': 0, 'Y': 2, 'G': 4, 'W': 0, 'B': 0}, 'legal_moves': [{'action_type': 'DISCARD', 'card_index': 0}, {'action_type': 'DISCARD', 'card_index': 1}, {'action_type': 'DISCARD', 'card_index': 2}, {'action_type': 'DISCARD', 'card_index': 3}, {'action_type': 'PLAY', 'card_index': 0}, {'action_type': 'PLAY', 'card_index': 1}, {'action_type': 'PLAY', 'card_index': 2}, {'action_type': 'PLAY', 'card_index': 3}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'R'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'W'}, {'action_type': 'REVEAL_COLOR', 'target_offset': 1, 'color': 'B'}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 0}, {'action_type': 'REVEAL_RANK', 'target_offset': 1, 'rank': 3}], 'legal_moves_as_int': [0, 1, 2, 3, 5, 6, 7, 8, 10, 13, 14, 15, 18], 'observed_hands': [[{'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}, {'color': None, 'rank': -1}], [{'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'B', 'rank': 0}]], 'discard_pile': [{'color': 'B', 'rank': 2}, {'color': 'R', 'rank': 2}, {'color': 'R', 'rank': 3}, {'color': 'Y', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': 'R', 'rank': 0}, {'color': 'R', 'rank': 4}, {'color': 'G', 'rank': 1}, {'color': 'Y', 'rank': 2}, {'color': 'W', 'rank': 2}, {'color': 'Y', 'rank': 2}, {'color': 'Y', 'rank': 0}, {'color': 'B', 'rank': 1}, {'color': 'Y', 'rank': 3}, {'color': 'G', 'rank': 0}, {'color': 'W', 'rank': 2}, {'color': 'W', 'rank': 0}, {'color': 'Y', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'B', 'rank': 0}, {'color': 'W', 'rank': 3}, {'color': 'W', 'rank': 1}, {'color': 'Y', 'rank': 1}, {'color': 'W', 'rank': 4}, {'color': 'Y', 'rank': 4}, {'color': 'G', 'rank': 3}, {'color': 'B', 'rank': 3}, {'color': 'G', 'rank': 4}, {'color': 'B', 'rank': 2}, {'color': 'B', 'rank': 3}, {'color': 'W', 'rank': 3}, {'color': 'G', 'rank': 2}, {'color': 'R', 'rank': 1}, {'color': 'R', 'rank': 2}], 'card_knowledge': [[{'color': 'B', 'rank': 4}, {'color': 'R', 'rank': 1}, {'color': 'B', 'rank': 1}, {'color': 'B', 'rank': 0}], [{'color': 'R', 'rank': 3}, {'color': 'R', 'rank': 0}, {'color': 'W', 'rank': 0}, {'color': None, 'rank': None}]], 'pyhanabi': Life tokens: 1
Info tokens: 3
Fireworks: R0 Y2 G4 W0 B0 
Hands:
Cur player
XX || B5|B5
XX || R2|R2
XX || B2|B2
XX || B1|B1
-----
R4 || R4|R4
R1 || R1|R1
W1 || W1|W1
B1 || XX|RYGWB12345
Deck size: 0
Discards: B3 R3 R4 Y1 R1 G1 W1 R1 R5 G2 Y3 W3 Y3 Y1 B2 Y4 G1 W3 W1 Y4 W2 B1 W4 W2 Y2 W5 Y5 G4 B4 G5 B3 B4 W4 G3 R2 R3}
2024-10-22 17:02:11,200 - DEBUG - MCTS Search completed with reward=0.0
2024-10-22 17:02:11,200 - DEBUG - Rollout #10 completed with reward=0.0
2024-10-22 17:02:11,200 - INFO - === MCTS Search Completed ===
2024-10-22 17:02:11,200 - DEBUG - Best node chosen by MCTS: ((Play 0),) | Visit Count: 4
2024-10-22 17:02:11,200 - INFO - Actual Game Score: 6
2024-10-22 17:02:11,200 - DEBUG - === Recording Training Data ===
2024-10-22 17:02:11,200 - DEBUG - State Vector Shape: 658
2024-10-22 17:02:11,201 - DEBUG - Policy Targets: [0.         0.33333333 0.         0.         0.         0.44444444
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.22222222 0.         0.
 0.         0.        ]
2024-10-22 17:02:11,201 - DEBUG - === End of Training Data ===
2024-10-22 17:02:11,201 - INFO - Chosen Action: (Play 0) | Visit Count: 4
2024-10-22 17:02:11,203 - DEBUG - Not the current player's turn.
